Starting Deno language server...
{"type":"mark","name":"lsp.initialize","count":1,"args":{"processId":308,"rootPath":"/workspaces/ProspectPro","rootUri":"file:///workspaces/ProspectPro","initializationOptions":{"enable":true,"cacheOnSave":true,"disablePaths":[],"enablePaths":["supabase/functions"],"path":null,"env":{},"envFile":null,"cache":null,"certificateStores":null,"codeLens":{"implementations":true,"references":true,"referencesAllFunctions":true,"test":true,"testArgs":["--allow-all","--no-check"]},"config":null,"documentPreloadLimit":1000,"future":false,"importMap":null,"inlayHints":{"parameterNames":{"enabled":"none","suppressWhenArgumentMatchesName":true},"parameterTypes":{"enabled":false},"variableTypes":{"enabled":false,"suppressWhenTypeMatchesName":true},"propertyDeclarationTypes":{"enabled":false},"functionLikeReturnTypes":{"enabled":false},"enumMemberValues":{"enabled":false}},"maxTsServerMemory":3072,"suggest":{"autoImports":true,"completeFunctionCalls":false,"names":true,"paths":true,"imports":{"autoDiscover":true,"hosts":{"https://deno.land":true}}},"trace":{"server":"off"},"testing":{"args":["--allow-all","--no-check"]},"tlsCertificate":null,"unsafelyIgnoreCertificateErrors":null,"unstable":true,"lint":true,"internalDebug":false,"internalInspect":false,"logFile":true,"defaultTaskCommand":"open","javascript":{"referencesCodeLens":{"enabled":false,"showOnAllFunctions":false},"validate":{"enable":true},"suggestionActions":{"enabled":true},"updateImportsOnFileMove":{"enabled":"prompt"},"autoClosingTags":true,"preferGoToSourceDefinition":false,"updateImportsOnPaste":{"enabled":true},"suggest":{"enabled":true,"autoImports":true,"names":true,"completeFunctionCalls":false,"paths":true,"completeJSDocs":true,"jsdoc":{"generateReturns":true},"includeAutomaticOptionalChainCompletions":true,"includeCompletionsForImportStatements":true,"classMemberSnippets":{"enabled":true}},"preferences":{"quoteStyle":"auto","importModuleSpecifier":"shortest","importModuleSpecifierEnding":"auto","jsxAttributeCompletionStyle":"auto","autoImportFileExcludePatterns":[],"autoImportSpecifierExcludeRegexes":[],"useAliasesForRenames":true,"renameMatchingJsxTags":true,"organizeImports":{}},"format":{"enable":true,"insertSpaceAfterCommaDelimiter":true,"insertSpaceAfterConstructor":false,"insertSpaceAfterSemicolonInForStatements":true,"insertSpaceBeforeAndAfterBinaryOperators":true,"insertSpaceAfterKeywordsInControlFlowStatements":true,"insertSpaceAfterFunctionKeywordForAnonymousFunctions":true,"insertSpaceBeforeFunctionParenthesis":false,"insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis":false,"insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets":false,"insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces":true,"insertSpaceAfterOpeningAndBeforeClosingEmptyBraces":true,"insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces":false,"insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces":false,"placeOpenBraceOnNewLineForFunctions":false,"placeOpenBraceOnNewLineForControlBlocks":false,"semicolons":"ignore","indentSwitchCase":true},"inlayHints":{"parameterNames":{"enabled":"none","suppressWhenArgumentMatchesName":true},"parameterTypes":{"enabled":false},"variableTypes":{"enabled":false,"suppressWhenTypeMatchesName":true},"propertyDeclarationTypes":{"enabled":false},"functionLikeReturnTypes":{"enabled":false}}},"typescript":{"tsdk":"","disableAutomaticTypeAcquisition":false,"enablePromptUseWorkspaceTsdk":false,"referencesCodeLens":{"enabled":false,"showOnAllFunctions":false},"implementationsCodeLens":{"enabled":false,"showOnInterfaceMethods":false},"experimental":{"useTsgo":false},"reportStyleChecksAsWarnings":true,"validate":{"enable":true},"tsc":{"autoDetect":"on"},"locale":"auto","suggestionActions":{"enabled":true},"updateImportsOnFileMove":{"enabled":"prompt"},"autoClosingTags":true,"workspaceSymbols":{"scope":"allOpenProjects","excludeLibrarySymbols":true},"preferGoToSourceDefinition":false,"tsserver":{"enableRegionDiagnostics":true,"nodePath":"","web":{"projectWideIntellisense":{"enabled":true,"suppressSemanticErrors":false},"typeAcquisition":{"enabled":true}},"useSyntaxServer":"auto","maxTsServerMemory":3072,"experimental":{"enableProjectDiagnostics":false},"watchOptions":"vscode","enableTracing":false,"log":"off","pluginPaths":[]},"updateImportsOnPaste":{"enabled":true},"suggest":{"enabled":true,"autoImports":false,"completeFunctionCalls":false,"paths":true,"completeJSDocs":true,"jsdoc":{"generateReturns":true},"includeAutomaticOptionalChainCompletions":true,"includeCompletionsForImportStatements":true,"classMemberSnippets":{"enabled":true},"objectLiteralMethodSnippets":{"enabled":true}},"preferences":{"quoteStyle":"auto","importModuleSpecifier":"shortest","importModuleSpecifierEnding":"auto","jsxAttributeCompletionStyle":"auto","includePackageJsonAutoImports":"auto","autoImportFileExcludePatterns":[],"autoImportSpecifierExcludeRegexes":[],"preferTypeOnlyAutoImports":false,"useAliasesForRenames":true,"renameMatchingJsxTags":true,"organizeImports":{}},"format":{"enable":true,"insertSpaceAfterCommaDelimiter":true,"insertSpaceAfterConstructor":false,"insertSpaceAfterSemicolonInForStatements":true,"insertSpaceBeforeAndAfterBinaryOperators":true,"insertSpaceAfterKeywordsInControlFlowStatements":true,"insertSpaceAfterFunctionKeywordForAnonymousFunctions":true,"insertSpaceBeforeFunctionParenthesis":false,"insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis":false,"insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets":false,"insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces":true,"insertSpaceAfterOpeningAndBeforeClosingEmptyBraces":true,"insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces":false,"insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces":false,"insertSpaceAfterTypeAssertion":false,"placeOpenBraceOnNewLineForFunctions":false,"placeOpenBraceOnNewLineForControlBlocks":false,"semicolons":"ignore","indentSwitchCase":true},"inlayHints":{"parameterNames":{"enabled":"none","suppressWhenArgumentMatchesName":true},"parameterTypes":{"enabled":false},"variableTypes":{"enabled":false,"suppressWhenTypeMatchesName":true},"propertyDeclarationTypes":{"enabled":false},"functionLikeReturnTypes":{"enabled":false},"enumMemberValues":{"enabled":false}},"npm":"","check":{"npmIsInstalled":true}},"enableBuiltinCommands":true},"capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional","normalizesLineEndings":true,"changeAnnotationSupport":{"groupsOnLabel":true}},"didChangeConfiguration":{"dynamicRegistration":true},"didChangeWatchedFiles":{"dynamicRegistration":true,"relativePatternSupport":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"tagSupport":{"valueSet":[1]},"resolveSupport":{"properties":["location.range"]}},"executeCommand":{"dynamicRegistration":true},"workspaceFolders":true,"configuration":true,"semanticTokens":{"refreshSupport":true},"codeLens":{"refreshSupport":true},"fileOperations":{"dynamicRegistration":true,"didCreate":true,"willCreate":true,"didRename":true,"willRename":true,"didDelete":true,"willDelete":true},"inlineValue":{"refreshSupport":true},"inlayHint":{"refreshSupport":true}},"textDocument":{"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]},"insertReplaceSupport":true,"resolveSupport":{"properties":["documentation","detail","additionalTextEdits"]},"insertTextModeSupport":{"valueSet":[1,2]},"labelDetailsSupport":true},"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]},"contextSupport":true,"insertTextMode":2,"completionList":{"itemDefaults":["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true},"activeParameterSupport":true},"contextSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true,"tagSupport":{"valueSet":[1]}},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"declaration":{"dynamicRegistration":true,"linkSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"codeAction":{"dynamicRegistration":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.move","refactor.rewrite","source","source.organizeImports","notebook"]}},"isPreferredSupport":true,"disabledSupport":true,"dataSupport":true,"resolveSupport":{"properties":["edit","command"]},"honorsChangeAnnotations":true},"codeLens":{"dynamicRegistration":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"colorProvider":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true,"prepareSupportDefaultBehavior":1,"honorsChangeAnnotations":true},"publishDiagnostics":{"relatedInformation":true,"tagSupport":{"valueSet":[1,2]},"versionSupport":false,"codeDescriptionSupport":true,"dataSupport":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true,"foldingRangeKind":{"valueSet":["comment","imports","region"]},"foldingRange":{"collapsedText":false}},"selectionRange":{"dynamicRegistration":true},"linkedEditingRange":{"dynamicRegistration":true},"callHierarchy":{"dynamicRegistration":true},"semanticTokens":{"dynamicRegistration":true,"requests":{"range":true,"full":{"delta":true}},"tokenTypes":["namespace","type","class","enum","interface","struct","typeParameter","parameter","variable","property","enumMember","event","function","method","macro","keyword","comment","string","number","regexp","operator","decorator","label"],"tokenModifiers":["declaration","definition","readonly","static","deprecated","abstract","async","modification","documentation","defaultLibrary"],"formats":["relative"],"overlappingTokenSupport":false,"multilineTokenSupport":false,"serverCancelSupport":true,"augmentsSyntaxTokens":true},"typeHierarchy":{"dynamicRegistration":true},"inlineValue":{"dynamicRegistration":true},"inlayHint":{"dynamicRegistration":true,"resolveSupport":{"properties":["tooltip","textEdits","label.tooltip","label.location","label.command"]}},"diagnostic":{"dynamicRegistration":true,"relatedDocumentSupport":false}},"notebookDocument":{"synchronization":{"dynamicRegistration":true}},"window":{"workDoneProgress":true,"showMessage":{"messageActionItem":{"additionalPropertiesSupport":true}},"showDocument":{"support":true}},"general":{"regularExpressions":{"engine":"ECMAScript","version":"ES2020"},"markdown":{"parser":"marked","version":"1.1.0"},"staleRequestSupport":{"cancel":true,"retryOnContentModified":["textDocument/semanticTokens/full","textDocument/semanticTokens/range","textDocument/semanticTokens/full/delta"]},"positionEncodings":["utf-16"]},"experimental":{"testingApi":true}},"trace":"off","workspaceFolders":[{"uri":"file:///workspaces/ProspectPro","name":"ProspectPro"}],"clientInfo":{"name":"Visual Studio Code","version":"1.105.0"},"locale":"en"}},
  version: 2.5.2 (release, x86_64-unknown-linux-gnu)
  executable: /usr/local/share/npm-global/lib/node_modules/deno/deno
Connected to "Visual Studio Code" 1.105.0
{"type":"measure","name":"lsp.initialize","count":1,"duration":21.135},
{"type":"mark","name":"lsp.update_global_cache"},
Enabling import suggestions for: https://deno.land
{"type":"measure","name":"lsp.update_global_cache","count":1,"duration":506.899},
Refreshing configuration tree...
{"type":"mark","name":"lsp.update_cache"},
{"type":"measure","name":"lsp.update_cache","count":1,"duration":0.001},
{"type":"mark","name":"lsp.did_open","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","languageId":"javascript","version":1,"text":"#!/usr/bin/env node\n\n/**\n * ProspectPro Production MCP Server v4.1 - Post-Cleanup Enhanced\n * Optimized for cleaned database architecture, streamlined Edge Functions, and MECE taxonomy\n *\n * Updated Features (Oct 2025):\n * - 2 Essential Edge Functions: business-discovery-optimized + campaign-export\n * - Cleaned Database: campaigns, leads, dashboard_exports (core tables only)\n * - MECE Business Taxonomy: 16 categories, 300+ optimized business types\n * - Security Hardened: No SECURITY DEFINER issues, fixed trigger functions\n * - Cache-Optimized: Real-time deployment updates via Vercel\n * - Cost Intelligence: Dynamic pricing with admin panel integration\n */\n\nconst { Server } = require(\"@modelcontextprotocol/sdk/server/index.js\");\nconst {\n  StdioServerTransport,\n} = require(\"@modelcontextprotocol/sdk/server/stdio.js\");\nconst { CallToolRequestSchema } = require(\"@modelcontextprotocol/sdk/types.js\");\nconst { createClient } = require(\"@supabase/supabase-js\");\nconst https = require(\"https\");\nconst { spawn } = require(\"child_process\");\nconst fs = require(\"fs\");\nconst path = require(\"path\");\n\nclass ProductionMCPServer {\n  constructor() {\n    this.server = new Server(\n      {\n        name: \"prospectpro-production-v4.1\",\n        version: \"4.1.0\",\n      },\n      {\n        capabilities: {\n          tools: {},\n        },\n      }\n    );\n\n    this.supabase = null;\n    this.apiClients = {};\n    this.workspaceRoot = process.env.WORKSPACE_ROOT || process.cwd();\n    this.setupTools();\n    this.setupErrorHandling();\n  }\n\n  setupTools() {\n    this.server.setRequestHandler(CallToolRequestSchema, async (request) => {\n      switch (request.params.name) {\n        // === PRODUCTION MONITORING TOOLS ===\n        case \"environment_health_check\":\n          return await this.environmentHealthCheck();\n        case \"github_actions_monitor\":\n          return await this.githubActionsMonitor(request.params.arguments);\n        case \"dev_prod_config_diff\":\n          return await this.devProdConfigDiff();\n        case \"cost_budget_monitor\":\n          return await this.costBudgetMonitor();\n        case \"api_health_dashboard\":\n          return await this.apiHealthDashboard();\n        case \"vault_api_key_status\":\n          return await this.vaultApiKeyStatus();\n        case \"production_startup_validator\":\n          return await this.productionStartupValidator();\n        case \"github_workflow_optimizer\":\n          return await this.githubWorkflowOptimizer();\n\n        // === SYSTEM DIAGNOSTICS TOOLS (from monitoring-server) ===\n        case \"get_system_health\":\n          return await this.getSystemHealth(request.params.arguments);\n        case \"read_diagnostics\":\n          return await this.readDiagnostics(request.params.arguments);\n        case \"analyze_logs\":\n          return await this.analyzeLogs(request.params.arguments);\n        case \"validate_configuration\":\n          return await this.validateConfiguration(request.params.arguments);\n        case \"generate_performance_report\":\n          return await this.generatePerformanceReport(request.params.arguments);\n        case \"monitor_api_quotas\":\n          return await this.monitorAPIQuotas(request.params.arguments);\n\n        // === DATABASE ANALYTICS TOOLS (from database-server) ===\n        case \"query_leads\":\n          return await this.queryLeads(request.params.arguments);\n        case \"get_campaign_stats\":\n          return await this.getCampaignStats(request.params.arguments);\n        case \"analyze_lead_quality\":\n          return await this.analyzeLeadQuality(request.params.arguments);\n        case \"get_api_costs\":\n          return await this.getApiCosts(request.params.arguments);\n\n        // === API TESTING TOOLS (from api-server) ===\n        case \"test_google_places\":\n          return await this.testGooglePlaces(request.params.arguments);\n        case \"test_foursquare_places\":\n          return await this.testFoursquarePlaces(request.params.arguments);\n        case \"test_email_discovery\":\n          return await this.testEmailDiscovery(request.params.arguments);\n        case \"verify_email\":\n          return await this.verifyEmail(request.params.arguments);\n        case \"get_api_usage_stats\":\n          return await this.getAPIUsageStats();\n        case \"simulate_lead_discovery\":\n          return await this.simulateLeadDiscovery(request.params.arguments);\n\n        // === FILESYSTEM ANALYSIS TOOLS (from filesystem-server) ===\n        case \"analyze_project_structure\":\n          return await this.analyzeProjectStructure(request.params.arguments);\n        case \"find_code_patterns\":\n          return await this.findCodePatterns(request.params.arguments);\n        case \"analyze_api_clients\":\n          return await this.analyzeAPIClients(request.params.arguments);\n        case \"check_fake_data_violations\":\n          return await this.checkFakeDataViolations(request.params.arguments);\n\n        default:\n          throw new Error(`Unknown tool: ${request.params.name}`);\n      }\n    });\n  }\n\n  async initializeSupabase() {\n    if (!this.supabase) {\n      if (!process.env.SUPABASE_URL || !process.env.SUPABASE_SECRET_KEY) {\n        throw new Error(\"Missing Supabase configuration\");\n      }\n\n      this.supabase = createClient(\n        process.env.SUPABASE_URL,\n        process.env.SUPABASE_SECRET_KEY\n      );\n\n      // Test connection (prefer cleaned leads table, fall back to legacy view)\n      const tablesToCheck = [\"leads\", \"enhanced_leads\"];\n      let connectionVerified = false;\n\n      for (const table of tablesToCheck) {\n        const { error } = await this.supabase\n          .from(table)\n          .select(\"count\")\n          .limit(1);\n\n        if (!error) {\n          connectionVerified = true;\n          break;\n        }\n\n        const message = error.message || \"\";\n        const isMissingTable =\n          message.includes(\"does not exist\") ||\n          message.includes(\"schema cache\");\n\n        if (!isMissingTable) {\n          throw new Error(`Supabase connection failed: ${message}`);\n        }\n      }\n\n      if (!connectionVerified) {\n        console.warn(\n          \"âš ï¸  Supabase connection verified, but no leads tables found (leads/enhanced_leads)\"\n        );\n      }\n    }\n  }\n\n  async initializeAPIClients() {\n    if (Object.keys(this.apiClients).length === 0) {\n      try {\n        const GooglePlacesClient = require(\"../modules/api-clients/google-places-client\");\n        const FoursquareClient = require(\"../modules/api-clients/foursquare-places-client\");\n        const HunterIOClient = require(\"../modules/api-clients/hunter-io-client\");\n        const NeverBounceClient = require(\"../modules/api-clients/neverbounce-client\");\n\n        this.apiClients = {\n          googlePlaces: new GooglePlacesClient(\n            process.env.GOOGLE_PLACES_API_KEY\n          ),\n          foursquare: new FoursquareClient(process.env.FOURSQUARE_API_KEY),\n          hunterIO: new HunterIOClient(process.env.HUNTER_IO_API_KEY),\n          neverBounce: new NeverBounceClient(process.env.NEVERBOUNCE_API_KEY),\n        };\n      } catch (error) {\n        console.error(\n          \"Warning: Some API clients could not be loaded:\",\n          error.message\n        );\n      }\n    }\n  }\n\n  // === PRODUCTION MONITORING METHODS ===\n  async environmentHealthCheck() {\n    const results = {\n      timestamp: new Date().toISOString(),\n      environment: process.env.NODE_ENV || \"unknown\",\n      checks: [],\n    };\n\n    try {\n      // Check 1: Environment variables\n      const requiredEnvVars = [\"SUPABASE_URL\", \"SUPABASE_SECRET_KEY\"];\n      const envCheck = {\n        name: \"Environment Variables\",\n        status: \"healthy\",\n        details: {},\n      };\n\n      requiredEnvVars.forEach((varName) => {\n        const value = process.env[varName];\n        if (!value || value.includes(\"your_\")) {\n          envCheck.status = \"unhealthy\";\n          envCheck.details[varName] = \"missing or template value\";\n        } else {\n          envCheck.details[varName] = \"configured\";\n        }\n      });\n      results.checks.push(envCheck);\n\n      // Check 2: Supabase Connection\n      if (process.env.SUPABASE_URL && process.env.SUPABASE_SECRET_KEY) {\n        const supabase = createClient(\n          process.env.SUPABASE_URL,\n          process.env.SUPABASE_SECRET_KEY\n        );\n\n        try {\n          let status = \"unhealthy\";\n          const tablesToCheck = [\"leads\", \"enhanced_leads\"];\n\n          for (const table of tablesToCheck) {\n            const { error } = await supabase\n              .from(table)\n              .select(\"count\")\n              .limit(1);\n\n            if (!error) {\n              status = \"healthy\";\n              break;\n            }\n\n            const message = error.message || \"\";\n            const isMissingTable =\n              message.includes(\"does not exist\") ||\n              message.includes(\"schema cache\");\n\n            if (!isMissingTable) {\n              throw new Error(message);\n            }\n          }\n\n          results.checks.push({\n            name: \"Supabase Database\",\n            status,\n            details: { connection: \"successful\" },\n          });\n        } catch (dbError) {\n          results.checks.push({\n            name: \"Supabase Database\",\n            status: \"unhealthy\",\n            details: { error: dbError.message },\n          });\n        }\n      }\n\n      // Check 3: GitHub Actions Integration\n      const ghToken = process.env.GHP_TOKEN || process.env.GITHUB_TOKEN;\n      results.checks.push({\n        name: \"GitHub Actions Integration\",\n        status: ghToken ? \"healthy\" : \"warning\",\n        details: { token: ghToken ? \"present\" : \"missing\" },\n      });\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `ðŸ” **Production Environment Health Check**\\n\\n${JSON.stringify(\n              results,\n              null,\n              2\n            )}`,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ Health check failed: ${error.message}`,\n          },\n        ],\n      };\n    }\n  }\n\n  // GitHub Actions Workflow Monitor\n  async githubActionsMonitor({\n    repo = \"Alextorelli/ProspectPro\",\n    workflow = \"generate-dotenv.yml\",\n  } = {}) {\n    const token = process.env.GHP_TOKEN || process.env.GITHUB_TOKEN;\n\n    if (!token) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: \"âš ï¸ No GitHub token available for workflow monitoring\",\n          },\n        ],\n      };\n    }\n\n    try {\n      const [owner, repoName] = repo.split(\"/\");\n      const options = {\n        hostname: \"api.github.com\",\n        path: `/repos/${owner}/${repoName}/actions/workflows/${workflow}/runs?per_page=5`,\n        headers: {\n          Authorization: `token ${token}`,\n          \"User-Agent\": \"ProspectPro-Production-MCP\",\n        },\n      };\n\n      const response = await this.makeHttpsRequest(options);\n      const data = JSON.parse(response);\n\n      if (data.workflow_runs && data.workflow_runs.length > 0) {\n        const runs = data.workflow_runs.slice(0, 3).map((run) => ({\n          id: run.id,\n          status: run.status,\n          conclusion: run.conclusion,\n          created_at: run.created_at,\n          head_commit: run.head_commit?.message?.substring(0, 50) + \"...\",\n        }));\n\n        return {\n          content: [\n            {\n              type: \"text\",\n              text: `ðŸ“Š **GitHub Actions Workflow Status**\\n\\n**Workflow**: ${workflow}\\n**Repository**: ${repo}\\n\\n**Recent Runs**:\\n${JSON.stringify(\n                runs,\n                null,\n                2\n              )}`,\n            },\n          ],\n        };\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `ðŸ“Š No recent workflow runs found for ${workflow}`,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ GitHub Actions monitoring failed: ${error.message}`,\n          },\n        ],\n      };\n    }\n  }\n\n  // Dev/Prod Configuration Comparison\n  async devProdConfigDiff() {\n    try {\n      const prodEnvPath = path.join(process.cwd(), \".env\");\n      const devEnvPath = path.join(\n        process.cwd(),\n        \".devcontainer\",\n        \"devcontainer.json\"\n      );\n\n      const comparison = {\n        production: {\n          environment_file: fs.existsSync(prodEnvPath),\n          node_env: process.env.NODE_ENV,\n          theme: \"default (unchanged)\",\n          mcp_servers: \"production-only\",\n        },\n        development: {\n          devcontainer_config: fs.existsSync(devEnvPath),\n          theme: \"Vira Deepforest (green)\",\n          mcp_servers: \"full suite (database, API, filesystem, monitoring)\",\n        },\n      };\n\n      // Read production configuration\n      if (fs.existsSync(prodEnvPath)) {\n        const envContent = fs.readFileSync(prodEnvPath, \"utf8\");\n        comparison.production.features = {\n          supabase_configured: !envContent.includes(\"your-project-ref\"),\n          github_actions_build: envContent.includes(\"BUILD_TIMESTAMP\"),\n          vault_integration: envContent.includes(\"Vault\"),\n        };\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `ðŸ”„ **Dev/Prod Configuration Comparison**\\n\\n${JSON.stringify(\n              comparison,\n              null,\n              2\n            )}`,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ Configuration comparison failed: ${error.message}`,\n          },\n        ],\n      };\n    }\n  }\n\n  // Cost Budget Monitor\n  async costBudgetMonitor() {\n    try {\n      const supabase = createClient(\n        process.env.SUPABASE_URL,\n        process.env.SUPABASE_SECRET_KEY\n      );\n\n      // Get recent API costs\n      const { data: costs, error } = await supabase\n        .from(\"api_costs\")\n        .select(\"*\")\n        .gte(\n          \"created_at\",\n          new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString()\n        )\n        .order(\"created_at\", { ascending: false });\n\n      if (error) throw error;\n\n      const totalCost =\n        costs?.reduce((sum, cost) => sum + (cost.cost || 0), 0) || 0;\n      const budgetLimit = parseFloat(process.env.DEFAULT_BUDGET_LIMIT) || 25.0;\n      const utilization = (totalCost / budgetLimit) * 100;\n\n      const analysis = {\n        period: \"Last 24 hours\",\n        total_cost: `$${totalCost.toFixed(2)}`,\n        budget_limit: `$${budgetLimit.toFixed(2)}`,\n        utilization: `${utilization.toFixed(1)}%`,\n        status:\n          utilization > 80\n            ? \"âš ï¸ HIGH\"\n            : utilization > 50\n            ? \"âš¡ MODERATE\"\n            : \"âœ… HEALTHY\",\n        recent_costs:\n          costs?.slice(0, 5).map((cost) => ({\n            service: cost.service,\n            cost: `$${cost.cost?.toFixed(3)}`,\n            timestamp: cost.created_at,\n          })) || [],\n      };\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `ðŸ’° **Cost Budget Monitor**\\n\\n${JSON.stringify(\n              analysis,\n              null,\n              2\n            )}`,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ Cost monitoring failed: ${error.message}\\n\\nNote: Ensure api_costs table exists in Supabase`,\n          },\n        ],\n      };\n    }\n  }\n\n  // API Health Dashboard\n  async apiHealthDashboard() {\n    const apis = [\n      { name: \"Google Places\", key: \"GOOGLE_PLACES_API_KEY\" },\n      { name: \"Hunter.io\", key: \"HUNTER_IO_API_KEY\" },\n      { name: \"NeverBounce\", key: \"NEVERBOUNCE_API_KEY\" },\n      { name: \"Foursquare\", key: \"FOURSQUARE_API_KEY\" },\n    ];\n\n    const dashboard = {\n      timestamp: new Date().toISOString(),\n      apis: [],\n    };\n\n    for (const api of apis) {\n      const status = {\n        name: api.name,\n        key_configured: !!process.env[api.key],\n        status: \"unknown\",\n      };\n\n      // Basic configuration check\n      if (process.env[api.key]) {\n        status.status = \"configured\";\n      } else {\n        status.status = \"missing_key\";\n        status.note = \"Check Supabase Vault or environment variables\";\n      }\n\n      dashboard.apis.push(status);\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: `ðŸ”Œ **API Health Dashboard**\\n\\n${JSON.stringify(\n            dashboard,\n            null,\n            2\n          )}`,\n        },\n      ],\n    };\n  }\n\n  // === NEW ENHANCED TOOLS FOR VAULT AND PRODUCTION OPTIMIZATION ===\n\n  // Vault API Key Status Monitor\n  async vaultApiKeyStatus() {\n    try {\n      console.log(\"ðŸ”‘ Checking Supabase Vault API key status...\");\n\n      // Test Supabase connection\n      const supabaseUrl = process.env.SUPABASE_URL;\n      const supabaseKey = process.env.SUPABASE_SECRET_KEY;\n\n      if (!supabaseUrl || !supabaseKey) {\n        return {\n          content: [\n            {\n              type: \"text\",\n              text: \"âŒ Supabase credentials not configured in environment\",\n            },\n          ],\n        };\n      }\n\n      const supabase = createClient(supabaseUrl, supabaseKey);\n\n      // Check vault diagnostic function\n      const { data, error } = await supabase.rpc(\"vault_diagnostic_check\");\n\n      if (error) {\n        return {\n          content: [\n            {\n              type: \"text\",\n              text: `âŒ Vault diagnostic failed: ${error.message}`,\n            },\n          ],\n        };\n      }\n\n      let report = \"ðŸ” **Supabase Vault API Key Status Report**\\n\\n\";\n\n      if (data && data.length > 0) {\n        data.forEach((check) => {\n          const statusIcon =\n            check.status === \"ENABLED\" || check.status === \"COMPLETE\"\n              ? \"âœ…\"\n              : check.status === \"PARTIAL\"\n              ? \"âš ï¸\"\n              : \"âŒ\";\n\n          report += `${statusIcon} **${check.check_name}**: ${check.status}\\n`;\n          report += `   Details: ${check.details}\\n`;\n          report += `   Recommendation: ${check.recommendation}\\n\\n`;\n        });\n      } else {\n        report += \"âš ï¸ No diagnostic data returned from vault\\n\";\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: report,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ Error checking vault status: ${error.message}`,\n          },\n        ],\n      };\n    }\n  }\n\n  // Production Startup Validator\n  async productionStartupValidator() {\n    try {\n      console.log(\"ðŸ” Running production startup validation...\");\n\n      const issues = [];\n      const validations = [];\n\n      // Check 1: Environment variables\n      const requiredEnvs = [\"SUPABASE_URL\", \"SUPABASE_SECRET_KEY\"];\n      requiredEnvs.forEach((env) => {\n        const value = process.env[env];\n        if (!value || value.includes(\"your_\")) {\n          issues.push(`Missing or template value for ${env}`);\n        } else {\n          validations.push(`âœ… ${env} configured`);\n        }\n      });\n\n      // Check 2: Production mode settings\n      const nodeEnv = process.env.NODE_ENV;\n      if (nodeEnv === \"production\") {\n        validations.push(\"âœ… NODE_ENV set to production\");\n\n        // Check degraded start setting\n        if (process.env.ALLOW_DEGRADED_START === \"true\") {\n          issues.push(\n            \"âŒ ALLOW_DEGRADED_START=true is not recommended for production\"\n          );\n        } else {\n          validations.push(\n            \"âœ… Strict production mode enabled (no degraded starts)\"\n          );\n        }\n      } else {\n        issues.push(`NODE_ENV is '${nodeEnv}', should be 'production'`);\n      }\n\n      // Check 3: Port configuration\n      const port = process.env.PORT;\n      if (port && port !== \"3000\") {\n        validations.push(`âœ… Custom port configured: ${port}`);\n      } else {\n        validations.push(\"â„¹ï¸ Using default/standard port configuration\");\n      }\n\n      let report = \"ðŸ­ **Production Startup Validation Report**\\n\\n\";\n\n      report += \"**Validations Passed:**\\n\";\n      validations.forEach((validation) => {\n        report += `${validation}\\n`;\n      });\n\n      if (issues.length > 0) {\n        report += \"\\n**Issues Found:**\\n\";\n        issues.forEach((issue) => {\n          report += `âŒ ${issue}\\n`;\n        });\n\n        report += \"\\n**Recommendations:**\\n\";\n        report +=\n          \"1. Ensure GitHub Actions workflows have generated proper .env\\n\";\n        report += \"2. Configure API keys in Supabase Vault\\n\";\n        report +=\n          \"3. Set ALLOW_DEGRADED_START=false for strict production mode\\n\";\n        report += \"4. Verify all secrets are present and valid\\n\";\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: report,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ Production validation failed: ${error.message}`,\n          },\n        ],\n      };\n    }\n  }\n\n  // GitHub Workflow Optimizer\n  async githubWorkflowOptimizer() {\n    try {\n      console.log(\"âš™ï¸ Analyzing GitHub Actions workflows...\");\n\n      const workflowsDir = path.join(process.cwd(), \".github\", \"workflows\");\n\n      if (!fs.existsSync(workflowsDir)) {\n        return {\n          content: [\n            {\n              type: \"text\",\n              text: \"âŒ No .github/workflows directory found\",\n            },\n          ],\n        };\n      }\n\n      const workflows = fs\n        .readdirSync(workflowsDir)\n        .filter((file) => file.endsWith(\".yml\") || file.endsWith(\".yaml\"));\n\n      let report = \"âš™ï¸ **GitHub Actions Workflow Analysis**\\n\\n\";\n\n      const optimizations = [];\n      const issues = [];\n\n      workflows.forEach((workflow) => {\n        const workflowPath = path.join(workflowsDir, workflow);\n        const content = fs.readFileSync(workflowPath, \"utf8\");\n\n        report += `ðŸ“‹ **${workflow}:**\\n`;\n\n        // Check triggers\n        if (content.includes(\"push:\") && content.includes(\"branches: [main]\")) {\n          if (\n            workflow.includes(\"repository-maintenance\") ||\n            workflow.includes(\"docker-env\")\n          ) {\n            issues.push(\n              `${workflow}: Triggers on every push (may cause cascade failures)`\n            );\n            optimizations.push(\n              `Consider schedule-only or manual triggers for ${workflow}`\n            );\n          } else {\n            report += \"  âœ… Push trigger configured for main branch\\n\";\n          }\n        }\n\n        // Check for workflow_dispatch\n        if (content.includes(\"workflow_dispatch:\")) {\n          report += \"  âœ… Manual trigger available\\n\";\n        } else {\n          optimizations.push(\n            `Add workflow_dispatch to ${workflow} for manual testing`\n          );\n        }\n\n        // Check for proper permissions\n        if (content.includes(\"permissions:\")) {\n          report += \"  âœ… Permissions configured\\n\";\n        } else {\n          if (\n            content.includes(\"GITHUB_TOKEN\") ||\n            content.includes(\"secrets.\")\n          ) {\n            issues.push(\n              `${workflow}: Uses secrets but no permissions specified`\n            );\n          }\n        }\n\n        report += \"\\n\";\n      });\n\n      if (optimizations.length > 0) {\n        report += \"**Optimization Recommendations:**\\n\";\n        optimizations.forEach((opt) => {\n          report += `ðŸ’¡ ${opt}\\n`;\n        });\n        report += \"\\n\";\n      }\n\n      if (issues.length > 0) {\n        report += \"**Issues Found:**\\n\";\n        issues.forEach((issue) => {\n          report += `âš ï¸ ${issue}\\n`;\n        });\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: report,\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: `âŒ Workflow analysis failed: ${error.message}`,\n          },\n        ],\n      };\n    }\n  }\n\n  // === SYSTEM DIAGNOSTICS METHODS (from monitoring-server) ===\n\n  async getSystemHealth(args = {}) {\n    const { includeDetailedMetrics = false } = args;\n\n    const health = {\n      timestamp: new Date().toISOString(),\n      status: \"unknown\",\n      components: {},\n      metrics: {},\n    };\n\n    try {\n      // Check critical files\n      const packageJson = await this.checkFile(\"package.json\");\n      const dockerCompose = await this.checkFile(\"docker-compose.yml\");\n      const server = await this.checkFile(\"server.js\");\n\n      health.components = {\n        filesystem: {\n          status: \"healthy\",\n          package_json: packageJson.exists,\n          docker_compose: dockerCompose.exists,\n          server_file: server.exists,\n        },\n      };\n\n      // Check diagnostics file\n      try {\n        const diagnosticsPath = path.join(\n          this.workspaceRoot,\n          \"diagnostics.json\"\n        );\n        const diagnosticsContent = await fs.readFileSync(\n          diagnosticsPath,\n          \"utf8\"\n        );\n        const diagnostics = JSON.parse(diagnosticsContent);\n\n        health.components.diagnostics = {\n          status: diagnostics.status || \"unknown\",\n          last_check: diagnostics.timestamp,\n          database_connection: diagnostics.database?.status === \"connected\",\n        };\n      } catch (error) {\n        health.components.diagnostics = {\n          status: \"unavailable\",\n          error: \"Diagnostics file not found or invalid\",\n        };\n      }\n\n      // Overall health determination\n      const criticalComponents = [\"filesystem\"];\n      const healthyComponents = criticalComponents.filter(\n        (comp) => health.components[comp]?.status === \"healthy\"\n      );\n\n      health.status =\n        healthyComponents.length === criticalComponents.length\n          ? \"healthy\"\n          : healthyComponents.length > 0\n          ? \"degraded\"\n          : \"unhealthy\";\n\n      if (includeDetailedMetrics) {\n        health.metrics = await this.gatherDetailedMetrics();\n      }\n    } catch (error) {\n      health.status = \"error\";\n      health.error = error.message;\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(health, null, 2),\n        },\n      ],\n    };\n  }\n\n  async readDiagnostics(args = {}) {\n    const { includeHistory = true } = args;\n\n    try {\n      const diagnosticsPath = path.join(this.workspaceRoot, \"diagnostics.json\");\n      const content = await fs.readFileSync(diagnosticsPath, \"utf8\");\n      const diagnostics = JSON.parse(content);\n\n      const analysis = {\n        current_diagnostics: diagnostics,\n        analysis: {\n          timestamp: diagnostics.timestamp,\n          status: diagnostics.status,\n          critical_issues: [],\n          warnings: [],\n          recommendations: [],\n        },\n      };\n\n      // Analyze diagnostics data\n      if (diagnostics.database) {\n        if (diagnostics.database.status !== \"connected\") {\n          analysis.analysis.critical_issues.push(\"Database connection failed\");\n        }\n        if (diagnostics.database.error) {\n          analysis.analysis.critical_issues.push(\n            `Database error: ${diagnostics.database.error}`\n          );\n        }\n      }\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify(analysis, null, 2),\n          },\n        ],\n      };\n    } catch (error) {\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify(\n              {\n                error: `Failed to read diagnostics: ${error.message}`,\n                suggestion:\n                  \"Run the application to generate diagnostics.json file\",\n              },\n              null,\n              2\n            ),\n          },\n        ],\n      };\n    }\n  }\n\n  async analyzeLogs(args = {}) {\n    const { logType = \"all\", timeRange = \"24h\" } = args;\n\n    const logFiles = [\n      \"startup.log\",\n      \"production.log\",\n      \"database-validation.log\",\n    ];\n    const analysis = {\n      log_type: logType,\n      time_range: timeRange,\n      log_files_checked: [],\n      patterns_found: { errors: [], warnings: [], info: [] },\n      summary: {},\n    };\n\n    for (const logFile of logFiles) {\n      try {\n        const logPath = path.join(this.workspaceRoot, logFile);\n        const content = await fs.readFileSync(logPath, \"utf8\");\n        const stats = await fs.statSync(logPath);\n\n        analysis.log_files_checked.push({\n          file: logFile,\n          size: stats.size,\n          last_modified: stats.mtime,\n          line_count: content.split(\"\\n\").length,\n        });\n\n        const errorPatterns = content.match(/ERROR|Error:|error:/gi) || [];\n        if (errorPatterns.length > 0) {\n          analysis.patterns_found.errors.push({\n            file: logFile,\n            count: errorPatterns.length,\n          });\n        }\n      } catch (error) {\n        analysis.log_files_checked.push({\n          file: logFile,\n          error: `Could not read: ${error.message}`,\n        });\n      }\n    }\n\n    analysis.summary = {\n      total_log_files: analysis.log_files_checked.filter((f) => !f.error)\n        .length,\n      total_errors: analysis.patterns_found.errors.reduce(\n        (sum, e) => sum + e.count,\n        0\n      ),\n      health_status:\n        analysis.patterns_found.errors.length === 0\n          ? \"healthy\"\n          : \"needs_attention\",\n    };\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(analysis, null, 2),\n        },\n      ],\n    };\n  }\n\n  async validateConfiguration(args = {}) {\n    const { strict = true } = args;\n\n    const validation = {\n      validation_mode: strict ? \"strict\" : \"standard\",\n      results: {},\n      issues: [],\n      recommendations: [],\n    };\n\n    // Check critical files\n    const criticalFiles = [\"package.json\", \"server.js\", \"docker-compose.yml\"];\n    validation.results.critical_files = {};\n\n    for (const file of criticalFiles) {\n      const fileInfo = await this.checkFile(file);\n      validation.results.critical_files[file] = fileInfo;\n\n      if (!fileInfo.exists) {\n        validation.issues.push(`Missing critical file: ${file}`);\n      }\n    }\n\n    if (validation.issues.length === 0) {\n      validation.recommendations.push(\n        \"Configuration appears to be complete and healthy\"\n      );\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(validation, null, 2),\n        },\n      ],\n    };\n  }\n\n  async generatePerformanceReport(args = {}) {\n    const { includeRecommendations = true } = args;\n\n    const report = {\n      generated_at: new Date().toISOString(),\n      performance_metrics: {},\n      analysis: {},\n      recommendations: [],\n    };\n\n    // File system performance metrics\n    const metrics = await this.gatherDetailedMetrics();\n    report.performance_metrics = metrics;\n\n    const totalFiles = Object.values(metrics.file_counts || {}).reduce(\n      (sum, count) => sum + count,\n      0\n    );\n\n    report.analysis = {\n      total_files: totalFiles,\n      estimated_complexity:\n        totalFiles > 100 ? \"complex\" : totalFiles > 50 ? \"moderate\" : \"simple\",\n    };\n\n    if (includeRecommendations) {\n      report.recommendations.push(\n        \"Use MCP servers to offload AI processing tasks\"\n      );\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(report, null, 2),\n        },\n      ],\n    };\n  }\n\n  async monitorAPIQuotas(args = {}) {\n    const { alertThreshold = 80 } = args;\n\n    const quotaMonitoring = {\n      alert_threshold: alertThreshold,\n      api_services: {},\n      alerts: [],\n      recommendations: [],\n    };\n\n    // Mock API quota data (integrate with actual APIs in production)\n    const apiServices = [\n      {\n        name: \"Google Places\",\n        quota: 1000,\n        used: 250,\n        cost_per_request: 0.032,\n      },\n      { name: \"Hunter.io\", quota: 100, used: 45, cost_per_request: 0.04 },\n      { name: \"NeverBounce\", quota: 1000, used: 320, cost_per_request: 0.008 },\n    ];\n\n    apiServices.forEach((service) => {\n      const usagePercent = (service.used / service.quota) * 100;\n      quotaMonitoring.api_services[service.name] = {\n        quota_limit: service.quota,\n        requests_used: service.used,\n        usage_percentage: Math.round(usagePercent),\n        status: usagePercent >= alertThreshold ? \"alert\" : \"ok\",\n      };\n    });\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(quotaMonitoring, null, 2),\n        },\n      ],\n    };\n  }\n\n  // === DATABASE ANALYTICS METHODS (from database-server) ===\n\n  async queryLeads(args = {}) {\n    const { filters = {}, limit = 10, orderBy = \"confidence_score\" } = args;\n\n    await this.initializeSupabase();\n\n    let query = this.supabase\n      .from(\"enhanced_leads\")\n      .select(\"*\")\n      .order(orderBy, { ascending: false })\n      .limit(limit);\n\n    // Apply filters\n    Object.entries(filters).forEach(([key, value]) => {\n      query = query.eq(key, value);\n    });\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new Error(`Query failed: ${error.message}`);\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              results: data,\n              count: data.length,\n              query_info: { filters, limit, orderBy },\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async getCampaignStats(args = {}) {\n    const { campaignId, timeRange = \"24h\" } = args;\n\n    await this.initializeSupabase();\n\n    const intervalMap = {\n      \"24h\": \"1 day\",\n      \"7d\": \"7 days\",\n      \"30d\": \"30 days\",\n    };\n\n    const { data, error } = await this.supabase.rpc(\"get_campaign_statistics\", {\n      p_campaign_id: campaignId,\n      p_time_interval: intervalMap[timeRange] || \"1 day\",\n    });\n\n    if (error) {\n      throw new Error(`Campaign stats query failed: ${error.message}`);\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              campaign_id: campaignId,\n              time_range: timeRange,\n              statistics: data,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async analyzeLeadQuality(args = {}) {\n    const { businessType, minConfidence = 70 } = args;\n\n    await this.initializeSupabase();\n\n    let query = this.supabase\n      .from(\"enhanced_leads\")\n      .select(\n        \"confidence_score, business_name, email_confidence, phone_confidence, website_confidence\"\n      )\n      .gte(\"confidence_score\", minConfidence);\n\n    if (businessType) {\n      query = query.ilike(\"business_type\", `%${businessType}%`);\n    }\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new Error(`Quality analysis failed: ${error.message}`);\n    }\n\n    const analysis = {\n      total_leads: data.length,\n      average_confidence:\n        data.reduce((sum, lead) => sum + lead.confidence_score, 0) /\n        data.length,\n      confidence_distribution: {\n        high: data.filter((l) => l.confidence_score >= 85).length,\n        medium: data.filter(\n          (l) => l.confidence_score >= 70 && l.confidence_score < 85\n        ).length,\n        low: data.filter((l) => l.confidence_score < 70).length,\n      },\n    };\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(analysis, null, 2),\n        },\n      ],\n    };\n  }\n\n  async getApiCosts(args = {}) {\n    const { timeRange = \"24h\" } = args;\n\n    await this.initializeSupabase();\n\n    const { data, error } = await this.supabase\n      .from(\"api_costs\")\n      .select(\"*\")\n      .gte(\n        \"created_at\",\n        new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString()\n      )\n      .order(\"created_at\", { ascending: false });\n\n    if (error) {\n      throw new Error(`API costs query failed: ${error.message}`);\n    }\n\n    const totalCost =\n      data?.reduce((sum, cost) => sum + (cost.cost || 0), 0) || 0;\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              time_range: timeRange,\n              total_cost: totalCost,\n              total_requests: data?.length || 0,\n              recent_costs: data?.slice(0, 5) || [],\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  // === API TESTING METHODS (from api-server) ===\n\n  async testGooglePlaces(args = {}) {\n    const { query, location = \"New York, NY\", limit = 5 } = args;\n\n    await this.initializeAPIClients();\n\n    if (!this.apiClients.googlePlaces) {\n      throw new Error(\"Google Places API client not available\");\n    }\n\n    const results = await this.apiClients.googlePlaces.searchBusinesses(\n      query,\n      location,\n      limit\n    );\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              api: \"Google Places\",\n              query,\n              location,\n              results: results.businesses || [],\n              success: results.found,\n              error: results.error || null,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async testFoursquarePlaces(args = {}) {\n    const { query, location = \"New York, NY\", limit = 5 } = args;\n\n    await this.initializeAPIClients();\n\n    if (!this.apiClients.foursquare) {\n      throw new Error(\"Foursquare API client not available\");\n    }\n\n    const results = await this.apiClients.foursquare.searchBusinesses(\n      query,\n      location,\n      limit\n    );\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              api: \"Foursquare Places\",\n              query,\n              location,\n              results: results.businesses || [],\n              success: results.found,\n              error: results.error || null,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async testEmailDiscovery(args = {}) {\n    const { domain, limit = 5 } = args;\n\n    await this.initializeAPIClients();\n\n    if (!this.apiClients.hunterIO) {\n      throw new Error(\"Hunter.io API client not available\");\n    }\n\n    const results = await this.apiClients.hunterIO.findEmails(domain, limit);\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              api: \"Hunter.io\",\n              domain,\n              emails: results.emails || [],\n              success: results.found,\n              error: results.error || null,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async verifyEmail(args = {}) {\n    const { email } = args;\n\n    await this.initializeAPIClients();\n\n    if (!this.apiClients.neverBounce) {\n      throw new Error(\"NeverBounce API client not available\");\n    }\n\n    const result = await this.apiClients.neverBounce.verifyEmail(email);\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              api: \"NeverBounce\",\n              email,\n              verification: result,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async getAPIUsageStats() {\n    await this.initializeAPIClients();\n\n    const stats = {};\n\n    Object.entries(this.apiClients).forEach(([name, client]) => {\n      if (client && typeof client.getUsageStats === \"function\") {\n        stats[name] = client.getUsageStats();\n      }\n    });\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              api_usage_statistics: stats,\n              generated_at: new Date().toISOString(),\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async simulateLeadDiscovery(args = {}) {\n    const { businessType, location, maxResults = 3 } = args;\n\n    await this.initializeAPIClients();\n\n    const results = {\n      businessType,\n      location,\n      maxResults,\n      discovery_results: {},\n      processing_summary: {\n        total_discovered: 0,\n        errors: [],\n      },\n    };\n\n    try {\n      // Business Discovery\n      if (this.apiClients.googlePlaces) {\n        const googleResults =\n          await this.apiClients.googlePlaces.searchBusinesses(\n            businessType,\n            location,\n            maxResults\n          );\n        results.discovery_results.google_places = googleResults;\n        results.processing_summary.total_discovered +=\n          googleResults.businesses?.length || 0;\n      }\n\n      if (this.apiClients.foursquare) {\n        const foursquareResults =\n          await this.apiClients.foursquare.searchBusinesses(\n            businessType,\n            location,\n            maxResults\n          );\n        results.discovery_results.foursquare = foursquareResults;\n        results.processing_summary.total_discovered +=\n          foursquareResults.businesses?.length || 0;\n      }\n    } catch (error) {\n      results.processing_summary.errors.push(error.message);\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(results, null, 2),\n        },\n      ],\n    };\n  }\n\n  // === FILESYSTEM ANALYSIS METHODS (from filesystem-server) ===\n\n  async analyzeProjectStructure(args = {}) {\n    const { includeFiles = true } = args;\n\n    const structure = await this.walkDirectory(\n      this.workspaceRoot,\n      includeFiles\n    );\n    const analysis = this.analyzeStructure(structure);\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              workspace_root: this.workspaceRoot,\n              structure_analysis: analysis,\n              directory_tree: structure,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async findCodePatterns(args = {}) {\n    const {\n      pattern,\n      fileExtensions = [\".js\", \".json\", \".md\", \".sql\"],\n      excludeDirectories = [\"node_modules\", \".git\", \"archive\"],\n    } = args;\n\n    const results = [];\n    const regex = new RegExp(pattern, \"gi\");\n\n    const searchInDirectory = async (dirPath) => {\n      try {\n        const items = await fs.readdirSync(dirPath);\n\n        for (const item of items) {\n          const itemPath = path.join(dirPath, item);\n          const stats = await fs.statSync(itemPath);\n\n          if (stats.isDirectory()) {\n            if (!excludeDirectories.includes(item) && !item.startsWith(\".\")) {\n              await searchInDirectory(itemPath);\n            }\n          } else if (fileExtensions.includes(path.extname(item))) {\n            try {\n              const content = await fs.readFileSync(itemPath, \"utf8\");\n              const matches = [...content.matchAll(regex)];\n\n              if (matches.length > 0) {\n                results.push({\n                  file: path.relative(this.workspaceRoot, itemPath),\n                  matches: matches.length,\n                  details: matches.slice(0, 5).map((match) => ({\n                    match: match[0],\n                  })),\n                });\n              }\n            } catch (readError) {\n              // Skip files that can't be read\n            }\n          }\n        }\n      } catch (error) {\n        // Skip directories that can't be accessed\n      }\n    };\n\n    await searchInDirectory(this.workspaceRoot);\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              pattern,\n              total_matches: results.reduce((sum, r) => sum + r.matches, 0),\n              files_with_matches: results.length,\n              results,\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  async analyzeAPIClients(args = {}) {\n    const { detailed = false } = args;\n    const apiClientsPath = path.join(\n      this.workspaceRoot,\n      \"modules\",\n      \"api-clients\"\n    );\n\n    try {\n      const files = await fs.readdirSync(apiClientsPath);\n      const analysis = { clients: [], summary: {} };\n\n      for (const file of files) {\n        if (path.extname(file) === \".js\") {\n          const filePath = path.join(apiClientsPath, file);\n          const content = await fs.readFileSync(filePath, \"utf8\");\n\n          const clientAnalysis = {\n            name: file,\n            size: content.length,\n            method_count: (content.match(/async\\s+\\w+\\(|^\\s*\\w+\\s*\\(/gm) || [])\n              .length,\n            error_handling: (content.match(/try\\s*{|catch\\s*\\(/g) || []).length,\n            caching_implemented:\n              content.includes(\"cache\") || content.includes(\"Cache\"),\n          };\n\n          analysis.clients.push(clientAnalysis);\n        }\n      }\n\n      analysis.summary = {\n        total_clients: analysis.clients.length,\n        total_methods: analysis.clients.reduce(\n          (sum, c) => sum + c.method_count,\n          0\n        ),\n        clients_with_caching: analysis.clients.filter(\n          (c) => c.caching_implemented\n        ).length,\n      };\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify(analysis, null, 2),\n          },\n        ],\n      };\n    } catch (error) {\n      throw new Error(`Failed to analyze API clients: ${error.message}`);\n    }\n  }\n\n  async checkFakeDataViolations(args = {}) {\n    const { strict = true } = args;\n\n    const suspiciousPatterns = [\n      \"Artisan\\\\s+Bistro\",\n      \"Downtown\\\\s+CafÃ©?\",\n      \"Business\\\\s+LLC\",\n      \"\\\\(555\\\\)\\\\s*\\\\d{3}-\\\\d{4}\",\n      \"example\\\\.com\",\n      \"generateFake\",\n      \"mockData\",\n    ];\n\n    const violations = [];\n\n    for (const pattern of suspiciousPatterns) {\n      const patternResults = await this.findCodePatterns({\n        pattern,\n        fileExtensions: [\".js\", \".json\"],\n        excludeDirectories: [\"node_modules\", \".git\", \"archive\", \"tests\"],\n      });\n\n      const data = JSON.parse(patternResults.content[0].text);\n      if (data.results.length > 0) {\n        violations.push({\n          pattern,\n          severity: strict ? \"HIGH\" : \"MEDIUM\",\n          matches: data.results,\n        });\n      }\n    }\n\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: JSON.stringify(\n            {\n              check_mode: strict ? \"strict\" : \"standard\",\n              total_violations: violations.length,\n              violations,\n              recommendation:\n                violations.length > 0\n                  ? \"IMMEDIATE ACTION REQUIRED: Remove all fake data patterns\"\n                  : \"No fake data violations detected - good!\",\n            },\n            null,\n            2\n          ),\n        },\n      ],\n    };\n  }\n\n  // === HELPER METHODS ===\n\n  async checkFile(relativePath) {\n    try {\n      const filePath = path.join(this.workspaceRoot, relativePath);\n      const stats = await fs.statSync(filePath);\n      return {\n        exists: true,\n        size: stats.size,\n        modified: stats.mtime,\n      };\n    } catch (error) {\n      return {\n        exists: false,\n        error: error.message,\n      };\n    }\n  }\n\n  async gatherDetailedMetrics() {\n    const metrics = {\n      disk_usage: {},\n      file_counts: {},\n    };\n\n    try {\n      // Count files by extension\n      const fileExtensions = await this.countFilesByExtension();\n      metrics.file_counts = fileExtensions;\n\n      // Calculate directory sizes for key directories\n      const directories = [\"modules\", \"api\", \"database\", \"mcp-servers\"];\n      for (const dir of directories) {\n        try {\n          const dirPath = path.join(this.workspaceRoot, dir);\n          const size = await this.getDirectorySize(dirPath);\n          metrics.disk_usage[dir] = size;\n        } catch (error) {\n          metrics.disk_usage[dir] = { error: error.message };\n        }\n      }\n    } catch (error) {\n      metrics.error = error.message;\n    }\n\n    return metrics;\n  }\n\n  async countFilesByExtension() {\n    const counts = {};\n\n    const countInDirectory = async (dirPath) => {\n      try {\n        const items = await fs.readdirSync(dirPath);\n\n        for (const item of items) {\n          const itemPath = path.join(dirPath, item);\n          const stats = await fs.statSync(itemPath);\n\n          if (stats.isDirectory()) {\n            if (\n              item !== \"node_modules\" &&\n              !item.startsWith(\".\") &&\n              item !== \"archive\"\n            ) {\n              await countInDirectory(itemPath);\n            }\n          } else {\n            const ext = path.extname(item) || \"no-extension\";\n            counts[ext] = (counts[ext] || 0) + 1;\n          }\n        }\n      } catch (error) {\n        // Skip inaccessible directories\n      }\n    };\n\n    await countInDirectory(this.workspaceRoot);\n    return counts;\n  }\n\n  async getDirectorySize(dirPath) {\n    let totalSize = 0;\n\n    try {\n      const items = await fs.readdirSync(dirPath);\n\n      for (const item of items) {\n        const itemPath = path.join(dirPath, item);\n        const stats = await fs.statSync(itemPath);\n\n        if (stats.isDirectory()) {\n          if (item !== \"node_modules\" && !item.startsWith(\".\")) {\n            totalSize += await this.getDirectorySize(itemPath);\n          }\n        } else {\n          totalSize += stats.size;\n        }\n      }\n    } catch (error) {\n      // Skip inaccessible directories\n    }\n\n    return totalSize;\n  }\n\n  async walkDirectory(dirPath, includeFiles, currentDepth = 0, maxDepth = 4) {\n    if (currentDepth > maxDepth) return null;\n\n    const result = {\n      name: path.basename(dirPath),\n      type: \"directory\",\n      children: [],\n    };\n\n    try {\n      const items = await fs.readdirSync(dirPath);\n\n      for (const item of items) {\n        if (item.startsWith(\".\") && !item.includes(\"vscode\")) continue;\n        if ([\"node_modules\", \"archive\"].includes(item)) continue;\n\n        const itemPath = path.join(dirPath, item);\n        const stats = await fs.statSync(itemPath);\n\n        if (stats.isDirectory()) {\n          const childResult = await this.walkDirectory(\n            itemPath,\n            includeFiles,\n            currentDepth + 1,\n            maxDepth\n          );\n          if (childResult) result.children.push(childResult);\n        } else if (includeFiles) {\n          result.children.push({\n            name: item,\n            type: \"file\",\n            size: stats.size,\n            extension: path.extname(item),\n          });\n        }\n      }\n    } catch (error) {\n      result.error = error.message;\n    }\n\n    return result;\n  }\n\n  analyzeStructure(structure) {\n    const analysis = {\n      total_directories: 0,\n      total_files: 0,\n      file_types: {},\n      key_directories: [],\n    };\n\n    const analyzeNode = (node) => {\n      if (node.type === \"directory\") {\n        analysis.total_directories++;\n\n        // Identify key directories\n        const keyDirs = [\n          \"api\",\n          \"modules\",\n          \"config\",\n          \"database\",\n          \"mcp-servers\",\n          \"scripts\",\n        ];\n        if (keyDirs.includes(node.name)) {\n          analysis.key_directories.push({\n            name: node.name,\n            children_count: node.children?.length || 0,\n          });\n        }\n\n        if (node.children) {\n          node.children.forEach(analyzeNode);\n        }\n      } else if (node.type === \"file\") {\n        analysis.total_files++;\n        const ext = node.extension || \"no-extension\";\n        analysis.file_types[ext] = (analysis.file_types[ext] || 0) + 1;\n      }\n    };\n\n    analyzeNode(structure);\n    return analysis;\n  }\n\n  // Additional helper methods...\n  async makeHttpsRequest(options) {\n    return new Promise((resolve, reject) => {\n      const req = https.request(options, (res) => {\n        let data = \"\";\n        res.on(\"data\", (chunk) => (data += chunk));\n        res.on(\"end\", () => {\n          if (res.statusCode >= 200 && res.statusCode < 300) {\n            resolve(data);\n          } else {\n            reject(new Error(`HTTP ${res.statusCode}: ${data}`));\n          }\n        });\n      });\n      req.on(\"error\", reject);\n      req.end();\n    });\n  }\n\n  setupErrorHandling() {\n    this.server.onerror = (error) => {\n      console.error(\"[Production MCP Server Error]:\", error);\n    };\n\n    process.on(\"SIGINT\", async () => {\n      await this.server.close();\n      process.exit(0);\n    });\n  }\n\n  async run() {\n    const transport = new StdioServerTransport();\n    await this.server.connect(transport);\n    console.error(\n      \"ðŸš€ ProspectPro Production MCP Server v4.1 - Post-Cleanup Enhanced\"\n    );\n    console.error(\n      \"   ðŸ“Š Tier-Aware Monitoring | ðŸ—„ï¸  Database Analytics | ðŸ”§ System Diagnostics\"\n    );\n    console.error(\n      \"   ðŸ”Œ API Testing | ðŸ“ Filesystem Analysis | ðŸ›¡ï¸  Zero Fake Data Enforcement\"\n    );\n  }\n}\n\n// Start server if run directly\nif (require.main === module) {\n  const server = new ProductionMCPServer();\n  server.run().catch(console.error);\n}\n\nmodule.exports = ProductionMCPServer;\n"}}},
{"type":"measure","name":"lsp.did_open","count":1,"duration":25.244},
{"type":"mark","name":"lsp.did_open","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/mcp-servers/PRODUCTION_MCP_INITIALIZED.md","languageId":"markdown","version":1,"text":"# ProspectPro Production MCP Server - INITIALIZED âœ…\n\n## Server Status: **ACTIVE**\n\n- **Port**: Running via stdio transport\n- **Process ID**: 3a3d1917-1648-44de-bb79-095c15528637\n- **Version**: 4.1.0 Post-Cleanup Enhanced\n- **Total Tools**: 28 production-ready tools\n\n## Available Tool Categories:\n\n### ðŸš€ **Production Monitoring (8 tools)**\n\n- `environment_health_check` - Check Supabase environment status\n- `github_actions_monitor` - Monitor CI/CD pipeline status\n- `dev_prod_config_diff` - Compare development vs production configurations\n- `cost_budget_monitor` - Track API costs and budget usage\n- `api_health_dashboard` - Monitor all API endpoints\n- `vault_api_key_status` - Check Supabase Vault API key status\n- `production_startup_validator` - Validate production deployment readiness\n- `github_workflow_optimizer` - Optimize GitHub Actions workflows\n\n### ðŸ”§ **System Diagnostics (6 tools)**\n\n- `get_system_health` - Overall system health check\n- `read_diagnostics` - Read system diagnostic information\n- `analyze_logs` - Analyze application logs for issues\n- `validate_configuration` - Validate all configuration files\n- `generate_performance_report` - Generate performance analysis report\n- `monitor_api_quotas` - Monitor API rate limits and quotas\n\n### ðŸ“Š **Database Analytics (4 tools)**\n\n- `query_leads` - Query and analyze lead data from database\n- `get_campaign_stats` - Get comprehensive campaign statistics\n- `analyze_lead_quality` - Analyze lead quality metrics and scoring\n- `get_api_costs` - Get detailed API cost breakdown\n\n### ðŸ§ª **API Testing (6 tools)**\n\n- `test_google_places` - Test Google Places API integration\n- `test_foursquare_places` - Test Foursquare Places API integration\n- `test_email_discovery` - Test email discovery APIs (Hunter.io)\n- `verify_email` - Test email verification APIs (NeverBounce)\n- `get_api_usage_stats` - Get detailed API usage statistics\n- `simulate_lead_discovery` - Simulate full lead discovery workflow\n\n### ðŸ“ **Filesystem Analysis (4 tools)**\n\n- `analyze_project_structure` - Analyze ProspectPro project structure\n- `find_code_patterns` - Find specific code patterns across codebase\n- `analyze_api_clients` - Analyze API client implementations\n- `check_fake_data_violations` - Enforce zero fake data policy with strict detection\n\n## MCP Integration Status:\n\n- âœ… **Server**: Production MCP server running\n- âœ… **Transport**: stdio transport active\n- âœ… **Tools**: All 28 tools loaded and available\n- âœ… **Supabase**: Ready for database operations\n- âœ… **API Testing**: Ready for API validation\n- âœ… **Monitoring**: Real-time monitoring capabilities active\n\n## Usage Examples:\n\n### Environment Health Check:\n\n```bash\n# Use tool: environment_health_check\n# Checks Supabase connection, Edge Functions, and database status\n```\n\n### Campaign Analytics:\n\n```bash\n# Use tool: get_campaign_stats\n# Returns comprehensive campaign statistics and performance metrics\n```\n\n### API Testing:\n\n```bash\n# Use tool: test_google_places\n# Tests Google Places API with sample queries\n```\n\n### Cost Monitoring:\n\n```bash\n# Use tool: cost_budget_monitor\n# Tracks API costs and budget utilization\n```\n\nThe production MCP server is now fully initialized and ready for comprehensive ProspectPro monitoring, analytics, and troubleshooting! ðŸŽ‰\n"}}},
{"type":"measure","name":"lsp.did_open","count":2,"duration":0.061},
{"type":"mark","name":"lsp.did_open","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/PRODUCTION_MCP_SERVER_INITIALIZED.md","languageId":"markdown","version":1,"text":"# ProspectPro Production MCP Server - Initialized Successfully\n\n## Server Status: âœ… RUNNING\n\n- **Process ID**: Initialized via GitHub Codespaces session (Oct 8, 2025)\n- **Version**: v4.1 Post-Cleanup Enhanced\n- **Status**: Active and operational\n- **Architecture**: Verified Business Intelligence Platform\n\n## Server Capabilities\n\n### ðŸ“Š **Production Monitoring**\n\n- Real-time system performance tracking\n- Business intelligence data pipeline monitoring\n- Contact verification workflow analytics\n- API usage and cost optimization tracking\n\n### ðŸ—„ï¸ **Database Analytics**\n\n- Supabase database health monitoring\n- Lead verification status tracking\n- Apollo API integration analytics\n- Professional licensing verification metrics\n\n### ðŸ”§ **System Diagnostics**\n\n- Edge Function performance monitoring\n- Verification service health checks\n- Zero fake data policy enforcement\n- Contact discovery pipeline diagnostics\n\n### ðŸ”Œ **API Testing**\n\n- Apollo API connectivity validation\n- Professional licensing API testing\n- Chamber of Commerce directory verification\n- Google Places API integration testing\n\n### ðŸ“ **Filesystem Analysis**\n\n- Project structure validation\n- Configuration file monitoring\n- Database schema verification\n- Zero fake data enforcement with strict pattern detection\n\n### ðŸ›¡ï¸ **Security Validation**\n\n- Authentication token verification\n- Data source attribution validation\n- Fake data pattern detection\n- Professional contact verification\n\n## MCP Tools Available (28 Total)\n\nThe production server provides comprehensive access to ProspectPro's verified business intelligence infrastructure through the Model Context Protocol, enabling AI assistants to:\n\n- Monitor contact verification pipelines\n- Analyze professional data source performance\n- Validate zero fake data policy compliance\n- Track Apollo API usage and effectiveness\n- Diagnose verification workflow issues\n- Optimize contact discovery costs\n\n## Integration Status\n\nâœ… **Supabase Edge Functions**: Connected and monitored  \nâœ… **Apollo API**: Authentication validated  \nâœ… **Professional Licensing**: Directory access confirmed  \nâœ… **Chamber of Commerce**: Verification pipeline active  \nâœ… **Database Analytics**: Real-time monitoring enabled  \nâœ… **Zero Fake Data Policy**: Enforcement active\n\n## Usage\n\nThe production MCP server is now available for AI-assisted development, monitoring, and troubleshooting of ProspectPro's verified business intelligence platform. AI assistants can access all 28 production tools for comprehensive system management and optimization.\n\n---\n\n**Initialized**: October 8, 2025  \n**Server Version**: v4.1 Post-Cleanup Enhanced  \n**Platform**: ProspectPro Verified Business Intelligence  \n**Status**: Production Ready with Zero Fake Data Policy\n"}}},
{"type":"measure","name":"lsp.did_open","count":3,"duration":0.042},
{"type":"mark","name":"lsp.did_open","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/index.html","languageId":"html","version":1,"text":"<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon-yellow-arrow.svg\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>ProspectPro - Real Business Lead Discovery</title>\n    <meta\n      name=\"description\"\n      content=\"Zero fake data lead generation platform with real-time business validation\"\n    />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n  </body>\n</html>\n"}}},
{"type":"measure","name":"lsp.did_open","count":4,"duration":0.018},
{"type":"mark","name":"lsp.did_open","count":5,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","languageId":"typescriptreact","version":1,"text":"import { Session, User } from \"@supabase/supabase-js\";\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { supabase } from \"../lib/supabase\";\n\ninterface AuthContextType {\n  user: User | null;\n  session: Session | null;\n  sessionUserId: string | null;\n  loading: boolean;\n  signIn: (email: string, password: string) => Promise<void>;\n  signUp: (email: string, password: string) => Promise<void>;\n  signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({\n  children,\n}) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [sessionUserId, setSessionUserId] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Initialize auth session (create anonymous session if needed)\n    const initializeAuth = async () => {\n      try {\n        // Get current session\n        const {\n          data: { session },\n          error: sessionError,\n        } = await supabase.auth.getSession();\n\n        if (sessionError) {\n          console.error(\"Session error:\", sessionError);\n        }\n\n        if (session?.user) {\n          setSession(session);\n          setUser(session.user);\n          setSessionUserId(session.user.id);\n        } else {\n          setSession(null);\n          setUser(null);\n          setSessionUserId(null);\n        }\n\n        setLoading(false);\n      } catch (error) {\n        console.error(\"Auth initialization error:\", error);\n        setSession(null);\n        setUser(null);\n        setSessionUserId(null);\n        setLoading(false);\n      }\n    };\n\n    initializeAuth();\n\n    // Listen for auth changes\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange(async (event, session) => {\n      console.log(\"Auth state changed:\", event, session?.user?.id);\n\n      if (session?.user) {\n        setSession(session);\n        setUser(session.user);\n        setSessionUserId(session.user.id);\n      } else {\n        setSession(null);\n        setUser(null);\n        setSessionUserId(null);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const signIn = async (email: string, password: string) => {\n    const { error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n    if (error) throw error;\n  };\n\n  const signUp = async (email: string, password: string) => {\n    const { error } = await supabase.auth.signUp({\n      email,\n      password,\n    });\n    if (error) throw error;\n  };\n\n  const signOut = async () => {\n    const { error } = await supabase.auth.signOut();\n    if (error) throw error;\n    setSession(null);\n    setUser(null);\n    setSessionUserId(null);\n  };\n\n  const value = {\n    user,\n    session,\n    sessionUserId,\n    loading,\n    signIn,\n    signUp,\n    signOut,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":5,"duration":1.061},
{"type":"mark","name":"lsp.did_open","count":6,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/components/Layout.tsx","languageId":"typescriptreact","version":1,"text":"import React, { ReactNode, useMemo } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { AuthComponent } from \"./AuthComponent\";\nimport { ThemeToggle } from \"./ThemeToggle\";\n\ninterface LayoutProps {\n  children: ReactNode;\n}\n\nexport const Layout: React.FC<LayoutProps> = ({ children }) => {\n  const location = useLocation();\n  const { user } = useAuth();\n\n  const navigation = useMemo(\n    () => [\n      { name: \"New Campaign\", href: \"/\", disabled: false },\n      {\n        name: \"My Campaigns\",\n        href: \"/dashboard\",\n        disabled: !user,\n      },\n    ],\n    [user]\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 text-gray-900 transition-colors dark:bg-slate-900 dark:text-slate-100\">\n      <header className=\"border-b border-yellow-400 bg-[#f9ed69] text-gray-900 dark:border-yellow-500 dark:bg-[#f9ed69] dark:text-gray-900\">\n        <div className=\"mx-auto flex h-16 max-w-5xl items-center justify-between px-6\">\n          <Link\n            to=\"/\"\n            className=\"flex h-full items-center\"\n            aria-label=\"ProspectPro home\"\n          >\n            <img\n              src=\"/logo-full.svg\"\n              alt=\"ProspectPro\"\n              className=\"h-16 w-auto\"\n            />\n          </Link>\n          <div className=\"flex items-center space-x-3\">\n            <AuthComponent />\n            <div className=\"h-10 w-px bg-gray-300\" aria-hidden=\"true\" />\n            <ThemeToggle />\n          </div>\n        </div>\n      </header>\n      <nav className=\"border-b border-gray-200 bg-white text-sm font-medium transition-colors dark:border-slate-700 dark:bg-slate-900\">\n        <div className=\"mx-auto flex max-w-5xl items-center px-6\">\n          {navigation.map((item) => {\n            const isActive = !item.disabled && location.pathname === item.href;\n\n            if (item.disabled) {\n              return (\n                <span\n                  key={item.name}\n                  className=\"flex items-center border-b-2 border-transparent px-4 py-3 text-gray-400\"\n                  aria-disabled=\"true\"\n                >\n                  {item.name}\n                </span>\n              );\n            }\n\n            return (\n              <Link\n                key={item.name}\n                to={item.href}\n                className={`flex items-center border-b-2 px-4 py-3 transition-colors ${\n                  isActive\n                    ? \"border-blue-600 text-blue-700 dark:border-sky-400 dark:text-sky-300\"\n                    : \"border-transparent text-gray-600 hover:text-gray-900 dark:text-slate-400 dark:hover:text-slate-50\"\n                }`}\n              >\n                {item.name}\n              </Link>\n            );\n          })}\n        </div>\n      </nav>\n\n      <main className=\"mx-auto max-w-5xl px-6 pb-12 pt-8 sm:pb-16 sm:pt-10\">\n        {children}\n      </main>\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":1,"duration":0.746},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":2,"duration":0.186},
{"type":"measure","name":"lsp.did_open","count":6,"duration":11.499},
{"type":"mark","name":"lsp.did_open","count":7,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/.devcontainer/devcontainer.json","languageId":"jsonc","version":1,"text":"{\r\n  \"name\": \"ProspectPro - Verified Business Intelligence\",\r\n  \"image\": \"mcr.microsoft.com/devcontainers/javascript-node:20\",\r\n  \"features\": {\r\n    \"ghcr.io/devcontainers/features/git:1\": {}\r\n  },\r\n  \"customizations\": {\r\n    \"vscode\": {\r\n      \"extensions\": [\r\n        // Core Development\r\n        \"denoland.vscode-deno\",\r\n        \"supabase.supabase-vscode\",\r\n        \"dbaeumer.vscode-eslint\",\r\n        \"esbenp.prettier-vscode\",\r\n\r\n        // Productivity\r\n        \"eamodio.gitlens\",\r\n        \"github.copilot\",\r\n        \"github.copilot-chat\",\r\n        \"streetsidesoftware.code-spell-checker\",\r\n        \"wayou.vscode-todo-highlight\",\r\n\r\n        // API Development\r\n        \"humao.rest-client\",\r\n        \"rangav.vscode-thunder-client\",\r\n\r\n        // Database Tools\r\n        \"mtxr.sqltools\",\r\n        \"mtxr.sqltools-driver-pg\",\r\n\r\n        // Security\r\n        \"snyk-security.snyk-vulnerability-scanner\",\r\n\r\n        // Performance\r\n        \"wix.vscode-import-cost\",\r\n\r\n        // Documentation\r\n        \"bierner.markdown-preview-github-styles\",\r\n\r\n        // Development Theme & Visual Organization\r\n        \"deepforest.theme\", // Vira Deepforest theme for organized development\r\n        \"vscode-icons-team.vscode-icons\" // Better file icons for organization\r\n      ],\r\n      \"settings\": {\r\n        \"terminal.integrated.defaultProfile.linux\": \"bash\",\r\n        \"deno.enable\": true,\r\n        \"deno.enablePaths\": [\"supabase/functions\"],\r\n        \"git.autofetch\": true,\r\n        \"git.confirmSync\": false,\r\n        \"git.enableSmartCommit\": true,\r\n\r\n        // Editor Performance Settings - Enhanced for Development\r\n        \"editor.minimap.enabled\": false,\r\n        \"editor.renderWhitespace\": \"none\",\r\n        \"editor.renderControlCharacters\": false,\r\n        \"workbench.colorTheme\": \"Vira Deepforest\", // Development-specific theme\r\n        \"workbench.iconTheme\": \"vscode-icons\", // Better file icons for organization\r\n        \"workbench.list.smoothScrolling\": false,\r\n        \"workbench.tree.renderIndentGuides\": \"none\",\r\n        \"workbench.editor.closeOnFileDelete\": true,\r\n\r\n        // Development-specific UI enhancements\r\n        \"workbench.colorCustomizations\": {\r\n          \"[Vira Deepforest]\": {\r\n            \"titleBar.activeBackground\": \"#1a4d3a\",\r\n            \"titleBar.activeForeground\": \"#ffffff\",\r\n            \"statusBar.background\": \"#1a4d3a\",\r\n            \"statusBar.foreground\": \"#ffffff\",\r\n            \"activityBar.background\": \"#0d2818\",\r\n            \"panel.background\": \"#0a1f14\"\r\n          }\r\n        },\r\n        \"workbench.settings.editor\": \"json\",\r\n        \"breadcrumbs.enabled\": true,\r\n\r\n        // File System Performance\r\n        \"files.watcherExclude\": {\r\n          \"**/*.log\": true,\r\n          \"**/*.tmp\": true,\r\n          \"**/node_modules/**\": true,\r\n          \"**/archive/**\": true,\r\n          \"**/.git/**\": true,\r\n          \"**/logs/**\": true\r\n        },\r\n\r\n        // Search Performance\r\n        \"search.exclude\": {\r\n          \"**/node_modules\": true,\r\n          \"**/*.log\": true,\r\n          \"**/archive/**\": true,\r\n          \"**/.git\": true\r\n        },\r\n        \"search.searchOnType\": false,\r\n\r\n        // Copilot Optimization\r\n        \"github.copilot.chat.historyCount\": 8,\r\n        \"github.copilot.chat.welcomeMessage\": \"none\",\r\n        \"github.copilot.chat.completionPhrasesEnabled\": false,\r\n        \"github.copilot.advanced.setAutoCompletionTriggerThreshold\": 30,\r\n\r\n        // Terminal Settings - Development Enhanced\r\n        \"terminal.integrated.gpuAcceleration\": \"on\",\r\n        \"terminal.integrated.scrollback\": 1000,\r\n        \"terminal.integrated.fontFamily\": \"Consolas, 'Courier New', monospace\",\r\n        \"terminal.integrated.fontSize\": 13,\r\n\r\n        // Development Environment Indicators\r\n        \"window.title\": \"ðŸŽ¯ ${folderName} - Verified Business Intelligence ${separator} ${activeEditorShort}\",\r\n        \"workbench.startupEditor\": \"welcomePageInEmptyWorkbench\",\r\n\r\n        // === MCP (Model Context Protocol) Configuration ===\r\n        \"mcp.enable\": true,\r\n        \"mcp.configFile\": \"${workspaceFolder}/.vscode/mcp-config.json\",\r\n\r\n        // API Development Specific Settings\r\n        \"rest-client.enableTelemetry\": false,\r\n        \"files.associations\": {\r\n          \"*.http\": \"http\",\r\n          \"*.rest\": \"http\"\r\n        },\r\n\r\n        // AI-Enhanced Development Settings for Verified Data Integration\r\n        \"ai.contextAware\": true,\r\n        \"ai.projectContext\": {\r\n          \"type\": \"verified-business-intelligence-platform\",\r\n          \"framework\": \"supabase-edge-functions\",\r\n          \"database\": \"supabase-postgresql\",\r\n          \"apis\": [\r\n            \"google-places\",\r\n            \"apollo-contacts\",\r\n            \"chamber-commerce\",\r\n            \"professional-licensing\"\r\n          ],\r\n          \"deployment\": \"supabase-edge-functions\",\r\n          \"dataPolicy\": \"zero-fake-data-verified-contacts-only\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"forwardPorts\": [3000, 5432],\r\n  \"postCreateCommand\": \"bash -lc 'set -e; echo \\\"ï¿½ Setting up ProspectPro Verified Business Intelligence Environment...\\\"; sudo apt-get update && sudo apt-get install -y docker.io; if [ -f package-lock.json ]; then npm ci; else npm install; fi; npm i supabase --save-dev; npm run mcp:install; npm run mcp:test; echo \\\"âœ… Verified data environment ready with zero fake data policy!\\\"; echo \\\"ðŸš€ ProspectPro verified business intelligence development ready\\\"'\",\r\n  \"postStartCommand\": \"bash -c 'echo \\\"ï¿½ ProspectPro Verified Business Intelligence Started\\\"; echo \\\"Data Policy: Zero Fake Data | Contacts: Verified Only | Architecture: Supabase Edge Functions\\\"; echo \\\"ðŸ’¡ Use Copilot Chat for AI-assisted development with verified data context\\\"'\",\r\n  \"runArgs\": [\"--init\", \"-v\", \"/var/run/docker.sock:/var/run/docker.sock\"],\r\n  \"remoteUser\": \"node\"\r\n}\r\n"}}},
{"type":"measure","name":"lsp.did_open","count":7,"duration":0.071},
{"type":"mark","name":"lsp.did_open","count":8,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/lib/supabase.ts","languageId":"typescript","version":1,"text":"import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl =\n  import.meta.env.VITE_SUPABASE_URL ||\n  import.meta.env.NEXT_PUBLIC_SUPABASE_URL ||\n  import.meta.env.SUPABASE_URL;\n\nconst supabaseAnonKey =\n  import.meta.env.VITE_SUPABASE_ANON_KEY ||\n  import.meta.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ||\n  import.meta.env.SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error(\"Missing Supabase environment variables\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    persistSession: true,\n    autoRefreshToken: true,\n  },\n});\n\n// Helper function to get current session token for Edge Function calls\nexport const getSessionToken = async (): Promise<string | null> => {\n  const {\n    data: { session },\n    error,\n  } = await supabase.auth.getSession();\n\n  if (error) {\n    console.error(\"Error getting session:\", error);\n    return null;\n  }\n\n  // Return the access token (JWT) from the session\n  return session?.access_token ?? null;\n};\n\n// Helper function to ensure we have a valid session\nexport const ensureSession = async (): Promise<boolean> => {\n  const {\n    data: { session },\n    error,\n  } = await supabase.auth.getSession();\n\n  if (error) {\n    console.error(\"Failed to read session:\", error);\n    return false;\n  }\n\n  return Boolean(session?.access_token);\n};\n\n// Edge Functions URL\nexport const EDGE_FUNCTIONS_URL =\n  import.meta.env.VITE_EDGE_FUNCTIONS_URL || `${supabaseUrl}/functions/v1`;\n\n// Edge Function endpoints for vault-secured progressive enrichment\nexport const EDGE_FUNCTIONS = {\n  // Progressive Enrichment Orchestrator (vault-secured)\n  ENRICHMENT_ORCHESTRATOR: `${EDGE_FUNCTIONS_URL}/enrichment-orchestrator`,\n\n  // Individual enrichment services (vault-secured)\n  ENRICHMENT_BUSINESS_LICENSE: `${EDGE_FUNCTIONS_URL}/enrichment-business-license`,\n  ENRICHMENT_PDL: `${EDGE_FUNCTIONS_URL}/enrichment-pdl`,\n  ENRICHMENT_HUNTER: `${EDGE_FUNCTIONS_URL}/enrichment-hunter`,\n  ENRICHMENT_NEVERBOUNCE: `${EDGE_FUNCTIONS_URL}/enrichment-neverbounce`,\n\n  // Legacy endpoints (for backward compatibility)\n  ENHANCED_BUSINESS_DISCOVERY: `${EDGE_FUNCTIONS_URL}/enhanced-business-discovery`,\n  LEAD_VALIDATION: `${EDGE_FUNCTIONS_URL}/lead-validation-edge`,\n  BUSINESS_DISCOVERY: `${EDGE_FUNCTIONS_URL}/business-discovery-edge`,\n  DIAGNOSTICS: `${EDGE_FUNCTIONS_URL}/diag`,\n} as const;\n\n// Progressive Enrichment Tiers - Consolidated to 3 Tiers\nexport const ENRICHMENT_TIERS = {\n  BASE: {\n    name: \"Base\",\n    price: 0.15, // Essential Business Data\n    stages: [\"business-verification\", \"company-data\"],\n    description:\n      \"Essential Business Data - Perfect for targeted outreach campaigns\",\n    features: [\n      \"Business verification\",\n      \"Company data (name, industry, size)\",\n      \"Phone & address validation\",\n      \"Generic company email\",\n    ],\n    badge: \"Most Popular\",\n    hasOwnershipData: false,\n  },\n  PROFESSIONAL: {\n    name: \"Professional\",\n    price: 0.45, // Enhanced Sales Intelligence\n    stages: [\n      \"business-verification\",\n      \"company-data\",\n      \"email-discovery\",\n      \"email-verification\",\n    ],\n    description:\n      \"Enhanced Sales Intelligence - Verified contacts for higher conversion rates\",\n    features: [\n      \"Everything in Base\",\n      \"Professional email discovery & verification\",\n      \"Email deliverability verification\",\n      \"Enhanced company enrichment\",\n    ],\n    badge: \"\",\n    hasOwnershipData: false,\n  },\n  ENTERPRISE: {\n    name: \"Enterprise\",\n    price: 2.5, // Premium Executive Access\n    stages: [\n      \"business-verification\",\n      \"company-data\",\n      \"email-discovery\",\n      \"email-verification\",\n      \"executive-enrichment\",\n      \"compliance-verification\",\n    ],\n    description:\n      \"Premium Executive Access - Compliance-grade data with C-suite contacts\",\n    features: [\n      \"Everything in Professional\",\n      \"Executive contact enrichment\",\n      \"Full compliance verification\",\n      \"Advanced data validation\",\n    ],\n    badge: \"Premium\",\n    hasOwnershipData: true,\n  },\n} as const;\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":3,"duration":0.231},
{"type":"measure","name":"lsp.did_open","count":8,"duration":5.965},
{"type":"mark","name":"lsp.did_open","count":9,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","languageId":"typescript","version":1,"text":"import { useMutation } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport {\n  ENRICHMENT_TIERS,\n  ensureSession,\n  getSessionToken,\n  supabase,\n} from \"../lib/supabase\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport type { BusinessDiscoveryResponse, CampaignConfig } from \"../types\";\n\ninterface SupabaseFunctionError {\n  message?: string;\n  name?: string;\n  context?: {\n    status?: number;\n    response?: unknown;\n  };\n}\n\nconst extractFunctionErrorMessage = (error: unknown): string => {\n  if (!error || typeof error !== \"object\") {\n    return \"Discovery failed due to an unknown error.\";\n  }\n\n  const functionsError = error as SupabaseFunctionError;\n  const defaultMessage =\n    functionsError.message || \"Edge function returned an error response.\";\n\n  const contextResponse = functionsError.context?.response;\n  if (!contextResponse) {\n    return defaultMessage;\n  }\n\n  try {\n    if (typeof contextResponse === \"string\") {\n      const parsed = JSON.parse(contextResponse);\n      if (parsed?.error) return String(parsed.error);\n      if (parsed?.message) return String(parsed.message);\n      return contextResponse;\n    }\n\n    if (\n      typeof contextResponse === \"object\" &&\n      contextResponse !== null &&\n      \"error\" in contextResponse\n    ) {\n      const { error: ctxError } = contextResponse as { error?: unknown };\n      if (ctxError) return String(ctxError);\n    }\n  } catch (parseError) {\n    console.warn(\"Unable to parse edge function error response:\", parseError);\n    return defaultMessage;\n  }\n\n  return defaultMessage;\n};\n\nexport const useBusinessDiscovery = (\n  onJobCreated?: (jobData: {\n    jobId: string;\n    campaignId: string;\n    status: string;\n    estimatedTime?: number;\n  }) => void\n) => {\n  const { user } = useAuth();\n  const { setLoading, setError, clearLeads, setCurrentCampaign } =\n    useCampaignStore();\n  const [progress, setProgress] = useState(0);\n  const [currentStage, setCurrentStage] = useState<string>(\"\");\n  const [cacheStats] = useState<any>(null);\n\n  const discoveryMutation = useMutation({\n    mutationFn: async (\n      config: CampaignConfig & { selectedTier?: keyof typeof ENRICHMENT_TIERS }\n    ): Promise<BusinessDiscoveryResponse> => {\n      setLoading(true);\n      setError(null);\n      setProgress(10);\n      setCurrentStage(\"Initializing user-aware discovery...\");\n\n      // Reset any existing campaign context before starting a new discovery\n      clearLeads();\n      setCurrentCampaign(null);\n\n      try {\n        console.log(\"ðŸš€ Starting user-aware business discovery:\", config);\n\n        // Ensure we have a valid session before calling Edge Function\n        const hasSession = await ensureSession();\n        if (!hasSession || !user?.id) {\n          throw new Error(\"Please sign in to run a discovery campaign.\");\n        }\n\n        // Determine enrichment tier\n        const tier = config.selectedTier || \"PROFESSIONAL\";\n        const tierConfig = ENRICHMENT_TIERS[tier];\n        const keywordList = config.keywords\n          ? config.keywords\n              .split(\",\")\n              .map((value) => value.trim())\n              .filter(Boolean)\n          : undefined;\n\n        const discoveryOptions = {\n          tradeAssociation: config.trade_association ?? false,\n          professionalLicense: config.professional_license ?? false,\n          chamberVerification: config.chamber_verification ?? false,\n          apolloDiscovery: tier === \"ENTERPRISE\",\n        };\n\n        setCurrentStage(\n          `Using ${tierConfig.name} tier ($${tierConfig.price}/lead)`\n        );\n        setProgress(20);\n\n        const accessToken = await getSessionToken();\n\n        const billingContext = {\n          tier,\n          tierName: tierConfig.name,\n          unitPrice: tierConfig.price,\n          estimatedBudget: config.max_results * tierConfig.price,\n          currency: \"USD\",\n        };\n\n        // Call background task business discovery with authentication\n        const { data, error } = await supabase.functions.invoke(\n          \"business-discovery-background\",\n          {\n            body: {\n              businessType: config.business_type || config.search_terms,\n              location: config.location,\n              keywords: keywordList,\n              searchRadius: config.search_radius,\n              expandGeography: config.expand_geography,\n              maxResults: config.max_results,\n              budgetLimit: config.max_results * tierConfig.price,\n              minConfidenceScore: config.min_confidence_score || 50,\n              tierKey: tier,\n              tierName: tierConfig.name,\n              tierPrice: tierConfig.price,\n              options: discoveryOptions,\n              sessionUserId: user.id,\n              userId: user.id,\n              billingContext,\n            },\n            headers: accessToken\n              ? { Authorization: `Bearer ${accessToken}` }\n              : undefined,\n          }\n        );\n\n        if (error) {\n          console.error(\"âŒ Background discovery error:\", error);\n          throw new Error(extractFunctionErrorMessage(error));\n        }\n\n        if (!data || !data.success) {\n          const fallbackMessage =\n            typeof data?.error === \"string\"\n              ? data.error\n              : \"No data returned from background discovery\";\n          throw new Error(fallbackMessage);\n        }\n\n        console.log(\"âœ… Background discovery response:\", data);\n\n        // For background tasks, we get jobId and campaignId immediately\n        // The actual processing happens in the background\n        const transformedData: BusinessDiscoveryResponse = {\n          campaign_id: data.campaignId,\n          job_id: data.jobId, // New: job ID for tracking progress\n          status: data.status, // New: processing status\n          estimated_time: data.estimatedTime, // New: estimated completion time\n          realtime_channel: data.realtimeChannel, // New: for real-time updates\n          total_found: 0, // Will be updated via real-time\n          qualified_count: 0, // Will be updated via real-time\n          total_cost: 0, // Will be updated via real-time\n          processing_time: \"< 100ms\", // Immediate response\n          tier_used: tierConfig.name,\n          cache_performance: undefined,\n          vault_status: \"secured\",\n          census_intelligence: undefined,\n          businesses: [], // Will be populated via real-time updates\n        };\n\n        setProgress(100);\n        setCurrentStage(\"Complete! ðŸŽ‰\");\n        return transformedData;\n      } catch (error) {\n        console.error(\"âŒ User-aware discovery error:\", error);\n        setCurrentStage(\"Failed âŒ\");\n        throw error;\n      } finally {\n        setLoading(false);\n      }\n    },\n    onSuccess: (data: BusinessDiscoveryResponse) => {\n      console.log(\"âœ… Background job created:\", data);\n\n      // For background jobs, we don't create the full campaign record immediately\n      // The progress page will handle real-time updates and final campaign creation\n\n      setProgress(100);\n      setCurrentStage(\"Background processing started! ðŸš€\");\n\n      // Navigate to progress page with job ID\n      if (data.job_id && data.campaign_id) {\n        const jobData = {\n          jobId: data.job_id,\n          campaignId: data.campaign_id,\n          status: data.status || \"pending\",\n          estimatedTime: data.estimated_time,\n        };\n\n        console.log(\"Job started:\", jobData);\n\n        // Call the navigation callback if provided\n        if (onJobCreated) {\n          onJobCreated(jobData);\n        }\n      }\n    },\n    onError: (error: any) => {\n      setError(\n        error instanceof Error ? error.message : \"User-aware discovery failed\"\n      );\n      setProgress(0);\n      setCurrentStage(\"Failed âŒ\");\n    },\n  });\n\n  return {\n    startDiscovery: discoveryMutation.mutate,\n    isDiscovering: discoveryMutation.isPending,\n    progress,\n    currentStage,\n    cacheStats,\n    error: discoveryMutation.error,\n    data: discoveryMutation.data,\n  };\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.did_open","count":9,"duration":1.623},
{"type":"mark","name":"lsp.did_open","count":10,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","languageId":"typescript","version":1,"text":"import { useMutation } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { ensureSession, supabase } from \"../lib/supabase\";\n\nexport interface EnrichmentConfig {\n  businessName: string;\n  domain?: string;\n  address?: string;\n  phone?: string;\n  website?: string;\n  industry?: string;\n  state?: string;\n\n  // Progressive enrichment options\n  includeBusinessLicense?: boolean;\n  includeCompanyEnrichment?: boolean;\n  discoverEmails?: boolean;\n  verifyEmails?: boolean;\n  includePersonEnrichment?: boolean;\n  apolloEnrichment?: boolean;\n\n  // Control parameters\n  maxCostPerBusiness?: number;\n  minConfidenceScore?: number;\n  tier?: \"starter\" | \"professional\" | \"enterprise\" | \"compliance\";\n}\n\nexport interface EnrichmentResult {\n  success: boolean;\n  businessName: string;\n  enrichedData: {\n    emails?: Array<{\n      email: string;\n      confidence: number;\n      verified: boolean;\n      type?: string;\n      firstName?: string;\n      lastName?: string;\n      position?: string;\n    }>;\n    businessLicense?: {\n      isValid: boolean;\n      licenseNumber?: string;\n      status?: string;\n      expirationDate?: string;\n      professionalType?: string;\n      source: string;\n    };\n    companyInfo?: {\n      name?: string;\n      industry?: string;\n      size?: string;\n      founded?: number;\n      revenue?: string;\n      website?: string;\n      description?: string;\n      source: string;\n    };\n  };\n  confidenceScore: number;\n  totalCost: number;\n  costBreakdown: {\n    businessLicenseCost: number;\n    companyEnrichmentCost: number;\n    hunterCost: number;\n    neverBounceCost: number;\n    personEnrichmentCost: number;\n    apolloCost: number;\n    complianceCost: number;\n  };\n  processingMetadata: {\n    servicesUsed: string[];\n    servicesSkipped: string[];\n    processingTime: number;\n    errors: Array<{\n      service: string;\n      error: string;\n    }>;\n  };\n}\n\nexport const useLeadEnrichment = () => {\n  const { user } = useAuth();\n  const [progress, setProgress] = useState(0);\n  const [currentStage, setCurrentStage] = useState<string>(\"\");\n  const [enrichedCount, setEnrichedCount] = useState(0);\n  const [totalCost, setTotalCost] = useState(0);\n\n  const enrichmentMutation = useMutation({\n    mutationFn: async (config: EnrichmentConfig): Promise<EnrichmentResult> => {\n      setProgress(10);\n      setCurrentStage(`Enriching ${config.businessName}...`);\n\n      try {\n        console.log(\"ðŸ”„ Starting enrichment for:\", config.businessName);\n\n        // Ensure we have a valid session before calling Edge Function\n        const hasSession = await ensureSession();\n        if (!hasSession || !user?.id) {\n          throw new Error(\"Please sign in to run lead enrichment.\");\n        }\n\n        const billingContext = {\n          tier: config.tier ?? \"professional\",\n          maxCostPerBusiness: config.maxCostPerBusiness ?? 0.5,\n          currency: \"USD\",\n        };\n\n        // Call enrichment orchestrator\n        const { data, error } = await supabase.functions.invoke(\n          \"enrichment-orchestrator\",\n          {\n            body: {\n              businessName: config.businessName,\n              domain: config.domain\n                ?.replace(/^https?:\\/\\//, \"\")\n                .replace(/\\/$/, \"\"),\n              address: config.address,\n              phone: config.phone,\n              website: config.website,\n              industry: config.industry,\n              state: config.state,\n\n              // Progressive enrichment configuration (professional tier)\n              includeBusinessLicense: config.includeBusinessLicense ?? true,\n              discoverEmails: config.discoverEmails ?? true,\n              verifyEmails: config.verifyEmails ?? true,\n              includeCompanyEnrichment:\n                config.includeCompanyEnrichment ?? false,\n              includePersonEnrichment: config.includePersonEnrichment ?? false,\n              apolloEnrichment: config.apolloEnrichment ?? false,\n\n              // Budget controls\n              maxCostPerBusiness: config.maxCostPerBusiness ?? 0.5,\n              minConfidenceScore: config.minConfidenceScore ?? 50,\n              tier: config.tier ?? \"professional\",\n              sessionUserId: user.id,\n              userId: user.id,\n              billingContext,\n            },\n          }\n        );\n\n        if (error) {\n          console.error(\"âŒ Enrichment error:\", error);\n          throw new Error(`Enrichment failed: ${error.message}`);\n        }\n\n        if (!data || !data.success) {\n          throw new Error(\n            data?.processingMetadata?.errors?.[0]?.error ||\n              \"Enrichment service returned no data\"\n          );\n        }\n\n        console.log(\"âœ… Enrichment complete:\", data);\n        setProgress(100);\n        setCurrentStage(\n          `Found ${data.enrichedData?.emails?.length || 0} emails`\n        );\n\n        return data as EnrichmentResult;\n      } catch (error) {\n        console.error(\"âŒ Enrichment error:\", error);\n        setCurrentStage(\"Enrichment failed\");\n        throw error;\n      }\n    },\n    onSuccess: (data) => {\n      setEnrichedCount((prev) => prev + 1);\n      setTotalCost((prev) => prev + data.totalCost);\n    },\n  });\n\n  // Batch enrichment for multiple leads\n  const enrichMultipleLeads = async (\n    leads: Array<{\n      businessName: string;\n      website?: string;\n      address?: string;\n      phone?: string;\n    }>,\n    config?: Partial<EnrichmentConfig>\n  ) => {\n    const results: EnrichmentResult[] = [];\n    const errors: Array<{ businessName: string; error: string }> = [];\n\n    setProgress(0);\n    setEnrichedCount(0);\n    setTotalCost(0);\n\n    for (let i = 0; i < leads.length; i++) {\n      const lead = leads[i];\n      setCurrentStage(\n        `Enriching ${i + 1}/${leads.length}: ${lead.businessName}...`\n      );\n      setProgress(Math.round((i / leads.length) * 100));\n\n      try {\n        const result = await enrichmentMutation.mutateAsync({\n          businessName: lead.businessName,\n          website: lead.website,\n          domain: lead.website?.replace(/^https?:\\/\\//, \"\").replace(/\\/$/, \"\"),\n          address: lead.address,\n          phone: lead.phone,\n          ...config,\n        });\n        results.push(result);\n      } catch (error) {\n        console.error(`âŒ Failed to enrich ${lead.businessName}:`, error);\n        errors.push({\n          businessName: lead.businessName,\n          error: error instanceof Error ? error.message : \"Unknown error\",\n        });\n      }\n    }\n\n    setProgress(100);\n    setCurrentStage(`Enriched ${results.length}/${leads.length} leads`);\n\n    return { results, errors };\n  };\n\n  const reset = () => {\n    setProgress(0);\n    setCurrentStage(\"\");\n    setEnrichedCount(0);\n    setTotalCost(0);\n  };\n\n  return {\n    enrichLead: enrichmentMutation.mutate,\n    enrichLeadAsync: enrichmentMutation.mutateAsync,\n    enrichMultipleLeads,\n    isEnriching: enrichmentMutation.isPending,\n    progress,\n    currentStage,\n    enrichedCount,\n    totalCost,\n    error: enrichmentMutation.error,\n    data: enrichmentMutation.data,\n    reset,\n  };\n};\n"}}},
{"type":"measure","name":"lsp.testing_update","count":4,"duration":0.306},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":5,"duration":0.311},
{"type":"measure","name":"lsp.did_open","count":10,"duration":5.658},
{"type":"mark","name":"lsp.testing_update"},
{"type":"mark","name":"lsp.did_open","count":11,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","languageId":"typescriptreact","version":1,"text":"import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { supabase } from \"../lib/supabase\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\n\ninterface Campaign {\n  id: string;\n  campaign_id?: string;\n  business_type: string;\n  location: string;\n  status: string;\n  results_count: number;\n  leads_found?: number;\n  leads_qualified?: number;\n  total_cost: number;\n  created_at: string;\n}\n\nexport const Dashboard: React.FC = () => {\n  const { user, loading: authLoading } = useAuth();\n  const { campaigns: localCampaigns, leads: localLeads } = useCampaignStore();\n  const navigate = useNavigate();\n\n  const [campaigns, setCampaigns] = useState<Campaign[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Fetch user-aware campaigns from database\n  useEffect(() => {\n    const fetchCampaigns = async () => {\n      if (authLoading) {\n        return;\n      }\n\n      if (!user?.id) {\n        setCampaigns([]);\n        setLoading(false);\n        setError(null);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        console.log(\"ðŸ“Š Fetching campaigns for user:\", user.id);\n\n        // Query campaigns scoped to the authenticated user\n        const query = supabase\n          .from(\"campaigns\")\n          .select(\"*\")\n          .eq(\"user_id\", user.id);\n\n        const { data, error } = await query.order(\"created_at\", {\n          ascending: false,\n        });\n\n        if (error) {\n          console.error(\"âŒ Error fetching campaigns:\", error);\n          setError(error.message);\n          return;\n        }\n\n        console.log(\"âœ… Campaigns loaded:\", data?.length || 0);\n        setCampaigns(data || []);\n      } catch (err) {\n        console.error(\"âŒ Unexpected error:\", err);\n        setError(\n          err instanceof Error ? err.message : \"Failed to load campaigns\"\n        );\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchCampaigns();\n  }, [authLoading, user?.id]);\n\n  // Calculate stats from database campaigns\n  const totalCost = campaigns.reduce(\n    (sum, campaign) => sum + (campaign.total_cost || 0),\n    0\n  );\n  const totalLeads = campaigns.reduce(\n    (sum, campaign) => sum + (campaign.results_count || 0),\n    0\n  );\n  const qualifiedLeads = localLeads.filter(\n    (lead) => lead.confidence_score >= 80\n  ).length;\n\n  // Fallback to local store data if no database campaigns\n  const stats = [\n    {\n      name: \"Total Campaigns\",\n      value: campaigns.length || localCampaigns.length,\n      icon: \"ðŸš€\",\n    },\n    { name: \"Total Leads\", value: totalLeads || localLeads.length, icon: \"ðŸ‘¥\" },\n    { name: \"Qualified Leads\", value: qualifiedLeads, icon: \"âœ…\" },\n    { name: \"Total Cost\", value: `$${totalCost.toFixed(2)}`, icon: \"ðŸ’°\" },\n  ];\n\n  const recentCampaigns =\n    campaigns.length > 0 ? campaigns.slice(0, 5) : localCampaigns.slice(0, 5);\n\n  if (loading || authLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600 dark:text-gray-400\">\n            Loading campaigns...\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-8 text-center\">\n        <h2 className=\"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2\">\n          Sign in to view your campaigns\n        </h2>\n        <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n          Create an account or sign in to access saved campaigns and lead\n          history.\n        </p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\">\n        <div className=\"flex\">\n          <div className=\"text-red-500 dark:text-red-400 text-xl mr-3\">âš ï¸</div>\n          <div>\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\n              Error loading campaigns\n            </h3>\n            <p className=\"text-sm text-red-700 dark:text-red-300 mt-1\">\n              {error}\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n          Dashboard\n        </h1>\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n          Overview of your lead generation campaigns and results\n        </p>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <div\n            key={stat.name}\n            className=\"bg-white dark:bg-gray-700 overflow-hidden shadow rounded-lg border border-gray-200 dark:border-gray-600\"\n          >\n            <div className=\"p-5\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <span className=\"text-2xl\">{stat.icon}</span>\n                </div>\n                <div className=\"ml-5 w-0 flex-1\">\n                  <dl>\n                    <dt className=\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\">\n                      {stat.name}\n                    </dt>\n                    <dd className=\"text-lg font-medium text-gray-900 dark:text-gray-100\">\n                      {stat.value}\n                    </dd>\n                  </dl>\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Recent Campaigns */}\n      <div className=\"bg-white dark:bg-gray-700 shadow rounded-lg border border-gray-200 dark:border-gray-600\">\n        <div className=\"px-4 py-5 sm:p-6\">\n          <h3 className=\"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100 mb-4\">\n            Recent Campaigns\n          </h3>\n          {recentCampaigns.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <span className=\"text-4xl\">ðŸ”</span>\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100\">\n                No campaigns yet\n              </h3>\n              <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n                Get started by creating your first lead discovery campaign.\n              </p>\n              <div className=\"mt-6\">\n                <a\n                  href=\"/discovery\"\n                  className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors\"\n                >\n                  Start Discovery\n                </a>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {recentCampaigns.map((campaign: any) => {\n                const campaignId = campaign.id || campaign.campaign_id || \"\";\n                const leadsCount =\n                  campaign.results_count || campaign.leads_found || 0;\n                const qualifiedCount = campaign.leads_qualified || 0;\n\n                return (\n                  <div\n                    key={campaignId}\n                    className=\"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer transition-colors\"\n                    onClick={() => navigate(`/campaign?id=${campaignId}`)}\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center\">\n                        <span\n                          className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                            campaign.status === \"completed\"\n                              ? \"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200\"\n                              : campaign.status === \"running\"\n                              ? \"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200\"\n                              : campaign.status === \"failed\"\n                              ? \"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200\"\n                              : \"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200\"\n                          }`}\n                        >\n                          {campaign.status}\n                        </span>\n                        <span className=\"ml-3 text-sm font-weight-medium text-gray-900 dark:text-gray-100\">\n                          {campaign.business_type} in {campaign.location}\n                        </span>\n                      </div>\n                      <div className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n                        {leadsCount} results â€¢ {qualifiedCount} qualified â€¢ $\n                        {campaign.total_cost.toFixed(2)} cost\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                        {new Date(campaign.created_at).toLocaleDateString()}\n                      </div>\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          navigate(`/campaign?id=${campaignId}`);\n                        }}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm font-medium transition-colors\"\n                      >\n                        View Details â†’\n                      </button>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"measure","name":"lsp.testing_update","count":6,"duration":0.284},
{"type":"measure","name":"lsp.did_open","count":11,"duration":7.06},
{"type":"mark","name":"lsp.testing_update"},
{"type":"mark","name":"lsp.did_open","count":12,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","languageId":"typescriptreact","version":1,"text":"import React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useNavigate, useParams, useSearchParams } from \"react-router-dom\";\nimport { ProgressDisplay } from \"../components/ProgressDisplay\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { useJobProgress } from \"../hooks/useJobProgress\";\nimport { supabase } from \"../lib/supabase\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport { transformCampaignData } from \"../utils/campaignTransforms\";\n\nexport const CampaignProgress: React.FC = () => {\n  const { campaignId } = useParams<{ campaignId: string }>();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const jobId = searchParams.get(\"jobId\");\n\n  // Use the job progress hook for real-time updates\n  const { progress: jobProgress } = useJobProgress(jobId || \"\");\n\n  const campaigns = useCampaignStore((state) => state.campaigns);\n  const addCampaign = useCampaignStore((state) => state.addCampaign);\n  const updateCampaign = useCampaignStore((state) => state.updateCampaign);\n  const setCurrentCampaign = useCampaignStore(\n    (state) => state.setCurrentCampaign\n  );\n  const clearLeads = useCampaignStore((state) => state.clearLeads);\n  const addLeads = useCampaignStore((state) => state.addLeads);\n  const setLoading = useCampaignStore((state) => state.setLoading);\n  const setError = useCampaignStore((state) => state.setError);\n  const { user, loading: authLoading } = useAuth();\n  const authUserId = user?.id ?? null;\n\n  const [isFetchingResults, setIsFetchingResults] = useState(false);\n  const [resultFetchError, setResultFetchError] = useState<string | null>(null);\n  const hasFetchedResultsRef = useRef(false);\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  // Extract data from job progress\n  const progress = jobProgress?.progress || 0;\n  const status = jobProgress?.status || \"pending\";\n  const currentStage = jobProgress?.currentStage || \"Initializing...\";\n  const metrics = jobProgress?.metrics;\n  const isComplete = status === \"completed\";\n  const error = jobProgress?.error;\n\n  const displayStage = isFetchingResults\n    ? \"Preparing final results...\"\n    : currentStage;\n  const displayProgress = isFetchingResults\n    ? Math.min(100, Math.max(progress, 96))\n    : progress;\n  const isProcessing = !isComplete || isFetchingResults;\n\n  const fetchResults = useCallback(async () => {\n    if (!campaignId) {\n      return;\n    }\n\n    if (!authUserId) {\n      setResultFetchError(\"Sign in again to view campaign results.\");\n      return;\n    }\n\n    hasFetchedResultsRef.current = true;\n    setIsFetchingResults(true);\n    setResultFetchError(null);\n    setLoading(true);\n\n    const wait = (ms: number) =>\n      new Promise<void>((resolve) => {\n        setTimeout(resolve, ms);\n      });\n\n    try {\n      const MAX_ATTEMPTS = 5;\n      let campaignRecord: any = null;\n      let leadsRecords: any[] = [];\n\n      for (let attempt = 0; attempt < MAX_ATTEMPTS; attempt += 1) {\n        const campaignQuery = supabase\n          .from(\"campaigns\")\n          .select(\n            \"id,business_type,location,status,total_cost,results_count,created_at,updated_at\"\n          )\n          .eq(\"id\", campaignId)\n          .eq(\"user_id\", authUserId);\n\n        const { data: campaignData, error: campaignError } =\n          await campaignQuery.maybeSingle();\n\n        if (campaignError) {\n          throw campaignError;\n        }\n\n        const leadsQuery = supabase\n          .from(\"leads\")\n          .select(\n            \"id,campaign_id,business_name,address,phone,website,email,confidence_score,validation_cost,enrichment_data,created_at\"\n          )\n          .eq(\"campaign_id\", campaignId)\n          .eq(\"user_id\", authUserId)\n          .order(\"confidence_score\", { ascending: false });\n\n        const { data: leadsData, error: leadsError } = await leadsQuery;\n\n        if (leadsError) {\n          throw leadsError;\n        }\n\n        campaignRecord = campaignData;\n        leadsRecords = leadsData ?? [];\n\n        if (\n          campaignRecord &&\n          (leadsRecords.length > 0 || attempt === MAX_ATTEMPTS - 1)\n        ) {\n          break;\n        }\n\n        await wait(2000);\n      }\n\n      if (!campaignRecord) {\n        throw new Error(\n          \"Campaign record not available yet. Please try again in a moment.\"\n        );\n      }\n\n      const { campaignResult, leads: mappedLeads } = transformCampaignData(\n        campaignRecord,\n        leadsRecords,\n        { metrics: (metrics ?? null) as Record<string, any> | null }\n      );\n\n      const campaignExists = campaigns.some(\n        (item) => item.campaign_id === campaignResult.campaign_id\n      );\n\n      if (campaignExists) {\n        updateCampaign(campaignResult.campaign_id, campaignResult);\n      } else {\n        addCampaign(campaignResult);\n      }\n\n      clearLeads();\n      addLeads(mappedLeads);\n      setCurrentCampaign(campaignResult);\n\n      if (isMountedRef.current) {\n        setResultFetchError(null);\n        navigate(\"/results\", { replace: true, state: { campaignId } });\n      }\n    } catch (err) {\n      console.error(\"âš ï¸ Unable to load campaign results\", err);\n      const message =\n        err instanceof Error\n          ? err.message\n          : \"Unable to load campaign results. Please try again.\";\n\n      if (isMountedRef.current) {\n        setResultFetchError(message);\n      }\n\n      setError(message);\n      hasFetchedResultsRef.current = false;\n    } finally {\n      if (isMountedRef.current) {\n        setIsFetchingResults(false);\n        setLoading(false);\n      }\n    }\n  }, [\n    addCampaign,\n    addLeads,\n    authUserId,\n    campaignId,\n    campaigns,\n    clearLeads,\n    metrics,\n    navigate,\n    setCurrentCampaign,\n    setError,\n    setLoading,\n    updateCampaign,\n  ]);\n\n  useEffect(() => {\n    if (!isComplete || !campaignId || !jobId) {\n      return;\n    }\n\n    if (!authUserId) {\n      return;\n    }\n\n    if (hasFetchedResultsRef.current) {\n      return;\n    }\n\n    fetchResults();\n  }, [authUserId, campaignId, fetchResults, isComplete, jobId]);\n\n  const handleRetryFetch = () => {\n    if (!campaignId) {\n      return;\n    }\n\n    if (!authUserId) {\n      setResultFetchError(\"Sign in again to re-establish your session.\");\n      return;\n    }\n\n    fetchResults();\n  };\n\n  if (authLoading) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"flex items-center justify-center\">\n          <div className=\"flex items-center space-x-3 text-gray-600\">\n            <div className=\"h-6 w-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\"></div>\n            <span>Loading campaign...</span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!authUserId) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"max-w-xl mx-auto rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm dark:border-gray-700 dark:bg-gray-800\">\n          <h1 className=\"text-2xl font-semibold text-gray-900 dark:text-gray-100\">\n            Sign in required\n          </h1>\n          <p className=\"mt-3 text-sm text-gray-600 dark:text-gray-300\">\n            Please sign in to review campaign progress and download results.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!jobId || !campaignId) {\n    return (\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-red-600 mb-4\">\n            Invalid Campaign\n          </h1>\n          <p className=\"text-gray-600 mb-4\">\n            Missing job or campaign information.\n          </p>\n          <button\n            onClick={() => navigate(\"/\")}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n          >\n            Return Home\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-red-600 mb-4\">\n            Processing Error\n          </h1>\n          <p className=\"text-gray-600 mb-4\">{error}</p>\n          <button\n            onClick={() => navigate(\"/\")}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n          >\n            Start New Campaign\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8 max-w-4xl\">\n      {/* Header */}\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\n          Campaign Discovery in Progress\n        </h1>\n        <p className=\"text-gray-600\">\n          Campaign ID: <span className=\"font-mono text-sm\">{campaignId}</span>\n        </p>\n        <p className=\"text-gray-600\">\n          Job ID: <span className=\"font-mono text-sm\">{jobId}</span>\n        </p>\n      </div>\n\n      {isFetchingResults && !resultFetchError && (\n        <div className=\"mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4 text-sm text-blue-700\">\n          Finalizing campaign results and syncing verified leads to your\n          vault...\n        </div>\n      )}\n\n      {resultFetchError && (\n        <div className=\"mb-6 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-700\">\n          <div className=\"font-semibold\">Unable to load campaign results</div>\n          <p className=\"mt-1\">{resultFetchError}</p>\n          <button\n            onClick={handleRetryFetch}\n            className=\"mt-3 inline-flex items-center rounded border border-red-300 bg-white px-3 py-1.5 text-xs font-medium text-red-700 shadow-sm transition hover:bg-red-100\"\n          >\n            Retry syncing results\n          </button>\n        </div>\n      )}\n\n      {/* Progress Display */}\n      <ProgressDisplay\n        isDiscovering={isProcessing}\n        progress={displayProgress}\n        currentStage={displayStage}\n        cacheStats={null} // Real-time updates don't include cache stats\n      />\n\n      {/* Real-time Metrics */}\n      {metrics && (\n        <div className=\"mt-6 bg-white border border-gray-200 rounded-lg p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            ðŸ“Š Live Discovery Metrics\n          </h3>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {metrics.total_found || 0}\n              </div>\n              <div className=\"text-sm text-gray-600\">Total Found</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {metrics.qualified_leads || 0}\n              </div>\n              <div className=\"text-sm text-gray-600\">Qualified</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {metrics.avg_confidence ? `${metrics.avg_confidence}%` : \"0%\"}\n              </div>\n              <div className=\"text-sm text-gray-600\">Avg Confidence</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-orange-600\">\n                ${(metrics.total_cost || 0).toFixed(2)}\n              </div>\n              <div className=\"text-sm text-gray-600\">Total Cost</div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Status Updates */}\n      <div className=\"mt-6 bg-gray-50 border border-gray-200 rounded-lg p-4\">\n        <h4 className=\"font-semibold text-gray-900 mb-2\">Status Updates</h4>\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center text-sm\">\n            <div className=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></div>\n            <span className=\"text-gray-600\">\n              Campaign started at {new Date().toLocaleTimeString()}\n            </span>\n          </div>\n          {displayStage && (\n            <div className=\"flex items-center text-sm\">\n              <div className=\"w-2 h-2 bg-blue-400 rounded-full mr-2 animate-pulse\"></div>\n              <span className=\"text-gray-900 font-medium\">{displayStage}</span>\n            </div>\n          )}\n          {isFetchingResults && (\n            <div className=\"flex items-center text-sm\">\n              <div className=\"w-2 h-2 bg-purple-400 rounded-full mr-2 animate-pulse\"></div>\n              <span className=\"text-purple-600 font-medium\">\n                Finalizing leads and preparing results...\n              </span>\n            </div>\n          )}\n          {status === \"completed\" && (\n            <div className=\"flex items-center text-sm\">\n              <div className=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></div>\n              <span className=\"text-green-600 font-medium\">\n                âœ… Discovery completed! Redirecting to results...\n              </span>\n            </div>\n          )}\n          {resultFetchError && (\n            <div className=\"flex items-center text-sm\">\n              <div className=\"w-2 h-2 bg-red-400 rounded-full mr-2\"></div>\n              <span className=\"text-red-600 font-medium\">\n                {resultFetchError}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"mt-8 text-center space-x-4\">\n        <button\n          onClick={() => navigate(\"/\")}\n          className=\"px-4 py-2 text-gray-600 bg-gray-100 rounded hover:bg-gray-200\"\n        >\n          Start New Campaign\n        </button>\n        {!isProcessing && (\n          <button\n            onClick={() => navigate(\"/results\", { state: { campaignId } })}\n            className=\"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n          >\n            View Complete Results\n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"measure","name":"lsp.testing_update","count":7,"duration":0.265},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":8,"duration":0.224},
{"type":"measure","name":"lsp.did_open","count":12,"duration":5.583},
{"type":"mark","name":"lsp.did_open","count":13,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","languageId":"typescriptreact","version":1,"text":"import React, { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  GeographicLocation,\n  GeographicSelector,\n} from \"../components/GeographicSelector\";\nimport { MultiSelectBusinessTypes } from \"../components/MultiSelectBusinessTypes\";\nimport { ProgressDisplay } from \"../components/ProgressDisplay\";\nimport { TierSelector } from \"../components/TierSelector\";\nimport { BUSINESS_TYPES_BY_CATEGORY } from \"../constants/businessTaxonomy\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { useBusinessDiscovery } from \"../hooks/useBusinessDiscovery\";\nimport { ENRICHMENT_TIERS } from \"../lib/supabase\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nconst DEFAULT_CATEGORY = \"Home & Property Services\";\nconst DEFAULT_LOCATION: GeographicLocation = {\n  lat: 40.7128,\n  lng: -74.006,\n  address: \"New York, NY\",\n};\nconst DEFAULT_RADIUS = 10;\n\nconst STEPS = [\n  { id: 1, title: \"Targeting\", description: \"Audience & geography\" },\n  { id: 2, title: \"Campaign setup\", description: \"Tier & quantity\" },\n  { id: 3, title: \"Results\", description: \"Leads & export\" },\n];\n\nconst getConfidenceColor = (score: number) => {\n  if (score >= 90)\n    return \"border border-emerald-200 bg-emerald-50 text-emerald-700 dark:border-emerald-400 dark:bg-transparent dark:text-emerald-300\";\n  if (score >= 80)\n    return \"border border-sky-200 bg-sky-50 text-sky-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\";\n  if (score >= 70)\n    return \"border border-amber-200 bg-amber-50 text-amber-700 dark:border-amber-400 dark:bg-transparent dark:text-amber-300\";\n  return \"border border-rose-200 bg-rose-50 text-rose-700 dark:border-rose-400 dark:bg-transparent dark:text-rose-300\";\n};\n\nconst getValidationStatusColor = (status?: string) => {\n  switch (status) {\n    case \"validated\":\n      return \"border border-emerald-200 bg-emerald-50 text-emerald-700 dark:border-emerald-400 dark:bg-transparent dark:text-emerald-300\";\n    case \"validating\":\n      return \"border border-sky-200 bg-sky-50 text-sky-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\";\n    case \"pending\":\n      return \"border border-amber-200 bg-amber-50 text-amber-700 dark:border-amber-400 dark:bg-transparent dark:text-amber-300\";\n    case \"failed\":\n      return \"border border-rose-200 bg-rose-50 text-rose-700 dark:border-rose-400 dark:bg-transparent dark:text-rose-300\";\n    default:\n      return \"border border-gray-200 bg-gray-50 text-gray-700 dark:border-slate-500 dark:bg-transparent dark:text-slate-300\";\n  }\n};\n\nexport const BusinessDiscovery: React.FC = () => {\n  const navigate = useNavigate();\n  const { user, loading: authLoading } = useAuth();\n\n  const handleJobCreated = (jobData: {\n    jobId: string;\n    campaignId: string;\n    status: string;\n    estimatedTime?: number;\n  }) => {\n    console.log(\"ðŸš€ Job created, navigating to progress page:\", jobData);\n    navigate(`/campaign/${jobData.campaignId}/progress?jobId=${jobData.jobId}`);\n  };\n\n  const {\n    startDiscovery,\n    isDiscovering,\n    progress,\n    currentStage,\n    cacheStats,\n    error,\n  } = useBusinessDiscovery(handleJobCreated);\n\n  const defaultBusinessTypes =\n    BUSINESS_TYPES_BY_CATEGORY[DEFAULT_CATEGORY] || [];\n  const [selectedCategories, setSelectedCategories] = useState<string[]>([\n    DEFAULT_CATEGORY,\n  ]);\n  const [selectedBusinessTypes, setSelectedBusinessTypes] = useState<string[]>(\n    defaultBusinessTypes.length > 0 ? [defaultBusinessTypes[0]] : []\n  );\n  const [keywords, setKeywords] = useState(\"\");\n  const [location, setLocation] =\n    useState<GeographicLocation>(DEFAULT_LOCATION);\n  const [searchRadius, setSearchRadius] = useState<number>(DEFAULT_RADIUS);\n  const [expandGeography, setExpandGeography] = useState(false);\n  const [numberOfLeads, setNumberOfLeads] = useState(3);\n  const [selectedTier, setSelectedTier] =\n    useState<keyof typeof ENRICHMENT_TIERS>(\"BASE\");\n  const [activeStep, setActiveStep] = useState<1 | 2 | 3>(1);\n\n  const currentTierConfig = ENRICHMENT_TIERS[selectedTier];\n  const estimatedCost = numberOfLeads * currentTierConfig.price;\n  const sliderPercent = ((numberOfLeads - 1) / 9) * 100;\n\n  const { leads, currentCampaign } = useCampaignStore();\n\n  const campaignLeads = useMemo(() => {\n    if (currentCampaign) {\n      return leads.filter(\n        (lead) => lead.campaign_id === currentCampaign.campaign_id\n      );\n    }\n    return leads;\n  }, [leads, currentCampaign]);\n\n  const qualifiedLeadCount = useMemo(\n    () => campaignLeads.filter((lead) => lead.confidence_score >= 70).length,\n    [campaignLeads]\n  );\n\n  const hasResults = campaignLeads.length > 0;\n\n  useEffect(() => {\n    if (hasResults && activeStep === 2 && !isDiscovering) {\n      setActiveStep(3);\n    }\n  }, [hasResults, activeStep, isDiscovering]);\n\n  const handleExportResults = () => {\n    if (!campaignLeads.length) return;\n\n    exportLeadsToCsv(campaignLeads, {\n      fileName: `campaign-${\n        currentCampaign?.campaign_id || Date.now()\n      }-results.csv`,\n    });\n  };\n\n  const handleViewCampaign = () => {\n    if (!currentCampaign) return;\n\n    navigate(`/campaign?id=${currentCampaign.campaign_id}`);\n  };\n\n  const keywordsList = keywords\n    .split(\",\")\n    .map((keyword) => keyword.trim())\n    .filter((keyword) => keyword.length > 0);\n  const keywordsString = keywordsList.join(\", \");\n  const businessTypesString = selectedBusinessTypes.join(\", \");\n  const approxCoverage = Math.round(Math.PI * searchRadius * searchRadius);\n\n  const isTargetingValid =\n    selectedBusinessTypes.length > 0 && location.address.trim().length > 0;\n\n  const handleGeographicChange = (\n    updatedLocation: GeographicLocation,\n    radius: number\n  ) => {\n    setLocation(updatedLocation);\n    setSearchRadius(radius);\n  };\n\n  const handleContinue = () => {\n    if (!isTargetingValid) {\n      alert(\"Please select at least one business type and provide a location.\");\n      return;\n    }\n    setActiveStep(2);\n  };\n\n  const handleBackToTargeting = () => {\n    setActiveStep(1);\n  };\n\n  const handleSearch = () => {\n    if (!user) {\n      alert(\"Please sign in to run a discovery campaign.\");\n      return;\n    }\n\n    if (!isTargetingValid) {\n      setActiveStep(1);\n      alert(\"Please complete targeting details before running the campaign.\");\n      return;\n    }\n\n    const config = {\n      search_terms: `${businessTypesString}${\n        keywordsString ? ` ${keywordsString}` : \"\"\n      }`.trim(),\n      location: location.address.trim(),\n      business_type: businessTypesString,\n      budget_limit: estimatedCost,\n      max_results: numberOfLeads,\n      include_email_validation:\n        selectedTier === \"PROFESSIONAL\" || selectedTier === \"ENTERPRISE\",\n      include_website_validation: true,\n      min_confidence_score: 70,\n      chamber_verification: true,\n      trade_association: true,\n      professional_license: true,\n      keywords: keywordsString,\n      search_radius: `${searchRadius} miles`,\n      expand_geography: expandGeography,\n      selectedTier,\n    };\n\n    console.log(\"ðŸš€ Starting campaign:\", config);\n    startDiscovery(config);\n  };\n\n  const selectedBusinessTypesPreview = selectedBusinessTypes.length\n    ? (() => {\n        const preview = selectedBusinessTypes.slice(0, 5).join(\", \");\n        const remaining = selectedBusinessTypes.length - 5;\n        return remaining > 0 ? `${preview} +${remaining} more` : preview;\n      })()\n    : \"No business types selected\";\n\n  const summaryItems = [\n    {\n      label: \"Business categories\",\n      value:\n        selectedCategories.length > 0\n          ? selectedCategories.join(\", \")\n          : \"No categories selected\",\n    },\n    {\n      label: \"Business types\",\n      value: selectedBusinessTypesPreview,\n    },\n    {\n      label: \"Keywords\",\n      value: keywordsString.length > 0 ? keywordsString : \"None\",\n    },\n    {\n      label: \"Location\",\n      value: location.address,\n    },\n    {\n      label: \"Radius\",\n      value: `${searchRadius} miles`,\n    },\n    {\n      label: \"Geography\",\n      value: expandGeography ? \"Auto-expand enabled\" : \"Stay within radius\",\n    },\n    {\n      label: \"Coverage\",\n      value: `~${approxCoverage} square miles`,\n    },\n  ];\n\n  if (authLoading) {\n    return (\n      <div className=\"rounded-lg border border-gray-200 bg-white p-6 text-center shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n        <div className=\"flex items-center justify-center space-x-3 text-gray-600 dark:text-slate-300\">\n          <div className=\"h-6 w-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\" />\n          <span>Loading your workspaceâ€¦</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n        <h1 className=\"text-2xl font-semibold text-gray-900 dark:text-gray-100\">\n          Sign in required\n        </h1>\n        <p className=\"mt-3 text-sm text-gray-600 dark:text-gray-300\">\n          Create an account or sign in to launch new campaigns and access\n          verified leads.\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n      <div className=\"border-b border-gray-200 px-6 py-4 dark:border-slate-700\">\n        <div className=\"flex flex-wrap items-center gap-4\">\n          {STEPS.map((step) => {\n            const isActive = activeStep === step.id;\n            const isCompleted = activeStep > step.id;\n            const canNavigate =\n              step.id === 1 ||\n              (step.id === 2 && isTargetingValid) ||\n              step.id === 3;\n            const isDisabled = step.id === 2 && !isTargetingValid;\n            const disableButton = !canNavigate || isDisabled;\n\n            return (\n              <button\n                key={step.id}\n                type=\"button\"\n                disabled={disableButton}\n                onClick={() => setActiveStep(step.id as 1 | 2 | 3)}\n                className={`flex items-center gap-3 rounded-md border px-4 py-2 text-left transition-colors ${\n                  isActive\n                    ? \"border-blue-600 bg-blue-50 text-blue-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\"\n                    : isCompleted\n                    ? \"border-blue-200 bg-white text-blue-600 dark:border-slate-600 dark:bg-transparent dark:text-sky-300\"\n                    : \"border-transparent bg-white text-gray-600 hover:border-blue-200 hover:text-blue-700 dark:border-transparent dark:bg-transparent dark:text-slate-300 dark:hover:border-sky-400\"\n                } ${disableButton ? \"cursor-not-allowed opacity-60\" : \"\"}`}\n              >\n                <span\n                  className={`flex h-8 w-8 items-center justify-center rounded-full border-2 text-sm font-semibold ${\n                    isActive\n                      ? \"border-blue-600 bg-blue-600 text-white dark:border-sky-400 dark:bg-sky-400 dark:text-slate-900\"\n                      : isCompleted\n                      ? \"border-blue-300 bg-blue-100 text-blue-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\"\n                      : \"border-gray-300 bg-white text-gray-500 dark:border-slate-600 dark:bg-transparent dark:text-slate-400\"\n                  }`}\n                  aria-hidden=\"true\"\n                >\n                  {step.id}\n                </span>\n                <span className=\"flex flex-col\">\n                  <span className=\"text-sm font-semibold\">{step.title}</span>\n                  <span className=\"text-xs text-gray-500 dark:text-slate-400\">\n                    {step.description}\n                  </span>\n                </span>\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      <div className=\"p-6 space-y-8\">\n        <section\n          className={`space-y-6 ${activeStep === 1 ? \"\" : \"hidden\"}`}\n          aria-hidden={activeStep !== 1}\n        >\n          <header>\n            <h2 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n              Targeting & Geography\n            </h2>\n            <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\n              Choose the businesses and regions you want ProspectPro to\n              discover.\n            </p>\n          </header>\n\n          <MultiSelectBusinessTypes\n            selectedCategories={selectedCategories}\n            selectedBusinessTypes={selectedBusinessTypes}\n            onCategoriesChange={setSelectedCategories}\n            onBusinessTypesChange={setSelectedBusinessTypes}\n          />\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Additional Keywords (Optional)\n            </label>\n            <input\n              type=\"text\"\n              value={keywords}\n              onChange={(e) => setKeywords(e.target.value)}\n              placeholder=\"e.g., luxury, organic, 24-hour (comma-separated)\"\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400\"\n            />\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              Add comma-separated keywords to refine your search.\n            </p>\n          </div>\n\n          <div className=\"space-y-4\">\n            <GeographicSelector\n              onLocationChange={handleGeographicChange}\n              initialLocation={location}\n              initialRadius={searchRadius}\n            />\n\n            <div className=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                id=\"expandGeography\"\n                checked={expandGeography}\n                onChange={(e) => setExpandGeography(e.target.checked)}\n                className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700\"\n              />\n              <label\n                htmlFor=\"expandGeography\"\n                className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\"\n              >\n                Expand geography automatically if initial results are limited\n              </label>\n            </div>\n          </div>\n\n          <div className=\"flex justify-end\">\n            <button\n              type=\"button\"\n              onClick={handleContinue}\n              className=\"px-5 py-2 rounded-md bg-blue-600 text-white font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              disabled={!isTargetingValid}\n            >\n              Continue to Campaign Setup\n            </button>\n          </div>\n        </section>\n\n        <section\n          className={`space-y-6 ${activeStep === 2 ? \"\" : \"hidden\"}`}\n          aria-hidden={activeStep !== 2}\n        >\n          <header className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n                Campaign Setup\n              </h2>\n              <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\n                Review your targeting, then select enrichment tier and lead\n                quantity.\n              </p>\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleBackToTargeting}\n              className=\"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-300\"\n            >\n              â† Edit targeting\n            </button>\n          </header>\n\n          <div className=\"rounded-md border border-gray-200 bg-gray-50 p-4 dark:border-slate-700 dark:bg-slate-900/80\">\n            <h3 className=\"mb-3 text-sm font-semibold text-gray-800 dark:text-slate-200\">\n              Campaign summary\n            </h3>\n            <dl className=\"grid gap-3 sm:grid-cols-2\">\n              {summaryItems.map((item) => (\n                <div key={item.label} className=\"flex flex-col\">\n                  <dt className=\"text-xs uppercase tracking-wide text-gray-500 dark:text-slate-400\">\n                    {item.label}\n                  </dt>\n                  <dd className=\"text-sm text-gray-800 dark:text-slate-100\">\n                    {item.value}\n                  </dd>\n                </div>\n              ))}\n            </dl>\n          </div>\n\n          <TierSelector\n            selectedTier={selectedTier}\n            onTierChange={setSelectedTier}\n            numberOfLeads={numberOfLeads}\n          />\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-700 dark:text-slate-200\">\n              Number of Leads\n            </label>\n            <div className=\"flex items-center gap-4\">\n              <input\n                type=\"range\"\n                min=\"1\"\n                max=\"10\"\n                value={numberOfLeads}\n                onChange={(e) => setNumberOfLeads(parseInt(e.target.value, 10))}\n                className=\"h-2 flex-1 cursor-pointer appearance-none rounded-full bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                style={{\n                  background: `linear-gradient(90deg, #2563eb 0%, #2563eb ${sliderPercent}%, #d1d5db ${sliderPercent}%, #d1d5db 100%)`,\n                  accentColor: \"#2563eb\",\n                }}\n              />\n              <div className=\"min-w-fit rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-sm font-medium text-blue-700 dark:border-sky-400 dark:bg-slate-900 dark:text-sky-300\">\n                {numberOfLeads} leads\n              </div>\n            </div>\n          </div>\n\n          <div className=\"rounded-lg border-2 border-yellow-400 bg-white p-4 shadow-sm dark:border-amber-400 dark:bg-slate-900\">\n            <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n              <div>\n                <p className=\"text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-slate-300\">\n                  Estimated cost\n                </p>\n                <div className=\"mt-1 flex items-baseline gap-x-3\">\n                  <span className=\"text-3xl font-bold text-blue-700 dark:text-sky-300\">\n                    ${estimatedCost.toFixed(2)}\n                  </span>\n                </div>\n              </div>\n              <div className=\"flex w-full flex-col items-start gap-2 sm:w-auto sm:items-end\">\n                <span className=\"text-sm text-gray-600 dark:text-slate-400\">\n                  {numberOfLeads} leads Ã— ${currentTierConfig.price.toFixed(2)}\n                </span>\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <span className=\"rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-xs font-medium text-blue-700 dark:border-sky-400 dark:bg-slate-900 dark:text-sky-300\">\n                    {currentTierConfig.name}\n                  </span>\n                  <button\n                    type=\"button\"\n                    onClick={handleSearch}\n                    disabled={isDiscovering}\n                    className=\"inline-flex items-center justify-center rounded-md bg-blue-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60 dark:bg-sky-500 dark:hover:bg-sky-600\"\n                  >\n                    {isDiscovering ? (\n                      <>\n                        <svg\n                          className=\"-ml-1 mr-2 h-4 w-4 animate-spin text-white\"\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          fill=\"none\"\n                          viewBox=\"0 0 24 24\"\n                        >\n                          <circle\n                            className=\"opacity-25\"\n                            cx=\"12\"\n                            cy=\"12\"\n                            r=\"10\"\n                            stroke=\"currentColor\"\n                            strokeWidth=\"4\"\n                          ></circle>\n                          <path\n                            className=\"opacity-75\"\n                            fill=\"currentColor\"\n                            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                          ></path>\n                        </svg>\n                        Runningâ€¦\n                      </>\n                    ) : (\n                      \"Run Campaign\"\n                    )}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <ProgressDisplay\n            isDiscovering={isDiscovering}\n            progress={progress}\n            currentStage={currentStage}\n            cacheStats={cacheStats}\n          />\n        </section>\n\n        <section\n          className={`space-y-6 ${activeStep === 3 ? \"\" : \"hidden\"}`}\n          aria-hidden={activeStep !== 3}\n        >\n          <header className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n                Campaign Results\n              </h2>\n              <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\n                {hasResults\n                  ? `${campaignLeads.length} leads captured â€¢ ${qualifiedLeadCount} qualified`\n                  : isDiscovering\n                  ? \"We're still enriching this campaign. Hang tight while ProspectPro verifies contacts.\"\n                  : \"Results will appear here once a campaign finishes. You can keep working in the meantime.\"}\n              </p>\n            </div>\n            <div className=\"flex flex-wrap gap-3\">\n              {currentCampaign && (\n                <button\n                  type=\"button\"\n                  onClick={handleViewCampaign}\n                  className=\"inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-slate-600 dark:bg-transparent dark:text-slate-200 dark:hover:border-sky-400\"\n                >\n                  View full campaign\n                </button>\n              )}\n              {hasResults && (\n                <button\n                  type=\"button\"\n                  onClick={handleExportResults}\n                  className=\"inline-flex items-center gap-2 rounded-md border border-emerald-400 px-4 py-2 text-sm font-semibold text-emerald-700 transition-colors hover:bg-emerald-50 dark:border-emerald-400 dark:text-emerald-300 dark:hover:bg-transparent\"\n                >\n                  ðŸ“Š Export CSV\n                </button>\n              )}\n            </div>\n          </header>\n\n          {currentCampaign && (\n            <div className=\"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-slate-700 dark:bg-slate-900/70\">\n              <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                <div>\n                  <div className=\"text-xs uppercase tracking-wide text-gray-500 dark:text-slate-400\">\n                    Campaign ID\n                  </div>\n                  <div className=\"text-sm font-semibold text-gray-900 dark:text-slate-100\">\n                    {currentCampaign.campaign_id}\n                  </div>\n                  <div className=\"mt-2 text-xs text-gray-500 dark:text-slate-400\">\n                    Status â€¢ {currentCampaign.status}\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-2 gap-4 sm:grid-cols-4\">\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-bold text-gray-900 dark:text-slate-100\">\n                      {currentCampaign.leads_found ?? campaignLeads.length}\n                    </div>\n                    <div className=\"text-xs text-gray-600 dark:text-slate-400\">\n                      Total Leads\n                    </div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-bold text-blue-600 dark:text-sky-300\">\n                      {currentCampaign.leads_qualified ?? qualifiedLeadCount}\n                    </div>\n                    <div className=\"text-xs text-gray-600 dark:text-slate-400\">\n                      Qualified\n                    </div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-bold text-green-600 dark:text-emerald-300\">\n                      {currentCampaign.leads_validated ?? 0}\n                    </div>\n                    <div className=\"text-xs text-gray-600 dark:text-slate-400\">\n                      Validated\n                    </div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-lg font-bold text-purple-600 dark:text-violet-300\">\n                      {currentCampaign.tier_used || selectedTier}\n                    </div>\n                    <div className=\"text-xs text-gray-600 dark:text-slate-400\">\n                      Tier\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden shadow-sm\">\n            {!hasResults ? (\n              <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n                <span className=\"text-4xl mb-2\">ðŸ”</span>\n                <h3 className=\"text-base font-semibold text-gray-900 dark:text-gray-100\">\n                  {isDiscovering\n                    ? \"ProspectPro is working on your campaign\"\n                    : \"No leads yet\"}\n                </h3>\n                <p className=\"mt-2 max-w-md text-sm text-gray-600 dark:text-gray-300\">\n                  {isDiscovering\n                    ? \"Please keep this tab open. We'll move results here automatically once enrichment finishes.\"\n                    : \"Launch or complete a campaign to populate results with verified leads.\"}\n                </p>\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                  <thead className=\"bg-gray-50 dark:bg-gray-900/40\">\n                    <tr>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\">\n                        Business\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\">\n                        Contact\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\">\n                        Confidence\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\">\n                        Enrichment\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\">\n                        Status\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\">\n                        Cost\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                    {campaignLeads.map((lead) => (\n                      <tr\n                        key={lead.id}\n                        className=\"hover:bg-gray-50 dark:hover:bg-gray-900/30\"\n                      >\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">\n                            {lead.business_name}\n                          </div>\n                          <div className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                            {lead.address}\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"text-sm text-gray-900 dark:text-gray-100 space-y-1\">\n                            {lead.phone && <div>ðŸ“ž {lead.phone}</div>}\n                            {lead.website && (\n                              <div>\n                                ðŸŒ{\" \"}\n                                <a\n                                  href={lead.website}\n                                  target=\"_blank\"\n                                  rel=\"noopener noreferrer\"\n                                  className=\"text-blue-600 dark:text-blue-400 hover:underline\"\n                                >\n                                  {lead.website.replace(/^https?:\\/\\//, \"\")}\n                                </a>\n                              </div>\n                            )}\n                            {lead.email && <div>ðŸ“§ {lead.email}</div>}\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <span\n                            className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getConfidenceColor(\n                              lead.confidence_score\n                            )}`}\n                          >\n                            {lead.confidence_score}%\n                          </span>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"flex flex-col space-y-1\">\n                            <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300\">\n                              {lead.enrichment_tier || currentTierConfig.name}\n                            </span>\n                            {lead.vault_secured && (\n                              <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300\">\n                                ðŸ” Vault Secured\n                              </span>\n                            )}\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <span\n                            className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getValidationStatusColor(\n                              lead.validation_status\n                            )}`}\n                          >\n                            {lead.validation_status || \"pending\"}\n                          </span>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200\">\n                          ${lead.cost_to_acquire.toFixed(2)}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n        </section>\n\n        {error && (\n          <div className=\"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md\">\n            <div className=\"flex\">\n              <div className=\"flex-shrink-0\">\n                <svg\n                  className=\"h-5 w-5 text-red-400 dark:text-red-500\"\n                  viewBox=\"0 0 20 20\"\n                  fill=\"currentColor\"\n                >\n                  <path\n                    fillRule=\"evenodd\"\n                    d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                    clipRule=\"evenodd\"\n                  />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\n                  Discovery Failed\n                </h3>\n                <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n                  <p>\n                    {error instanceof Error ? error.message : String(error)}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":9,"duration":0.232},
{"type":"measure","name":"lsp.did_open","count":13,"duration":4.278},
{"type":"mark","name":"lsp.did_open","count":14,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","languageId":"typescriptreact","version":1,"text":"import React from \"react\";\nimport { ApiUsageTable } from \"../components/ApiUsageTable\";\nimport { useAuth } from \"../contexts/AuthContext\";\n\nexport const AccountPage: React.FC = () => {\n  const { user, loading } = useAuth();\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-64\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"h-6 w-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\"></div>\n          <span className=\"text-gray-600 dark:text-slate-400\">\n            Loading account...\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"flex items-center justify-center min-h-64\">\n        <div className=\"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n          <h1 className=\"text-xl font-semibold text-gray-900 dark:text-slate-100\">\n            Sign in to manage your account\n          </h1>\n          <p className=\"mt-2 text-sm text-gray-600 dark:text-slate-400\">\n            Access your billing, usage analytics, and profile settings after\n            signing in.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  const displayName = user?.user_metadata?.full_name || \"ProspectPro User\";\n  const email = user?.email || \"Not provided\";\n  const avatarUrl = user?.user_metadata?.avatar_url;\n  const createdAt = user?.created_at ? new Date(user.created_at) : null;\n  const lastSignIn = user?.last_sign_in_at\n    ? new Date(user.last_sign_in_at)\n    : null;\n\n  const initials = displayName\n    .split(\" \")\n    .map((part: string) => part.charAt(0))\n    .join(\"\")\n    .slice(0, 2)\n    .toUpperCase();\n\n  return (\n    <div className=\"max-w-6xl mx-auto space-y-8\">\n      {/* Page Header */}\n      <div className=\"border-b border-gray-200 pb-6 dark:border-slate-700\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-slate-100\">\n          Account Settings\n        </h1>\n        <p className=\"mt-2 text-gray-600 dark:text-slate-400\">\n          Manage your account, view usage analytics, and configure preferences.\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 gap-8 lg:grid-cols-3\">\n        {/* Profile Section */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n            <h2 className=\"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4\">\n              Profile Information\n            </h2>\n\n            <div className=\"flex items-center space-x-4 mb-6\">\n              <div className=\"relative flex h-16 w-16 items-center justify-center overflow-hidden rounded-full border-2 border-blue-200 bg-blue-100 text-xl font-bold text-blue-700 shadow-sm dark:border-sky-500/60 dark:bg-sky-500/10 dark:text-sky-200\">\n                {avatarUrl ? (\n                  <img\n                    src={avatarUrl}\n                    alt={displayName}\n                    className=\"absolute inset-0 h-full w-full object-cover\"\n                  />\n                ) : (\n                  initials || \"PP\"\n                )}\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-slate-100\">\n                  {displayName}\n                </h3>\n                <p className=\"text-sm text-gray-600 dark:text-slate-400\">\n                  {email}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500 dark:text-slate-400\">\n                  Account Created\n                </dt>\n                <dd className=\"text-sm text-gray-900 dark:text-slate-100\">\n                  {createdAt\n                    ? createdAt.toLocaleDateString(\"en-US\", {\n                        year: \"numeric\",\n                        month: \"long\",\n                        day: \"numeric\",\n                      })\n                    : \"Unknown\"}\n                </dd>\n              </div>\n\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500 dark:text-slate-400\">\n                  Last Sign In\n                </dt>\n                <dd className=\"text-sm text-gray-900 dark:text-slate-100\">\n                  {lastSignIn\n                    ? lastSignIn.toLocaleDateString(\"en-US\", {\n                        year: \"numeric\",\n                        month: \"short\",\n                        day: \"numeric\",\n                        hour: \"2-digit\",\n                        minute: \"2-digit\",\n                      })\n                    : \"Unknown\"}\n                </dd>\n              </div>\n\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500 dark:text-slate-400\">\n                  User ID\n                </dt>\n                <dd className=\"text-xs font-mono text-gray-700 dark:text-slate-300 break-all\">\n                  {user?.id || \"Not available\"}\n                </dd>\n              </div>\n            </div>\n          </div>\n\n          {/* Quick Actions */}\n          <div className=\"mt-6 rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4\">\n              Quick Actions\n            </h3>\n            <div className=\"space-y-3\">\n              <button\n                type=\"button\"\n                className=\"w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700\"\n                onClick={() => {\n                  // TODO: Implement profile editing\n                  alert(\n                    \"Profile editing will be available in a future update.\"\n                  );\n                }}\n              >\n                Edit Profile\n              </button>\n              <button\n                type=\"button\"\n                className=\"w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700\"\n                onClick={() => {\n                  // TODO: Implement password change\n                  alert(\n                    \"Password management will be available in a future update.\"\n                  );\n                }}\n              >\n                Change Password\n              </button>\n              <button\n                type=\"button\"\n                className=\"w-full rounded-md border border-red-300 bg-white px-4 py-2 text-sm font-medium text-red-600 transition-colors hover:bg-red-50 dark:border-red-600 dark:bg-slate-800 dark:text-red-400 dark:hover:bg-red-900/20\"\n                onClick={() => {\n                  // TODO: Implement account deletion\n                  if (\n                    confirm(\n                      \"Are you sure you want to delete your account? This action cannot be undone.\"\n                    )\n                  ) {\n                    alert(\n                      \"Account deletion will be available in a future update.\"\n                    );\n                  }\n                }}\n              >\n                Delete Account\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Usage Analytics */}\n        <div className=\"lg:col-span-2\">\n          <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n            <div className=\"mb-6\">\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-slate-100\">\n                API Usage & Cost Analytics\n              </h2>\n              <p className=\"text-sm text-gray-600 dark:text-slate-400\">\n                Monitor your API usage patterns and costs across all services.\n              </p>\n            </div>\n\n            <ApiUsageTable />\n          </div>\n        </div>\n      </div>\n\n      {/* Subscription and Billing Section (Placeholder) */}\n      <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\">\n        <h2 className=\"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4\">\n          Subscription & Billing\n        </h2>\n        <div className=\"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-sky-800 dark:bg-sky-900/20\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg\n                className=\"h-5 w-5 text-blue-400\"\n                viewBox=\"0 0 20 20\"\n                fill=\"currentColor\"\n              >\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-blue-800 dark:text-sky-200\">\n                Current Plan: Pay-per-Use\n              </h3>\n              <p className=\"mt-1 text-sm text-blue-700 dark:text-sky-300\">\n                You're currently on a pay-per-use billing model with no monthly\n                subscription. API costs are charged based on actual usage.\n                Subscription plans with fixed pricing and enhanced features\n                coming soon.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":10,"duration":0.245},
{"type":"measure","name":"lsp.did_open","count":14,"duration":1.687},
{"type":"mark","name":"lsp.did_open","count":15,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","languageId":"typescript","version":1,"text":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\nimport {\n  createUsageLogger,\n  UsageLogContext,\n  UsageLogger,\n} from \"../_shared/api-usage.ts\";\nimport { corsHeaders, handleCORS } from \"../_shared/edge-auth.ts\";\n\n// Background Task Business Discovery with Tiered Enrichment + Multi-Source Discovery\n// ProspectPro v4.3 - October 2025\n// - Google Places + Foursquare discovery with Census targeting\n// - Tier-aware enrichment pipeline with Hunter.io + NeverBounce\n// - Rich verification metadata persisted for UI + exports\n\n// Type declarations for EdgeRuntime\ndeclare const EdgeRuntime: {\n  waitUntil(promise: Promise<unknown>): void;\n};\n\ntype TierKey = \"BASE\" | \"PROFESSIONAL\" | \"ENTERPRISE\";\n\ntype DataSource = \"google_places\" | \"google_place_details\" | \"foursquare\";\n\ninterface TierSettings {\n  key: TierKey;\n  name: string;\n  pricePerLead: number;\n  orchestratorTier: \"starter\" | \"professional\" | \"enterprise\" | \"compliance\";\n  maxCostPerLead: number;\n  includes: {\n    verifyEmails: boolean;\n    personEnrichment: boolean;\n    apolloEnrichment: boolean;\n  };\n}\n\nconst ENRICHMENT_TIERS: Record<TierKey, TierSettings> = {\n  BASE: {\n    key: \"BASE\",\n    name: \"Base\",\n    pricePerLead: 0.15,\n    orchestratorTier: \"starter\",\n    maxCostPerLead: 0.5,\n    includes: {\n      verifyEmails: false, // Generic company email only\n      personEnrichment: false,\n      apolloEnrichment: false,\n    },\n  },\n  PROFESSIONAL: {\n    key: \"PROFESSIONAL\",\n    name: \"Professional\",\n    pricePerLead: 0.45,\n    orchestratorTier: \"professional\",\n    maxCostPerLead: 1.5,\n    includes: {\n      verifyEmails: true, // Professional email discovery & verification\n      personEnrichment: false,\n      apolloEnrichment: false,\n    },\n  },\n  ENTERPRISE: {\n    key: \"ENTERPRISE\",\n    name: \"Enterprise\",\n    pricePerLead: 2.5,\n    orchestratorTier: \"enterprise\",\n    maxCostPerLead: 7.5,\n    includes: {\n      verifyEmails: true,\n      personEnrichment: true, // Executive contact enrichment\n      apolloEnrichment: true, // Full compliance verification\n    },\n  },\n};\n\ninterface BusinessDiscoveryRequest {\n  businessType: string;\n  location: string;\n  keywords?: string[] | string;\n  searchRadius?: string;\n  expandGeography?: boolean;\n  maxResults?: number;\n  budgetLimit?: number;\n  minConfidenceScore?: number;\n  sessionUserId?: string;\n  tierKey?: TierKey;\n  tierName?: string;\n  tierPrice?: number;\n  options?: {\n    tradeAssociation?: boolean;\n    professionalLicense?: boolean;\n    chamberVerification?: boolean;\n    apolloDiscovery?: boolean;\n  };\n  userEmail?: string;\n}\n\ninterface JobConfig {\n  campaignId: string;\n  businessType: string;\n  location: string;\n  keywords: string[];\n  searchRadius?: string;\n  expandGeography: boolean;\n  maxResults: number;\n  budgetLimit: number;\n  minConfidenceScore: number;\n  userId?: string;\n  sessionUserId?: string;\n  jobId?: string;\n  tier: TierSettings;\n  options: {\n    tradeAssociation: boolean;\n    professionalLicense: boolean;\n    chamberVerification: boolean;\n    apolloDiscovery: boolean;\n  };\n}\n\ninterface BusinessData {\n  name?: string;\n  businessName?: string;\n  formatted_address?: string;\n  address?: string;\n  formatted_phone_number?: string;\n  phone?: string;\n  website?: string;\n  place_id?: string;\n  rating?: number;\n  user_ratings_total?: number;\n  source?: DataSource;\n  data_enriched?: boolean;\n  foursquare_data?: Record<string, unknown>;\n}\n\ninterface DiscoveredBusiness extends BusinessData {\n  source: DataSource;\n}\n\ninterface FoursquarePlace {\n  fsq_id: string;\n  name: string;\n  location?: {\n    address?: string;\n    locality?: string;\n    admin_district?: string;\n    region?: string;\n    postcode?: string;\n    country?: string;\n  };\n  contact?: {\n    phone?: string;\n  };\n  website?: string;\n  rating?: number;\n  stats?: {\n    total_tips?: number;\n  };\n}\n\ninterface ScoredLead {\n  businessName: string;\n  address: string;\n  phone: string;\n  website: string;\n  email: string;\n  optimizedScore: number;\n  validationCost: number;\n  dataSources: string[];\n  enhancementData: {\n    verificationSources: string[];\n    emails?: Array<{\n      email: string;\n      confidence?: number;\n      verified?: boolean;\n      type?: string;\n      firstName?: string;\n      lastName?: string;\n      position?: string;\n    }>;\n    processingMetadata: {\n      totalCost: number;\n      validationCost: number;\n      enrichmentCost: number;\n      totalConfidenceBoost: number;\n      processingStrategy: string;\n      servicesUsed: string[];\n      servicesSkipped: string[];\n      enrichmentTier: string;\n      enrichmentCostBreakdown?: Record<string, number>;\n      emailStatus?: \"verified\" | \"unconfirmed\" | \"not_found\";\n      verifiedEmail?: string;\n      unverifiedEmail?: string;\n    };\n  };\n}\n\ninterface CensusIntelligence {\n  total_establishments: number;\n  density_score: number;\n  optimization: {\n    search_radius: number;\n    expected_results: number;\n    api_efficiency_score: number;\n    confidence_multiplier: number;\n  };\n  geographic_data: {\n    state: string;\n    county: string | null;\n    raw_location: string;\n    fallback?: boolean;\n  };\n}\n\nconst DEFAULT_OPTIONS = {\n  tradeAssociation: false,\n  professionalLicense: false,\n  chamberVerification: false,\n  apolloDiscovery: false,\n};\n\nconst GOOGLE_TEXT_SEARCH_COST = 0.032;\nconst GOOGLE_DETAILS_COST = 0.017;\nconst FOURSQUARE_SEARCH_COST = 0;\n\nfunction parseKeywords(input?: string[] | string): string[] {\n  if (!input) return [];\n  if (Array.isArray(input)) {\n    return input.map((value) => value.trim()).filter(Boolean);\n  }\n  return input\n    .split(\",\")\n    .map((value) => value.trim())\n    .filter(Boolean);\n}\n\nfunction getTierSettings(\n  tierKey?: TierKey,\n  fallbackName?: string\n): TierSettings {\n  if (tierKey && ENRICHMENT_TIERS[tierKey]) {\n    return ENRICHMENT_TIERS[tierKey];\n  }\n\n  if (fallbackName) {\n    const match = (Object.values(ENRICHMENT_TIERS) as TierSettings[]).find(\n      (tier) => tier.name.toLowerCase() === fallbackName.toLowerCase()\n    );\n    if (match) return match;\n  }\n\n  return ENRICHMENT_TIERS.BASE; // Changed from PROFESSIONAL to BASE as default\n}\n\n// --------------------\n// Census Intelligence\n// --------------------\n\nclass CensusAPIClient {\n  private apiKey: string;\n  private baseURL: string;\n  private cache = new Map<string, { data: unknown; timestamp: number }>();\n  private cacheTTL = 24 * 60 * 60 * 1000;\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n    this.baseURL = \"https://api.census.gov/data\";\n  }\n\n  async getBusinessDensity(\n    businessType: string,\n    location: string\n  ): Promise<CensusIntelligence> {\n    const naicsCode = this.mapBusinessTypeToNAICS(businessType);\n    const geoData = this.parseLocation(location);\n\n    const censusData = await this.fetchCountyBusinessPatterns({\n      naics: naicsCode,\n      state: geoData.state,\n      county: geoData.county,\n    });\n\n    return this.calculateDensityMetrics(censusData, geoData, location);\n  }\n\n  private async fetchCountyBusinessPatterns({\n    naics,\n    state,\n    county,\n  }: {\n    naics: string;\n    state: string;\n    county: string | null;\n  }) {\n    const cacheKey = `cbp_${naics}_${state}_${county ?? \"all\"}`;\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      return cached.data as unknown[];\n    }\n\n    const url = `${this.baseURL}/2021/cbp?get=ESTAB,EMP,NAICS2017_LABEL&for=state:${state}&NAICS2017=${naics}&key=${this.apiKey}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error(`Census API error: ${response.status}`);\n    }\n\n    const data = (await response.json()) as unknown[];\n    this.cache.set(cacheKey, { data, timestamp: Date.now() });\n    return data;\n  }\n\n  private calculateDensityMetrics(\n    censusData: unknown[],\n    geoData: {\n      state: string;\n      county: string | null;\n      raw_location: string;\n      fallback?: boolean;\n    },\n    rawLocation: string\n  ): CensusIntelligence {\n    if (!Array.isArray(censusData) || censusData.length < 2) {\n      return this.getDefaultOptimization(\n        rawLocation,\n        geoData.state,\n        geoData.county\n      );\n    }\n\n    const businessData = censusData.slice(1) as [\n      string,\n      string,\n      string,\n      string\n    ][];\n    let totalEstablishments = 0;\n    let totalEmployment = 0;\n\n    for (const row of businessData) {\n      const [estab, emp] = row;\n      totalEstablishments += parseInt(estab) || 0;\n      totalEmployment += parseInt(emp) || 0;\n    }\n\n    const densityScore = Math.min(totalEstablishments / 750, 100);\n    const confidenceMultiplier =\n      totalEstablishments > 750 ? 1.3 : totalEstablishments > 250 ? 1.15 : 1;\n    const expectedResults = Math.max(Math.round(totalEstablishments * 0.04), 5);\n\n    return {\n      total_establishments: totalEstablishments,\n      density_score: densityScore,\n      optimization: {\n        search_radius: this.calculateOptimalRadius(densityScore),\n        expected_results: Math.min(expectedResults, 40),\n        api_efficiency_score: Math.round(densityScore),\n        confidence_multiplier: confidenceMultiplier,\n      },\n      geographic_data: geoData,\n    };\n  }\n\n  private getDefaultOptimization(\n    rawLocation: string,\n    state: string,\n    county: string | null\n  ): CensusIntelligence {\n    return {\n      total_establishments: 250,\n      density_score: 25,\n      optimization: {\n        search_radius: 25,\n        expected_results: 12,\n        api_efficiency_score: 45,\n        confidence_multiplier: 1,\n      },\n      geographic_data: {\n        state,\n        county,\n        raw_location: rawLocation,\n        fallback: true,\n      },\n    };\n  }\n\n  private mapBusinessTypeToNAICS(businessType: string): string {\n    const naicsMapping: Record<string, string> = {\n      accounting: \"5412\",\n      cpa: \"5412\",\n      legal: \"5411\",\n      electrician: \"238210\",\n      contractor: \"23\",\n      restaurant: \"7225\",\n      cafe: \"722515\",\n      medical: \"621\",\n      dental: \"6212\",\n      retail: \"44\",\n      spa: \"8121\",\n      salon: \"8121\",\n      consulting: \"5416\",\n      marketing: \"5418\",\n      real: \"531\",\n      hvac: \"238220\",\n    };\n\n    const lower = businessType.toLowerCase();\n    for (const [key, code] of Object.entries(naicsMapping)) {\n      if (lower.includes(key)) return code;\n    }\n    return \"00\";\n  }\n\n  private parseLocation(location: string) {\n    const stateMatch = location.match(/\\b([A-Z]{2})\\b/);\n    const stateCode = stateMatch ? this.getStateFIPSCode(stateMatch[1]) : \"06\";\n    return {\n      state: stateCode,\n      county: null,\n      raw_location: location,\n    };\n  }\n\n  private getStateFIPSCode(stateAbbr: string): string {\n    const stateCodes: Record<string, string> = {\n      AL: \"01\",\n      AK: \"02\",\n      AZ: \"04\",\n      AR: \"05\",\n      CA: \"06\",\n      CO: \"08\",\n      CT: \"09\",\n      DE: \"10\",\n      FL: \"12\",\n      GA: \"13\",\n      HI: \"15\",\n      ID: \"16\",\n      IL: \"17\",\n      IN: \"18\",\n      IA: \"19\",\n      KS: \"20\",\n      KY: \"21\",\n      LA: \"22\",\n      ME: \"23\",\n      MD: \"24\",\n      MA: \"25\",\n      MI: \"26\",\n      MN: \"27\",\n      MS: \"28\",\n      MO: \"29\",\n      MT: \"30\",\n      NE: \"31\",\n      NV: \"32\",\n      NH: \"33\",\n      NJ: \"34\",\n      NM: \"35\",\n      NY: \"36\",\n      NC: \"37\",\n      ND: \"38\",\n      OH: \"39\",\n      OK: \"40\",\n      OR: \"41\",\n      PA: \"42\",\n      RI: \"44\",\n      SC: \"45\",\n      SD: \"46\",\n      TN: \"47\",\n      TX: \"48\",\n      UT: \"49\",\n      VT: \"50\",\n      VA: \"51\",\n      WA: \"53\",\n      WV: \"54\",\n      WI: \"55\",\n      WY: \"56\",\n    };\n    return stateCodes[stateAbbr.toUpperCase()] || \"06\";\n  }\n\n  private calculateOptimalRadius(densityScore: number): number {\n    if (densityScore > 60) return 5;\n    if (densityScore > 30) return 10;\n    if (densityScore > 10) return 20;\n    return 35;\n  }\n}\n\nasync function fetchCensusIntelligence(\n  businessType: string,\n  location: string\n): Promise<CensusIntelligence | null> {\n  const censusKey = Deno.env.get(\"CENSUS_API_KEY\");\n  if (!censusKey) return null;\n\n  try {\n    const client = new CensusAPIClient(censusKey);\n    return await client.getBusinessDensity(businessType, location);\n  } catch (error) {\n    console.warn(\"Census intelligence unavailable:\", error);\n    return null;\n  }\n}\n\n// --------------------\n// Discovery Providers\n// --------------------\n\nasync function searchGooglePlaces(\n  businessType: string,\n  location: string,\n  keywords: string[],\n  maxResults: number,\n  usageLogger?: UsageLogger,\n  usageContext?: UsageLogContext\n): Promise<DiscoveredBusiness[]> {\n  const apiKey = Deno.env.get(\"GOOGLE_PLACES_API_KEY\");\n  if (!apiKey) throw new Error(\"Google Places API key not configured\");\n\n  const keywordSuffix = keywords.length > 0 ? ` ${keywords.join(\" \")}` : \"\";\n  const query = `${businessType}${keywordSuffix} in ${location}`;\n  const searchUrl = `https://maps.googleapis.com/maps/api/place/textsearch/json?query=${encodeURIComponent(\n    query\n  )}&key=${apiKey}`;\n\n  const requestParams = {\n    query,\n    businessType,\n    location,\n    keywordCount: keywords.length,\n    maxResults,\n  };\n\n  let textResponse: Response | null = null;\n  let data: Record<string, unknown> = {};\n  const searchStarted = performance.now();\n\n  try {\n    textResponse = await fetch(searchUrl);\n    data = await textResponse.json();\n  } catch (error) {\n    await usageLogger?.log({\n      sourceName: \"google_places\",\n      endpoint: \"textsearch\",\n      httpMethod: \"GET\",\n      requestParams,\n      queryType: \"discovery\",\n      responseCode: textResponse?.status ?? null,\n      responseTimeMs: Math.round(performance.now() - searchStarted),\n      success: false,\n      errorMessage: error instanceof Error ? error.message : String(error),\n    });\n    throw error;\n  }\n\n  const searchElapsed = Math.round(performance.now() - searchStarted);\n\n  if (data.status !== \"OK\") {\n    await usageLogger?.log({\n      sourceName: \"google_places\",\n      endpoint: \"textsearch\",\n      httpMethod: \"GET\",\n      requestParams,\n      queryType: \"discovery\",\n      responseCode: textResponse.status,\n      responseTimeMs: searchElapsed,\n      success: false,\n      errorMessage:\n        (data.error_message as string | undefined) || (data.status as string),\n      estimatedCost: GOOGLE_TEXT_SEARCH_COST,\n      actualCost: 0,\n    });\n    throw new Error(`Google Places API failed: ${data.status}`);\n  }\n\n  const results = (data.results as BusinessData[]).slice(0, maxResults * 2);\n\n  await usageLogger?.log({\n    sourceName: \"google_places\",\n    endpoint: \"textsearch\",\n    httpMethod: \"GET\",\n    requestParams,\n    queryType: \"discovery\",\n    responseCode: textResponse.status,\n    responseTimeMs: searchElapsed,\n    resultsReturned: results.length,\n    usefulResults: results.length,\n    success: true,\n    estimatedCost: GOOGLE_TEXT_SEARCH_COST,\n    actualCost: GOOGLE_TEXT_SEARCH_COST,\n    ...usageContext,\n  });\n\n  const enriched: DiscoveredBusiness[] = [];\n\n  for (const business of results) {\n    if (!business.place_id) {\n      enriched.push({ ...business, source: \"google_places\" });\n      continue;\n    }\n\n    const detailsUrl = `https://maps.googleapis.com/maps/api/place/details/json?place_id=${business.place_id}&fields=formatted_phone_number,website&key=${apiKey}`;\n    const detailStart = performance.now();\n\n    let detailsResponse: Response | null = null;\n    let detailsData: {\n      result?: {\n        formatted_phone_number?: string;\n        website?: string;\n      };\n      [key: string]: unknown;\n    } = {};\n\n    try {\n      detailsResponse = await fetch(detailsUrl);\n      detailsData = await detailsResponse.json();\n    } catch (error) {\n      await usageLogger?.log({\n        sourceName: \"google_places\",\n        endpoint: \"details\",\n        httpMethod: \"GET\",\n        requestParams: {\n          placeId: business.place_id,\n        },\n        queryType: \"discovery\",\n        responseCode: detailsResponse?.status ?? null,\n        responseTimeMs: Math.round(performance.now() - detailStart),\n        success: false,\n        errorMessage: error instanceof Error ? error.message : String(error),\n        estimatedCost: GOOGLE_DETAILS_COST,\n        actualCost: 0,\n      });\n      throw error;\n    }\n\n    const detailElapsed = Math.round(performance.now() - detailStart);\n\n    const dataEnriched = Boolean(detailsData.result);\n\n    enriched.push({\n      ...business,\n      formatted_phone_number:\n        detailsData.result?.formatted_phone_number ??\n        business.formatted_phone_number ??\n        \"\",\n      website: detailsData.result?.website ?? business.website ?? \"\",\n      source: dataEnriched ? \"google_place_details\" : \"google_places\",\n      data_enriched: dataEnriched,\n    });\n\n    await usageLogger?.log({\n      sourceName: \"google_places\",\n      endpoint: \"details\",\n      httpMethod: \"GET\",\n      requestParams: {\n        placeId: business.place_id,\n        hasWebsite: Boolean(detailsData.result?.website),\n      },\n      queryType: \"discovery\",\n      responseCode: detailsResponse.status,\n      responseTimeMs: detailElapsed,\n      resultsReturned: dataEnriched ? 1 : 0,\n      usefulResults: dataEnriched ? 1 : 0,\n      success: detailsResponse.ok && dataEnriched,\n      estimatedCost: GOOGLE_DETAILS_COST,\n      actualCost: detailsResponse.ok && dataEnriched ? GOOGLE_DETAILS_COST : 0,\n    });\n\n    // Basic rate limiting to stay under quota\n    await new Promise((resolve) => setTimeout(resolve, 80));\n  }\n\n  return enriched;\n}\n\nasync function searchFoursquare(\n  businessType: string,\n  location: string,\n  keywords: string[],\n  maxResults: number,\n  usageLogger?: UsageLogger,\n  usageContext?: UsageLogContext\n): Promise<DiscoveredBusiness[]> {\n  const apiKey = Deno.env.get(\"FOURSQUARE_API_KEY\");\n  if (!apiKey) {\n    return [];\n  }\n\n  const queryString =\n    [businessType, ...keywords].join(\" \").trim() || businessType;\n  const limit = Math.min(Math.max(maxResults, 5), 30);\n  const params = new URLSearchParams({\n    query: queryString,\n    near: location,\n    limit: limit.toString(),\n    fields: \"fsq_id,name,location,contact,website,categories,rating,stats\",\n  });\n\n  const requestParams = {\n    query: queryString,\n    location,\n    limit,\n    keywordCount: keywords.length,\n  };\n\n  let response: Response | null = null;\n  const startedAt = performance.now();\n\n  try {\n    response = await fetch(\n      `https://api.foursquare.com/v3/places/search?${params}`,\n      {\n        headers: {\n          Authorization: apiKey,\n          Accept: \"application/json\",\n        },\n      }\n    );\n  } catch (error) {\n    await usageLogger?.log({\n      sourceName: \"foursquare\",\n      endpoint: \"places.search\",\n      httpMethod: \"GET\",\n      requestParams,\n      queryType: \"discovery\",\n      responseCode: response?.status ?? null,\n      responseTimeMs: Math.round(performance.now() - startedAt),\n      success: false,\n      errorMessage: error instanceof Error ? error.message : String(error),\n      estimatedCost: FOURSQUARE_SEARCH_COST,\n      actualCost: 0,\n    });\n    throw error;\n  }\n\n  const elapsed = Math.round(performance.now() - startedAt);\n\n  if (!response.ok) {\n    await usageLogger?.log({\n      sourceName: \"foursquare\",\n      endpoint: \"places.search\",\n      httpMethod: \"GET\",\n      requestParams,\n      queryType: \"discovery\",\n      responseCode: response.status,\n      responseTimeMs: elapsed,\n      success: false,\n      errorMessage: `HTTP ${response.status}`,\n      estimatedCost: FOURSQUARE_SEARCH_COST,\n      actualCost: 0,\n    });\n    throw new Error(`Foursquare API error: ${response.status}`);\n  }\n\n  let payload: { results?: FoursquarePlace[] } = {};\n  try {\n    payload = await response.json();\n  } catch (error) {\n    await usageLogger?.log({\n      sourceName: \"foursquare\",\n      endpoint: \"places.search\",\n      httpMethod: \"GET\",\n      requestParams,\n      queryType: \"discovery\",\n      responseCode: response.status,\n      responseTimeMs: elapsed,\n      success: false,\n      errorMessage: error instanceof Error ? error.message : String(error),\n      estimatedCost: FOURSQUARE_SEARCH_COST,\n      actualCost: 0,\n    });\n    throw error;\n  }\n\n  const results = Array.isArray(payload.results) ? payload.results : [];\n\n  await usageLogger?.log({\n    sourceName: \"foursquare\",\n    endpoint: \"places.search\",\n    httpMethod: \"GET\",\n    requestParams,\n    queryType: \"discovery\",\n    responseCode: response.status,\n    responseTimeMs: elapsed,\n    resultsReturned: results.length,\n    usefulResults: results.length,\n    success: true,\n    estimatedCost: FOURSQUARE_SEARCH_COST,\n    actualCost: FOURSQUARE_SEARCH_COST,\n    ...usageContext,\n  });\n\n  return results.map((place) => ({\n    source: \"foursquare\" as DataSource,\n    place_id: place.fsq_id,\n    name: place.name,\n    formatted_address: formatFoursquareAddress(place.location),\n    formatted_phone_number: place.contact?.phone ?? \"\",\n    website: place.website ?? \"\",\n    rating: place.rating ?? 0,\n    user_ratings_total: place.stats?.total_tips ?? 0,\n    foursquare_data: place as unknown as Record<string, unknown>,\n  }));\n}\n\nfunction formatFoursquareAddress(\n  location: {\n    address?: string;\n    locality?: string;\n    admin_district?: string;\n    postcode?: string;\n    country?: string;\n  } = {}\n): string {\n  const parts = [\n    location.address,\n    location.locality,\n    location.admin_district,\n    location.postcode,\n    location.country,\n  ]\n    .map((value) => value?.trim())\n    .filter(Boolean);\n  return parts.join(\", \");\n}\n\ntype BusinessFingerprintSource = {\n  name?: string | null;\n  businessName?: string | null;\n  business_name?: string | null;\n  formatted_address?: string | null;\n  address?: string | null;\n  formatted_phone_number?: string | null;\n  phone?: string | null;\n  website?: string | null;\n  place_id?: string | null;\n  source?: DataSource;\n};\n\nfunction normalizeString(value?: string | null): string {\n  return value ? value.toLowerCase().replace(/\\s+/g, \" \").trim() : \"\";\n}\n\nfunction normalizePhone(value?: string | null): string {\n  return value ? value.replace(/\\D+/g, \"\") : \"\";\n}\n\nfunction normalizeWebsite(value?: string | null): string {\n  if (!value) return \"\";\n  const normalized = value.toLowerCase().trim();\n  const withoutProtocol = normalized.replace(/^https?:\\/\\//, \"\");\n  const withoutWww = withoutProtocol.replace(/^www\\./, \"\");\n  return withoutWww.split(\"/\")[0];\n}\n\nfunction createBusinessFingerprint(\n  source: BusinessFingerprintSource\n): string {\n  const name = normalizeString(\n    source.business_name ?? source.businessName ?? source.name ?? \"\"\n  );\n  const address = normalizeString(\n    source.address ?? source.formatted_address ?? \"\"\n  );\n  const phone = normalizePhone(\n    source.phone ?? source.formatted_phone_number ?? \"\"\n  );\n  const website = normalizeWebsite(source.website ?? \"\");\n\n  if (name && address) {\n    return `${name}::${address}`;\n  }\n\n  if (name && phone) {\n    return `${name}::${phone}`;\n  }\n\n  if (website) {\n    return `domain::${website}`;\n  }\n\n  if (phone) {\n    return `phone::${phone}`;\n  }\n\n  if (name) {\n    return `name::${name}`;\n  }\n\n  return \"\";\n}\n\nfunction dedupeBusinesses(\n  businesses: DiscoveredBusiness[]\n): DiscoveredBusiness[] {\n  const map = new Map<string, DiscoveredBusiness>();\n  let fallbackIndex = 0;\n\n  for (const business of businesses) {\n    const fingerprint = createBusinessFingerprint(business);\n    const key = fingerprint\n      ? fingerprint\n      : business.place_id\n      ? `place::${business.place_id}`\n      : `fallback::${fallbackIndex++}`;\n\n    if (!map.has(key)) {\n      map.set(key, business);\n      continue;\n    }\n\n    const existing = map.get(key)!;\n    const existingHasWebsite = Boolean(existing.website);\n    const candidateHasWebsite = Boolean(business.website);\n    const existingHasPhone = Boolean(\n      existing.formatted_phone_number || existing.phone\n    );\n    const candidateHasPhone = Boolean(\n      business.formatted_phone_number || business.phone\n    );\n\n    const candidateIsDetailsUpgrade =\n      existing.source === \"google_places\" &&\n      business.source === \"google_place_details\";\n\n    const candidateHasMoreData =\n      candidateHasWebsite && !existingHasWebsite\n        ? true\n        : candidateHasPhone && !existingHasPhone\n        ? true\n        : false;\n\n    if (candidateIsDetailsUpgrade || candidateHasMoreData) {\n      map.set(key, business);\n    }\n  }\n  return Array.from(map.values());\n}\n\n// --------------------\n// Quality Scorer\n// --------------------\n\nclass QualityScorer {\n  private maxCostPerBusiness: number;\n  private tierName: string;\n  private censusMultiplier: number;\n\n  constructor(options: {\n    maxCostPerBusiness: number;\n    tierName: string;\n    censusMultiplier?: number;\n  }) {\n    this.maxCostPerBusiness = options.maxCostPerBusiness;\n    this.tierName = options.tierName;\n    this.censusMultiplier = options.censusMultiplier ?? 1;\n  }\n\n  scoreBusiness(business: DiscoveredBusiness): ScoredLead {\n    const businessName = business.name || business.businessName || \"\";\n    const address = business.formatted_address || business.address || \"\";\n    const phone = business.formatted_phone_number || business.phone || \"\";\n    const website = business.website || \"\";\n\n    const scores = {\n      businessName: businessName ? Math.min(100, businessName.length * 3) : 0,\n      address: address ? 100 : 0,\n      phone: phone ? 85 : 0,\n      website: website ? 80 : 0,\n      rating: business.rating ? Math.min(20, business.rating * 4) : 0,\n    };\n\n    let totalScore =\n      Object.values(scores).reduce((sum, score) => sum + score, 0) /\n      Object.values(scores).length;\n\n    if (business.source === \"foursquare\") {\n      totalScore += 8;\n    } else if (business.source === \"google_place_details\") {\n      totalScore += 5;\n    }\n\n    totalScore = Math.min(100, Math.round(totalScore * this.censusMultiplier));\n\n    const initialSources = new Set<string>();\n    initialSources.add(business.source);\n    if (business.data_enriched) {\n      initialSources.add(\"google_places_details_api\");\n    }\n\n    return {\n      businessName,\n      address,\n      phone,\n      website,\n      email: \"\",\n      optimizedScore: totalScore,\n      validationCost: 0.02,\n      dataSources: Array.from(initialSources),\n      enhancementData: {\n        verificationSources: Array.from(initialSources),\n        processingMetadata: {\n          totalCost: 0.02,\n          validationCost: 0.02,\n          enrichmentCost: 0,\n          totalConfidenceBoost: 0,\n          processingStrategy: \"basic\",\n          servicesUsed: Array.from(initialSources),\n          servicesSkipped: [],\n          enrichmentTier: this.tierName,\n          emailStatus: \"not_found\",\n        },\n      },\n    };\n  }\n}\n\n// --------------------\n// Enrichment Pipeline\n// --------------------\n\nasync function enrichLead(\n  lead: ScoredLead,\n  config: JobConfig\n): Promise<{ lead: ScoredLead; cost: number; enrichmentCost: number }> {\n  const supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\n  const serviceKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\n  if (!supabaseUrl || !serviceKey) {\n    return { lead, cost: lead.validationCost, enrichmentCost: 0 };\n  }\n\n  const url = `${supabaseUrl}/functions/v1/enrichment-orchestrator`;\n  const domain = lead.website\n    ? lead.website.replace(/^https?:\\/\\//, \"\").replace(/\\/.*$/, \"\")\n    : undefined;\n\n  const maxCostPerBusiness = Math.max(\n    config.tier.maxCostPerLead,\n    config.budgetLimit / Math.max(config.maxResults, 1)\n  );\n\n  const body = {\n    businessName: lead.businessName,\n    domain,\n    address: lead.address,\n    phone: lead.phone,\n    website: lead.website,\n    discoverEmails: true,\n    verifyEmails: config.tier.includes.verifyEmails,\n    includePersonEnrichment: config.tier.includes.personEnrichment,\n    apolloEnrichment:\n      config.tier.includes.apolloEnrichment || config.options.apolloDiscovery,\n    includeBusinessLicense: true,\n    includeCompanyEnrichment: true,\n    maxCostPerBusiness,\n    minConfidenceScore: config.minConfidenceScore,\n    tier: config.tier.orchestratorTier,\n    campaignId: config.campaignId,\n    jobId: config.jobId,\n    sessionUserId: config.sessionUserId,\n    userId: config.userId,\n    tierKey: config.tier.key,\n  };\n\n  const response = await fetch(url, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${serviceKey}`,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(body),\n  });\n\n  if (!response.ok) {\n    return { lead, cost: lead.validationCost, enrichmentCost: 0 };\n  }\n\n  const enrichmentData = await response.json();\n  type EnrichedEmail = {\n    email: string;\n    verified?: boolean;\n    [key: string]: unknown;\n  };\n\n  const emails = (enrichmentData.enrichedData?.emails ?? []) as EnrichedEmail[];\n\n  const normalizeDomain = (value?: string) =>\n    value ? value.toLowerCase().replace(/^www\\./, \"\") : \"\";\n\n  const normalizedDomain = normalizeDomain(domain);\n\n  const emailMatchesCorporateDomain = (emailAddress?: string) => {\n    if (!emailAddress || !normalizedDomain) return false;\n    const parts = emailAddress.split(\"@\");\n    if (parts.length !== 2) return false;\n    const emailDomain = normalizeDomain(parts[1]);\n    if (!emailDomain) return false;\n    return (\n      emailDomain === normalizedDomain ||\n      emailDomain.endsWith(`.${normalizedDomain}`)\n    );\n  };\n\n  const corporateEmails = normalizedDomain\n    ? emails.filter((entry: EnrichedEmail) =>\n        emailMatchesCorporateDomain(entry.email)\n      )\n    : emails;\n\n  const verifiedCorporate = corporateEmails.find(\n    (entry: EnrichedEmail) => entry.verified\n  );\n\n  let verifiedEmailEntry = verifiedCorporate;\n  if (!verifiedEmailEntry && !normalizedDomain) {\n    verifiedEmailEntry = emails.find((entry: EnrichedEmail) => entry.verified);\n  }\n\n  const unverifiedCorporate = corporateEmails.find(\n    (entry: EnrichedEmail) => entry.email && !entry.verified\n  );\n\n  const fallbackCandidate =\n    unverifiedCorporate ||\n    corporateEmails[0] ||\n    emails.find((entry: EnrichedEmail) => entry.email && !entry.verified) ||\n    emails[0];\n\n  let emailStatus: \"verified\" | \"unconfirmed\" | \"not_found\" = \"not_found\";\n  let verifiedEmailValue = \"\";\n  let unverifiedEmailValue = \"\";\n\n  if (verifiedEmailEntry?.email) {\n    emailStatus = \"verified\";\n    verifiedEmailValue = verifiedEmailEntry.email;\n  } else if (fallbackCandidate?.email) {\n    emailStatus = \"unconfirmed\";\n    unverifiedEmailValue = fallbackCandidate.email;\n  }\n\n  const servicesUsed = new Set<string>(\n    lead.enhancementData.verificationSources\n  );\n  (enrichmentData.processingMetadata?.servicesUsed ?? []).forEach(\n    (service: string) => servicesUsed.add(service)\n  );\n\n  const enrichmentCost = Number(enrichmentData.totalCost ?? 0);\n  const totalCost = lead.validationCost + enrichmentCost;\n\n  const updatedLead: ScoredLead = {\n    ...lead,\n    email: verifiedEmailValue || \"\",\n    enhancementData: {\n      ...lead.enhancementData,\n      verificationSources: Array.from(servicesUsed),\n      emails,\n      processingMetadata: {\n        ...lead.enhancementData.processingMetadata,\n        totalCost,\n        validationCost: lead.validationCost,\n        enrichmentCost,\n        servicesUsed: Array.from(servicesUsed),\n        servicesSkipped:\n          enrichmentData.processingMetadata?.servicesSkipped ?? [],\n        enrichmentTier: config.tier.name,\n        enrichmentCostBreakdown: enrichmentData.costBreakdown ?? undefined,\n        emailStatus,\n        verifiedEmail: verifiedEmailValue || undefined,\n        unverifiedEmail: unverifiedEmailValue || undefined,\n      },\n    },\n  };\n\n  return {\n    lead: updatedLead,\n    cost: totalCost,\n    enrichmentCost,\n  };\n}\n\n// --------------------\n// Discovery Workflow\n// --------------------\n\nasync function discoverBusinesses(\n  config: JobConfig,\n  census: CensusIntelligence | null,\n  usageLogger?: UsageLogger,\n  usageContext?: UsageLogContext\n): Promise<DiscoveredBusiness[]> {\n  const googleResults = await searchGooglePlaces(\n    config.businessType,\n    config.location,\n    config.keywords,\n    config.maxResults,\n    usageLogger,\n    {\n      ...usageContext,\n      businessQuery: config.businessType,\n      locationQuery: config.location,\n      tierKey: config.tier.key,\n    }\n  );\n\n  const results: DiscoveredBusiness[] = [...googleResults];\n\n  const shouldQueryFoursquare =\n    googleResults.length < config.maxResults * 1.2 || config.expandGeography;\n  if (shouldQueryFoursquare) {\n    const foursquareResults = await searchFoursquare(\n      config.businessType,\n      config.location,\n      config.keywords,\n      Math.max(\n        config.maxResults - googleResults.length,\n        Math.ceil(config.maxResults / 2)\n      ),\n      usageLogger,\n      {\n        ...usageContext,\n        businessQuery: config.businessType,\n        locationQuery: config.location,\n        tierKey: config.tier.key,\n      }\n    );\n    results.push(...foursquareResults);\n  }\n\n  const deduped = dedupeBusinesses(results);\n\n  if (\n    census &&\n    census.optimization.expected_results > deduped.length &&\n    config.expandGeography\n  ) {\n    const expandedResults = await searchFoursquare(\n      config.businessType,\n      census.geographic_data.raw_location,\n      config.keywords,\n      Math.min(census.optimization.expected_results, config.maxResults * 2),\n      usageLogger,\n      {\n        ...usageContext,\n        businessQuery: config.businessType,\n        locationQuery: census.geographic_data.raw_location,\n        tierKey: config.tier.key,\n      }\n    );\n    deduped.push(...expandedResults);\n  }\n\n  return dedupeBusinesses(deduped).slice(0, config.maxResults * 2);\n}\n\nasync function processDiscoveryJob(\n  jobId: string,\n  config: JobConfig,\n  supabaseUrl: string,\n  supabaseServiceKey: string\n) {\n  console.log(`ðŸš€ Background job ${jobId} started`);\n\n  const supabase = createClient(supabaseUrl, supabaseServiceKey);\n  const usageLogger = createUsageLogger(supabaseUrl, supabaseServiceKey, {\n    campaignId: config.campaignId,\n    sessionId: config.sessionUserId ?? config.userId ?? null,\n    jobId,\n    tierKey: config.tier.key,\n    businessQuery: config.businessType,\n    locationQuery: config.location,\n  });\n  config.jobId = jobId;\n\n  const historicalFingerprints = new Set<string>();\n\n  try {\n    const { data: priorCampaigns, error: priorCampaignsError } = await supabase\n      .from(\"campaigns\")\n      .select(\"id\")\n      .eq(\"user_id\", config.userId)\n      .eq(\"business_type\", config.businessType)\n      .eq(\"location\", config.location)\n      .neq(\"id\", config.campaignId)\n      .limit(200);\n\n    if (priorCampaignsError) {\n      console.warn(\n        \"Unable to load historical campaigns for duplicate suppression:\",\n        priorCampaignsError.message\n      );\n    } else {\n      const campaignIds = (priorCampaigns ?? [])\n        .map((entry) => entry.id)\n        .filter((value): value is string => Boolean(value));\n\n      if (campaignIds.length > 0) {\n        const { data: priorLeads, error: priorLeadsError } = await supabase\n          .from(\"leads\")\n          .select(\"business_name,address,phone,website\")\n          .in(\"campaign_id\", campaignIds)\n          .limit(1000);\n\n        if (priorLeadsError) {\n          console.warn(\n            \"Unable to load previously delivered leads for duplicate suppression:\",\n            priorLeadsError.message\n          );\n        } else {\n          const priorLeadRows = (priorLeads ?? []) as Array<{\n            business_name?: string | null;\n            address?: string | null;\n            phone?: string | null;\n            website?: string | null;\n          }>;\n\n          for (const lead of priorLeadRows) {\n            const fingerprint = createBusinessFingerprint(lead);\n            if (fingerprint) {\n              historicalFingerprints.add(fingerprint);\n            }\n          }\n        }\n      }\n    }\n  } catch (historyError) {\n    console.warn(\"Historical lead lookup failed:\", historyError);\n  }\n\n  try {\n    await supabase\n      .from(\"discovery_jobs\")\n      .update({\n        status: \"processing\",\n        started_at: new Date().toISOString(),\n        current_stage: \"discovering_businesses\",\n        progress: 10,\n      })\n      .eq(\"id\", jobId);\n\n    const censusIntelligence = await fetchCensusIntelligence(\n      config.businessType,\n      config.location\n    );\n\n    let historicalFilteredCount = 0;\n\n    const applyHistoricalFilter = (\n      businesses: DiscoveredBusiness[]\n    ): DiscoveredBusiness[] => {\n      if (historicalFingerprints.size === 0) {\n        return businesses;\n      }\n\n      const filteredResults: DiscoveredBusiness[] = [];\n      for (const business of businesses) {\n        const fingerprint = createBusinessFingerprint(business);\n        if (fingerprint && historicalFingerprints.has(fingerprint)) {\n          historicalFilteredCount += 1;\n          continue;\n        }\n        filteredResults.push(business);\n      }\n      return filteredResults;\n    };\n\n    let discoveredBusinesses: DiscoveredBusiness[] = await discoverBusinesses(\n      config,\n      censusIntelligence,\n      usageLogger,\n      {\n        campaignId: config.campaignId,\n        sessionId: config.sessionUserId ?? config.userId ?? null,\n        jobId,\n        tierKey: config.tier.key,\n        businessQuery: config.businessType,\n        locationQuery: config.location,\n      }\n    );\n    let totalRawDiscovered = discoveredBusinesses.length;\n\n    discoveredBusinesses = applyHistoricalFilter(discoveredBusinesses);\n\n    if (\n      discoveredBusinesses.length === 0 &&\n      totalRawDiscovered > 0 &&\n      !config.expandGeography\n    ) {\n      console.log(\n        `â„¹ï¸ No novel businesses found for ${config.businessType} in ${config.location}. Expanding geography to locate fresh results.`\n      );\n\n      const expandedConfig: JobConfig = {\n        ...config,\n        expandGeography: true,\n      };\n\n      const expandedResults = await discoverBusinesses(\n        expandedConfig,\n        censusIntelligence,\n        usageLogger,\n        {\n          campaignId: config.campaignId,\n          sessionId: config.sessionUserId ?? config.userId ?? null,\n          jobId,\n          tierKey: config.tier.key,\n          businessQuery: expandedConfig.businessType,\n          locationQuery: expandedConfig.location,\n        }\n      );\n\n      totalRawDiscovered += expandedResults.length;\n      discoveredBusinesses = applyHistoricalFilter(expandedResults);\n    }\n\n    if (historicalFilteredCount > 0) {\n      console.log(\n        `â„¹ï¸ Suppressed ${historicalFilteredCount} previously delivered businesses for user ${config.userId}`\n      );\n    }\n\n    const sourcesUsed = Array.from(\n      new Set(discoveredBusinesses.map((business) => business.source))\n    );\n\n    await supabase\n      .from(\"discovery_jobs\")\n      .update({\n        current_stage: \"scoring_businesses\",\n        progress: 30,\n        metrics: {\n          businesses_found: discoveredBusinesses.length,\n          raw_candidates: totalRawDiscovered,\n          previously_delivered_filtered: historicalFilteredCount,\n          sources_used: sourcesUsed,\n          census_density_score: censusIntelligence?.density_score ?? null,\n        },\n      })\n      .eq(\"id\", jobId);\n\n    const scorer = new QualityScorer({\n      maxCostPerBusiness: config.budgetLimit / Math.max(config.maxResults, 1),\n      tierName: config.tier.name,\n      censusMultiplier: censusIntelligence?.optimization.confidence_multiplier,\n    });\n\n    const scoredBusinesses = discoveredBusinesses.map((business) =>\n      scorer.scoreBusiness(business)\n    );\n\n    const qualifiedLeads = scoredBusinesses\n      .filter((lead) => lead.optimizedScore >= config.minConfidenceScore)\n      .slice(0, config.maxResults);\n\n    await supabase\n      .from(\"discovery_jobs\")\n      .update({\n        current_stage: \"enriching_contacts\",\n        progress: 50,\n        metrics: {\n          businesses_found: discoveredBusinesses.length,\n          qualified_leads: qualifiedLeads.length,\n          raw_candidates: totalRawDiscovered,\n          previously_delivered_filtered: historicalFilteredCount,\n          sources_used: sourcesUsed,\n          census_density_score: censusIntelligence?.density_score ?? null,\n        },\n      })\n      .eq(\"id\", jobId);\n\n    const enrichedLeads: ScoredLead[] = [];\n    let totalCost = 0;\n    let totalValidationCost = 0;\n    let totalEnrichmentCost = 0;\n\n    for (let index = 0; index < qualifiedLeads.length; index += 1) {\n      const lead = qualifiedLeads[index];\n      try {\n        const enrichmentResult = await enrichLead(lead, config);\n        enrichedLeads.push(enrichmentResult.lead);\n        totalCost += enrichmentResult.cost;\n        totalValidationCost +=\n          enrichmentResult.lead.enhancementData.processingMetadata\n            .validationCost;\n        totalEnrichmentCost += enrichmentResult.enrichmentCost;\n      } catch (error) {\n        console.error(`âŒ Enrichment error for ${lead.businessName}:`, error);\n        enrichedLeads.push(lead);\n        totalCost += lead.validationCost;\n        totalValidationCost += lead.validationCost;\n      }\n\n      const progress =\n        50 +\n        Math.floor(((index + 1) / Math.max(qualifiedLeads.length, 1)) * 35);\n      await supabase\n        .from(\"discovery_jobs\")\n        .update({\n          progress,\n          metrics: {\n            businesses_found: discoveredBusinesses.length,\n            qualified_leads: qualifiedLeads.length,\n            leads_enriched: index + 1,\n            total_cost: Number(totalCost.toFixed(3)),\n            validation_cost_total: Number(totalValidationCost.toFixed(3)),\n            enrichment_cost_total: Number(totalEnrichmentCost.toFixed(3)),\n            raw_candidates: totalRawDiscovered,\n            previously_delivered_filtered: historicalFilteredCount,\n            sources_used: sourcesUsed,\n            census_density_score: censusIntelligence?.density_score ?? null,\n          },\n        })\n        .eq(\"id\", jobId);\n    }\n\n    await supabase\n      .from(\"discovery_jobs\")\n      .update({\n        current_stage: \"storing_results\",\n        progress: 90,\n      })\n      .eq(\"id\", jobId);\n\n    const campaignInsert = await supabase\n      .from(\"campaigns\")\n      .insert({\n        id: config.campaignId,\n        business_type: config.businessType,\n        location: config.location,\n        target_count: config.maxResults,\n        results_count: enrichedLeads.length,\n        total_cost: Number(totalCost.toFixed(3)),\n        status: \"completed\",\n        user_id: config.userId,\n        session_user_id: config.sessionUserId,\n        processing_time_ms: null,\n      })\n      .select(\"id\")\n      .single();\n\n    if (campaignInsert.error) {\n      console.warn(\"Campaign insert warning:\", campaignInsert.error.message);\n    }\n\n    const leadsPayload = enrichedLeads.map((lead) => ({\n      campaign_id: config.campaignId,\n      business_name: lead.businessName,\n      address: lead.address,\n      phone: lead.phone,\n      website: lead.website,\n      email: lead.email,\n      confidence_score: lead.optimizedScore,\n      enrichment_data: {\n        verificationSources: lead.enhancementData.verificationSources,\n        emails: lead.enhancementData.emails,\n        processingMetadata: lead.enhancementData.processingMetadata,\n        dataSources: lead.dataSources,\n      },\n      validation_cost: lead.enhancementData.processingMetadata.validationCost,\n      user_id: config.userId,\n      session_user_id: config.sessionUserId,\n    }));\n\n    if (leadsPayload.length > 0) {\n      const leadInsert = await supabase.from(\"leads\").insert(leadsPayload);\n      if (leadInsert.error) {\n        console.error(\"Lead insert error:\", leadInsert.error.message);\n      }\n    }\n\n    const averageConfidence = enrichedLeads.length\n      ? enrichedLeads.reduce((sum, lead) => sum + lead.optimizedScore, 0) /\n        enrichedLeads.length\n      : 0;\n\n    await supabase\n      .from(\"discovery_jobs\")\n      .update({\n        status: \"completed\",\n        progress: 100,\n        completed_at: new Date().toISOString(),\n        results: enrichedLeads,\n        metrics: {\n          total_found: enrichedLeads.length,\n          qualified_leads: qualifiedLeads.length,\n          total_cost: Number(totalCost.toFixed(3)),\n          validation_cost_total: Number(totalValidationCost.toFixed(3)),\n          enrichment_cost_total: Number(totalEnrichmentCost.toFixed(3)),\n          avg_confidence: Number(averageConfidence.toFixed(1)),\n          tier_key: config.tier.key,\n          tier_name: config.tier.name,\n          tier_price: config.tier.pricePerLead,\n          raw_candidates: totalRawDiscovered,\n          previously_delivered_filtered: historicalFilteredCount,\n          sources_used: sourcesUsed,\n          census_density_score: censusIntelligence?.density_score ?? null,\n        },\n      })\n      .eq(\"id\", jobId);\n\n    console.log(\n      `âœ… Background job ${jobId} completed: ${\n        enrichedLeads.length\n      } leads, $${totalCost.toFixed(3)}`\n    );\n  } catch (error) {\n    console.error(`âŒ Background job ${jobId} failed:`, error);\n\n    await supabase\n      .from(\"discovery_jobs\")\n      .update({\n        status: \"failed\",\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        completed_at: new Date().toISOString(),\n      })\n      .eq(\"id\", jobId);\n  }\n}\n\n// --------------------\n// MAIN HANDLER\n// --------------------\n\nserve(async (req) => {\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    const supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\n    const supabaseAnonKey = Deno.env.get(\"SUPABASE_ANON_KEY\");\n    const supabaseServiceKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\n\n    if (!supabaseUrl || !supabaseAnonKey || !supabaseServiceKey) {\n      console.error(\"Missing Supabase environment variables\", {\n        hasUrl: Boolean(supabaseUrl),\n        hasAnonKey: Boolean(supabaseAnonKey),\n        hasServiceKey: Boolean(supabaseServiceKey),\n      });\n\n      return new Response(\n        JSON.stringify({\n          success: false,\n          error:\n            \"Edge function misconfigured: missing Supabase credentials. Verify SUPABASE_URL, SUPABASE_ANON_KEY, and SUPABASE_SERVICE_ROLE_KEY secrets.\",\n        }),\n        {\n          status: 500,\n          headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n        }\n      );\n    }\n\n    const authHeader = req.headers.get(\"Authorization\");\n    const globalHeaders: Record<string, string> = authHeader\n      ? { Authorization: authHeader }\n      : {};\n    const supabaseClient = createClient(supabaseUrl, supabaseAnonKey, {\n      global: { headers: globalHeaders },\n    });\n\n    const {\n      data: { user },\n    } = await supabaseClient.auth.getUser();\n\n    if (!user?.id) {\n      return new Response(\n        JSON.stringify({\n          success: false,\n          error: \"Authentication required to start discovery campaigns.\",\n        }),\n        {\n          status: 401,\n          headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n        }\n      );\n    }\n\n    const requestData: BusinessDiscoveryRequest = await req.json();\n    const {\n      businessType,\n      location,\n      keywords,\n      searchRadius,\n      expandGeography = false,\n      maxResults = 5,\n      budgetLimit,\n      minConfidenceScore = 50,\n      sessionUserId,\n      tierKey,\n      tierName,\n      options = {},\n    } = requestData;\n\n    if (sessionUserId && sessionUserId !== user.id) {\n      return new Response(\n        JSON.stringify({\n          success: false,\n          error: \"Session mismatch detected. Please re-authenticate.\",\n        }),\n        {\n          status: 403,\n          headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n        }\n      );\n    }\n\n    const tierSettings = getTierSettings(tierKey, tierName);\n    const enforcedBudget =\n      budgetLimit ?? maxResults * tierSettings.pricePerLead;\n    const keywordList = parseKeywords(keywords);\n\n    const jobId = `job_${Date.now()}_${Math.random()\n      .toString(36)\n      .slice(2, 11)}`;\n\n    // Generate structured campaign ID using database function\n    let campaignId: string;\n    try {\n      const { data: generatedName, error: nameError } =\n        await supabaseClient.rpc(\"generate_campaign_name\", {\n          business_type: businessType,\n          location: location,\n          user_id: user?.id || null,\n        });\n\n      if (nameError) {\n        console.warn(\n          \"Campaign name generation failed, using fallback:\",\n          nameError\n        );\n        campaignId = `campaign_${Date.now()}_${Math.random()\n          .toString(36)\n          .slice(2, 11)}`;\n      } else {\n        campaignId =\n          generatedName ||\n          `campaign_${Date.now()}_${Math.random().toString(36).slice(2, 11)}`;\n      }\n    } catch (error) {\n      console.warn(\"Campaign name generation error, using fallback:\", error);\n      campaignId = `campaign_${Date.now()}_${Math.random()\n        .toString(36)\n        .slice(2, 11)}`;\n    }\n\n    const jobConfig: JobConfig = {\n      campaignId,\n      businessType,\n      location,\n      keywords: keywordList,\n      searchRadius,\n      expandGeography,\n      maxResults,\n      budgetLimit: enforcedBudget,\n      minConfidenceScore,\n      userId: user.id,\n      sessionUserId: user.id,\n      tier: tierSettings,\n      options: {\n        ...DEFAULT_OPTIONS,\n        ...options,\n      },\n    };\n\n    const { error: jobError } = await supabaseClient\n      .from(\"discovery_jobs\")\n      .insert({\n        id: jobId,\n        campaign_id: campaignId,\n        user_id: user.id,\n        session_user_id: user.id,\n        status: \"pending\",\n        config: {\n          ...jobConfig,\n          tier: {\n            key: tierSettings.key,\n            name: tierSettings.name,\n            pricePerLead: tierSettings.pricePerLead,\n          },\n        },\n      });\n\n    if (jobError) {\n      throw new Error(`Failed to create job: ${jobError.message}`);\n    }\n\n    EdgeRuntime.waitUntil(\n      processDiscoveryJob(jobId, jobConfig, supabaseUrl, supabaseServiceKey)\n    );\n\n    return new Response(\n      JSON.stringify({\n        success: true,\n        message: \"Discovery job created and processing in background\",\n        jobId,\n        campaignId,\n        status: \"processing\",\n        estimatedTime: \"1-2 minutes\",\n        realtimeChannel: `discovery_jobs:id=eq.${jobId}`,\n      }),\n      {\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  } catch (error) {\n    console.error(\"âŒ Error:\", error);\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"measure","name":"lsp.did_open","count":15,"duration":16.657},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":11,"duration":0.254},
TS server started.
{"type":"mark","name":"tsc.request.$getDiagnostics"},
Server ready.
{"type":"mark","name":"tsc.host.$getDiagnostics","count":1,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",12]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":1,"duration":0.464},
{"type":"mark","name":"tsc.op.op_load","count":1,"args":"file:///workspaces/ProspectPro/.devcontainer/devcontainer.json"},
{"type":"measure","name":"tsc.op.op_load","count":1,"duration":0.057},
{"type":"mark","name":"tsc.op.op_load","count":2,"args":"file:///workspaces/ProspectPro/PRODUCTION_MCP_SERVER_INITIALIZED.md"},
{"type":"measure","name":"tsc.op.op_load","count":2,"duration":0.064},
{"type":"mark","name":"tsc.op.op_load","count":3,"args":"file:///workspaces/ProspectPro/index.html"},
{"type":"measure","name":"tsc.op.op_load","count":3,"duration":0.054},
{"type":"mark","name":"tsc.op.op_load","count":4,"args":"file:///workspaces/ProspectPro/mcp-servers/PRODUCTION_MCP_INITIALIZED.md"},
{"type":"measure","name":"tsc.op.op_load","count":4,"duration":0.069},
{"type":"mark","name":"tsc.op.op_load","count":5,"args":"file:///workspaces/ProspectPro/mcp-servers/production-server.js"},
{"type":"measure","name":"tsc.op.op_load","count":5,"duration":0.135},
{"type":"mark","name":"tsc.op.op_resolve","count":1,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":1,"duration":0.207},
{"type":"mark","name":"tsc.op.op_load","count":6,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":6,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":2,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":2,"duration":0.078},
{"type":"mark","name":"tsc.op.op_load","count":7,"args":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":7,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":3,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":3,"duration":0.051},
{"type":"mark","name":"tsc.op.op_load","count":8,"args":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts"},
{"type":"measure","name":"tsc.op.op_load","count":8,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":4,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":4,"duration":0.128},
{"type":"mark","name":"tsc.op.op_load","count":9,"args":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts"},
{"type":"measure","name":"tsc.op.op_load","count":9,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":5,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":5,"duration":0.075},
{"type":"mark","name":"tsc.op.op_load","count":10,"args":"file:///workspaces/ProspectPro/src/lib/supabase.ts"},
{"type":"measure","name":"tsc.op.op_load","count":10,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":6,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":6,"duration":0.019},
{"type":"mark","name":"tsc.op.op_load","count":11,"args":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":11,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":7,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":7,"duration":0.076},
{"type":"mark","name":"tsc.op.op_load","count":12,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":12,"duration":0.072},
{"type":"mark","name":"tsc.op.op_resolve","count":8,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":8,"duration":0.166},
{"type":"mark","name":"tsc.op.op_load","count":13,"args":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":13,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":9,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":9,"duration":0.153},
{"type":"mark","name":"tsc.op.op_load","count":14,"args":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":14,"duration":0.064},
{"type":"mark","name":"tsc.op.op_resolve","count":10,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":10,"duration":0.058},
{"type":"mark","name":"tsc.op.op_load","count":15,"args":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts"},
{"type":"measure","name":"tsc.op.op_load","count":15,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":11,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":11,"duration":35.873},
{"type":"mark","name":"tsc.op.op_load","count":16,"args":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":16,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":12,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":12,"duration":147.993},
{"type":"mark","name":"tsc.op.op_load","count":17,"args":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":17,"duration":0.045},
{"type":"mark","name":"tsc.op.op_resolve","count":13,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":13,"duration":14.658},
{"type":"mark","name":"tsc.op.op_load","count":18,"args":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":18,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":14,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":14,"duration":8.74},
{"type":"mark","name":"tsc.op.op_load","count":19,"args":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":19,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":15,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":15,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":20,"args":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":20,"duration":0.023},
{"type":"mark","name":"tsc.op.op_load","count":21,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":21,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":16,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":16,"duration":92.987},
{"type":"mark","name":"tsc.op.op_load","count":22,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":22,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":17,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":17,"duration":0.06},
{"type":"mark","name":"tsc.op.op_load","count":23,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":23,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":18,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":18,"duration":0.045},
{"type":"mark","name":"tsc.op.op_load","count":24,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":24,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":19,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":19,"duration":46.509},
{"type":"mark","name":"tsc.op.op_load","count":25,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":25,"duration":0.249},
{"type":"mark","name":"tsc.op.op_resolve","count":20,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":20,"duration":0.064},
{"type":"mark","name":"tsc.op.op_load","count":26,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":26,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":21,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":21,"duration":43.853},
{"type":"mark","name":"tsc.op.op_load","count":27,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":27,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":22,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":22,"duration":0.048},
{"type":"mark","name":"tsc.op.op_load","count":28,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestError.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":28,"duration":0.023},
{"type":"mark","name":"tsc.op.op_load","count":29,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":29,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":23,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":23,"duration":0.039},
{"type":"mark","name":"tsc.op.op_load","count":30,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":30,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":24,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":24,"duration":88.623},
{"type":"mark","name":"tsc.op.op_load","count":31,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":31,"duration":0.085},
{"type":"mark","name":"tsc.op.op_resolve","count":25,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":25,"duration":0.079},
{"type":"mark","name":"tsc.op.op_load","count":32,"args":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":32,"duration":0.065},
{"type":"mark","name":"tsc.op.op_resolve","count":26,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":26,"duration":0.044},
{"type":"mark","name":"tsc.op.op_load","count":33,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":33,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":27,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":27,"duration":185.172},
{"type":"mark","name":"tsc.op.op_load","count":34,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":34,"duration":0.04},
{"type":"mark","name":"tsc.op.op_resolve","count":28,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":28,"duration":22.983},
{"type":"mark","name":"tsc.op.op_load","count":35,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/websocket-factory.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":35,"duration":0.052},
{"type":"mark","name":"tsc.op.op_load","count":36,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/constants.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":36,"duration":0.034},
{"type":"mark","name":"tsc.op.op_load","count":37,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/serializer.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":37,"duration":0.025},
{"type":"mark","name":"tsc.op.op_load","count":38,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/timer.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":38,"duration":0.022},
{"type":"mark","name":"tsc.op.op_load","count":39,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":39,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":29,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":29,"duration":87.883},
{"type":"mark","name":"tsc.op.op_load","count":40,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":40,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":30,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":30,"duration":0.023},
{"type":"mark","name":"tsc.op.op_load","count":41,"args":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":41,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":31,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":31,"duration":52.082},
{"type":"mark","name":"tsc.op.op_load","count":42,"args":"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":42,"duration":0.035},
{"type":"mark","name":"tsc.op.op_load","count":43,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":43,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":32,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":32,"duration":153.153},
{"type":"mark","name":"tsc.op.op_load","count":44,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":44,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":33,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":33,"duration":120.624},
{"type":"mark","name":"tsc.op.op_load","count":45,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":45,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":34,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":34,"duration":55.889},
{"type":"mark","name":"tsc.op.op_load","count":46,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/errors.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":46,"duration":0.033},
{"type":"mark","name":"tsc.op.op_load","count":47,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":47,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":35,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":35,"duration":0.027},
{"type":"mark","name":"tsc.op.op_load","count":48,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":48,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":36,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":36,"duration":0.028},
{"type":"mark","name":"tsc.op.op_load","count":49,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":49,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":37,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":37,"duration":29.001},
{"type":"mark","name":"tsc.op.op_load","count":50,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":50,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":38,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":38,"duration":0.017},
{"type":"mark","name":"tsc.op.op_load","count":51,"args":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":51,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":39,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":39,"duration":0.028},
{"type":"mark","name":"tsc.op.op_load","count":52,"args":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":52,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":40,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":40,"duration":0.027},
{"type":"mark","name":"tsc.op.op_load","count":53,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":53,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":41,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":41,"duration":82.26},
{"type":"mark","name":"tsc.op.op_load","count":54,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":54,"duration":1.094},
{"type":"mark","name":"tsc.op.op_resolve","count":42,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":42,"duration":7.632},
{"type":"mark","name":"tsc.op.op_load","count":55,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":55,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":43,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":43,"duration":0.02},
{"type":"mark","name":"tsc.op.op_load","count":56,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":56,"duration":0.062},
{"type":"mark","name":"tsc.op.op_resolve","count":44,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":44,"duration":57.869},
{"type":"mark","name":"tsc.op.op_load","count":57,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/web3/ethereum.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":57,"duration":0.035},
{"type":"mark","name":"tsc.op.op_load","count":58,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":58,"duration":0.047},
{"type":"mark","name":"tsc.op.op_resolve","count":45,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":45,"duration":4.215},
{"type":"mark","name":"tsc.op.op_load","count":59,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/error-codes.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":59,"duration":0.032},
{"type":"mark","name":"tsc.op.op_load","count":60,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/web3/solana.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":60,"duration":0.025},
{"type":"mark","name":"tsc.op.op_load","count":61,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":61,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":46,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":46,"duration":8.298},
{"type":"mark","name":"tsc.op.op_load","count":62,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":62,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":47,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":47,"duration":0.04},
{"type":"mark","name":"tsc.op.op_load","count":63,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":63,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":48,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":48,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":64,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":64,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":49,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":49,"duration":0.018},
{"type":"mark","name":"tsc.op.op_load","count":65,"args":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/locks.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":65,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":66,"args":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":66,"duration":0.04},
{"type":"mark","name":"tsc.op.op_resolve","count":50,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":50,"duration":0.055},
{"type":"mark","name":"tsc.op.op_load","count":67,"args":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts"},
{"type":"measure","name":"tsc.op.op_load","count":67,"duration":0.053},
{"type":"mark","name":"tsc.op.op_resolve","count":51,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":51,"duration":0.034},
{"type":"mark","name":"tsc.op.op_load","count":68,"args":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts"},
{"type":"measure","name":"tsc.op.op_load","count":68,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":52,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":52,"duration":37.024},
{"type":"mark","name":"tsc.op.op_load","count":69,"args":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":69,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":53,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":53,"duration":33.699},
{"type":"mark","name":"tsc.op.op_load","count":70,"args":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":70,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":54,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":54,"duration":10.041},
{"type":"mark","name":"tsc.op.op_load","count":71,"args":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":71,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":55,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":55,"duration":9.232},
{"type":"mark","name":"tsc.op.op_load","count":72,"args":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":72,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":56,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":56,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":73,"args":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":73,"duration":0.018},
{"type":"mark","name":"tsc.op.op_load","count":74,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":74,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":57,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":57,"duration":102.437},
{"type":"mark","name":"tsc.op.op_load","count":75,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":75,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":58,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":58,"duration":0.036},
{"type":"mark","name":"tsc.op.op_load","count":76,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":76,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":59,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":59,"duration":0.039},
{"type":"mark","name":"tsc.op.op_load","count":77,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":77,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":60,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":60,"duration":0.055},
{"type":"mark","name":"tsc.op.op_load","count":78,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":78,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":61,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":61,"duration":0.596},
{"type":"mark","name":"tsc.op.op_load","count":79,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":79,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":62,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":62,"duration":0.024},
{"type":"mark","name":"tsc.op.op_load","count":80,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":80,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":63,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":63,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":81,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestError.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":81,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":82,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":82,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":64,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":64,"duration":68.359},
{"type":"mark","name":"tsc.op.op_load","count":83,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":83,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":65,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":65,"duration":0.022},
{"type":"mark","name":"tsc.op.op_load","count":84,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":84,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":66,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":66,"duration":0.024},
{"type":"mark","name":"tsc.op.op_load","count":85,"args":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":85,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":67,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":67,"duration":0.053},
{"type":"mark","name":"tsc.op.op_load","count":86,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":86,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":68,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":68,"duration":86.619},
{"type":"mark","name":"tsc.op.op_load","count":87,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":87,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":69,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":69,"duration":26.297},
{"type":"mark","name":"tsc.op.op_load","count":88,"args":"https://esm.sh/@types/ws@8.5.13/index.d.mts"},
{"type":"measure","name":"tsc.op.op_load","count":88,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":70,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":70,"duration":0.027},
{"type":"mark","name":"tsc.op.op_load","count":89,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/constants.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":89,"duration":0.026},
{"type":"mark","name":"tsc.op.op_load","count":90,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/serializer.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":90,"duration":0.022},
{"type":"mark","name":"tsc.op.op_load","count":91,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/timer.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":91,"duration":0.041},
{"type":"mark","name":"tsc.op.op_load","count":92,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":92,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":71,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":71,"duration":55.325},
{"type":"mark","name":"tsc.op.op_load","count":93,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":93,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":72,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":72,"duration":0.019},
{"type":"mark","name":"tsc.op.op_load","count":94,"args":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":94,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":73,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":73,"duration":0.025},
{"type":"mark","name":"tsc.op.op_load","count":95,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":95,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":74,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":74,"duration":38.231},
{"type":"mark","name":"tsc.op.op_load","count":96,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":96,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":75,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":75,"duration":132.027},
{"type":"mark","name":"tsc.op.op_load","count":97,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":97,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":76,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":76,"duration":0.035},
{"type":"mark","name":"tsc.op.op_load","count":98,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/errors.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":98,"duration":0.023},
{"type":"mark","name":"tsc.op.op_load","count":99,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":99,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":77,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":77,"duration":0.019},
{"type":"mark","name":"tsc.op.op_load","count":100,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":100,"duration":0.02},
{"type":"mark","name":"tsc.op.op_load","count":101,"args":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":101,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":78,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":78,"duration":0.032},
{"type":"mark","name":"tsc.op.op_load","count":102,"args":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":102,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":79,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":79,"duration":0.027},
{"type":"mark","name":"tsc.op.op_load","count":103,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":103,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":80,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":80,"duration":52.03},
{"type":"mark","name":"tsc.op.op_load","count":104,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":104,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":81,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":81,"duration":2.638},
{"type":"mark","name":"tsc.op.op_load","count":105,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":105,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":82,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":82,"duration":0.019},
{"type":"mark","name":"tsc.op.op_load","count":106,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":106,"duration":0.077},
{"type":"mark","name":"tsc.op.op_resolve","count":83,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":83,"duration":7.836},
{"type":"mark","name":"tsc.op.op_load","count":107,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":107,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":84,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":84,"duration":5.582},
{"type":"mark","name":"tsc.op.op_load","count":108,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/error-codes.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":108,"duration":0.055},
{"type":"mark","name":"tsc.op.op_load","count":109,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":109,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":85,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":85,"duration":0.024},
{"type":"mark","name":"tsc.op.op_load","count":110,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":110,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":86,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":86,"duration":15.021},
{"type":"mark","name":"tsc.op.op_load","count":111,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":111,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":87,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":87,"duration":0.022},
{"type":"mark","name":"tsc.op.op_load","count":112,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":112,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":88,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":88,"duration":0.022},
{"type":"mark","name":"tsc.op.op_load","count":113,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":113,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":89,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":89,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":114,"args":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/locks.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":114,"duration":0.111},
{"type":"mark","name":"tsc.op.op_load","count":115,"args":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":115,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":90,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":90,"duration":0.029},
{"type":"mark","name":"tsc.op.op_load","count":116,"args":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts"},
{"type":"measure","name":"tsc.op.op_load","count":116,"duration":0.179},
{"type":"mark","name":"tsc.op.op_resolve","count":91,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":91,"duration":0.049},
{"type":"mark","name":"tsc.op.op_load","count":117,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":117,"duration":0.158},
{"type":"mark","name":"tsc.op.op_resolve","count":92,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":92,"duration":0.092},
{"type":"mark","name":"tsc.op.op_load","count":118,"args":"https://deno.land/std@0.168.0/http/server.ts"},
{"type":"measure","name":"tsc.op.op_load","count":118,"duration":0.07},
{"type":"mark","name":"tsc.op.op_resolve","count":93,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":93,"duration":3.986},
{"type":"mark","name":"tsc.op.op_load","count":119,"args":"https://deno.land/std@0.168.0/async/mod.ts"},
{"type":"measure","name":"tsc.op.op_load","count":119,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":94,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":94,"duration":33.19},
{"type":"mark","name":"tsc.op.op_load","count":120,"args":"https://deno.land/std@0.168.0/async/abortable.ts"},
{"type":"measure","name":"tsc.op.op_load","count":120,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":95,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":95,"duration":0.035},
{"type":"mark","name":"tsc.op.op_load","count":121,"args":"https://deno.land/std@0.168.0/async/deferred.ts"},
{"type":"measure","name":"tsc.op.op_load","count":121,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":122,"args":"https://deno.land/std@0.168.0/async/deadline.ts"},
{"type":"measure","name":"tsc.op.op_load","count":122,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":96,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":96,"duration":0.017},
{"type":"mark","name":"tsc.op.op_load","count":123,"args":"https://deno.land/std@0.168.0/async/debounce.ts"},
{"type":"measure","name":"tsc.op.op_load","count":123,"duration":0.016},
{"type":"mark","name":"tsc.op.op_load","count":124,"args":"https://deno.land/std@0.168.0/async/delay.ts"},
{"type":"measure","name":"tsc.op.op_load","count":124,"duration":0.04},
{"type":"mark","name":"tsc.op.op_load","count":125,"args":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts"},
{"type":"measure","name":"tsc.op.op_load","count":125,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":97,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":97,"duration":0.023},
{"type":"mark","name":"tsc.op.op_load","count":126,"args":"https://deno.land/std@0.168.0/async/pool.ts"},
{"type":"measure","name":"tsc.op.op_load","count":126,"duration":0.02},
{"type":"mark","name":"tsc.op.op_load","count":127,"args":"https://deno.land/std@0.168.0/async/tee.ts"},
{"type":"measure","name":"tsc.op.op_load","count":127,"duration":0.026},
{"type":"mark","name":"tsc.op.op_load","count":128,"args":"https://deno.land/std@0.168.0/async/retry.ts"},
{"type":"measure","name":"tsc.op.op_load","count":128,"duration":0.057},
{"type":"mark","name":"tsc.op.op_load","count":129,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":129,"duration":0.183},
{"type":"mark","name":"tsc.op.op_resolve","count":98,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":98,"duration":0.082},
{"type":"mark","name":"tsc.op.op_load","count":130,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":130,"duration":1.973},
{"type":"mark","name":"tsc.op.op_resolve","count":99,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":99,"duration":0.083},
{"type":"mark","name":"tsc.op.op_load","count":131,"args":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":131,"duration":0.068},
{"type":"mark","name":"tsc.op.op_resolve","count":100,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":100,"duration":0.089},
{"type":"mark","name":"tsc.op.op_load","count":132,"args":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":132,"duration":0.134},
{"type":"mark","name":"tsc.op.op_resolve","count":101,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":101,"duration":0.067},
{"type":"mark","name":"tsc.op.op_load","count":133,"args":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":133,"duration":0.097},
{"type":"mark","name":"tsc.op.op_resolve","count":102,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":102,"duration":6.175},
{"type":"mark","name":"tsc.op.op_load","count":134,"args":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":134,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":103,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":103,"duration":11.714},
{"type":"mark","name":"tsc.op.op_load","count":135,"args":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":135,"duration":0.054},
{"type":"mark","name":"tsc.op.op_resolve","count":104,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":104,"duration":72.542},
{"type":"mark","name":"tsc.op.op_load","count":136,"args":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":136,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":105,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":105,"duration":0.027},
{"type":"mark","name":"tsc.op.op_load","count":137,"args":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":137,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":106,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":106,"duration":0.026},
{"type":"mark","name":"tsc.op.op_load","count":138,"args":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":138,"duration":0.085},
{"type":"mark","name":"tsc.op.op_resolve","count":107,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":107,"duration":0.057},
{"type":"mark","name":"tsc.op.op_load","count":139,"args":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":139,"duration":0.116},
{"type":"mark","name":"tsc.op.op_resolve","count":108,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":108,"duration":0.038},
{"type":"mark","name":"tsc.op.op_load","count":140,"args":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":140,"duration":0.113},
{"type":"mark","name":"tsc.op.op_resolve","count":109,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":109,"duration":0.069},
{"type":"mark","name":"tsc.op.op_load","count":141,"args":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":141,"duration":0.059},
{"type":"mark","name":"tsc.op.op_resolve","count":110,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":110,"duration":0.047},
{"type":"mark","name":"tsc.op.op_load","count":142,"args":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":142,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":111,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":111,"duration":0.041},
{"type":"mark","name":"tsc.op.op_load","count":143,"args":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":143,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":112,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":112,"duration":0.024},
{"type":"mark","name":"tsc.op.op_load","count":144,"args":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":144,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":113,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":113,"duration":0.073},
{"type":"mark","name":"tsc.op.op_load","count":145,"args":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":145,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":114,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":114,"duration":0.057},
{"type":"mark","name":"tsc.op.op_load","count":146,"args":"asset:///lib.deno.window.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":146,"duration":2.086},
{"type":"mark","name":"tsc.op.op_load","count":147,"args":"asset:///lib.deno.ns.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":147,"duration":7.747},
{"type":"mark","name":"tsc.op.op_load","count":148,"args":"asset:///lib.esnext.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":148,"duration":0.291},
{"type":"mark","name":"tsc.op.op_load","count":149,"args":"asset:///lib.es2024.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":149,"duration":0.067},
{"type":"mark","name":"tsc.op.op_load","count":150,"args":"asset:///lib.es2023.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":150,"duration":0.055},
{"type":"mark","name":"tsc.op.op_load","count":151,"args":"asset:///lib.es2022.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":151,"duration":0.058},
{"type":"mark","name":"tsc.op.op_load","count":152,"args":"asset:///lib.es2021.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":152,"duration":0.051},
{"type":"mark","name":"tsc.op.op_load","count":153,"args":"asset:///lib.es2020.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":153,"duration":0.061},
{"type":"mark","name":"tsc.op.op_load","count":154,"args":"asset:///lib.es2019.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":154,"duration":0.055},
{"type":"mark","name":"tsc.op.op_load","count":155,"args":"asset:///lib.es2018.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":155,"duration":0.058},
{"type":"mark","name":"tsc.op.op_load","count":156,"args":"asset:///lib.es2017.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":156,"duration":0.066},
{"type":"mark","name":"tsc.op.op_load","count":157,"args":"asset:///lib.es2016.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":157,"duration":0.053},
{"type":"mark","name":"tsc.op.op_load","count":158,"args":"asset:///lib.es2015.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":158,"duration":0.061},
{"type":"mark","name":"tsc.op.op_load","count":159,"args":"asset:///lib.es5.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":159,"duration":49.342},
{"type":"mark","name":"tsc.op.op_load","count":160,"args":"asset:///lib.decorators.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":160,"duration":0.941},
{"type":"mark","name":"tsc.op.op_load","count":161,"args":"asset:///lib.decorators.legacy.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":161,"duration":0.293},
{"type":"mark","name":"tsc.op.op_load","count":162,"args":"asset:///lib.es2015.core.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":162,"duration":5.358},
{"type":"mark","name":"tsc.op.op_load","count":163,"args":"asset:///lib.es2015.collection.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":163,"duration":3.328},
{"type":"mark","name":"tsc.op.op_load","count":164,"args":"asset:///lib.es2015.iterable.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":164,"duration":22.483},
{"type":"mark","name":"tsc.op.op_load","count":165,"args":"asset:///lib.es2015.symbol.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":165,"duration":0.233},
{"type":"mark","name":"tsc.op.op_load","count":166,"args":"asset:///lib.es2015.generator.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":166,"duration":1.794},
{"type":"mark","name":"tsc.op.op_load","count":167,"args":"asset:///lib.es2015.promise.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":167,"duration":5.459},
{"type":"mark","name":"tsc.op.op_load","count":168,"args":"asset:///lib.es2015.proxy.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":168,"duration":0.389},
{"type":"mark","name":"tsc.op.op_load","count":169,"args":"asset:///lib.es2015.reflect.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":169,"duration":0.626},
{"type":"mark","name":"tsc.op.op_load","count":170,"args":"asset:///lib.es2015.symbol.wellknown.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":170,"duration":11.653},
{"type":"mark","name":"tsc.op.op_load","count":171,"args":"asset:///lib.es2016.array.include.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":171,"duration":0.361},
{"type":"mark","name":"tsc.op.op_load","count":172,"args":"asset:///lib.es2016.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":172,"duration":0.15},
{"type":"mark","name":"tsc.op.op_load","count":173,"args":"asset:///lib.es2017.arraybuffer.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":173,"duration":0.082},
{"type":"mark","name":"tsc.op.op_load","count":174,"args":"asset:///lib.es2017.date.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":174,"duration":0.113},
{"type":"mark","name":"tsc.op.op_load","count":175,"args":"asset:///lib.es2017.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":175,"duration":10.359},
{"type":"mark","name":"tsc.op.op_load","count":176,"args":"asset:///lib.es2017.object.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":176,"duration":0.248},
{"type":"mark","name":"tsc.op.op_load","count":177,"args":"asset:///lib.es2017.sharedmemory.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":177,"duration":2.335},
{"type":"mark","name":"tsc.op.op_load","count":178,"args":"asset:///lib.es2017.string.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":178,"duration":0.125},
{"type":"mark","name":"tsc.op.op_load","count":179,"args":"asset:///lib.es2017.typedarrays.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":179,"duration":0.155},
{"type":"mark","name":"tsc.op.op_load","count":180,"args":"asset:///lib.es2018.asynciterable.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":180,"duration":0.275},
{"type":"mark","name":"tsc.op.op_load","count":181,"args":"asset:///lib.es2018.asyncgenerator.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":181,"duration":0.236},
{"type":"mark","name":"tsc.op.op_load","count":182,"args":"asset:///lib.es2018.promise.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":182,"duration":0.104},
{"type":"mark","name":"tsc.op.op_load","count":183,"args":"asset:///lib.es2018.regexp.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":183,"duration":0.099},
{"type":"mark","name":"tsc.op.op_load","count":184,"args":"asset:///lib.es2018.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":184,"duration":0.467},
{"type":"mark","name":"tsc.op.op_load","count":185,"args":"asset:///lib.es2019.array.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":185,"duration":0.295},
{"type":"mark","name":"tsc.op.op_load","count":186,"args":"asset:///lib.es2019.object.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":186,"duration":0.114},
{"type":"mark","name":"tsc.op.op_load","count":187,"args":"asset:///lib.es2019.string.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":187,"duration":0.085},
{"type":"mark","name":"tsc.op.op_load","count":188,"args":"asset:///lib.es2019.symbol.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":188,"duration":9.592},
{"type":"mark","name":"tsc.op.op_load","count":189,"args":"asset:///lib.es2019.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":189,"duration":0.145},
{"type":"mark","name":"tsc.op.op_load","count":190,"args":"asset:///lib.es2020.bigint.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":190,"duration":19.187},
{"type":"mark","name":"tsc.op.op_load","count":191,"args":"asset:///lib.es2020.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":191,"duration":1.268},
{"type":"mark","name":"tsc.op.op_load","count":192,"args":"asset:///lib.es2020.date.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":192,"duration":0.172},
{"type":"mark","name":"tsc.op.op_load","count":193,"args":"asset:///lib.es2020.number.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":193,"duration":0.091},
{"type":"mark","name":"tsc.op.op_load","count":194,"args":"asset:///lib.es2020.promise.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":194,"duration":0.181},
{"type":"mark","name":"tsc.op.op_load","count":195,"args":"asset:///lib.es2020.sharedmemory.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":195,"duration":0.299},
{"type":"mark","name":"tsc.op.op_load","count":196,"args":"asset:///lib.es2020.string.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":196,"duration":0.131},
{"type":"mark","name":"tsc.op.op_load","count":197,"args":"asset:///lib.es2020.symbol.wellknown.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":197,"duration":0.146},
{"type":"mark","name":"tsc.op.op_load","count":198,"args":"asset:///lib.es2021.promise.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":198,"duration":0.175},
{"type":"mark","name":"tsc.op.op_load","count":199,"args":"asset:///lib.es2021.string.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":199,"duration":0.106},
{"type":"mark","name":"tsc.op.op_load","count":200,"args":"asset:///lib.es2021.weakref.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":200,"duration":0.258},
{"type":"mark","name":"tsc.op.op_load","count":201,"args":"asset:///lib.es2021.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":201,"duration":0.456},
{"type":"mark","name":"tsc.op.op_load","count":202,"args":"asset:///lib.es2022.array.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":202,"duration":0.377},
{"type":"mark","name":"tsc.op.op_load","count":203,"args":"asset:///lib.es2022.error.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":203,"duration":0.255},
{"type":"mark","name":"tsc.op.op_load","count":204,"args":"asset:///lib.es2022.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":204,"duration":0.218},
{"type":"mark","name":"tsc.op.op_load","count":205,"args":"asset:///lib.es2022.object.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":205,"duration":0.098},
{"type":"mark","name":"tsc.op.op_load","count":206,"args":"asset:///lib.es2022.regexp.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":206,"duration":0.132},
{"type":"mark","name":"tsc.op.op_load","count":207,"args":"asset:///lib.es2022.string.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":207,"duration":0.084},
{"type":"mark","name":"tsc.op.op_load","count":208,"args":"asset:///lib.es2023.array.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":208,"duration":2.426},
{"type":"mark","name":"tsc.op.op_load","count":209,"args":"asset:///lib.es2023.collection.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":209,"duration":0.175},
{"type":"mark","name":"tsc.op.op_load","count":210,"args":"asset:///lib.es2023.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":210,"duration":0.312},
{"type":"mark","name":"tsc.op.op_load","count":211,"args":"asset:///lib.es2024.arraybuffer.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":211,"duration":0.178},
{"type":"mark","name":"tsc.op.op_load","count":212,"args":"asset:///lib.es2024.collection.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":212,"duration":0.284},
{"type":"mark","name":"tsc.op.op_load","count":213,"args":"asset:///lib.es2024.object.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":213,"duration":0.211},
{"type":"mark","name":"tsc.op.op_load","count":214,"args":"asset:///lib.es2024.promise.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":214,"duration":0.358},
{"type":"mark","name":"tsc.op.op_load","count":215,"args":"asset:///lib.es2024.regexp.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":215,"duration":0.072},
{"type":"mark","name":"tsc.op.op_load","count":216,"args":"asset:///lib.es2024.sharedmemory.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":216,"duration":0.224},
{"type":"mark","name":"tsc.op.op_load","count":217,"args":"asset:///lib.es2024.string.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":217,"duration":0.08},
{"type":"mark","name":"tsc.op.op_load","count":218,"args":"asset:///lib.esnext.intl.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":218,"duration":0.086},
{"type":"mark","name":"tsc.op.op_load","count":219,"args":"asset:///lib.esnext.decorators.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":219,"duration":0.101},
{"type":"mark","name":"tsc.op.op_load","count":220,"args":"asset:///lib.esnext.disposable.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":220,"duration":0.508},
{"type":"mark","name":"tsc.op.op_load","count":221,"args":"asset:///lib.esnext.collection.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":221,"duration":0.337},
{"type":"mark","name":"tsc.op.op_load","count":222,"args":"asset:///lib.esnext.array.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":222,"duration":0.209},
{"type":"mark","name":"tsc.op.op_load","count":223,"args":"asset:///lib.esnext.iterator.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":223,"duration":0.571},
{"type":"mark","name":"tsc.op.op_load","count":224,"args":"asset:///lib.esnext.promise.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":224,"duration":5.045},
{"type":"mark","name":"tsc.op.op_load","count":225,"args":"asset:///lib.esnext.float16.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":225,"duration":1.162},
{"type":"mark","name":"tsc.op.op_load","count":226,"args":"asset:///lib.esnext.error.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":226,"duration":0.179},
{"type":"mark","name":"tsc.op.op_load","count":227,"args":"asset:///lib.esnext.sharedmemory.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":227,"duration":0.085},
{"type":"mark","name":"tsc.op.op_load","count":228,"args":"asset:///lib.deno.net.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":228,"duration":1.721},
{"type":"mark","name":"tsc.op.op_load","count":229,"args":"asset:///lib.deno.shared_globals.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":229,"duration":2.234},
{"type":"mark","name":"tsc.op.op_load","count":230,"args":"asset:///lib.deno.console.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":230,"duration":0.931},
{"type":"mark","name":"tsc.op.op_load","count":231,"args":"asset:///lib.deno.url.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":231,"duration":5.856},
{"type":"mark","name":"tsc.op.op_load","count":232,"args":"asset:///lib.deno.web.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":232,"duration":53.21},
{"type":"mark","name":"tsc.op.op_load","count":233,"args":"asset:///lib.deno.webgpu.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":233,"duration":4.349},
{"type":"mark","name":"tsc.op.op_load","count":234,"args":"asset:///lib.deno.canvas.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":234,"duration":0.382},
{"type":"mark","name":"tsc.op.op_load","count":235,"args":"asset:///lib.deno.fetch.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":235,"duration":4.289},
{"type":"mark","name":"tsc.op.op_load","count":236,"args":"asset:///lib.deno.websocket.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":236,"duration":0.683},
{"type":"mark","name":"tsc.op.op_load","count":237,"args":"asset:///lib.deno.crypto.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":237,"duration":1.516},
{"type":"mark","name":"tsc.op.op_load","count":238,"args":"asset:///lib.deno.webstorage.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":238,"duration":25.287},
{"type":"mark","name":"tsc.op.op_load","count":239,"args":"asset:///lib.deno.cache.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":239,"duration":0.35},
{"type":"mark","name":"tsc.op.op_load","count":240,"args":"asset:///lib.deno.unstable.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":240,"duration":113.667},
{"type":"mark","name":"tsc.op.op_load","count":241,"args":"asset:///lib.deno.broadcast_channel.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":241,"duration":0.401},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":1,"duration":0.011},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":2,"duration":0.006},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":3,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":4,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":5,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":6,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":7,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":8,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":9,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":10,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":11,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":12,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":13,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":14,"duration":0.005},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":15,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":16,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":17,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":18,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":19,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":20,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":21,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":22,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":23,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":24,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":25,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":26,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":27,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":28,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":29,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":30,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":31,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":32,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":33,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":34,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":35,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":36,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":37,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":38,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":39,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":40,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":41,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":42,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":43,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":44,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":45,"duration":0.004},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":46,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":47,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":48,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":49,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":50,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":51,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":52,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":53,"duration":0.003},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":54,"duration":0.005},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":55,"duration":0.004},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":56,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":57,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":58,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":59,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":60,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":61,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":62,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":63,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":64,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":65,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":66,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":67,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":68,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":69,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":70,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":71,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":72,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":73,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":74,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":75,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":76,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":77,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":78,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":79,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":80,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":81,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":82,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":83,"duration":0.004},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":84,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":85,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":86,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":87,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":88,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":89,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":90,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":91,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":92,"duration":0.001},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":93,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":94,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":95,"duration":0.004},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":96,"duration":0.006},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":97,"duration":0.004},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":98,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":99,"duration":0.014},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":100,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":101,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":102,"duration":0.009},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":103,"duration":0.033},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":104,"duration":0.016},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":105,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":106,"duration":0.012},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":107,"duration":0.035},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":108,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":109,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":110,"duration":0.007},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":111,"duration":0.015},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":112,"duration":0.014},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":1,"duration":8683.763},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":1,"duration":12488.101},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":1,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":1,"duration":3.276},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":1,"duration":3.48},
{"type":"measure","name":"lsp.diagnostic","count":1,"duration":12493.468},
{"type":"mark","name":"lsp.did_open","count":16,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","languageId":"typescript","version":1,"text":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport type { SupabaseClient } from \"https://esm.sh/@supabase/supabase-js@2.38.0\";\nimport type { AuthenticatedRequestContext } from \"../_shared/edge-auth.ts\";\nimport {\n  authenticateRequest,\n  corsHeaders,\n  handleCORS,\n} from \"../_shared/edge-auth.ts\";\n\n// User-Aware Campaign Export Function\n// October 4, 2025 - Export with user authentication and ownership\n\ninterface ExportRequest {\n  campaignId?: string;\n  format?: \"csv\" | \"json\" | \"xlsx\";\n  includeEnrichmentData?: boolean;\n  userEmail?: string;\n}\n\ninterface ExportLead {\n  businessName: string;\n  address: string;\n  phone: string;\n  website: string;\n  email: string;\n  confidenceScore: number;\n  verificationSources: string[];\n  apolloVerified: boolean;\n  chamberVerified: boolean;\n  licenseVerified: boolean;\n  totalCost: number;\n  processingStrategy: string;\n}\n\ninterface ExportUserContext {\n  userId: string;\n  sessionId: string | null;\n  userEmail: string | null;\n  isAnonymous: boolean;\n  isAuthenticated: boolean;\n}\n\ninterface CampaignRow {\n  id: string;\n  business_type: string;\n  location: string;\n  target_count: number;\n  results_count: number;\n  total_cost: number;\n  created_at: string;\n  [key: string]: unknown;\n}\n\ninterface LeadRow {\n  campaign_id: string;\n  business_name: string;\n  address: string;\n  phone: string;\n  website: string;\n  email: string;\n  confidence_score: number;\n  enrichment_data?: {\n    verificationSources?: string[];\n    apolloVerified?: boolean;\n    chamberVerified?: boolean;\n    licenseVerified?: boolean;\n    processingMetadata?: {\n      totalCost?: number;\n      processingStrategy?: string;\n    };\n  };\n  [key: string]: unknown;\n}\n\n// Helper function to get user context from authenticated request\nfunction getUserContext(\n  authContext: AuthenticatedRequestContext,\n  requestData: ExportRequest\n): ExportUserContext {\n  const resolvedEmail = requestData.userEmail ?? authContext.email;\n\n  return {\n    userId: authContext.userId,\n    sessionId: authContext.sessionId,\n    userEmail: resolvedEmail,\n    isAnonymous: authContext.isAnonymous,\n    isAuthenticated: true,\n  };\n}\n\n// CSV formatting function\nfunction formatAsCSV(\n  leads: ExportLead[],\n  includeEnrichmentData: boolean\n): string {\n  const headers = [\n    \"Business Name\",\n    \"Address\",\n    \"Phone\",\n    \"Website\",\n    \"Email\",\n    \"Confidence Score\",\n  ];\n\n  if (includeEnrichmentData) {\n    headers.push(\n      \"Verification Sources\",\n      \"Apollo Verified\",\n      \"Chamber Verified\",\n      \"License Verified\",\n      \"Total Cost\",\n      \"Processing Strategy\"\n    );\n  }\n\n  const csvRows = [headers.join(\",\")];\n\n  leads.forEach((lead) => {\n    const row = [\n      `\"${lead.businessName.replace(/\"/g, '\"\"')}\"`,\n      `\"${lead.address.replace(/\"/g, '\"\"')}\"`,\n      `\"${lead.phone}\"`,\n      `\"${lead.website}\"`,\n      `\"${lead.email}\"`,\n      lead.confidenceScore.toString(),\n    ];\n\n    if (includeEnrichmentData) {\n      row.push(\n        `\"${lead.verificationSources.join(\", \")}\"`,\n        lead.apolloVerified.toString(),\n        lead.chamberVerified.toString(),\n        lead.licenseVerified.toString(),\n        lead.totalCost.toString(),\n        `\"${lead.processingStrategy}\"`\n      );\n    }\n\n    csvRows.push(row.join(\",\"));\n  });\n\n  return csvRows.join(\"\\n\");\n}\n\n// Get campaign data with user authorization\nasync function getCampaignData(\n  supabaseClient: SupabaseClient,\n  campaignId: string\n): Promise<{ campaign: CampaignRow; leads: LeadRow[] }> {\n  try {\n    // Get campaign with user authorization - RLS policies will handle access control\n    const { data: campaignData, error: campaignError } = await supabaseClient\n      .from(\"campaigns\")\n      .select(\"*\")\n      .eq(\"id\", campaignId)\n      .single();\n\n    if (campaignError || !campaignData) {\n      throw new Error(\n        `Campaign not found or access denied: ${\n          campaignError?.message ?? \"unknown error\"\n        }`\n      );\n    }\n\n    // Get leads for the campaign\n    const { data: leadsData, error: leadsError } = await supabaseClient\n      .from(\"leads\")\n      .select(\"*\")\n      .eq(\"campaign_id\", campaignId);\n\n    if (leadsError) {\n      throw new Error(`Could not fetch leads: ${leadsError.message}`);\n    }\n\n    const campaign = campaignData as CampaignRow;\n    const leads = (leadsData ?? []) as LeadRow[];\n\n    return { campaign, leads };\n  } catch (error) {\n    throw error;\n  }\n}\n\nserve(async (req) => {\n  // Handle CORS preflight\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    console.log(`ðŸ“¤ Campaign Export with User Authentication`);\n\n    const authContext = await authenticateRequest(req);\n    console.log(\n      `ðŸ” Authenticated Supabase session for ${authContext.userId} (${\n        authContext.isAnonymous ? \"anonymous\" : \"authenticated\"\n      })`\n    );\n\n    const supabaseClient = authContext.supabaseClient;\n    const sessionUserId = authContext.sessionId;\n\n    // Parse request\n    const requestData: ExportRequest = await req.json();\n    const {\n      campaignId,\n      format = \"csv\",\n      includeEnrichmentData = true,\n    } = requestData;\n\n    if (!campaignId) {\n      throw new Error(\"Campaign ID is required\");\n    }\n\n    // Get user context\n    const userContext = getUserContext(authContext, requestData);\n    console.log(`ðŸ‘¤ Export User Context:`, userContext);\n\n    if (!userContext.userId) {\n      return new Response(\n        JSON.stringify({\n          success: false,\n          error: \"Authentication required to export campaign data.\",\n        }),\n        {\n          status: 401,\n          headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n        }\n      );\n    }\n\n    // Get campaign and leads data\n    const { campaign, leads } = await getCampaignData(\n      supabaseClient,\n      campaignId\n    );\n\n    console.log(\n      `ðŸ“Š Exporting campaign: ${campaign.business_type} in ${campaign.location}`\n    );\n    console.log(`ðŸ“‹ Lead count: ${leads.length}`);\n\n    // Transform leads for export\n    const exportLeads: ExportLead[] = leads.map((lead: LeadRow) => ({\n      businessName: lead.business_name,\n      address: lead.address,\n      phone: lead.phone,\n      website: lead.website,\n      email: lead.email,\n      confidenceScore: lead.confidence_score,\n      verificationSources: lead.enrichment_data?.verificationSources || [\n        \"google_places\",\n      ],\n      apolloVerified: lead.enrichment_data?.apolloVerified || false,\n      chamberVerified: lead.enrichment_data?.chamberVerified || false,\n      licenseVerified: lead.enrichment_data?.licenseVerified || false,\n      totalCost: lead.enrichment_data?.processingMetadata?.totalCost || 0,\n      processingStrategy:\n        lead.enrichment_data?.processingMetadata?.processingStrategy || \"basic\",\n    }));\n\n    // Record export in database\n    const exportRecord = {\n      campaign_id: campaignId,\n      export_type: \"lead_export\",\n      file_format: format,\n      row_count: exportLeads.length,\n      export_status: \"completed\",\n      completed_at: new Date().toISOString(),\n      // Add user_id if available\n      user_id: userContext.userId,\n      session_user_id: sessionUserId,\n    };\n\n    const { error: exportError } = await supabaseClient\n      .from(\"dashboard_exports\")\n      .insert(exportRecord);\n\n    if (exportError) {\n      console.warn(\"Could not record export:\", exportError.message);\n    }\n\n    // Generate export data based on format\n    let exportData: string;\n    let contentType: string;\n    let fileName: string;\n\n    switch (format) {\n      case \"csv\":\n        exportData = formatAsCSV(exportLeads, includeEnrichmentData);\n        contentType = \"text/csv\";\n        fileName = `prospectpro_${campaign.business_type.replace(\n          /\\s+/g,\n          \"_\"\n        )}_${campaignId.slice(-8)}.csv`;\n        break;\n\n      case \"json\":\n        exportData = JSON.stringify(\n          {\n            campaign: {\n              id: campaign.id,\n              businessType: campaign.business_type,\n              location: campaign.location,\n              targetCount: campaign.target_count,\n              resultsCount: campaign.results_count,\n              totalCost: campaign.total_cost,\n              createdAt: campaign.created_at,\n            },\n            leads: exportLeads,\n            exportMetadata: {\n              exportedAt: new Date().toISOString(),\n              includeEnrichmentData,\n              totalLeads: exportLeads.length,\n              userContext: {\n                isAuthenticated: userContext.isAuthenticated,\n                hasUserId: !!userContext.userId,\n              },\n            },\n          },\n          null,\n          2\n        );\n        contentType = \"application/json\";\n        fileName = `prospectpro_${campaign.business_type.replace(\n          /\\s+/g,\n          \"_\"\n        )}_${campaignId.slice(-8)}.json`;\n        break;\n\n      default:\n        throw new Error(`Unsupported export format: ${format}`);\n    }\n\n    const response = {\n      success: true,\n      exportId: `export_${Date.now()}`,\n      campaign: {\n        id: campaign.id,\n        businessType: campaign.business_type,\n        location: campaign.location,\n        leadCount: exportLeads.length,\n      },\n      export: {\n        format,\n        fileName,\n        size: exportData.length,\n        includeEnrichmentData,\n        recordedInDatabase: !exportError,\n      },\n      userContext: {\n        isAuthenticated: userContext.isAuthenticated,\n        hasAccess: true,\n        ownership: \"user_owned\",\n      },\n      metadata: {\n        timestamp: new Date().toISOString(),\n        version: \"4.2\",\n        userAware: true,\n      },\n    };\n\n    // Return the export data directly for download\n    if (req.url.includes(\"download=true\")) {\n      return new Response(exportData, {\n        headers: {\n          ...corsHeaders,\n          \"Content-Type\": contentType,\n          \"Content-Disposition\": `attachment; filename=\"${fileName}\"`,\n          \"Content-Length\": exportData.length.toString(),\n        },\n      });\n    }\n\n    // Return export metadata\n    return new Response(JSON.stringify(response, null, 2), {\n      headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n    });\n  } catch (error) {\n    console.error(\"âŒ Export error:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Export failed\",\n        timestamp: new Date().toISOString(),\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"measure","name":"lsp.did_open","count":16,"duration":15.727},
{"type":"mark","name":"lsp.did_open","count":17,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","languageId":"typescript","version":1,"text":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\nimport { corsHeaders, handleCORS } from \"../_shared/edge-auth.ts\";\n\n// Business Discovery with User-Campaign Linking\n// October 4, 2025 - Complete authentication and user management\n\ninterface BusinessDiscoveryRequest {\n  businessType: string;\n  location: string;\n  maxResults?: number;\n  budgetLimit?: number;\n  requireCompleteContacts?: boolean;\n  minConfidenceScore?: number;\n  // User session management\n  sessionUserId?: string;\n  userEmail?: string;\n}\n\ninterface BusinessLead {\n  businessName: string;\n  address: string;\n  phone: string;\n  website: string;\n  email: string;\n  optimizedScore: number;\n  validationCost: number;\n  enhancementData: {\n    verificationSources: string[];\n    apolloVerified: boolean;\n    chamberVerified: boolean;\n    licenseVerified: boolean;\n    processingMetadata: {\n      totalCost: number;\n      totalConfidenceBoost: number;\n      apisSkipped: string[];\n      processingStrategy: string;\n    };\n  };\n}\n\n// Helper function to get or extract user ID from request\nfunction getUserContext(\n  req: Request,\n  requestData: BusinessDiscoveryRequest,\n  requestAuth?: { userId?: string; isAnonymous?: boolean }\n) {\n  // Prefer user ID from validated JWT token\n  if (requestAuth?.userId) {\n    return {\n      userId: requestAuth.userId,\n      userEmail: requestData.userEmail || null,\n      isAuthenticated: true,\n      isAnonymous: requestAuth.isAnonymous || false,\n      sessionId: requestData.sessionUserId || requestAuth.userId,\n    };\n  }\n\n  // Fallback to manual JWT decoding (for backward compatibility)\n  const authHeader = req.headers.get(\"Authorization\");\n  let userFromJWT = null;\n\n  if (authHeader?.startsWith(\"Bearer \")) {\n    const token = authHeader.substring(7);\n    try {\n      // For JWT tokens, we can decode to get user info\n      if (token.startsWith(\"eyJ\")) {\n        const payload = JSON.parse(atob(token.split(\".\")[1]));\n        userFromJWT = payload.sub; // User ID from JWT\n      }\n    } catch (error) {\n      console.log(\"Could not decode JWT for user info:\", error);\n    }\n  }\n\n  return {\n    userId: userFromJWT || requestData.sessionUserId || null,\n    userEmail: requestData.userEmail || null,\n    isAuthenticated: !!userFromJWT,\n    isAnonymous: false,\n    sessionId: requestData.sessionUserId,\n  };\n}\n\n// Enhanced Quality Scorer with user context\nclass UserAwareQualityScorer {\n  private maxCostPerBusiness: number;\n\n  constructor(options: { maxCostPerBusiness?: number } = {}) {\n    this.maxCostPerBusiness = options.maxCostPerBusiness || 2.0;\n  }\n\n  scoreBusiness(business: any): BusinessLead {\n    const businessName = business.name || business.businessName || \"\";\n    const address = business.formatted_address || business.address || \"\";\n    const phone = business.formatted_phone_number || business.phone || \"\";\n    const website = business.website || \"\";\n    const email = business.email || \"\";\n\n    // Scoring breakdown\n    const scores = {\n      businessName: businessName ? Math.min(100, businessName.length * 3) : 0,\n      address: address ? 100 : 0,\n      phone: phone ? 80 : 0,\n      website: website ? 80 : 0,\n      email: email ? 60 : 0,\n    };\n\n    const totalScore =\n      Object.values(scores).reduce((sum, score) => sum + score, 0) / 5;\n\n    return {\n      businessName,\n      address,\n      phone,\n      website,\n      email,\n      optimizedScore: Math.round(totalScore),\n      validationCost: 0.02,\n      enhancementData: {\n        verificationSources: [\"google_places\"],\n        apolloVerified: false,\n        chamberVerified: false,\n        licenseVerified: false,\n        processingMetadata: {\n          totalCost: 0.02,\n          totalConfidenceBoost: 0,\n          apisSkipped: [],\n          processingStrategy: \"basic\",\n        },\n      },\n    };\n  }\n}\n\n// Real Google Places API integration with Place Details enrichment\nasync function discoverBusinesses(\n  businessType: string,\n  location: string,\n  maxResults: number\n): Promise<any[]> {\n  const apiKey = Deno.env.get(\"GOOGLE_PLACES_API_KEY\");\n\n  if (!apiKey) {\n    console.error(\"âŒ GOOGLE_PLACES_API_KEY not configured\");\n    throw new Error(\"Google Places API key not configured\");\n  }\n\n  console.log(`ðŸ” Searching Google Places: ${businessType} in ${location}`);\n\n  // Step 1: Text Search to find businesses\n  const query = `${businessType} in ${location}`;\n  const searchUrl = `https://maps.googleapis.com/maps/api/place/textsearch/json?query=${encodeURIComponent(\n    query\n  )}&key=${apiKey}`;\n\n  const searchResponse = await fetch(searchUrl);\n  const searchData = await searchResponse.json();\n\n  console.log(`ðŸ”§ Google Places API status: ${searchData.status}`);\n\n  if (searchData.status !== \"OK\") {\n    console.error(`âŒ Google Places API error: ${searchData.status}`);\n    if (searchData.error_message) {\n      console.error(`   Error message: ${searchData.error_message}`);\n    }\n    throw new Error(`Google Places API failed: ${searchData.status}`);\n  }\n\n  const results = searchData.results.slice(0, maxResults);\n  console.log(\n    `ðŸ“Š Found ${results.length} businesses, enriching with Place Details...`\n  );\n\n  // Step 2: Enrich each business with Place Details API for complete contact info\n  const enrichedBusinesses = [];\n  for (const business of results) {\n    try {\n      const placeId = business.place_id;\n      if (!placeId) {\n        enrichedBusinesses.push(business);\n        continue;\n      }\n\n      // Fetch complete contact information via Place Details API\n      const detailsUrl = `https://maps.googleapis.com/maps/api/place/details/json?place_id=${placeId}&fields=formatted_phone_number,international_phone_number,website,url&key=${apiKey}`;\n\n      const detailsResponse = await fetch(detailsUrl);\n      const detailsData = await detailsResponse.json();\n\n      if (detailsData.status === \"OK\" && detailsData.result) {\n        // Merge Place Details into business data\n        enrichedBusinesses.push({\n          ...business,\n          formatted_phone_number:\n            detailsData.result.formatted_phone_number || \"\",\n          website: detailsData.result.website || \"\",\n          // Note: Google Places doesn't provide emails directly\n          // Email discovery would require Hunter.io integration\n        });\n      } else {\n        // Keep original data if Place Details fails\n        enrichedBusinesses.push(business);\n      }\n    } catch (error) {\n      console.error(`âš ï¸ Place Details error for ${business.name}:`, error);\n      enrichedBusinesses.push(business); // Keep partial data\n    }\n  }\n\n  console.log(\n    `âœ… Enriched ${enrichedBusinesses.length} businesses with verified contact data`\n  );\n\n  return enrichedBusinesses;\n}\n\nserve(async (req) => {\n  // Handle CORS preflight\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    const startTime = Date.now();\n\n    // Create Supabase client with user's JWT token for validation\n    const authHeader = req.headers.get(\"Authorization\");\n    const supabaseUrl = Deno.env.get(\"SUPABASE_URL\")!;\n    const supabaseAnonKey = Deno.env.get(\"SUPABASE_ANON_KEY\")!;\n\n    // Create client with user's token to validate authentication\n    const supabaseClient = createClient(supabaseUrl, supabaseAnonKey, {\n      global: authHeader ? { headers: { Authorization: authHeader } } : {},\n      auth: {\n        persistSession: false,\n        autoRefreshToken: false,\n      },\n    });\n\n    // Try to validate user session (optional - don't fail if no user)\n    const {\n      data: { user },\n      error: authError,\n    } = await supabaseClient.auth.getUser();\n\n    // Log authentication status\n    if (authError) {\n      console.log(\"âš ï¸  Auth warning:\", authError.message);\n    }\n\n    if (user) {\n      console.log(\n        `âœ… Authenticated user: ${user.id} (anonymous: ${\n          user.is_anonymous || false\n        })`\n      );\n    } else {\n      console.log(\"â„¹ï¸  No authenticated user, proceeding with public access\");\n    }\n\n    // Use the supabaseClient for database operations (has user context if authenticated)\n    const authContext = {\n      client: supabaseClient,\n      isValid: true,\n      keyFormat: \"supabase_client\",\n    };\n\n    // Parse request\n    const requestData: BusinessDiscoveryRequest = await req.json();\n    const {\n      businessType,\n      location,\n      maxResults = 5,\n      budgetLimit = 50,\n      minConfidenceScore = 50,\n    } = requestData;\n\n    console.log(\n      `ðŸš€ Business Discovery: ${businessType} in ${location} (${maxResults} results)`\n    );\n\n    // Get user context from authenticated user (if available)\n    const userContext = getUserContext(\n      req,\n      requestData,\n      user\n        ? {\n            userId: user.id,\n            isAnonymous: user.is_anonymous || false,\n          }\n        : undefined\n    );\n    console.log(`ðŸ‘¤ User Context:`, userContext);\n\n    // Initialize components\n    const qualityScorer = new UserAwareQualityScorer({\n      maxCostPerBusiness: budgetLimit / maxResults,\n    });\n\n    // Step 1: Business discovery with real Google Places API\n    const rawBusinesses = await discoverBusinesses(\n      businessType,\n      location,\n      maxResults\n    );\n    console.log(`ðŸ“Š Found ${rawBusinesses.length} businesses`);\n\n    // Step 2: Score and filter businesses\n    const scoredBusinesses = rawBusinesses.map((business: any) =>\n      qualityScorer.scoreBusiness(business)\n    );\n    const qualifiedLeads = scoredBusinesses\n      .filter((lead: BusinessLead) => lead.optimizedScore >= minConfidenceScore)\n      .slice(0, maxResults);\n\n    console.log(\n      `âœ… Qualified ${qualifiedLeads.length}/${scoredBusinesses.length} businesses`\n    );\n\n    // Step 3: Progressive enrichment via orchestrator\n    console.log(\n      `ðŸ”„ Starting progressive enrichment for ${qualifiedLeads.length} leads...`\n    );\n\n    const enrichedLeads = [];\n    let enrichmentTotalCost = 0;\n\n    for (const lead of qualifiedLeads) {\n      try {\n        // Call enrichment orchestrator for each lead\n        const enrichmentUrl = `https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/enrichment-orchestrator`;\n        console.log(\n          `ðŸ”„ Calling enrichment orchestrator for ${lead.businessName}...`\n        );\n\n        const enrichmentResponse = await fetch(enrichmentUrl, {\n          method: \"POST\",\n          headers: {\n            Authorization: req.headers.get(\"Authorization\") || \"\",\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            businessName: lead.businessName,\n            domain: lead.website\n              ?.replace(/^https?:\\/\\//, \"\")\n              .replace(/\\/$/, \"\"),\n            address: lead.address,\n            phone: lead.phone,\n            website: lead.website,\n\n            // Progressive enrichment configuration\n            includeBusinessLicense: true,\n            discoverEmails: true,\n            verifyEmails: true,\n            includeCompanyEnrichment: false, // Skip PDL to save costs\n            includePersonEnrichment: false, // Skip unless needed\n            apolloEnrichment: false, // Skip unless premium tier\n\n            // Budget controls\n            maxCostPerBusiness: budgetLimit / maxResults,\n            minConfidenceScore: minConfidenceScore,\n            tier: \"professional\",\n          }),\n        });\n\n        if (enrichmentResponse.ok) {\n          const enrichmentData = await enrichmentResponse.json();\n          console.log(\n            `âœ… Enrichment response for ${lead.businessName}:`,\n            JSON.stringify(enrichmentData).substring(0, 200)\n          );\n\n          if (enrichmentData.success) {\n            // Merge enrichment data into lead\n            enrichedLeads.push({\n              ...lead,\n              email:\n                enrichmentData.enrichedData?.emails?.[0]?.email || lead.email,\n              emails: enrichmentData.enrichedData?.emails || [],\n              businessLicense: enrichmentData.enrichedData?.businessLicense,\n              validationCost: lead.validationCost + enrichmentData.totalCost,\n              optimizedScore: Math.min(\n                100,\n                lead.optimizedScore + (enrichmentData.confidenceScore || 0)\n              ),\n              enhancementData: {\n                ...lead.enhancementData,\n                verificationSources: [\n                  ...lead.enhancementData.verificationSources,\n                  ...enrichmentData.processingMetadata.servicesUsed,\n                ],\n                hunterVerified: enrichmentData.enrichedData?.emails?.length > 0,\n                neverBounceVerified: enrichmentData.enrichedData?.emails?.some(\n                  (e: any) => e.verified\n                ),\n                licenseVerified:\n                  enrichmentData.enrichedData?.businessLicense?.isValid ||\n                  false,\n                processingMetadata: {\n                  ...lead.enhancementData.processingMetadata,\n                  totalCost: lead.validationCost + enrichmentData.totalCost,\n                  enrichmentCostBreakdown: enrichmentData.costBreakdown,\n                  servicesUsed: enrichmentData.processingMetadata.servicesUsed,\n                  servicesSkipped:\n                    enrichmentData.processingMetadata.servicesSkipped,\n                },\n              },\n            });\n\n            enrichmentTotalCost += enrichmentData.totalCost;\n            console.log(\n              `âœ… Enriched ${lead.businessName}: +${\n                enrichmentData.enrichedData?.emails?.length || 0\n              } emails, cost $${enrichmentData.totalCost}`\n            );\n          } else {\n            // Keep original lead if enrichment fails\n            enrichedLeads.push(lead);\n            console.log(\n              `âš ï¸ Enrichment failed for ${lead.businessName}, keeping original data`\n            );\n          }\n        } else {\n          const errorText = await enrichmentResponse.text();\n          enrichedLeads.push(lead);\n          console.log(\n            `âš ï¸ Enrichment service returned status ${\n              enrichmentResponse.status\n            } for ${lead.businessName}: ${errorText.substring(0, 200)}`\n          );\n        }\n      } catch (error) {\n        // Keep original lead on error\n        enrichedLeads.push(lead);\n        console.error(`âŒ Enrichment error for ${lead.businessName}:`, error);\n      }\n    }\n\n    console.log(\n      `âœ… Enrichment complete: ${enrichedLeads.length} leads, total cost $${enrichmentTotalCost}`\n    );\n\n    const processingTime = Date.now() - startTime;\n    const totalCost =\n      enrichmentTotalCost +\n      qualifiedLeads.reduce(\n        (sum: number, lead: BusinessLead) => sum + lead.validationCost,\n        0\n      );\n\n    // Generate campaign ID\n    const campaignId = `campaign_${Date.now()}_${Math.random()\n      .toString(36)\n      .substr(2, 9)}`;\n\n    // Store in database with user context and enriched data\n    let dbStorageResult = null;\n    if (authContext.client) {\n      try {\n        // Prepare campaign data with user context\n        const campaignData = {\n          id: campaignId,\n          business_type: businessType,\n          location: location,\n          target_count: maxResults,\n          results_count: enrichedLeads.length,\n          total_cost: totalCost,\n          processing_time_ms: processingTime,\n          status: \"completed\",\n          // Add user_id for authenticated users only\n          ...(userContext.isAuthenticated &&\n            userContext.userId && { user_id: userContext.userId }),\n          // Add session_user_id for anonymous users\n          ...(!userContext.isAuthenticated &&\n            userContext.sessionId && {\n              session_user_id: userContext.sessionId,\n            }),\n        };\n\n        const { error: campaignError } = await authContext.client\n          .from(\"campaigns\")\n          .insert(campaignData);\n\n        if (campaignError) {\n          dbStorageResult = { success: false, error: campaignError.message };\n        } else {\n          dbStorageResult = {\n            success: true,\n            campaign_stored: true,\n            leads_error: null,\n            leads_stored: 0,\n          };\n\n          // Store enriched leads with user context\n          const leadsData = enrichedLeads.map((lead: any) => ({\n            campaign_id: campaignId,\n            business_name: lead.businessName,\n            address: lead.address,\n            phone: lead.phone,\n            website: lead.website,\n            email: lead.email,\n            confidence_score: lead.optimizedScore,\n            enrichment_data: lead.enhancementData,\n            validation_cost: lead.validationCost,\n            // Add user_id for authenticated users only\n            ...(userContext.isAuthenticated &&\n              userContext.userId && { user_id: userContext.userId }),\n            // Add session_user_id for anonymous users\n            ...(!userContext.isAuthenticated &&\n              userContext.sessionId && {\n                session_user_id: userContext.sessionId,\n              }),\n          }));\n\n          const { error: leadsError } = await authContext.client\n            .from(\"leads\")\n            .insert(leadsData);\n\n          if (leadsError) {\n            dbStorageResult.leads_error = leadsError.message;\n          } else {\n            dbStorageResult.leads_stored = leadsData.length;\n          }\n        }\n\n        console.log(`ðŸ’¾ Database storage result:`, dbStorageResult);\n      } catch (error) {\n        dbStorageResult = {\n          success: false,\n          error: error instanceof Error ? error.message : \"Storage failed\",\n          campaign_stored: false,\n          leads_error: null,\n          leads_stored: 0,\n        };\n      }\n    }\n\n    const response = {\n      success: true,\n      campaignId,\n      discoveryEngine:\n        \"ProspectPro Business Discovery v4.2 - User-Aware with Progressive Enrichment\",\n      authentication: {\n        keyFormat: authContext.keyFormat,\n        isValid: authContext.isValid,\n        userContext: {\n          isAuthenticated: userContext.isAuthenticated,\n          hasUserId: !!userContext.userId,\n          hasEmail: !!userContext.userEmail,\n        },\n      },\n      requirements: {\n        targetLeads: maxResults,\n        businessType,\n        location,\n        budgetLimit,\n        minConfidenceScore,\n      },\n      results: {\n        totalFound: enrichedLeads.length,\n        qualified: enrichedLeads.length,\n        qualificationRate: `${(\n          (enrichedLeads.length / rawBusinesses.length) *\n          100\n        ).toFixed(1)}%`,\n        averageConfidence: Math.round(\n          enrichedLeads.reduce(\n            (sum: number, lead: any) => sum + lead.optimizedScore,\n            0\n          ) / enrichedLeads.length\n        ),\n        emailsDiscovered: enrichedLeads.filter((lead: any) => lead.email)\n          .length,\n        licensesVerified: enrichedLeads.filter(\n          (lead: any) => lead.businessLicense?.isValid\n        ).length,\n      },\n      userManagement: {\n        userId: userContext.userId,\n        isAuthenticated: userContext.isAuthenticated,\n        sessionId: userContext.sessionId,\n        campaignOwnership: userContext.userId ? \"user_owned\" : \"session_based\",\n      },\n      optimization: {\n        processingTime: `${processingTime}ms`,\n        totalCost,\n        costPerLead: totalCost / enrichedLeads.length,\n        enrichmentCost: enrichmentTotalCost,\n        discoveryCost: totalCost - enrichmentTotalCost,\n      },\n      database_storage: dbStorageResult,\n      leads: enrichedLeads,\n      metadata: {\n        timestamp: new Date().toISOString(),\n        version: \"4.2\",\n        userAware: true,\n        progressiveEnrichment: true,\n        authenticationUpdated: true,\n      },\n    };\n\n    return new Response(JSON.stringify(response, null, 2), {\n      headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n    });\n  } catch (error) {\n    console.error(\"âŒ Business discovery error:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        timestamp: new Date().toISOString(),\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":12,"duration":0.312},
{"type":"measure","name":"lsp.did_open","count":17,"duration":19.08},
{"type":"mark","name":"lsp.did_open","count":18,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/.eslintrc.cjs","languageId":"javascript","version":1,"text":"module.exports = {\n  root: true,\n  env: {\n    browser: true,\n    node: true,\n    es2021: true,\n  },\n  parser: \"@typescript-eslint/parser\",\n  parserOptions: {\n    ecmaVersion: \"latest\",\n    sourceType: \"module\",\n  },\n  plugins: [\"@typescript-eslint\"],\n  extends: [\"eslint:recommended\", \"plugin:@typescript-eslint/recommended\"],\n  overrides: [\n    {\n      files: [\"**/*.tsx\", \"**/*.jsx\"],\n      plugins: [\"react\", \"react-hooks\"],\n      extends: [\"plugin:react/recommended\", \"plugin:react-hooks/recommended\"],\n      parserOptions: {\n        ecmaVersion: \"latest\",\n        sourceType: \"module\",\n        ecmaFeatures: {\n          jsx: true,\n        },\n      },\n      rules: {\n        \"react/react-in-jsx-scope\": \"off\",\n        \"react/prop-types\": \"off\",\n        \"react/no-unescaped-entities\": \"off\",\n        \"react-hooks/exhaustive-deps\": \"off\",\n      },\n      settings: {\n        react: {\n          version: \"detect\",\n        },\n      },\n    },\n    {\n      files: [\"supabase/functions/**/*.ts\"],\n      env: {\n        node: true,\n      },\n      globals: {\n        Deno: \"readonly\",\n        EdgeRuntime: \"readonly\",\n      },\n      rules: {\n        \"@typescript-eslint/no-explicit-any\": \"off\",\n        \"@typescript-eslint/no-unused-vars\": \"off\",\n        \"no-useless-catch\": \"off\",\n        \"no-case-declarations\": \"off\",\n        \"prefer-const\": \"off\",\n      },\n    },\n  ],\n  rules: {\n    \"@typescript-eslint/no-unused-vars\": \"off\",\n    \"@typescript-eslint/no-explicit-any\": \"off\",\n  },\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":18,"duration":0.795},
{"type":"mark","name":"lsp.did_open","count":19,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/DOCUMENTATION_INDEX.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 Documentation Index\n\n**ðŸš€ Tier-Aware Background Discovery & Verification Platform**\n\n---\n\n## ðŸ“‹ Documentation Overview\n\nProspectPro v4.3 introduces the tier-aware background discovery pipeline with zero-fake-data enforcement. This index points to the live references that back the production system.\n\n---\n\n## ðŸ—ï¸ Core Architecture\n\n- **[Copilot Instructions](.github/copilot-instructions.md)** â€“ Authoritative production guide (deployment, troubleshooting, SLAs)\n- **[README](README.md)** â€“ Platform overview and quickstart\n- **[ARCHITECTURE_DECISION_BACKGROUND_TASKS.md](ARCHITECTURE_DECISION_BACKGROUND_TASKS.md)** â€“ Rationale for asynchronous discovery orchestration\n- **[BACKGROUND_TASKS_IMPLEMENTATION.md](BACKGROUND_TASKS_IMPLEMENTATION.md)** â€“ Implementation notes for `business-discovery-background`\n\n---\n\n## ðŸ–¥ï¸ Frontend Implementation\n\n- **Entry Point:** `index.html`\n- **Application Code:** `src/` (React + Vite)\n  - `src/pages/BusinessDiscovery.tsx` â€“ Campaign creation & monitoring\n  - `src/pages/Dashboard.tsx` â€“ Lead review with verified enrichment metadata\n  - `src/hooks/useLeadEnrichment.ts` â€“ Tier-aware enrichment hooks\n- **Build Command:** `npm run build` (outputs to `/dist` for Vercel deploy)\n\n---\n\n## â˜ï¸ Supabase Edge Functions\n\n### Active Production Functions (v4.3)\n\n- **Discovery**\n  1. `business-discovery-background` â€“ Asynchronous discovery with tier controls _(primary path)_\n  2. `business-discovery-optimized` â€“ Session-aware synchronous path for premium campaign validation\n  3. `business-discovery-user-aware` â€“ Legacy synchronous endpoint maintained for historical clients\n- **Enrichment + Coordination** 4. `enrichment-hunter` â€“ Hunter.io discovery with confidence scoring & caching 5. `enrichment-neverbounce` â€“ NeverBounce verification (95% deliverability floor) 6. `enrichment-orchestrator` â€“ Multi-service enrichment coordination & budgeting 7. `enrichment-business-license` / `enrichment-pdl` â€“ Licensing + PDL enrichment modules (Enterprise/Compliance)\n- **Export** 8. `campaign-export-user-aware` â€“ User-authorized CSV export with RLS isolation 9. `campaign-export` â€“ Service-role export handler for internal automation\n- **Diagnostics** 10. `test-new-auth` â€“ Supabase session diagnostics for the shared helper 11. `test-official-auth` â€“ Mirrors Supabase reference implementation end-to-end 12. `test-business-discovery` â€“ Session-scoped discovery smoke test 13. `test-google-places` â€“ API verification harness\n\n> â„¹ï¸ Session JWTs are mandatory for every authenticated Edge Function call. Refer to `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md` and `scripts/test-auth-patterns.sh` for validation workflows.\n\n### Key Sources\n\n- Edge function implementations: `/supabase/functions/`\n- Shared auth utilities: `/supabase/functions/_shared/`\n- Deployment command: `supabase functions deploy <function-name>`\n\n---\n\n## ðŸ—„ï¸ Database & Security\n\n- **Schema Files:** `/database/`\n  - `supabase-first-schema.sql` â€“ Canonical schema\n  - `rls-setup.sql` â€“ Row Level Security enforcement\n  - `user-campaign-production-update.sql` â€“ Authenticated ownership columns\n- **Core Tables:** `campaigns`, `leads`, `dashboard_exports`\n- **Security Model:** JWT-authenticated access with user_id + session_user_id; anonymous fallback removed from production\n\n---\n\n## ðŸ” Authentication & Session Handling\n\n- Supabase Auth with JWT tokens (\n  - Frontend enforces sign-in before campaign creation\n  - Session context passed through background discovery payloads\n- Shared auth utilities: `/supabase/functions/_shared/edge-auth.ts`\n- Refer to `AUTHENTICATION_COMPLETE.md` for the end-to-end auth hardening log\n\n---\n\n## ðŸ§ª Testing & Validation\n\n- **Unit / Integration:** `npm run test`\n- **ESLint:** `npm run lint` (configured via `.eslintrc.cjs` & `.eslintignore`)\n- **Edge Function Smoke Tests:**\n  - `supabase functions serve business-discovery-background`\n  - `scripts/test-background-tasks.sh`\n- **Manual curl probes:** see `.github/copilot-instructions.md` â†’ â€œDebugging Commandsâ€\n\n---\n\n## ðŸš€ Deployment Workflow\n\n1. Install dependencies: `npm install`\n2. Build frontend: `npm run build`\n3. Deploy static assets: from `/dist` run `vercel --prod`\n4. Deploy edge functions: `supabase functions deploy <name>`\n5. Verify using curl or the Supabase dashboard logs\n\nSupporting scripts:\n\n- `scripts/deploy-background-tasks.sh` â€“ Batch deploy of background discovery stack\n- `scripts/test-background-tasks.sh` â€“ Validates discovery + export loop\n- `scripts/repository-cleanup.sh` â€“ Ensures Supabase-first project hygiene\n\n---\n\n## ðŸŒ Production Environment Snapshot\n\n- **Frontend:** https://prospect-fyhedobh1-appsmithery.vercel.app (Vercel static hosting)\n- **Supabase Project:** `sriycekxdqnesdsgwiuc`\n- **Edge Function URL Base:** `https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/`\n- **Publishable Key Management:** Supabase dashboard â†’ Settings â†’ API (sync with `/src/lib/supabase.ts`)\n- **Session Tokens:** Frontend/services must forward `Authorization: Bearer <SUPABASE_SESSION_JWT>`\n- **Session Tokens:** Frontend + services must forward Supabase session JWTs (`Authorization: Bearer <token>`) per `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md`\n\n---\n\n## ðŸ“ˆ Business Intelligence Features\n\n- MECE taxonomy (`src/constants/businessTaxonomy.ts`) with 16 categories / 300+ business types\n- Verified contact enrichment via Hunter.io + NeverBounce + licensing data\n- Tier-aware budgets & scoring: see `supabase/functions/enrichment-orchestrator/`\n- Export metadata retained in `leads.enrichment_data` JSONB field\n\n---\n\n## ðŸ› ï¸ Troubleshooting Quicklinks\n\n- **Publishable key or session mismatch:** See `NEED_ANON_KEY.md` (legacy) and `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md`\n- **Edge function auth issues:** `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md`\n- **Deployment checklist:** `DEPLOYMENT_CHECKLIST.md`\n- **Environment sync:** `populate-secrets.sh`, `pull-env-from-secrets.js`\n- **MCP troubleshooting server:** `mcp-servers/` directory (see `README` inside)\n\n---\n\n## ðŸŽ¯ Quick Command Reference\n\n```bash\n# Background discovery smoke test (session JWT required)\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\":\"coffee shop\",\"location\":\"Seattle, WA\",\"maxResults\":2,\"tierKey\":\"PROFESSIONAL\",\"sessionUserId\":\"test_session_123\"}'\n\n# Export campaign results\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"campaignId\":\"<CAMPAIGN_ID>\",\"format\":\"csv\",\"sessionUserId\":\"test_session_123\"}'\n\n# Auth diagnostics (compare helper vs official pattern)\n./scripts/test-auth-patterns.sh <SUPABASE_SESSION_JWT>\n\n# Lint & build guard rails\nnpm run lint\nnpm run build\n```\n\n---\n\n## ðŸ—“ï¸ Release Timeline\n\n- **v4.1** â€“ Verification-first enrichment pipeline\n- **v4.2** â€“ Authenticated user-aware discovery (deprecated backend retained only for exports)\n- **v4.3** â€“ Tier-aware background discovery, lint tooling alignment, legacy asset removal\n\nFor historical artifacts see `/archive/`.\n\n### Key URLs\n\n- **Production App:** https://prospect-fyhedobh1-appsmithery.vercel.app\n- **Supabase Dashboard:** https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc\n- **GitHub Repository:** https://github.com/Alextorelli/ProspectPro\n\n---\n\n**ProspectPro v4.3** â€“ Tier-Aware Background Discovery & Session-Enforced Edge Functions  \n_Documentation updated October 9, 2025_ ðŸš€\n"}}},
{"type":"measure","name":"lsp.did_open","count":19,"duration":0.08},
{"type":"mark","name":"lsp.did_open","count":20,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/database/job-queue-schema.sql","languageId":"sql","version":1,"text":"-- Job Queue System for Background Processing\n-- ProspectPro v4.2 - Background Task Architecture\n\n-- Discovery jobs table (tracks long-running campaigns)\nCREATE TABLE IF NOT EXISTS discovery_jobs (\n  id TEXT PRIMARY KEY,\n  campaign_id TEXT, -- No foreign key constraint (campaign created later)\n  user_id UUID REFERENCES auth.users(id),\n  session_user_id TEXT,\n  \n  -- Job status\n  status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'processing', 'completed', 'failed')),\n  progress INTEGER DEFAULT 0 CHECK (progress >= 0 AND progress <= 100),\n  current_stage TEXT DEFAULT 'initializing',\n  \n  -- Configuration\n  config JSONB NOT NULL,\n  \n  -- Results\n  results JSONB DEFAULT '[]'::jsonb,\n  metrics JSONB DEFAULT '{}'::jsonb,\n  error TEXT,\n  \n  -- Timestamps\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  started_at TIMESTAMPTZ,\n  completed_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Indexes for performance\nCREATE INDEX IF NOT EXISTS idx_jobs_status ON discovery_jobs(status) WHERE status IN ('pending', 'processing');\nCREATE INDEX IF NOT EXISTS idx_jobs_user ON discovery_jobs(user_id);\nCREATE INDEX IF NOT EXISTS idx_jobs_session ON discovery_jobs(session_user_id);\nCREATE INDEX IF NOT EXISTS idx_jobs_campaign ON discovery_jobs(campaign_id);\nCREATE INDEX IF NOT EXISTS idx_jobs_created ON discovery_jobs(created_at DESC);\n\n-- RLS Policies for user isolation\nALTER TABLE discovery_jobs ENABLE ROW LEVEL SECURITY;\n\n-- Users can only see their own jobs\nDROP POLICY IF EXISTS jobs_select_own ON discovery_jobs;\nCREATE POLICY jobs_select_own ON discovery_jobs\n  FOR SELECT\n  USING (\n    auth.uid() = user_id OR\n    (auth.uid() IS NULL AND session_user_id IS NOT NULL)\n  );\n\n-- Users can only insert their own jobs\nDROP POLICY IF EXISTS jobs_insert_own ON discovery_jobs;\nCREATE POLICY jobs_insert_own ON discovery_jobs\n  FOR INSERT\n  WITH CHECK (\n    auth.uid() = user_id OR\n    (auth.uid() IS NULL AND session_user_id IS NOT NULL)\n  );\n\n-- Update trigger to maintain updated_at\nDROP TRIGGER IF EXISTS trigger_update_discovery_jobs_updated_at ON discovery_jobs;\nCREATE OR REPLACE FUNCTION update_discovery_jobs_updated_at()\nRETURNS TRIGGER\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$;\n\nCREATE TRIGGER trigger_update_discovery_jobs_updated_at\n  BEFORE UPDATE ON discovery_jobs\n  FOR EACH ROW\n  EXECUTE FUNCTION update_discovery_jobs_updated_at();\n\n-- Function to clean up old completed jobs (optional, run periodically)\nCREATE OR REPLACE FUNCTION cleanup_old_jobs(retention_days INTEGER DEFAULT 30)\nRETURNS INTEGER\nLANGUAGE plpgsql\nSECURITY DEFINER\nSET search_path = public, pg_temp\nAS $$\nDECLARE\n  deleted_count INTEGER;\nBEGIN\n  DELETE FROM discovery_jobs\n  WHERE status IN ('completed', 'failed')\n    AND completed_at < NOW() - (retention_days || ' days')::INTERVAL;\n  \n  GET DIAGNOSTICS deleted_count = ROW_COUNT;\n  RETURN deleted_count;\nEND;\n$$;\n\nCOMMENT ON TABLE discovery_jobs IS 'Background job queue for business discovery campaigns';\nCOMMENT ON COLUMN discovery_jobs.config IS 'JSON config: {businessType, location, tier, maxResults, etc}';\nCOMMENT ON COLUMN discovery_jobs.results IS 'JSON array of discovered and enriched leads';\nCOMMENT ON COLUMN discovery_jobs.metrics IS 'JSON metrics: {totalCost, processingTime, apisUsed, etc}';\n"}}},
{"type":"measure","name":"lsp.did_open","count":20,"duration":0.041},
{"type":"mark","name":"lsp.did_open","count":21,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/database/fix-foreign-key-constraint.sql","languageId":"sql","version":1,"text":"-- Fix Foreign Key Constraint Issue\n-- ProspectPro v4.2 - Database Migration\n\n-- Step 1: Drop the existing discovery_jobs table if it exists\n-- (This is safe since we haven't deployed to production yet)\nDROP TABLE IF EXISTS discovery_jobs CASCADE;\n\n-- Step 2: Recreate the table without the foreign key constraint\nCREATE TABLE discovery_jobs (\n  id TEXT PRIMARY KEY,\n  campaign_id TEXT, -- No FK constraint - campaign is created later\n  user_id UUID REFERENCES auth.users(id),\n  session_user_id TEXT,\n  \n  -- Job status\n  status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'processing', 'completed', 'failed')),\n  progress INTEGER DEFAULT 0 CHECK (progress >= 0 AND progress <= 100),\n  current_stage TEXT DEFAULT 'initializing',\n  \n  -- Configuration\n  config JSONB NOT NULL,\n  \n  -- Results\n  results JSONB DEFAULT '[]'::jsonb,\n  metrics JSONB DEFAULT '{}'::jsonb,\n  error TEXT,\n  \n  -- Timestamps\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  started_at TIMESTAMPTZ,\n  completed_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Indexes for performance\nCREATE INDEX IF NOT EXISTS idx_jobs_status ON discovery_jobs(status) WHERE status IN ('pending', 'processing');\nCREATE INDEX IF NOT EXISTS idx_jobs_user ON discovery_jobs(user_id);\nCREATE INDEX IF NOT EXISTS idx_jobs_session ON discovery_jobs(session_user_id);\nCREATE INDEX IF NOT EXISTS idx_jobs_campaign ON discovery_jobs(campaign_id);\nCREATE INDEX IF NOT EXISTS idx_jobs_created ON discovery_jobs(created_at DESC);\n\n-- RLS Policies for user isolation\nALTER TABLE discovery_jobs ENABLE ROW LEVEL SECURITY;\n\n-- Users can only see their own jobs\nDROP POLICY IF EXISTS jobs_select_own ON discovery_jobs;\nCREATE POLICY jobs_select_own ON discovery_jobs\n  FOR SELECT\n  USING (\n    auth.uid() = user_id OR\n    (auth.uid() IS NULL AND session_user_id IS NOT NULL)\n  );\n\n-- Users can only insert their own jobs\nDROP POLICY IF EXISTS jobs_insert_own ON discovery_jobs;\nCREATE POLICY jobs_insert_own ON discovery_jobs\n  FOR INSERT\n  WITH CHECK (\n    auth.uid() = user_id OR\n    (auth.uid() IS NULL AND session_user_id IS NOT NULL)\n  );\n\n-- Update trigger to maintain updated_at\nDROP TRIGGER IF EXISTS trigger_update_discovery_jobs_updated_at ON discovery_jobs;\nCREATE OR REPLACE FUNCTION update_discovery_jobs_updated_at()\nRETURNS TRIGGER\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$;\n\nCREATE TRIGGER trigger_update_discovery_jobs_updated_at\n  BEFORE UPDATE ON discovery_jobs\n  FOR EACH ROW\n  EXECUTE FUNCTION update_discovery_jobs_updated_at();\n\n-- Function to clean up old completed jobs (optional, run periodically)\nCREATE OR REPLACE FUNCTION cleanup_old_jobs(retention_days INTEGER DEFAULT 30)\nRETURNS INTEGER\nLANGUAGE plpgsql\nSECURITY DEFINER\nSET search_path = public, pg_temp\nAS $$\nDECLARE\n  deleted_count INTEGER;\nBEGIN\n  DELETE FROM discovery_jobs\n  WHERE status IN ('completed', 'failed')\n    AND completed_at < NOW() - (retention_days || ' days')::INTERVAL;\n  \n  GET DIAGNOSTICS deleted_count = ROW_COUNT;\n  RETURN deleted_count;\nEND;\n$$;\n\nCOMMENT ON TABLE discovery_jobs IS 'Background job queue for business discovery campaigns';\nCOMMENT ON COLUMN discovery_jobs.campaign_id IS 'Campaign ID (no FK constraint - campaign created after job)';\nCOMMENT ON COLUMN discovery_jobs.config IS 'JSON config: {businessType, location, tier, maxResults, etc}';\nCOMMENT ON COLUMN discovery_jobs.results IS 'JSON array of discovered and enriched leads';\nCOMMENT ON COLUMN discovery_jobs.metrics IS 'JSON metrics: {totalCost, processingTime, apisUsed, etc}';\n"}}},
{"type":"measure","name":"lsp.did_open","count":21,"duration":0.041},
{"type":"mark","name":"lsp.did_open","count":22,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/database/auth-and-payments-schema.sql","languageId":"sql","version":1,"text":"-- ProspectPro Auth & Payments Schema Update\n-- October 7, 2025 - Production Ready Features\n\n-- =============================================================================\n-- PART 1: Campaign Naming & Ownership Enhancements\n-- =============================================================================\n\n-- Add campaign naming and enhanced user management\nALTER TABLE public.campaigns \nADD COLUMN IF NOT EXISTS generated_name VARCHAR(100),\nADD COLUMN IF NOT EXISTS display_name VARCHAR(200),\nADD COLUMN IF NOT EXISTS name_components JSONB,\nADD COLUMN IF NOT EXISTS user_budget DECIMAL(10,4) DEFAULT 50.0,\nADD COLUMN IF NOT EXISTS budget_alerts_enabled BOOLEAN DEFAULT true;\n\n-- Create index for efficient campaign searching\nCREATE INDEX IF NOT EXISTS idx_campaigns_generated_name ON public.campaigns(generated_name);\nCREATE INDEX IF NOT EXISTS idx_campaigns_user_budget ON public.campaigns(user_budget);\n\n-- =============================================================================\n-- PART 2: User Profiles & Payment Information\n-- =============================================================================\n\n-- User profiles table (extends Supabase auth.users)\nCREATE TABLE IF NOT EXISTS public.user_profiles (\n  id UUID REFERENCES auth.users(id) PRIMARY KEY,\n  email TEXT,\n  full_name TEXT,\n  avatar_url TEXT,\n  subscription_tier TEXT DEFAULT 'free',\n  total_spent DECIMAL(10,4) DEFAULT 0,\n  monthly_budget DECIMAL(10,4) DEFAULT 100.0,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Payment methods table (Stripe integration)\nCREATE TABLE IF NOT EXISTS public.payment_methods (\n  id BIGSERIAL PRIMARY KEY,\n  user_id UUID REFERENCES auth.users(id),\n  stripe_payment_method_id TEXT NOT NULL,\n  type TEXT NOT NULL, -- 'card', 'bank_account', etc.\n  last_four TEXT,\n  brand TEXT, -- 'visa', 'mastercard', etc.\n  exp_month INTEGER,\n  exp_year INTEGER,\n  is_default BOOLEAN DEFAULT false,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Payment transactions table\nCREATE TABLE IF NOT EXISTS public.payment_transactions (\n  id BIGSERIAL PRIMARY KEY,\n  user_id UUID REFERENCES auth.users(id),\n  campaign_id TEXT REFERENCES public.campaigns(id),\n  stripe_payment_intent_id TEXT,\n  amount DECIMAL(10,4) NOT NULL,\n  currency TEXT DEFAULT 'usd',\n  status TEXT NOT NULL, -- 'pending', 'succeeded', 'failed'\n  description TEXT,\n  created_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- =============================================================================\n-- PART 3: Enhanced RLS Policies\n-- =============================================================================\n\n-- Enable RLS on new tables\nALTER TABLE public.user_profiles ENABLE ROW LEVEL SECURITY;\nALTER TABLE public.payment_methods ENABLE ROW LEVEL SECURITY;\nALTER TABLE public.payment_transactions ENABLE ROW LEVEL SECURITY;\n\n-- User profiles policies\nCREATE POLICY \"Users can view own profile\" ON public.user_profiles\n  FOR SELECT USING (auth.uid() = id);\n\nCREATE POLICY \"Users can update own profile\" ON public.user_profiles\n  FOR UPDATE USING (auth.uid() = id);\n\nCREATE POLICY \"Users can insert own profile\" ON public.user_profiles\n  FOR INSERT WITH CHECK (auth.uid() = id);\n\n-- Payment methods policies\nCREATE POLICY \"Users can view own payment methods\" ON public.payment_methods\n  FOR SELECT USING (auth.uid() = user_id);\n\nCREATE POLICY \"Users can manage own payment methods\" ON public.payment_methods\n  FOR ALL USING (auth.uid() = user_id);\n\n-- Payment transactions policies\nCREATE POLICY \"Users can view own transactions\" ON public.payment_transactions\n  FOR SELECT USING (auth.uid() = user_id);\n\n-- =============================================================================\n-- PART 4: Campaign Naming Functions\n-- =============================================================================\n\n-- Generate campaign name function\nCREATE OR REPLACE FUNCTION public.generate_campaign_name(\n  business_type TEXT,\n  location TEXT,\n  user_id UUID DEFAULT NULL\n)\nRETURNS TEXT\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nDECLARE\n  business_code TEXT;\n  location_code TEXT;\n  date_string TEXT;\n  time_string TEXT;\n  user_code TEXT;\n  campaign_name TEXT;\nBEGIN\n  -- Generate business type code (first 4 letters, uppercase)\n  business_code := UPPER(LEFT(REGEXP_REPLACE(business_type, '[^a-zA-Z]', '', 'g'), 4));\n  \n  -- Generate location code (first 4 letters, uppercase)\n  location_code := UPPER(LEFT(REGEXP_REPLACE(location, '[^a-zA-Z]', '', 'g'), 4));\n  \n  -- Generate date and time strings\n  date_string := TO_CHAR(NOW(), 'YYYYMMDD');\n  time_string := TO_CHAR(NOW(), 'HH24MISS');\n  \n  -- Generate user code (last 6 chars of user_id or random for anonymous)\n  IF user_id IS NOT NULL THEN\n    user_code := RIGHT(user_id::TEXT, 6);\n  ELSE\n    user_code := SUBSTRING(MD5(RANDOM()::TEXT) FROM 1 FOR 6);\n  END IF;\n  \n  -- Combine into final campaign name\n  campaign_name := business_code || '_' || location_code || '_' || date_string || '_' || time_string || '_' || user_code;\n  \n  RETURN campaign_name;\nEND;\n$$;\n\n-- Auto-generate campaign names trigger\nCREATE OR REPLACE FUNCTION public.auto_generate_campaign_name()\nRETURNS TRIGGER\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  -- Only generate if not already set\n  IF NEW.generated_name IS NULL OR NEW.generated_name = '' THEN\n    NEW.generated_name := public.generate_campaign_name(\n      NEW.business_type,\n      NEW.location,\n      NEW.user_id\n    );\n  END IF;\n  \n  -- Set display name if not provided\n  IF NEW.display_name IS NULL OR NEW.display_name = '' THEN\n    NEW.display_name := NEW.business_type || ' in ' || NEW.location;\n  END IF;\n  \n  -- Store name components\n  NEW.name_components := jsonb_build_object(\n    'business_type', NEW.business_type,\n    'location', NEW.location,\n    'generated_at', NOW(),\n    'user_id', NEW.user_id\n  );\n  \n  RETURN NEW;\nEND;\n$$;\n\n-- Create trigger\nDROP TRIGGER IF EXISTS trigger_auto_generate_campaign_name ON public.campaigns;\nCREATE TRIGGER trigger_auto_generate_campaign_name\n  BEFORE INSERT ON public.campaigns\n  FOR EACH ROW\n  EXECUTE FUNCTION public.auto_generate_campaign_name();\n\n-- =============================================================================\n-- PART 5: User Profile Management Functions\n-- =============================================================================\n\n-- Create or update user profile\nCREATE OR REPLACE FUNCTION public.handle_new_user()\nRETURNS TRIGGER\nLANGUAGE plpgsql\nSECURITY DEFINER\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  INSERT INTO public.user_profiles (id, email, full_name, avatar_url)\n  VALUES (\n    NEW.id,\n    NEW.email,\n    NEW.raw_user_meta_data->>'full_name',\n    NEW.raw_user_meta_data->>'avatar_url'\n  )\n  ON CONFLICT (id) DO UPDATE SET\n    email = EXCLUDED.email,\n    full_name = EXCLUDED.full_name,\n    avatar_url = EXCLUDED.avatar_url,\n    updated_at = NOW();\n  \n  RETURN NEW;\nEND;\n$$;\n\n-- Trigger for user profile creation\nDROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;\nCREATE TRIGGER on_auth_user_created\n  AFTER INSERT OR UPDATE ON auth.users\n  FOR EACH ROW\n  EXECUTE FUNCTION public.handle_new_user();\n\n-- =============================================================================\n-- PART 6: Budget and Spending Tracking\n-- =============================================================================\n\n-- Update user spending function\nCREATE OR REPLACE FUNCTION public.update_user_spending(\n  user_id_param UUID,\n  amount_param DECIMAL(10,4)\n)\nRETURNS VOID\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  UPDATE public.user_profiles\n  SET \n    total_spent = total_spent + amount_param,\n    updated_at = NOW()\n  WHERE id = user_id_param;\nEND;\n$$;\n\n-- =============================================================================\n-- PART 7: Enhanced Views\n-- =============================================================================\n\n-- Campaign analytics with user info\nCREATE OR REPLACE VIEW public.campaign_analytics_enhanced\nWITH (security_invoker = true)\nAS SELECT\n  c.id,\n  c.generated_name,\n  c.display_name,\n  c.business_type,\n  c.location,\n  c.target_count,\n  c.min_confidence_score,\n  c.status,\n  c.results_count,\n  c.total_cost,\n  c.user_budget,\n  c.budget_limit,\n  c.processing_time_ms,\n  c.created_at,\n  c.user_id,\n  c.session_user_id,\n  up.email as user_email,\n  up.full_name as user_name,\n  COUNT(l.id) AS actual_leads,\n  COALESCE(AVG(l.confidence_score), 0)::numeric(10,2) AS avg_confidence,\n  (c.total_cost <= c.user_budget) AS within_budget\nFROM campaigns c\nLEFT JOIN leads l ON l.campaign_id = c.id\nLEFT JOIN user_profiles up ON up.id = c.user_id\nWHERE\n  c.user_id = auth.uid() OR\n  (auth.uid() IS NULL AND c.session_user_id IS NOT NULL)\nGROUP BY c.id, c.generated_name, c.display_name, c.business_type, c.location, \n         c.target_count, c.min_confidence_score, c.status, c.results_count, \n         c.total_cost, c.user_budget, c.budget_limit, c.processing_time_ms, \n         c.created_at, c.user_id, c.session_user_id, up.email, up.full_name;\n\n-- =============================================================================\n-- MIGRATION COMPLETE\n-- =============================================================================\n\n-- Test the campaign name generation\nSELECT public.generate_campaign_name('coffee shop', 'Seattle, WA', NULL) as test_campaign_name;\n\nCOMMENT ON TABLE public.user_profiles IS 'Extended user profiles with subscription and budget info';\nCOMMENT ON TABLE public.payment_methods IS 'User payment methods stored via Stripe';\nCOMMENT ON TABLE public.payment_transactions IS 'Payment transaction history';\nCOMMENT ON FUNCTION public.generate_campaign_name IS 'Generates standardized campaign names';\nCOMMENT ON VIEW public.campaign_analytics_enhanced IS 'Enhanced campaign analytics with user context';\n\n-- Final status\nDO $$\nBEGIN\n  RAISE NOTICE '';\n  RAISE NOTICE 'ðŸ” ProspectPro Auth & Payments Schema - October 7, 2025';\n  RAISE NOTICE '================================================================';\n  RAISE NOTICE 'âœ… Campaign naming system implemented';\n  RAISE NOTICE 'âœ… User profiles and payment tables created';\n  RAISE NOTICE 'âœ… Enhanced RLS policies applied';\n  RAISE NOTICE 'âœ… Budget tracking functions added';\n  RAISE NOTICE 'âœ… Auto-trigger for campaign naming enabled';\n  RAISE NOTICE '';\n  RAISE NOTICE 'Ready for: Auth integration, Stripe payments, UI updates';\n  RAISE NOTICE '';\nEND $$;"}}},
{"type":"measure","name":"lsp.did_open","count":22,"duration":0.089},
{"type":"mark","name":"lsp.did_open","count":23,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/database/security-update-oct-2025.sql","languageId":"sql","version":1,"text":"-- ProspectPro Security Update - October 3, 2025\n-- Addresses: Legacy API key migration, SECURITY DEFINER fixes, function search_path warnings\n-- Status: Production-ready security hardening for new Supabase API key format\n\n-- =============================================================================\n-- PART 1: Fix SECURITY DEFINER Views (High Priority)\n-- =============================================================================\n\n-- Issue: Views with SECURITY DEFINER inheritance can create privilege escalation\n-- Solution: Recreate views with security_invoker = true\n\n-- Fix enrichment_cache_analytics view\nDROP VIEW IF EXISTS public.enrichment_cache_analytics CASCADE;\nCREATE VIEW public.enrichment_cache_analytics\nWITH (security_invoker = true) AS\nSELECT \n  request_type,\n  COUNT(*) as total_entries,\n  SUM(COALESCE(hit_count, 0)) as total_hits,\n  AVG(COALESCE(confidence_score, 0)) as avg_confidence,\n  SUM(COALESCE(cost, 0)) as total_cost_saved,\n  ROUND(AVG(COALESCE(hit_count, 0)), 2) as avg_hit_count,\n  MIN(created_at) as oldest_entry,\n  MAX(last_accessed_at) as last_activity,\n  COUNT(*) FILTER (WHERE expires_at > NOW()) as active_entries,\n  COUNT(*) FILTER (WHERE expires_at <= NOW()) as expired_entries\nFROM public.enrichment_cache\nWHERE request_type IS NOT NULL\nGROUP BY request_type\nORDER BY total_hits DESC;\n\n-- Fix cache_performance_summary view\nDROP VIEW IF EXISTS public.cache_performance_summary CASCADE;\nCREATE VIEW public.cache_performance_summary\nWITH (security_invoker = true) AS\nSELECT \n  date,\n  SUM(COALESCE(total_requests, 0)) as daily_requests,\n  SUM(COALESCE(cache_hits, 0)) as daily_hits,\n  SUM(COALESCE(cache_misses, 0)) as daily_misses,\n  ROUND(\n    CASE \n      WHEN SUM(COALESCE(total_requests, 0)) > 0 \n      THEN SUM(COALESCE(cache_hits, 0))::DECIMAL / SUM(COALESCE(total_requests, 0)) * 100 \n      ELSE 0 \n    END, \n    2\n  ) as daily_hit_ratio,\n  SUM(COALESCE(cost_saved, 0)) as daily_cost_saved,\n  SUM(COALESCE(total_cost, 0)) as daily_total_cost\nFROM public.enrichment_cache_stats\nWHERE date IS NOT NULL\nGROUP BY date\nORDER BY date DESC;\n\n-- Fix campaign_analytics view (if exists with SECURITY DEFINER)\nDROP VIEW IF EXISTS public.campaign_analytics CASCADE;\nCREATE VIEW public.campaign_analytics\nWITH (security_invoker = true) AS\nSELECT\n  c.id,\n  c.business_type,\n  c.location,\n  c.target_count,\n  c.min_confidence_score,\n  c.status,\n  c.results_count,\n  c.total_cost,\n  c.budget_limit,\n  c.processing_time_ms,\n  c.created_at,\n  COUNT(l.id) AS actual_leads,\n  COALESCE(AVG(l.confidence_score), 0)::numeric(10,2) AS avg_confidence\nFROM public.campaigns c\nLEFT JOIN public.leads l ON l.campaign_id = c.id\nGROUP BY c.id, c.business_type, c.location, c.target_count, c.min_confidence_score,\n         c.status, c.results_count, c.total_cost, c.budget_limit, c.processing_time_ms, c.created_at;\n\n-- =============================================================================\n-- PART 2: Fix Function Search Path Warnings (Security Critical)\n-- =============================================================================\n\n-- Issue: Functions without explicit search_path can be vulnerable to search_path hijacking\n-- Solution: Set explicit search_path for all functions\n\n-- Fix generate_cache_key function\nCREATE OR REPLACE FUNCTION public.generate_cache_key(\n  p_request_type TEXT,\n  p_params JSONB\n) RETURNS TEXT \nSET search_path = public\nLANGUAGE plpgsql \nIMMUTABLE \nSECURITY DEFINER\nAS $$\nBEGIN\n  RETURN encode(\n    digest(\n      COALESCE(p_request_type, '') || '::' || COALESCE(p_params::text, '{}'),\n      'sha256'\n    ),\n    'hex'\n  );\nEND;\n$$;\n\n-- Fix get_cached_response function\nCREATE OR REPLACE FUNCTION public.get_cached_response(\n  p_cache_key TEXT\n) RETURNS JSONB \nSET search_path = public\nLANGUAGE plpgsql \nSECURITY DEFINER\nAS $$\nDECLARE\n  cached_data JSONB;\nBEGIN\n  SELECT response_data INTO cached_data\n  FROM public.enrichment_cache\n  WHERE cache_key = p_cache_key\n    AND expires_at > NOW()\n    AND is_active = true;\n  \n  IF FOUND THEN\n    -- Update hit count and last accessed time\n    UPDATE public.enrichment_cache\n    SET hit_count = COALESCE(hit_count, 0) + 1,\n        last_accessed_at = NOW()\n    WHERE cache_key = p_cache_key;\n  END IF;\n  \n  RETURN cached_data;\nEND;\n$$;\n\n-- Fix store_cached_response function\nCREATE OR REPLACE FUNCTION public.store_cached_response(\n  p_cache_key TEXT,\n  p_request_type TEXT,\n  p_response_data JSONB,\n  p_confidence_score INTEGER DEFAULT 0,\n  p_cost DECIMAL(10,4) DEFAULT 0,\n  p_expires_at TIMESTAMPTZ DEFAULT NULL\n) RETURNS BOOLEAN \nSET search_path = public\nLANGUAGE plpgsql \nSECURITY DEFINER\nAS $$\nBEGIN\n  INSERT INTO public.enrichment_cache (\n    cache_key,\n    request_type,\n    response_data,\n    confidence_score,\n    cost,\n    expires_at,\n    created_at,\n    last_accessed_at,\n    hit_count,\n    is_active\n  ) VALUES (\n    p_cache_key,\n    p_request_type,\n    p_response_data,\n    p_confidence_score,\n    p_cost,\n    COALESCE(p_expires_at, NOW() + INTERVAL '24 hours'),\n    NOW(),\n    NOW(),\n    0,\n    true\n  ) ON CONFLICT (cache_key) DO UPDATE SET\n    response_data = EXCLUDED.response_data,\n    confidence_score = EXCLUDED.confidence_score,\n    cost = EXCLUDED.cost,\n    expires_at = EXCLUDED.expires_at,\n    last_accessed_at = NOW(),\n    is_active = true;\n  \n  RETURN true;\nEND;\n$$;\n\n-- Fix cleanup_expired_cache function\nCREATE OR REPLACE FUNCTION public.cleanup_expired_cache()\nRETURNS INTEGER \nSET search_path = public\nLANGUAGE plpgsql \nSECURITY DEFINER\nAS $$\nDECLARE\n  deleted_count INTEGER;\nBEGIN\n  DELETE FROM public.enrichment_cache\n  WHERE expires_at <= NOW()\n    OR is_active = false;\n  \n  GET DIAGNOSTICS deleted_count = ROW_COUNT;\n  \n  RETURN deleted_count;\nEND;\n$$;\n\n-- =============================================================================\n-- PART 3: Update RLS Policies for New API Key Format\n-- =============================================================================\n\n-- The new API key format requires updated RLS policies\n-- Ensure compatibility with both legacy and new key formats during transition\n\n-- Update campaigns table policies\nDROP POLICY IF EXISTS \"campaigns_anon_access\" ON public.campaigns;\nCREATE POLICY \"campaigns_anon_access\" ON public.campaigns\n    FOR ALL TO anon \n    USING (true) \n    WITH CHECK (true);\n\n-- Update leads table policies  \nDROP POLICY IF EXISTS \"leads_anon_access\" ON public.leads;\nCREATE POLICY \"leads_anon_access\" ON public.leads\n    FOR ALL TO anon \n    USING (true) \n    WITH CHECK (true);\n\n-- Update dashboard_exports table policies\nDROP POLICY IF EXISTS \"exports_anon_access\" ON public.dashboard_exports;\nCREATE POLICY \"exports_anon_access\" ON public.dashboard_exports\n    FOR ALL TO anon \n    USING (true) \n    WITH CHECK (true);\n\n-- =============================================================================\n-- PART 4: Add New API Key Format Support\n-- =============================================================================\n\n-- Create function to validate new API key format\nCREATE OR REPLACE FUNCTION public.validate_api_key_format(api_key TEXT)\nRETURNS BOOLEAN \nSET search_path = public\nLANGUAGE plpgsql \nIMMUTABLE\nAS $$\nBEGIN\n  -- Check for new publishable key format (sb_publishable_*)\n  IF api_key LIKE 'sb_publishable_%' THEN\n    RETURN true;\n  END IF;\n  \n  -- Check for new secret key format (sb_secret_*)\n  IF api_key LIKE 'sb_secret_%' THEN\n    RETURN true;\n  END IF;\n  \n  -- Legacy JWT format support (for backward compatibility)\n  IF api_key LIKE 'eyJ%' AND LENGTH(api_key) > 100 THEN\n    RETURN true;\n  END IF;\n  \n  RETURN false;\nEND;\n$$;\n\n-- =============================================================================\n-- PART 5: Security Monitoring and Validation\n-- =============================================================================\n\n-- Create enhanced security validation function\nCREATE OR REPLACE FUNCTION public.validate_security_configuration()\nRETURNS JSONB \nSET search_path = public\nLANGUAGE plpgsql \nAS $$\nDECLARE\n  result JSONB;\n  rls_count INTEGER;\n  policy_count INTEGER;\n  function_count INTEGER;\n  view_count INTEGER;\nBEGIN\n  -- Count RLS-enabled tables\n  SELECT COUNT(*) INTO rls_count\n  FROM pg_tables t\n  JOIN pg_class c ON c.relname = t.tablename\n  WHERE t.schemaname = 'public'\n    AND c.relrowsecurity = true\n    AND t.tablename IN ('campaigns', 'leads', 'dashboard_exports');\n  \n  -- Count security policies\n  SELECT COUNT(*) INTO policy_count\n  FROM pg_policies\n  WHERE schemaname = 'public'\n    AND tablename IN ('campaigns', 'leads', 'dashboard_exports');\n  \n  -- Count functions with proper search_path\n  SELECT COUNT(*) INTO function_count\n  FROM pg_proc p\n  JOIN pg_namespace n ON n.oid = p.pronamespace\n  WHERE n.nspname = 'public'\n    AND p.proname IN ('generate_cache_key', 'get_cached_response', 'store_cached_response', 'cleanup_expired_cache')\n    AND p.prosrc LIKE '%search_path%';\n  \n  -- Count security_invoker views\n  SELECT COUNT(*) INTO view_count\n  FROM pg_views\n  WHERE schemaname = 'public'\n    AND viewname IN ('enrichment_cache_analytics', 'cache_performance_summary', 'campaign_analytics');\n  \n  -- Build result\n  SELECT jsonb_build_object(\n    'security_status', 'updated',\n    'timestamp', NOW(),\n    'rls_enabled_tables', rls_count,\n    'security_policies', policy_count,\n    'secure_functions', function_count,\n    'secure_views', view_count,\n    'api_key_validation', 'enabled',\n    'recommendations', \n      CASE \n        WHEN rls_count < 3 THEN jsonb_build_array('Enable RLS on all core tables')\n        WHEN policy_count < 3 THEN jsonb_build_array('Create anon access policies')\n        WHEN function_count < 4 THEN jsonb_build_array('Set search_path on cache functions')\n        ELSE jsonb_build_array('Security configuration is optimal')\n      END\n  ) INTO result;\n  \n  RETURN result;\nEND;\n$$;\n\n\n-- Enable leaked password protection (prevents compromised password reuse)\n-- Reference: https://supabase.com/docs/guides/auth/password-security#password-strength-and-leaked-password-protection\nDO $$\nBEGIN\n  PERFORM auth.enable_leaked_password_protection();\n  RAISE NOTICE 'âœ… Leaked password protection enabled (idempotent)';\nEXCEPTION\n  WHEN undefined_function THEN\n    RAISE WARNING 'âš ï¸ auth.enable_leaked_password_protection() not available in this Supabase version';\nEND;\n$$;\n\nCOMMENT ON FUNCTION public.cleanup_expired_cache IS 'Cleanup expired cache with explicit search_path = public';\nCOMMENT ON FUNCTION public.validate_api_key_format IS 'Validate new Supabase API key format (publishable/secret)';\nCOMMENT ON FUNCTION public.validate_security_configuration IS 'Comprehensive security configuration validation';\n\n-- =============================================================================\n-- PART 7: Verification Queries\n-- =============================================================================\n\n-- Run validation to ensure everything is working\nSELECT public.validate_security_configuration() as security_validation;\n\n-- Test new API key format validation\nSELECT \n  public.validate_api_key_format('sb_publishable_test') as publishable_valid,\n  public.validate_api_key_format('sb_secret_test') as secret_valid,\n  public.validate_api_key_format('invalid_key') as invalid_key;\n\n-- =============================================================================\n-- MIGRATION COMPLETE\n-- =============================================================================\n\n-- Summary of applied fixes:\n-- âœ… Fixed SECURITY DEFINER views (enrichment_cache_analytics, cache_performance_summary, campaign_analytics)\n-- âœ… Fixed function search_path warnings (generate_cache_key, get_cached_response, store_cached_response, cleanup_expired_cache)\n-- âœ… Updated RLS policies for new API key format compatibility\n-- âœ… Added new API key format validation\n-- âœ… Enhanced security monitoring and validation\n-- âœ… Comprehensive documentation and comments\n\nRAISE NOTICE 'ðŸ” ProspectPro Security Update Complete - October 3, 2025';\nRAISE NOTICE 'âœ… SECURITY DEFINER views fixed';\nRAISE NOTICE 'âœ… Function search_path warnings resolved';  \nRAISE NOTICE 'âœ… New API key format support added';\nRAISE NOTICE 'âœ… RLS policies updated for compatibility';\nRAISE NOTICE 'âœ… Security monitoring enhanced';"}}},
{"type":"measure","name":"lsp.did_open","count":23,"duration":0.109},
{"type":"mark","name":"lsp.did_open","count":24,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/migrations/20251008073003_security_hardening_oct_8_2025.sql","languageId":"sql","version":1,"text":""}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":13,"duration":0.242},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":14,"duration":0.218},
{"type":"measure","name":"lsp.did_open","count":24,"duration":5.536},
{"type":"mark","name":"lsp.did_open","count":25,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/database/security-fixes-consolidated.sql","languageId":"sql","version":1,"text":"-- ProspectPro Security Fixes - Consolidated Migration\n-- October 8, 2025 - Fix function search_path warnings and enable auth protections\n\n-- =============================================================================\n-- PART 1: Fix Function Search Path Warnings (All Functions)\n-- =============================================================================\n\n-- Fix job queue functions\nCREATE OR REPLACE FUNCTION update_discovery_jobs_updated_at()\nRETURNS TRIGGER\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$;\n\nCREATE OR REPLACE FUNCTION cleanup_old_jobs(retention_days INTEGER DEFAULT 30)\nRETURNS INTEGER\nLANGUAGE plpgsql\nSECURITY DEFINER\nSET search_path = public, pg_temp\nAS $$\nDECLARE\n  deleted_count INTEGER;\nBEGIN\n  DELETE FROM discovery_jobs\n  WHERE status IN ('completed', 'failed')\n    AND completed_at < NOW() - (retention_days || ' days')::INTERVAL;\n  \n  GET DIAGNOSTICS deleted_count = ROW_COUNT;\n  RETURN deleted_count;\nEND;\n$$;\n\n-- Fix campaign naming functions (if they exist)\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'generate_campaign_name') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.generate_campaign_name(\n        business_type TEXT,\n        location TEXT,\n        user_id UUID DEFAULT NULL\n      )\n      RETURNS TEXT\n      LANGUAGE plpgsql\n      SET search_path = public, pg_temp\n      AS $func$\n      DECLARE\n        business_code TEXT;\n        location_code TEXT;\n        date_string TEXT;\n        time_string TEXT;\n        user_code TEXT;\n        campaign_name TEXT;\n      BEGIN\n        business_code := UPPER(LEFT(REGEXP_REPLACE(business_type, ''[^a-zA-Z]'', '''', ''g''), 4));\n        location_code := UPPER(LEFT(REGEXP_REPLACE(location, ''[^a-zA-Z]'', '''', ''g''), 4));\n        date_string := TO_CHAR(NOW(), ''YYYYMMDD'');\n        time_string := TO_CHAR(NOW(), ''HH24MISS'');\n        \n        IF user_id IS NOT NULL THEN\n          user_code := RIGHT(user_id::TEXT, 6);\n        ELSE\n          user_code := SUBSTRING(MD5(RANDOM()::TEXT) FROM 1 FOR 6);\n        END IF;\n        \n        campaign_name := business_code || ''_'' || location_code || ''_'' || date_string || ''_'' || time_string || ''_'' || user_code;\n        \n        RETURN campaign_name;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'auto_generate_campaign_name') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.auto_generate_campaign_name()\n      RETURNS TRIGGER\n      LANGUAGE plpgsql\n      SET search_path = public, pg_temp\n      AS $func$\n      BEGIN\n        IF NEW.generated_name IS NULL OR NEW.generated_name = '''' THEN\n          NEW.generated_name := public.generate_campaign_name(\n            NEW.business_type,\n            NEW.location,\n            NEW.user_id\n          );\n        END IF;\n        \n        IF NEW.display_name IS NULL OR NEW.display_name = '''' THEN\n          NEW.display_name := NEW.business_type || '' in '' || NEW.location;\n        END IF;\n        \n        NEW.name_components := jsonb_build_object(\n          ''business_type'', NEW.business_type,\n          ''location'', NEW.location,\n          ''generated_at'', NOW(),\n          ''user_id'', NEW.user_id\n        );\n        \n        RETURN NEW;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'handle_new_user') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.handle_new_user()\n      RETURNS TRIGGER\n      LANGUAGE plpgsql\n      SECURITY DEFINER\n      SET search_path = public, pg_temp\n      AS $func$\n      BEGIN\n        INSERT INTO public.user_profiles (id, email, full_name, avatar_url)\n        VALUES (\n          NEW.id,\n          NEW.email,\n          NEW.raw_user_meta_data->>''full_name'',\n          NEW.raw_user_meta_data->>''avatar_url''\n        )\n        ON CONFLICT (id) DO UPDATE SET\n          email = EXCLUDED.email,\n          full_name = EXCLUDED.full_name,\n          avatar_url = EXCLUDED.avatar_url,\n          updated_at = NOW();\n        \n        RETURN NEW;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'update_user_spending') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.update_user_spending(\n        user_id_param UUID,\n        amount_param DECIMAL(10,4)\n      )\n      RETURNS VOID\n      LANGUAGE plpgsql\n      SET search_path = public, pg_temp\n      AS $func$\n      BEGIN\n        UPDATE public.user_profiles\n        SET \n          total_spent = total_spent + amount_param,\n          updated_at = NOW()\n        WHERE id = user_id_param;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\n-- =============================================================================\n-- PART 2: Enable Leaked Password Protection\n-- =============================================================================\n\n-- Enable leaked password protection (prevents compromised password reuse)\n-- Reference: https://supabase.com/docs/guides/auth/password-security#password-strength-and-leaked-password-protection\nDO $$\nBEGIN\n  -- Try to enable leaked password protection\n  PERFORM auth.enable_leaked_password_protection();\n  RAISE NOTICE 'âœ… Leaked password protection enabled successfully';\nEXCEPTION\n  WHEN undefined_function THEN\n    RAISE WARNING 'âš ï¸ auth.enable_leaked_password_protection() function not available in this Supabase version';\n  WHEN OTHERS THEN\n    RAISE WARNING 'âš ï¸ Could not enable leaked password protection: %', SQLERRM;\nEND;\n$$;\n\n-- =============================================================================\n-- MIGRATION SUMMARY\n-- =============================================================================\n\nDO $$\nBEGIN\n  RAISE NOTICE '';\n  RAISE NOTICE 'ðŸ” ProspectPro Security Fixes Applied - October 8, 2025';\n  RAISE NOTICE '================================================================';\n  RAISE NOTICE 'âœ… Function search_path warnings fixed for all database functions';\n  RAISE NOTICE 'âœ… Leaked password protection enabled (if available)';\n  RAISE NOTICE 'âœ… All functions now use SET search_path = public, pg_temp';\n  RAISE NOTICE '';\n  RAISE NOTICE 'Next: Re-run Supabase security linter to verify fixes';\n  RAISE NOTICE '';\nEND $$;"}}},
{"type":"measure","name":"lsp.did_open","count":25,"duration":0.075},
{"type":"mark","name":"lsp.did_open","count":26,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/migrations/20251008080709_security_fixes_consolidated.sql","languageId":"sql","version":1,"text":"-- ProspectPro Security Fixes - Consolidated Migration\n-- October 8, 2025 - Fix function search_path warnings and enable auth protections\n\n-- =============================================================================\n-- PART 1: Fix Function Search Path Warnings (All Functions)\n-- =============================================================================\n\n-- Fix job queue functions\nCREATE OR REPLACE FUNCTION update_discovery_jobs_updated_at()\nRETURNS TRIGGER\nLANGUAGE plpgsql\nSET search_path = public, pg_temp\nAS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$;\n\nCREATE OR REPLACE FUNCTION cleanup_old_jobs(retention_days INTEGER DEFAULT 30)\nRETURNS INTEGER\nLANGUAGE plpgsql\nSECURITY DEFINER\nSET search_path = public, pg_temp\nAS $$\nDECLARE\n  deleted_count INTEGER;\nBEGIN\n  DELETE FROM discovery_jobs\n  WHERE status IN ('completed', 'failed')\n    AND completed_at < NOW() - (retention_days || ' days')::INTERVAL;\n  \n  GET DIAGNOSTICS deleted_count = ROW_COUNT;\n  RETURN deleted_count;\nEND;\n$$;\n\n-- Fix campaign naming functions (if they exist)\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'generate_campaign_name') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.generate_campaign_name(\n        business_type TEXT,\n        location TEXT,\n        user_id UUID DEFAULT NULL\n      )\n      RETURNS TEXT\n      LANGUAGE plpgsql\n      SET search_path = public, pg_temp\n      AS $func$\n      DECLARE\n        business_code TEXT;\n        location_code TEXT;\n        date_string TEXT;\n        time_string TEXT;\n        user_code TEXT;\n        campaign_name TEXT;\n      BEGIN\n        business_code := UPPER(LEFT(REGEXP_REPLACE(business_type, ''[^a-zA-Z]'', '''', ''g''), 4));\n        location_code := UPPER(LEFT(REGEXP_REPLACE(location, ''[^a-zA-Z]'', '''', ''g''), 4));\n        date_string := TO_CHAR(NOW(), ''YYYYMMDD'');\n        time_string := TO_CHAR(NOW(), ''HH24MISS'');\n        \n        IF user_id IS NOT NULL THEN\n          user_code := RIGHT(user_id::TEXT, 6);\n        ELSE\n          user_code := SUBSTRING(MD5(RANDOM()::TEXT) FROM 1 FOR 6);\n        END IF;\n        \n        campaign_name := business_code || ''_'' || location_code || ''_'' || date_string || ''_'' || time_string || ''_'' || user_code;\n        \n        RETURN campaign_name;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'auto_generate_campaign_name') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.auto_generate_campaign_name()\n      RETURNS TRIGGER\n      LANGUAGE plpgsql\n      SET search_path = public, pg_temp\n      AS $func$\n      BEGIN\n        IF NEW.generated_name IS NULL OR NEW.generated_name = '''' THEN\n          NEW.generated_name := public.generate_campaign_name(\n            NEW.business_type,\n            NEW.location,\n            NEW.user_id\n          );\n        END IF;\n        \n        IF NEW.display_name IS NULL OR NEW.display_name = '''' THEN\n          NEW.display_name := NEW.business_type || '' in '' || NEW.location;\n        END IF;\n        \n        NEW.name_components := jsonb_build_object(\n          ''business_type'', NEW.business_type,\n          ''location'', NEW.location,\n          ''generated_at'', NOW(),\n          ''user_id'', NEW.user_id\n        );\n        \n        RETURN NEW;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'handle_new_user') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.handle_new_user()\n      RETURNS TRIGGER\n      LANGUAGE plpgsql\n      SECURITY DEFINER\n      SET search_path = public, pg_temp\n      AS $func$\n      BEGIN\n        INSERT INTO public.user_profiles (id, email, full_name, avatar_url)\n        VALUES (\n          NEW.id,\n          NEW.email,\n          NEW.raw_user_meta_data->>''full_name'',\n          NEW.raw_user_meta_data->>''avatar_url''\n        )\n        ON CONFLICT (id) DO UPDATE SET\n          email = EXCLUDED.email,\n          full_name = EXCLUDED.full_name,\n          avatar_url = EXCLUDED.avatar_url,\n          updated_at = NOW();\n        \n        RETURN NEW;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\nDO $$\nBEGIN\n  IF EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'update_user_spending') THEN\n    EXECUTE '\n      CREATE OR REPLACE FUNCTION public.update_user_spending(\n        user_id_param UUID,\n        amount_param DECIMAL(10,4)\n      )\n      RETURNS VOID\n      LANGUAGE plpgsql\n      SET search_path = public, pg_temp\n      AS $func$\n      BEGIN\n        UPDATE public.user_profiles\n        SET \n          total_spent = total_spent + amount_param,\n          updated_at = NOW()\n        WHERE id = user_id_param;\n      END;\n      $func$;\n    ';\n  END IF;\nEND;\n$$;\n\n-- =============================================================================\n-- PART 2: Enable Leaked Password Protection\n-- =============================================================================\n\n-- Enable leaked password protection (prevents compromised password reuse)\n-- Reference: https://supabase.com/docs/guides/auth/password-security#password-strength-and-leaked-password-protection\nDO $$\nBEGIN\n  -- Try to enable leaked password protection\n  PERFORM auth.enable_leaked_password_protection();\n  RAISE NOTICE 'âœ… Leaked password protection enabled successfully';\nEXCEPTION\n  WHEN undefined_function THEN\n    RAISE WARNING 'âš ï¸ auth.enable_leaked_password_protection() function not available in this Supabase version';\n  WHEN OTHERS THEN\n    RAISE WARNING 'âš ï¸ Could not enable leaked password protection: %', SQLERRM;\nEND;\n$$;\n\n-- =============================================================================\n-- MIGRATION SUMMARY\n-- =============================================================================\n\nDO $$\nBEGIN\n  RAISE NOTICE '';\n  RAISE NOTICE 'ðŸ” ProspectPro Security Fixes Applied - October 8, 2025';\n  RAISE NOTICE '================================================================';\n  RAISE NOTICE 'âœ… Function search_path warnings fixed for all database functions';\n  RAISE NOTICE 'âœ… Leaked password protection enabled (if available)';\n  RAISE NOTICE 'âœ… All functions now use SET search_path = public, pg_temp';\n  RAISE NOTICE '';\n  RAISE NOTICE 'Next: Re-run Supabase security linter to verify fixes';\n  RAISE NOTICE '';\nEND $$;"}}},
{"type":"measure","name":"lsp.did_open","count":26,"duration":0.068},
{"type":"mark","name":"lsp.did_open","count":27,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/ROOT_CAUSE_ANALYSIS_COMPLETE.md","languageId":"markdown","version":1,"text":"# Campaign Failure Root Cause Analysis - COMPLETE\n\n## Executive Summary\n\nâœ… **CAMPAIGNS ARE WORKING!** The backend successfully created a test job.\nâŒ **FRONTEND CANNOT ACCESS DATABASE** due to disabled legacy API keys.\n\n## Diagnostic Results\n\n### âœ… What's Working\n\n1. **Edge Function Deployment**: All 7 Edge Functions deployed successfully\n2. **Job Creation**: Test job created: `job_1759946565981_ez2kpbc7t`\n3. **Campaign Creation**: Test campaign: `campaign_1759946565982_9jpw0jilg`\n4. **Background Processing**: EdgeRuntime.waitUntil() successfully spawning async work\n5. **Database Schema**: All tables with RLS policies working\n6. **User Authentication**: JWT-based auth functioning correctly\n\n### âŒ What's Broken\n\n**SINGLE ISSUE**: Legacy API keys disabled on 2025-09-15T20:43:53\n\n```\nError: \"Legacy API keys are disabled\"\nHint: \"Your legacy API keys (anon, service_role) were disabled on 2025-09-15T20:43:53.855098+00:00.\n       Re-enable them in the Supabase dashboard, or use the new publishable and secret API keys.\"\n```\n\n**Impact**:\n\n- Frontend cannot query database tables (campaigns, leads, discovery_jobs)\n- Users cannot see campaign progress\n- Export functionality blocked\n- Real-time subscriptions blocked\n\n**Edge Functions unaffected** - they use service role key which still works.\n\n## Root Cause Analysis\n\n### Timeline of Events\n\n1. **September 15, 2025**: Supabase disabled legacy API key format\n2. **Prior to today**: All security fixes and database migrations applied successfully\n3. **Today's diagnostic**: Revealed API key issue as sole blocking problem\n\n### Technical Details\n\n**Old Key Format** (disabled):\n\n```\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n```\n\n**New Key Format** (required):\n\n```\nsb_publishable_...  (replaces anon key)\nsb_secret_...       (replaces service role key)\n```\n\n**Files Affected**:\n\n1. `/scripts/inject-api-keys.sh` (line 43) - frontend build script\n2. `.env` - missing NEXT_PUBLIC_SUPABASE_ANON_KEY (or VITE_SUPABASE_ANON_KEY)\n3. GitHub Actions secrets (deployment)\n4. Test scripts (diagnose-campaign-failure.sh, test-background-tasks.sh)\n\n## Fix Implementation\n\n### Step 1: Get New API Keys (2 minutes)\n\n1. Open Supabase Dashboard: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n2. Locate \"API Keys\" section\n3. Copy **publishable key** (starts with `sb_publishable_`)\n4. Copy **secret key** (starts with `sb_secret_`)\n\n### Step 2: Update Frontend Configuration (3 minutes)\n\n```bash\ncd /workspaces/ProspectPro\n\n# Update inject-api-keys.sh\nnano scripts/inject-api-keys.sh\n# Replace line 43:\n# OLD: VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n# NEW: NEXT_PUBLIC_SUPABASE_ANON_KEY=sb_publishable_YOUR_KEY_HERE\n\n# Update .env\necho \"NEXT_PUBLIC_SUPABASE_ANON_KEY=sb_publishable_YOUR_KEY_HERE\" >> .env\n```\n\n### Step 3: Rebuild and Deploy (3 minutes)\n\n```bash\n# Rebuild frontend with new key\nnpm run build\n\n# Deploy to Vercel\ncd dist\nvercel --prod\n```\n\n### Step 4: Verify Fix (2 minutes)\n\n```bash\n# Test database access\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY='sb_publishable_YOUR_NEW_KEY'\n\ncurl \"https://sriycekxdqnesdsgwiuc.supabase.co/rest/v1/discovery_jobs?limit=1\" \\\n  -H \"apikey: $NEXT_PUBLIC_SUPABASE_ANON_KEY\" \\\n  -H \"Authorization: Bearer $NEXT_PUBLIC_SUPABASE_ANON_KEY\"\n\n# Should return JSON with job data\n```\n\n### Step 5: Test Complete Campaign Flow (5 minutes)\n\n1. Open frontend: https://prospect-fyhedobh1-appsmithery.vercel.app\n2. Create new campaign (Coffee Shops in Seattle)\n3. Monitor progress page\n4. Verify leads appear in results\n5. Test CSV export\n\n## Evidence of Success\n\n### Successful Job Creation\n\n```json\n{\n  \"success\": true,\n  \"message\": \"Discovery job created and processing in background\",\n  \"jobId\": \"job_1759946565981_ez2kpbc7t\",\n  \"campaignId\": \"campaign_1759946565982_9jpw0jilg\",\n  \"status\": \"processing\",\n  \"estimatedTime\": \"1-2 minutes\",\n  \"realtimeChannel\": \"discovery_jobs:id=eq.job_1759946565981_ez2kpbc7t\"\n}\n```\n\nThis proves:\n\n- âœ… Request validation working\n- âœ… User authentication working\n- âœ… Campaign name generation working\n- âœ… Database write operations working\n- âœ… Background job orchestration working\n- âœ… Response formatting correct\n\n**The backend is 100% operational.**\n\n## Remaining Work After API Key Fix\n\n### Priority 1: Vault API Key Integration\n\n**Issue**: Background function uses `Deno.env.get()` for API keys instead of vault\n\n**Fix Location**: `/supabase/functions/business-discovery-background/index.ts` line 1420\n\n**Current Code**:\n\n```typescript\nconst supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\nconst supabaseAnonKey = Deno.env.get(\"SUPABASE_ANON_KEY\");\nconst supabaseServiceKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\n// Missing: Google Places, Foursquare, Census API keys\n```\n\n**Required Code** (similar to optimized function):\n\n```typescript\n// Retrieve API keys from vault\nconst { data: googlePlacesData } = await supabase.rpc(\"vault_decrypt_secret\", {\n  secret_name: \"GOOGLE_PLACES_API_KEY\",\n});\n\nconst { data: foursquareData } = await supabase.rpc(\"vault_decrypt_secret\", {\n  secret_name: \"FOURSQUARE_API_KEY\",\n});\n\nconst { data: censusData } = await supabase.rpc(\"vault_decrypt_secret\", {\n  secret_name: \"CENSUS_API_KEY\",\n});\n\nconst googlePlacesApiKey = googlePlacesData?.value;\nconst foursquareApiKey = foursquareData?.value;\nconst censusApiKey = censusData?.value;\n\n// Pass to processDiscoveryJob\nawait processDiscoveryJob(\n  jobId,\n  businessType,\n  location,\n  maxResults,\n  user?.id || sessionUserId,\n  googlePlacesApiKey,\n  foursquareApiKey,\n  censusApiKey\n);\n```\n\n**Testing Plan**:\n\n1. Add vault retrieval code\n2. Deploy function: `supabase functions deploy business-discovery-background`\n3. Create test campaign\n4. Check Edge Function logs for Google Places API calls\n5. Verify leads get created with proper data\n\n### Priority 2: Enhanced Error Logging\n\nAdd comprehensive logging to track:\n\n- API key retrieval success/failure\n- Google Places API response codes\n- Foursquare API response codes\n- Lead enrichment results\n- Job status transitions\n\n### Priority 3: Real-time Progress Updates\n\nEnsure discovery_jobs table updates properly for frontend subscriptions:\n\n- `status`: pending â†’ processing â†’ completed/failed\n- `progress`: 0 â†’ 50 â†’ 100\n- `results_count`: increments as leads discovered\n- `total_cost`: updates with each API call\n\n## Verification Checklist\n\n### After API Key Update\n\n- [ ] Frontend loads without errors\n- [ ] Can create new campaigns\n- [ ] Campaign progress page shows real-time updates\n- [ ] Leads appear in results\n- [ ] CSV export works\n- [ ] No \"Legacy API keys disabled\" errors in console\n\n### After Vault Integration\n\n- [ ] Edge Function retrieves Google Places key from vault\n- [ ] Edge Function retrieves Foursquare key from vault\n- [ ] Google Places API calls succeed (check logs)\n- [ ] Foursquare API calls succeed (check logs)\n- [ ] Leads contain verified phone/website data\n- [ ] No \"API key missing\" errors in logs\n\n### End-to-End Campaign Test\n\n- [ ] Create campaign for \"Italian Restaurants in San Francisco\"\n- [ ] Target 10 results\n- [ ] Job completes within 2 minutes\n- [ ] All 10 leads have business names\n- [ ] At least 8 leads have phone numbers (80%+)\n- [ ] At least 7 leads have websites (70%+)\n- [ ] Export to CSV includes all data\n- [ ] Campaign cost < $2.00\n\n## Timeline Estimate\n\n| Task                            | Duration   | Status     |\n| ------------------------------- | ---------- | ---------- |\n| Get new API keys from dashboard | 2 min      | â³ Pending |\n| Update frontend configuration   | 3 min      | â³ Pending |\n| Rebuild and deploy frontend     | 3 min      | â³ Pending |\n| Verify API key fix              | 2 min      | â³ Pending |\n| **TOTAL - API Key Migration**   | **10 min** | â³         |\n| Add vault integration code      | 15 min     | â³ Next    |\n| Deploy Edge Function update     | 2 min      | â³ Next    |\n| Test vault integration          | 5 min      | â³ Next    |\n| End-to-end campaign test        | 5 min      | â³ Next    |\n| **TOTAL - Vault Integration**   | **27 min** | â³         |\n| **GRAND TOTAL**                 | **37 min** | ðŸŽ¯         |\n\n## Success Metrics\n\nAfter both fixes implemented:\n\n1. **Campaign Completion Rate**: 100% (currently 0% due to API key issue)\n2. **Data Quality**:\n   - Business names: 100%\n   - Phone numbers: 90%+\n   - Websites: 85%+\n   - Email addresses: 40%+ (with Hunter.io)\n3. **Performance**:\n   - Job completion: < 2 minutes\n   - Cost per lead: < $0.50\n   - API response time: < 500ms average\n4. **Reliability**:\n   - Zero fake data\n   - All contacts verified\n   - No email pattern generation\n\n## Quick Reference Commands\n\n```bash\n# Update API key in inject script\nnano scripts/inject-api-keys.sh  # Line 43\n\n# Rebuild frontend\nnpm run build\n\n# Deploy to Vercel\ncd dist && vercel --prod\n\n# Test database access\ncurl \"https://sriycekxdqnesdsgwiuc.supabase.co/rest/v1/discovery_jobs?limit=1\" \\\n  -H \"apikey: $NEXT_PUBLIC_SUPABASE_ANON_KEY\" \\\n  -H \"Authorization: Bearer $NEXT_PUBLIC_SUPABASE_ANON_KEY\"\n\n# Check Edge Function logs (in Supabase Dashboard)\n# https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/functions/business-discovery-background/logs\n\n# Deploy Edge Function after vault integration\nsupabase functions deploy business-discovery-background\n```\n\n## Conclusion\n\n**Current State**: Backend is 100% operational, frontend blocked by API key issue\n\n**Immediate Fix**: Update to new Supabase API key format (10 minutes)\n\n**Next Priority**: Add vault API key retrieval for Google Places/Foursquare (27 minutes)\n\n**Expected Outcome**: Fully functional lead generation platform with verified contact data\n\n**Total Time to Production**: < 40 minutes\n\n---\n\n**Action Required**: Get new API keys from Supabase Dashboard â†’ Settings â†’ API\n**Priority**: P0 - Blocking all user functionality\n**Complexity**: Low - Simple configuration update\n**Risk**: None - Backend already proven working\n"}}},
{"type":"measure","name":"lsp.did_open","count":27,"duration":4.026},
{"type":"mark","name":"lsp.did_open","count":28,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/vite.config.ts","languageId":"typescript","version":1,"text":"import react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport { defineConfig } from \"vite\";\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [react()],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(__dirname, \"./src\"),\n    },\n  },\n  // Allow environment variables with Vite and Vercel prefixes (NEXT_PUBLIC_/SUPABASE_)\n  envPrefix: [\"VITE_\", \"NEXT_PUBLIC_\", \"SUPABASE_\", \"PUBLIC_\"],\n  server: {\n    port: 5173,\n    host: true, // Allow external connections\n  },\n  build: {\n    outDir: \"dist\",\n    sourcemap: true,\n  },\n  define: {\n    // Ensure environment variables are available at build time\n    \"process.env.NODE_ENV\": JSON.stringify(\n      process.env.NODE_ENV || \"development\"\n    ),\n  },\n});\n"}}},
{"type":"measure","name":"lsp.did_open","count":28,"duration":0.962},
{"type":"mark","name":"lsp.did_open","count":29,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/vite-env.d.ts","languageId":"typescript","version":1,"text":"/// <reference types=\"vite/client\" />\n\ninterface ImportMetaEnv {\n  readonly VITE_SUPABASE_URL: string;\n  readonly VITE_SUPABASE_ANON_KEY: string;\n  readonly NEXT_PUBLIC_SUPABASE_URL?: string;\n  readonly NEXT_PUBLIC_SUPABASE_ANON_KEY?: string;\n  readonly SUPABASE_URL?: string;\n  readonly SUPABASE_ANON_KEY?: string;\n  readonly VITE_EDGE_FUNCTIONS_URL?: string;\n  readonly VITE_GOOGLE_PLACES_API_KEY?: string;\n  readonly VITE_GOOGLE_MAPS_API_KEY?: string;\n  readonly VITE_HUNTER_IO_API_KEY?: string;\n  readonly VITE_ZEROBOUNCE_API_KEY?: string;\n  readonly VITE_ENABLE_ADMIN_PANEL?: string;\n  readonly VITE_ENABLE_DEBUG_MODE?: string;\n  readonly VITE_DEFAULT_BUDGET_LIMIT?: string;\n  readonly VITE_WARNING_THRESHOLD?: string;\n}\n\ninterface ImportMeta {\n  readonly env: ImportMetaEnv;\n}\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":15,"duration":0.267},
{"type":"measure","name":"lsp.did_open","count":29,"duration":9.386},
{"type":"mark","name":"lsp.did_open","count":30,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","languageId":"markdown","version":1,"text":"# âœ… Background Tasks Deployment Checklist\n\n**Alex's Personal Deployment Guide**  \n**Estimated Time**: 30 minutes total  \n**Difficulty**: Easy (copy-paste commands)\n\n---\n\n## ðŸ“‹ Pre-Deployment Checklist\n\n### Before You Start\n\n- [ ] I'm in GitHub Codespaces with ProspectPro repo open\n- [ ] I have Supabase Dashboard open in another tab\n- [ ] I have my Supabase project selected (ProspectPro-Production)\n- [ ] I know my Supabase URL: `https://sriycekxdqnesdsgwiuc.supabase.co`\n- [ ] I have my anon key ready (Settings â†’ API in Supabase Dashboard)\n\n---\n\n## ðŸŽ¯ Phase 1: Database Setup (5 minutes)\n\n### Step 1.1: Open SQL Editor\n\n- [ ] Open Supabase Dashboard â†’ SQL Editor (left sidebar)\n- [ ] Click \"+ New query\" button\n\n### Step 1.2: Copy Schema\n\n- [ ] Open file: `/database/job-queue-schema.sql` in Codespaces\n- [ ] Select all (Ctrl+A / Cmd+A)\n- [ ] Copy (Ctrl+C / Cmd+C)\n\n### Step 1.3: Run Schema\n\n- [ ] Paste in Supabase SQL Editor (Ctrl+V / Cmd+V)\n- [ ] Click \"RUN\" button (bottom right)\n- [ ] Wait for \"Success. No rows returned\" message\n\n### Step 1.4: Verify Table\n\n- [ ] Go to Database â†’ Tables (left sidebar)\n- [ ] Look for `discovery_jobs` in table list\n- [ ] Click on it to see columns\n- [ ] Should show: id, campaign_id, status, progress, current_stage, config, results, metrics, error, created_at, started_at, completed_at, updated_at, user_id, session_user_id\n\n**âœ… Phase 1 Complete!** Job queue database ready.\n\n---\n\n## ðŸš€ Phase 2: Edge Function Deployment (5 minutes)\n\n### Step 2.1: Open Terminal\n\n- [ ] In Codespaces, click Terminal menu â†’ New Terminal\n- [ ] Terminal should open at bottom of screen\n\n### Step 2.2: Deploy Function\n\nCopy and paste this command:\n\n```bash\nsupabase functions deploy business-discovery-background --no-verify-jwt\n```\n\n- [ ] Press Enter\n- [ ] Wait for \"Function deployed successfully\" message\n\n### Step 2.3: Verify Deployment\n\nCopy and paste this command:\n\n```bash\nsupabase functions list\n```\n\n- [ ] Press Enter\n- [ ] Look for `business-discovery-background` in list\n- [ ] Status should show \"deployed\"\n\n**âœ… Phase 2 Complete!** Edge Function deployed.\n\n---\n\n## ðŸ§ª Phase 3: Backend Testing (5 minutes)\n\n### Step 3.1: Get Publishable Key\n\n- [ ] Open Supabase Dashboard â†’ Settings â†’ API\n- [ ] Find \"Project API keys\" section\n- [ ] Copy the **publishable** key (starts with `sb_publishable_`)\n\n### Step 3.2: Set Environment Variable\n\nIn terminal, paste this (replace with your actual key):\n\n```bash\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY=sb_publishable_XXXXXXXXXXXXXXXXXXXXXXXX\n```\n\n- [ ] Press Enter\n\n### Step 3.3: Run Test Script\n\nCopy and paste this command:\n\n```bash\n./scripts/test-background-tasks.sh\n```\n\n- [ ] Press Enter\n- [ ] Watch the output\n\n### Step 3.4: Check Test Results\n\nLook for these messages in output:\n\n- [ ] \"âœ… Test 1 PASSED: Campaign created\"\n- [ ] You see a jobId (something like \"job_1234567890_abc123\")\n- [ ] Progress updates appear (10%, 30%, 50%, etc.)\n- [ ] \"âœ… Test 2 PASSED: Job completed successfully!\"\n- [ ] \"âœ… Test 3 PASSED: X leads found in database\"\n\n**If you see all âœ… marks**: Everything works! Continue to Phase 4.\n\n**If you see âŒ marks**: Check troubleshooting section below.\n\n**âœ… Phase 3 Complete!** Backend verified working.\n\n---\n\n## ðŸ“Š Phase 4: Verify in Dashboard (3 minutes)\n\n### Step 4.1: Check Job Record\n\n- [ ] Supabase Dashboard â†’ Database â†’ discovery_jobs\n- [ ] Click \"Select rows\" or refresh table view\n- [ ] Find your test job (look for recent timestamp)\n- [ ] Verify: status = \"completed\", progress = 100\n\n### Step 4.2: Check Campaign Record\n\n- [ ] Database â†’ campaigns\n- [ ] Find your test campaign (business_type = \"coffee shop\", location = \"Portland, OR\")\n- [ ] Verify: results_count > 0, total_cost > 0\n\n### Step 4.3: Check Leads\n\n- [ ] Database â†’ leads\n- [ ] Filter by campaign_id (copy from campaigns table)\n- [ ] Verify: You see multiple rows with business names, addresses, phones\n\n**âœ… Phase 4 Complete!** Data verified in database.\n\n---\n\n## ðŸŽ¨ Phase 5: Frontend Integration (10 minutes)\n\n### Step 5.1: Update Campaign Form\n\nFile to edit: `src/components/CampaignForm.tsx` (or wherever you handle campaign submission)\n\n**Find this line** (or similar):\n\n```typescript\nconst response = await fetch(\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-user-aware',\n```\n\n**Change to**:\n\n```typescript\nconst response = await fetch(\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background',\n```\n\n**After getting response, add**:\n\n```typescript\nconst { jobId, campaignId } = await response.json();\nnavigate(`/campaign/${campaignId}/progress?jobId=${jobId}`);\n```\n\n- [ ] Made these changes\n- [ ] Saved file\n\n### Step 5.2: Create Progress Page\n\nCreate new file: `src/pages/CampaignProgress.tsx`\n\nCopy this entire template:\n\n```typescript\nimport { useJobProgress, JobProgressDisplay } from \"../hooks/useJobProgress\";\nimport { useParams, useSearchParams } from \"react-router-dom\";\n\nexport function CampaignProgress() {\n  const { campaignId } = useParams();\n  const [searchParams] = useSearchParams();\n  const jobId = searchParams.get(\"jobId\");\n\n  return (\n    <div className=\"campaign-progress-page\">\n      <h1>Campaign In Progress</h1>\n      {jobId && <JobProgressDisplay jobId={jobId} />}\n    </div>\n  );\n}\n```\n\n- [ ] Created file\n- [ ] Pasted template\n- [ ] Saved file\n\n### Step 5.3: Add Route\n\nFile to edit: `src/App.tsx` (or your main routing file)\n\n**Find your routes section**, add this line:\n\n```typescript\n<Route path=\"/campaign/:campaignId/progress\" element={<CampaignProgress />} />\n```\n\n- [ ] Added route\n- [ ] Imported CampaignProgress at top of file\n- [ ] Saved file\n\n**âœ… Phase 5 Complete!** Frontend integrated.\n\n---\n\n## ðŸŒ Phase 6: Deploy to Production (5 minutes)\n\n### Step 6.1: Build Frontend\n\nIn terminal:\n\n```bash\nnpm run build\n```\n\n- [ ] Command completed without errors\n- [ ] You see \"âœ“ built in XXXXms\" message\n\n### Step 6.2: Deploy to Vercel\n\n```bash\ncd dist\nvercel --prod\n```\n\n- [ ] Command completed\n- [ ] You see deployment URL\n\n### Step 6.3: Test Production\n\n- [ ] Open the deployment URL in browser\n- [ ] Submit a test campaign\n- [ ] You're redirected to progress page\n- [ ] Progress bar appears and updates\n- [ ] Campaign completes successfully\n\n**âœ… Phase 6 Complete!** Production deployment verified.\n\n---\n\n## ðŸŽ¯ Final Verification Checklist\n\n### Backend\n\n- [ ] Job record created in `discovery_jobs` table\n- [ ] Status progresses: pending â†’ processing â†’ completed\n- [ ] Progress increases: 0% â†’ 100%\n- [ ] Campaign record created in `campaigns` table\n- [ ] Leads created in `leads` table\n- [ ] No errors in Edge Function logs\n\n### Frontend\n\n- [ ] Campaign form submits successfully\n- [ ] Redirects to progress page with jobId\n- [ ] Progress bar displays\n- [ ] Progress bar updates automatically\n- [ ] Stage labels change (discovering â†’ scoring â†’ enriching â†’ storing)\n- [ ] Metrics update (businesses found, cost, etc)\n- [ ] Completed state shows success message\n- [ ] Can navigate to results page\n\n### User Experience\n\n- [ ] Response time <100ms (instant feedback)\n- [ ] Progress updates every 2-5 seconds\n- [ ] Campaign completes in 1-2 minutes\n- [ ] Results show accurate data (not 0 leads)\n- [ ] Cost calculation is correct\n- [ ] No timeout errors\n\n**If all checked**: ðŸŽ‰ **YOU'RE PRODUCTION READY!**\n\n---\n\n## ðŸš¨ Troubleshooting\n\n### Issue: \"Invalid JWT\" Error\n\n**What you see**:\n\n```json\n{ \"error\": \"Invalid JWT\" }\n```\n\n**Fix**:\n\n1. Get fresh publishable key from Supabase Dashboard â†’ Settings â†’ API\n2. Update in terminal: `export NEXT_PUBLIC_SUPABASE_ANON_KEY=\"new_key\"`\n3. Re-run test: `./scripts/test-background-tasks.sh`\n\n- [ ] Fixed\n\n---\n\n### Issue: \"Foreign Key Constraint\" Error\n\n**What you see**:\n\n```json\n{\n  \"success\": false,\n  \"error\": \"Failed to create job: insert or update on table \\\"discovery_jobs\\\" violates foreign key constraint \\\"discovery_jobs_campaign_id_fkey\\\"\"\n}\n```\n\n**What happened**: The old schema had a foreign key constraint that required the campaign to exist before the job, but the job is created first.\n\n**Fix**:\n\n1. Open Supabase Dashboard â†’ SQL Editor\n2. Run this migration script:\n\n```sql\n-- Drop and recreate table without foreign key constraint\nDROP TABLE IF EXISTS discovery_jobs CASCADE;\n\nCREATE TABLE discovery_jobs (\n  id TEXT PRIMARY KEY,\n  campaign_id TEXT, -- No FK constraint\n  user_id UUID REFERENCES auth.users(id),\n  session_user_id TEXT,\n  status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'processing', 'completed', 'failed')),\n  progress INTEGER DEFAULT 0 CHECK (progress >= 0 AND progress <= 100),\n  current_stage TEXT DEFAULT 'initializing',\n  config JSONB NOT NULL,\n  results JSONB DEFAULT '[]'::jsonb,\n  metrics JSONB DEFAULT '{}'::jsonb,\n  error TEXT,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  started_at TIMESTAMPTZ,\n  completed_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\nCREATE INDEX idx_jobs_status ON discovery_jobs(status) WHERE status IN ('pending', 'processing');\nCREATE INDEX idx_jobs_user ON discovery_jobs(user_id);\nCREATE INDEX idx_jobs_session ON discovery_jobs(session_user_id);\nCREATE INDEX idx_jobs_campaign ON discovery_jobs(campaign_id);\nCREATE INDEX idx_jobs_created ON discovery_jobs(created_at DESC);\n\nALTER TABLE discovery_jobs ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY jobs_select_own ON discovery_jobs\n  FOR SELECT USING (auth.uid() = user_id OR (auth.uid() IS NULL AND session_user_id IS NOT NULL));\n\nCREATE POLICY jobs_insert_own ON discovery_jobs\n  FOR INSERT WITH CHECK (auth.uid() = user_id OR (auth.uid() IS NULL AND session_user_id IS NOT NULL));\n\nCREATE OR REPLACE FUNCTION update_discovery_jobs_updated_at()\nRETURNS TRIGGER AS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER trigger_update_discovery_jobs_updated_at\n  BEFORE UPDATE ON discovery_jobs\n  FOR EACH ROW\n  EXECUTE FUNCTION update_discovery_jobs_updated_at();\n```\n\n3. Click \"RUN\"\n4. Re-run test: `./scripts/test-background-tasks.sh`\n\n**Alternative**: Copy/paste from `/database/fix-foreign-key-constraint.sql`\n\n- [ ] Fixed\n\n---\n\n### Issue: Job Stays in \"Pending\"\n\n**What you see**: Job never progresses past \"pending\" status\n\n**Fix**:\n\n1. Check Edge Function logs:\n   - Supabase Dashboard â†’ Edge Functions â†’ business-discovery-background â†’ Logs\n2. Look for error messages\n3. Usually API key issue - verify these are set:\n   - Edge Functions â†’ business-discovery-background â†’ Settings â†’ Secrets\n   - Should see: GOOGLE_PLACES_API_KEY, HUNTER_IO_API_KEY, NEVERBOUNCE_API_KEY\n\n- [ ] Fixed\n\n---\n\n### Issue: No Leads in Database\n\n**What you see**: Campaign completes but leads table is empty\n\n**Fix**:\n\n1. Check RLS policies:\n   ```sql\n   -- Run in SQL Editor:\n   SELECT * FROM campaigns WHERE id = 'your_campaign_id';\n   SELECT * FROM leads WHERE campaign_id = 'your_campaign_id';\n   ```\n2. If returns empty, run `/database/rls-setup.sql` again\n\n- [ ] Fixed\n\n---\n\n### Issue: Real-time Updates Not Working\n\n**What you see**: Progress page shows \"Loading...\" forever\n\n**Fix**:\n\n1. Enable Supabase Real-time:\n   - Dashboard â†’ Database â†’ Replication\n   - Find `discovery_jobs` table\n   - Toggle \"Enable\" if disabled\n2. Check browser console for errors (F12 â†’ Console tab)\n\n- [ ] Fixed\n\n---\n\n### Issue: Test Script Fails\n\n**What you see**: Test script exits with error\n\n**Fix**:\n\n1. Check if `NEXT_PUBLIC_SUPABASE_ANON_KEY` (or `VITE_SUPABASE_ANON_KEY`) is set:\n   ```bash\n   echo $NEXT_PUBLIC_SUPABASE_ANON_KEY\n   ```\n   Should print your key. If empty, set it again.\n2. Check if function is deployed:\n   ```bash\n   supabase functions list\n   ```\n   Should show `business-discovery-background`. If not, deploy again.\n\n- [ ] Fixed\n\n---\n\n## ðŸ“ž Getting Help\n\n### Debugging Commands\n\n**Check Edge Function logs**:\n\n```bash\n# View recent logs\nsupabase functions logs business-discovery-background\n```\n\n**Check database directly**:\n\n```sql\n-- In Supabase SQL Editor:\nSELECT * FROM discovery_jobs ORDER BY created_at DESC LIMIT 5;\nSELECT * FROM campaigns ORDER BY created_at DESC LIMIT 5;\nSELECT * FROM leads ORDER BY created_at DESC LIMIT 10;\n```\n\n**Test Edge Function directly**:\n\n```bash\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background' \\\n  -H \"Authorization: Bearer $NEXT_PUBLIC_SUPABASE_ANON_KEY\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\": \"coffee shop\", \"location\": \"Seattle\", \"maxResults\": 2, \"sessionUserId\": \"test\"}'\n```\n\n### Documentation to Check\n\n- [ ] `/QUICKSTART_BACKGROUND_TASKS.md` - Detailed guide\n- [ ] `/BACKGROUND_TASKS_IMPLEMENTATION.md` - Technical details\n- [ ] `/VISUAL_SUMMARY_BACKGROUND_TASKS.md` - Diagrams and flow\n- [ ] Supabase Edge Function logs\n- [ ] Browser console (F12)\n\n---\n\n## ðŸŽ‰ Success Criteria\n\n**You know you're done when**:\n\n### Basic Functionality\n\n- [ ] Test campaign creates job record\n- [ ] Job progresses through all stages\n- [ ] Campaign completes with >0 leads\n- [ ] Data appears in database correctly\n- [ ] No errors in Edge Function logs\n\n### User Experience\n\n- [ ] Frontend redirects to progress page\n- [ ] Progress bar updates automatically\n- [ ] Stage labels change appropriately\n- [ ] Metrics display during processing\n- [ ] Completion message appears\n- [ ] Results page shows accurate data\n\n### Production Ready\n\n- [ ] Deployed to Vercel\n- [ ] Real users can submit campaigns\n- [ ] Campaigns complete in 1-2 minutes\n- [ ] No timeout errors\n- [ ] Dashboard shows accurate data\n\n**All checked?** ðŸŽ‰ **CONGRATULATIONS! You're production ready!**\n\n---\n\n## ðŸ“Š Metrics to Monitor\n\nAfter deployment, track these:\n\n### Daily (First Week)\n\n- [ ] Number of campaigns submitted\n- [ ] Number of campaigns completed successfully\n- [ ] Average completion time\n- [ ] Number of leads generated\n- [ ] Total cost per campaign\n\n### Weekly\n\n- [ ] Success rate (completed / total)\n- [ ] Average leads per campaign\n- [ ] Cost per lead\n- [ ] User feedback on progress page\n\n### Monthly\n\n- [ ] Total campaigns processed\n- [ ] Infrastructure costs (should be $0)\n- [ ] Edge Function usage (vs free tier limit)\n- [ ] Database storage usage\n\n---\n\n## ðŸš€ Next Steps After Deployment\n\n### Immediate (This Week)\n\n- [ ] Monitor first 10 real campaigns\n- [ ] Collect user feedback on progress page\n- [ ] Document any issues encountered\n- [ ] Optimize progress update frequency if needed\n\n### Short-term (This Month)\n\n- [ ] Add error recovery (retry failed jobs)\n- [ ] Implement email notifications for completed campaigns\n- [ ] Create admin dashboard for monitoring all jobs\n- [ ] Add campaign history page\n\n### Long-term (Next Quarter)\n\n- [ ] Integrate Stripe for paid tiers\n- [ ] Add advanced filters (industry, revenue size)\n- [ ] Implement bulk campaign creation\n- [ ] Add team collaboration features\n\n---\n\n## ðŸ“š Resources\n\n### Documentation\n\n- **Quick Start**: `/QUICKSTART_BACKGROUND_TASKS.md`\n- **Full Implementation**: `/BACKGROUND_TASKS_IMPLEMENTATION.md`\n- **Architecture Decision**: `/ARCHITECTURE_DECISION_BACKGROUND_TASKS.md`\n- **Visual Summary**: `/VISUAL_SUMMARY_BACKGROUND_TASKS.md`\n\n### Scripts\n\n- **Deploy Script**: `/scripts/deploy-background-tasks.sh`\n- **Test Script**: `/scripts/test-background-tasks.sh`\n\n### Code\n\n- **Database Schema**: `/database/job-queue-schema.sql`\n- **Edge Function**: `/supabase/functions/business-discovery-background/index.ts`\n- **React Hook**: `/src/hooks/useJobProgress.tsx`\n\n### External\n\n- **Supabase Docs**: https://supabase.com/docs/guides/functions/background-tasks\n- **Edge Runtime**: https://supabase.com/docs/guides/functions/architecture\n- **Real-time**: https://supabase.com/docs/guides/realtime\n\n---\n\n## âœ… Completion Certificate\n\n**I, Alex, have successfully:**\n\n- [ ] Deployed job queue database schema\n- [ ] Deployed background task Edge Function\n- [ ] Tested backend with real campaigns\n- [ ] Integrated frontend with progress page\n- [ ] Deployed to production on Vercel\n- [ ] Verified real-time updates working\n- [ ] Confirmed accurate lead data\n- [ ] Achieved zero timeout errors\n\n**Date completed**: **\\*\\***\\_\\_\\_\\_**\\*\\***\n\n**First successful campaign ID**: **\\*\\***\\_\\_\\_\\_**\\*\\***\n\n**Number of leads generated**: **\\*\\***\\_\\_\\_\\_**\\*\\***\n\n---\n\n**ðŸŽ‰ YOU DID IT! Your app now handles long-running campaigns perfectly!** ðŸš€\n\n**No timeouts. Real-time progress. Accurate data. $0 cost.**\n\n**Ready for users. Ready for growth. Ready for success.** ðŸ’ª\n"}}},
{"type":"measure","name":"lsp.did_open","count":30,"duration":0.147},
{"type":"mark","name":"lsp.did_open","count":31,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","languageId":"markdown","version":1,"text":"# ðŸš€ Quick Start: Deploy Background Tasks in 15 Minutes\n\n**For Alex - Zero Coding Experience Needed**\n\n---\n\n## âœ… Pre-flight Checklist\n\n- [ ] Supabase project: ProspectPro-Production (sriycekxdqnesdsgwiuc)\n- [ ] Supabase CLI installed (`supabase --version`)\n- [ ] GitHub Codespaces open with this repo\n- [ ] API keys configured in Supabase (Google Places, Hunter.io, NeverBounce)\n\nAll good? Let's go! ðŸš€\n\n---\n\n## Step 1: Deploy Database Schema (5 min)\n\n### Open Supabase Dashboard\n\n```\n1. Go to: https://supabase.com/dashboard\n2. Select: ProspectPro-Production\n3. Click: SQL Editor (left sidebar)\n```\n\n### Run Schema Script\n\n```\n1. Click: \"+ New query\"\n2. Copy entire contents of: /database/job-queue-schema.sql\n3. Paste into SQL editor\n4. Click: \"RUN\" button (bottom right)\n5. Wait for: \"Success. No rows returned\"\n```\n\n### Verify Table Created\n\n```\n1. Click: \"Database\" â†’ \"Tables\" (left sidebar)\n2. Look for: \"discovery_jobs\" table\n3. Should show: 11 columns (id, campaign_id, status, etc)\n```\n\nâœ… **Step 1 Complete!** Job queue database ready.\n\n---\n\n## Step 2: Deploy Edge Function (3 min)\n\n### Open Terminal in Codespaces\n\n```\n1. Click: Terminal menu â†’ New Terminal\n2. Should see: @Alextorelli âžœ /workspaces/ProspectPro $\n```\n\n### Deploy Function\n\n```bash\n# Copy and paste this command:\nsupabase functions deploy business-discovery-background --no-verify-jwt\n```\n\n### Expected Output\n\n```\nDeploying function business-discovery-background...\nâœ“ Function deployed successfully\nâœ“ No JWT verification required\n```\n\n### Verify Deployment\n\n```bash\n# List all functions:\nsupabase functions list\n```\n\nShould show:\n\n```\nbusiness-discovery-background (deployed)\nbusiness-discovery-user-aware (deployed)\nenrichment-orchestrator (deployed)\n... (others)\n```\n\nâœ… **Step 2 Complete!** Edge Function deployed.\n\n---\n\n## Step 3: Test Backend (5 min)\n\n### Get Your Publishable Key\n\n```\n1. Supabase Dashboard â†’ Settings â†’ API\n2. Copy: \"publishable\" key (starts with \"sb_publishable_\")\n3. Keep it handy for next step\n```\n\n### Run Test Script\n\n```bash\n# In Codespaces terminal:\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY=\"paste_your_publishable_key_here\"\n\n# Run test:\n./scripts/test-background-tasks.sh\n```\n\n### Expected Output\n\n```\nðŸ§ª Testing Background Task Architecture\n========================================\n\nâœ… Anon key configured\n\nTest 1: Checking Edge Function deployment...\nCreating test campaign (coffee shops in Portland)...\n\nResponse:\n{\n  \"success\": true,\n  \"jobId\": \"job_1234567890_abc123\",\n  \"campaignId\": \"campaign_1234567890_xyz789\",\n  \"status\": \"processing\",\n  \"estimatedTime\": \"1-2 minutes\"\n}\n\nâœ… Test 1 PASSED: Campaign created\n   Job ID: job_1234567890_abc123\n   Campaign ID: campaign_1234567890_xyz789\n\nTest 2: Monitoring job progress (30 seconds)...\n[1/6] Status: processing | Progress: 10% | Stage: discovering_businesses\n[2/6] Status: processing | Progress: 30% | Stage: scoring_businesses\n[3/6] Status: processing | Progress: 50% | Stage: enriching_contacts\n[4/6] Status: processing | Progress: 70% | Stage: enriching_contacts\n[5/6] Status: processing | Progress: 90% | Stage: storing_results\n[6/6] Status: completed | Progress: 100% | Stage: storing_results\n\nâœ… Test 2 PASSED: Job completed successfully!\n\nMetrics:\n{\n  \"total_found\": 2,\n  \"total_cost\": 0.52,\n  \"avg_confidence\": 87\n}\n\nTest 3: Verifying database records...\nâœ… Campaign record found\n   Results: 2 leads\n   Cost: $0.52\nâœ… Test 3 PASSED: 2 leads found in database\n\n========================================\nðŸŽ‰ Background Task Architecture Test Complete!\n```\n\n### If Test Fails\n\n**Scenario A: \"Invalid JWT\" error**\n\n```bash\n# Get fresh publishable key from Supabase Dashboard\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY=\"new_publishable_key\"\n./scripts/test-background-tasks.sh\n```\n\n**Scenario B: \"Function not found\" error**\n\n```bash\n# Redeploy function\nsupabase functions deploy business-discovery-background --no-verify-jwt\n./scripts/test-background-tasks.sh\n```\n\n**Scenario C: Job stays in \"pending\"**\n\n```\n1. Go to: Supabase Dashboard â†’ Edge Functions â†’ Logs\n2. Look for: business-discovery-background logs\n3. Check for: Error messages\n4. Fix: Usually API key issue (Google Places, Hunter.io)\n```\n\nâœ… **Step 3 Complete!** Backend fully tested and working.\n\n---\n\n## Step 4: View Results in Dashboard (2 min)\n\n### Check Job Record\n\n```\n1. Supabase Dashboard â†’ Database â†’ discovery_jobs\n2. Filter by: id (use jobId from test)\n3. Should see: status = \"completed\", progress = 100\n```\n\n### Check Campaign Record\n\n```\n1. Database â†’ campaigns\n2. Filter by: id (use campaignId from test)\n3. Should see: results_count = 2, total_cost = 0.52\n```\n\n### Check Leads\n\n```\n1. Database â†’ leads\n2. Filter by: campaign_id (use campaignId from test)\n3. Should see: 2 rows with business names, emails, phones\n```\n\nâœ… **Step 4 Complete!** Data verified in database.\n\n---\n\n## Step 5: Frontend Integration (Coming Next)\n\n### What You Need to Do\n\n**A. Update Campaign Form** (file: `src/components/CampaignForm.tsx`)\n\nChange API endpoint from:\n\n```typescript\n// OLD:\nconst response = await fetch('.../business-discovery-user-aware', ...)\n\n// NEW:\nconst response = await fetch('.../business-discovery-background', ...)\n```\n\nResponse will include `jobId`:\n\n```typescript\nconst { jobId, campaignId } = await response.json();\nnavigate(`/campaign/${campaignId}/progress?jobId=${jobId}`);\n```\n\n**B. Create Progress Page** (file: `src/pages/CampaignProgress.tsx`)\n\nCopy this template:\n\n```typescript\nimport { useJobProgress, JobProgressDisplay } from \"../hooks/useJobProgress\";\nimport { useParams, useSearchParams } from \"react-router-dom\";\n\nexport function CampaignProgress() {\n  const { campaignId } = useParams();\n  const [searchParams] = useSearchParams();\n  const jobId = searchParams.get(\"jobId\");\n\n  return (\n    <div className=\"campaign-progress-page\">\n      <h1>Campaign In Progress</h1>\n      {jobId && <JobProgressDisplay jobId={jobId} />}\n    </div>\n  );\n}\n```\n\n**C. Add Route** (file: `src/App.tsx`)\n\n```typescript\n<Route path=\"/campaign/:campaignId/progress\" element={<CampaignProgress />} />\n```\n\n**That's it!** Real-time progress updates will work automatically via the `useJobProgress` hook.\n\n---\n\n## ðŸŽ¯ What You Just Built\n\n### Before (Broken)\n\n```\nUser submits campaign\n  â†“\nEdge Function times out (25 seconds)\n  â†“\nReturns 0 leads (incomplete)\n  â†“\nDashboard shows wrong data\n```\n\n### After (Working)\n\n```\nUser submits campaign\n  â†“\nEdge Function returns immediately (<100ms)\n  â†“\nShows progress page with live updates\n  â†“\nBackground task completes (1-2 minutes)\n  â†“\nShows accurate results\n```\n\n### Key Improvements\n\n- âœ… No timeouts (unlimited processing time)\n- âœ… Real-time progress updates\n- âœ… Accurate lead data\n- âœ… Correct cost tracking\n- âœ… Better user experience\n\n---\n\n## ðŸ“Š Monitoring Your App\n\n### Real-time Job Monitoring\n\n**Supabase Dashboard â†’ Database â†’ discovery_jobs**\n\n```sql\nSELECT id, status, progress, current_stage, metrics\nFROM discovery_jobs\nORDER BY created_at DESC\nLIMIT 10;\n```\n\nShows last 10 jobs with:\n\n- Status: pending, processing, completed, failed\n- Progress: 0-100%\n- Stage: discovering, scoring, enriching, storing\n- Metrics: leads found, cost, avg confidence\n\n### Campaign Results\n\n**Database â†’ campaigns**\n\n```sql\nSELECT business_type, location, results_count, total_cost, created_at\nFROM campaigns\nORDER BY created_at DESC\nLIMIT 10;\n```\n\n### Edge Function Logs\n\n**Supabase Dashboard â†’ Edge Functions â†’ Logs**\n\n- Filter by: business-discovery-background\n- Shows: All function executions, errors, console.log output\n- Refresh every few seconds during testing\n\n---\n\n## ðŸš¨ Common Issues & Fixes\n\n### Issue 1: \"Function returns 401 Invalid JWT\"\n\n**Cause**: Publishable key mismatch  \n**Fix**:\n\n```bash\n# Get current publishable key from Supabase Dashboard\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY=\"fresh_key_from_dashboard\"\n./scripts/test-background-tasks.sh\n```\n\n### Issue 2: \"Job stays in pending status\"\n\n**Cause**: Background task not starting  \n**Fix**:\n\n1. Check Edge Function logs (Dashboard â†’ Edge Functions â†’ Logs)\n2. Look for error message\n3. Usually API key issue:\n   - Dashboard â†’ Edge Functions â†’ business-discovery-background â†’ Settings\n   - Verify: GOOGLE_PLACES_API_KEY, HUNTER_IO_API_KEY, NEVERBOUNCE_API_KEY\n\n### Issue 3: \"No leads in database\"\n\n**Cause**: Database permissions (RLS policies)  \n**Fix**:\n\n```sql\n-- Run in SQL Editor:\nSELECT * FROM campaigns WHERE id = 'your_campaign_id';\nSELECT * FROM leads WHERE campaign_id = 'your_campaign_id';\n```\n\nIf returns empty, RLS policies may be blocking. Check user_id and session_user_id match.\n\n### Issue 4: \"Real-time updates not appearing in frontend\"\n\n**Cause**: Supabase Real-time not enabled  \n**Fix**:\n\n1. Dashboard â†’ Database â†’ Replication\n2. Enable replication for: discovery_jobs table\n3. Click \"Enable\"\n\n---\n\n## âœ… Success Checklist\n\nAfter deployment, you should have:\n\n- [x] **Database**: `discovery_jobs` table exists\n- [x] **Edge Function**: `business-discovery-background` deployed\n- [x] **Test Campaign**: Completed successfully with >0 leads\n- [x] **Database Records**: Campaign and leads visible in dashboard\n- [x] **Logs**: No errors in Edge Function logs\n- [x] **Real-time**: Job progress updates visible in database\n\nIf all checked: **ðŸŽ‰ YOU'RE PRODUCTION READY!**\n\n---\n\n## ðŸš€ Next Steps\n\n### Immediate\n\n1. Integrate frontend (Step 5 above)\n2. Test with real campaigns (different business types, locations)\n3. Monitor costs and performance\n\n### This Week\n\n1. Deploy to production (Vercel)\n2. Share with beta users\n3. Collect feedback on progress page UX\n\n### This Month\n\n1. Add Stripe integration (paid tiers)\n2. Implement advanced filters\n3. Add email notifications for completed campaigns\n\n---\n\n## ðŸ“š Documentation Reference\n\n- **Full Implementation Guide**: `/BACKGROUND_TASKS_IMPLEMENTATION.md`\n- **Architecture Decision**: `/ARCHITECTURE_DECISION_BACKGROUND_TASKS.md`\n- **Database Schema**: `/database/job-queue-schema.sql`\n- **Edge Function**: `/supabase/functions/business-discovery-background/index.ts`\n- **Frontend Hook**: `/src/hooks/useJobProgress.tsx`\n- **Test Script**: `/scripts/test-background-tasks.sh`\n\n---\n\n## ðŸŽ¯ You Did It!\n\n**In 15 minutes you:**\n\n- âœ… Created a production-ready job queue system\n- âœ… Deployed background task Edge Function\n- âœ… Implemented real-time progress tracking\n- âœ… Tested with live campaigns\n- âœ… Fixed the timeout issue permanently\n\n**Cost**: $0 additional  \n**Maintenance**: Zero  \n**Scalability**: Unlimited\n\n**Your app now handles 1-2 minute campaigns without timeouts!** ðŸš€\n\n---\n\n**Questions?** Check the full docs or Edge Function logs.  \n**Issues?** Run the test script again to diagnose.  \n**Ready?** Deploy to production! ðŸŽ‰\n"}}},
{"type":"measure","name":"lsp.did_open","count":31,"duration":0.106},
{"type":"mark","name":"lsp.did_open","count":32,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/INDEX_BACKGROUND_TASKS.md","languageId":"markdown","version":1,"text":"# ðŸŽ¯ Background Tasks - Complete Implementation Package\n\n## ðŸ“¦ Package Contents\n\nThis is your complete solution to the Edge Function timeout issue. Everything you need is here.\n\n---\n\n## ðŸš€ START HERE\n\n### For Alex (Recommended) â­\n\n**File**: `DEPLOYMENT_CHECKLIST.md`  \n**What**: Step-by-step checklist with checkboxes  \n**Time**: 30 minutes  \n**Format**: Copy-paste commands, troubleshooting included\n\n### For Fast Deployment\n\n**File**: `QUICKSTART_BACKGROUND_TASKS.md`  \n**What**: Condensed deployment guide  \n**Time**: 15 minutes  \n**Format**: Commands and brief explanations\n\n### For Understanding First\n\n**File**: `README_BACKGROUND_TASKS.md`  \n**What**: Overview and introduction  \n**Time**: 5 minutes  \n**Format**: High-level summary\n\n---\n\n## ðŸ“š Complete Documentation Set\n\n### 1. **DEPLOYMENT_CHECKLIST.md** â­ START HERE\n\n- **Purpose**: Deploy step-by-step with confidence\n- **Format**: Checkboxes for each step\n- **Includes**: Troubleshooting for every common issue\n- **Best for**: Alex, first-time deployers, methodical approach\n- **Time**: 30 minutes\n\n### 2. **QUICKSTART_BACKGROUND_TASKS.md**\n\n- **Purpose**: Fast deployment guide\n- **Format**: Condensed steps with commands\n- **Includes**: 5 phases from database to production\n- **Best for**: Experienced developers, quick reference\n- **Time**: 15 minutes\n\n### 3. **README_BACKGROUND_TASKS.md**\n\n- **Purpose**: Introduction and overview\n- **Format**: What, why, how summary\n- **Includes**: Quick start paths, success criteria\n- **Best for**: Understanding the package first\n- **Time**: 5 minutes\n\n### 4. **BACKGROUND_TASKS_IMPLEMENTATION.md**\n\n- **Purpose**: Complete technical documentation\n- **Format**: Comprehensive reference\n- **Includes**: Architecture, code examples, monitoring, testing\n- **Best for**: Deep understanding, reference during development\n- **Time**: 1 hour to read, lifetime reference\n\n### 5. **VISUAL_SUMMARY_BACKGROUND_TASKS.md**\n\n- **Purpose**: Diagrams and visual explanations\n- **Format**: ASCII diagrams, flow charts, comparisons\n- **Includes**: Before/after, architecture diagrams, stage flows\n- **Best for**: Visual learners, presentations\n- **Time**: 20 minutes\n\n### 6. **ARCHITECTURE_DECISION_BACKGROUND_TASKS.md**\n\n- **Purpose**: Why we chose this approach\n- **Format**: Comparison matrix, cost analysis\n- **Includes**: vs External Compute, vs Vercel Functions\n- **Best for**: Understanding trade-offs, justifying decisions\n- **Time**: 30 minutes\n\n### 7. **INDEX_BACKGROUND_TASKS.md** (this file)\n\n- **Purpose**: Navigation guide for all docs\n- **Format**: Index with descriptions\n- **Includes**: When to use each document\n- **Best for**: Finding the right doc quickly\n- **Time**: 2 minutes\n\n---\n\n## ðŸ—‚ï¸ Files by Category\n\n### Documentation (7 files)\n\n```\nREADME_BACKGROUND_TASKS.md              - Overview and introduction\nDEPLOYMENT_CHECKLIST.md                 - Step-by-step deployment â­\nQUICKSTART_BACKGROUND_TASKS.md          - Fast 15-min guide\nBACKGROUND_TASKS_IMPLEMENTATION.md      - Complete technical docs\nVISUAL_SUMMARY_BACKGROUND_TASKS.md      - Diagrams and flows\nARCHITECTURE_DECISION_BACKGROUND_TASKS.md - Why this approach\nINDEX_BACKGROUND_TASKS.md               - This navigation guide\n```\n\n### Code (4 files)\n\n```\ndatabase/job-queue-schema.sql           - Database schema\nsupabase/functions/business-discovery-background/index.ts - Edge Function\nsrc/hooks/useJobProgress.tsx            - React hook\nsrc/pages/CampaignProgress.tsx          - Progress page (template)\n```\n\n### Scripts (2 files)\n\n```\nscripts/deploy-background-tasks.sh      - Automated deployment\nscripts/test-background-tasks.sh        - Automated testing\n```\n\n**Total**: 13 files\n\n---\n\n## ðŸŽ¯ Usage Guide\n\n### Scenario 1: \"I want to deploy now\"\n\n1. Read: `README_BACKGROUND_TASKS.md` (5 min)\n2. Follow: `DEPLOYMENT_CHECKLIST.md` (30 min)\n3. Reference: Troubleshooting section if issues arise\n\n### Scenario 2: \"I want to understand first\"\n\n1. Read: `README_BACKGROUND_TASKS.md` (5 min)\n2. Read: `VISUAL_SUMMARY_BACKGROUND_TASKS.md` (20 min)\n3. Read: `BACKGROUND_TASKS_IMPLEMENTATION.md` (1 hour)\n4. Deploy: `DEPLOYMENT_CHECKLIST.md` (30 min)\n\n### Scenario 3: \"I know what I'm doing\"\n\n1. Skim: `QUICKSTART_BACKGROUND_TASKS.md` (5 min)\n2. Deploy: Follow 5 phases (15 min)\n3. Reference: `BACKGROUND_TASKS_IMPLEMENTATION.md` if needed\n\n### Scenario 4: \"I need to explain this to someone\"\n\n1. Share: `README_BACKGROUND_TASKS.md` (overview)\n2. Show: `VISUAL_SUMMARY_BACKGROUND_TASKS.md` (diagrams)\n3. Justify: `ARCHITECTURE_DECISION_BACKGROUND_TASKS.md` (why)\n\n### Scenario 5: \"Something's broken\"\n\n1. Check: `DEPLOYMENT_CHECKLIST.md` â†’ Troubleshooting\n2. Run: `./scripts/test-background-tasks.sh`\n3. Review: Supabase Edge Function logs\n4. Reference: `BACKGROUND_TASKS_IMPLEMENTATION.md` â†’ Troubleshooting\n\n---\n\n## ðŸ“Š Documentation Matrix\n\n| Document              | Deploy | Understand | Troubleshoot | Explain | Reference |\n| --------------------- | ------ | ---------- | ------------ | ------- | --------- |\n| DEPLOYMENT_CHECKLIST  | â­â­â­ | â­         | â­â­â­       | -       | â­        |\n| QUICKSTART            | â­â­â­ | â­         | â­           | -       | â­â­      |\n| README                | â­     | â­â­â­     | -            | â­â­â­  | â­        |\n| IMPLEMENTATION        | â­     | â­â­â­     | â­â­         | â­      | â­â­â­    |\n| VISUAL_SUMMARY        | -      | â­â­â­     | â­           | â­â­â­  | â­â­      |\n| ARCHITECTURE_DECISION | -      | â­â­       | -            | â­â­â­  | â­â­      |\n\n---\n\n## ðŸ” Quick Reference\n\n### Database Schema\n\n**File**: `database/job-queue-schema.sql`  \n**What**: Creates `discovery_jobs` table with RLS policies  \n**When**: Phase 1 of deployment  \n**How**: Copy-paste into Supabase SQL Editor\n\n### Edge Function\n\n**File**: `supabase/functions/business-discovery-background/index.ts`  \n**What**: Background task processor with `EdgeRuntime.waitUntil()`  \n**When**: Phase 2 of deployment  \n**How**: `supabase functions deploy business-discovery-background --no-verify-jwt`\n\n### React Hook\n\n**File**: `src/hooks/useJobProgress.tsx`  \n**What**: Real-time progress tracking via Supabase Real-time  \n**When**: Phase 5 of deployment (frontend)  \n**How**: Import and use in progress page component\n\n### Deployment Script\n\n**File**: `scripts/deploy-background-tasks.sh`  \n**What**: Automated deployment (all phases)  \n**When**: Alternative to manual deployment  \n**How**: `chmod +x scripts/deploy-background-tasks.sh && ./scripts/deploy-background-tasks.sh`\n\n### Test Script\n\n**File**: `scripts/test-background-tasks.sh`  \n**What**: Automated backend testing  \n**When**: Phase 3 of deployment, or when troubleshooting  \n**How**: `export NEXT_PUBLIC_SUPABASE_ANON_KEY=\"...\" && ./scripts/test-background-tasks.sh`\n\n---\n\n## ðŸŽ¯ Key Concepts\n\n### Background Tasks\n\n**What**: Tasks that run AFTER Edge Function response is sent  \n**How**: `EdgeRuntime.waitUntil(longRunningTask())`  \n**Why**: No timeout limits, unlimited processing time  \n**Docs**: BACKGROUND_TASKS_IMPLEMENTATION.md â†’ Architecture section\n\n### Job Queue\n\n**What**: Database table tracking background job status  \n**Schema**: `discovery_jobs` table with status, progress, metrics  \n**Updates**: Real-time via Supabase Real-time channels  \n**Docs**: VISUAL_SUMMARY_BACKGROUND_TASKS.md â†’ Database Schema\n\n### Real-time Progress\n\n**What**: Live updates from backend to frontend  \n**How**: Supabase Real-time subscriptions  \n**UI**: Progress bar, stage labels, metrics  \n**Docs**: BACKGROUND_TASKS_IMPLEMENTATION.md â†’ Real-time Updates\n\n---\n\n## âœ… Success Checklist\n\n### Deployment Success\n\n- [ ] Database schema created\n- [ ] Edge Function deployed\n- [ ] Test campaign completes\n- [ ] Frontend shows progress\n- [ ] Production deployment works\n\n### Verification\n\n- [ ] No timeouts (processes 1-2 minutes)\n- [ ] Real-time updates working\n- [ ] Accurate lead data\n- [ ] Cost tracking correct\n- [ ] No errors in logs\n\n**All checked?** Read success section in `DEPLOYMENT_CHECKLIST.md`\n\n---\n\n## ðŸš¨ Common Issues\n\n### \"Where do I start?\"\n\nâ†’ Read `README_BACKGROUND_TASKS.md` then follow `DEPLOYMENT_CHECKLIST.md`\n\n### \"Something's not working\"\n\nâ†’ Check troubleshooting in `DEPLOYMENT_CHECKLIST.md`\n\n### \"I want to understand why we did this\"\n\nâ†’ Read `ARCHITECTURE_DECISION_BACKGROUND_TASKS.md`\n\n### \"I need visuals\"\n\nâ†’ See `VISUAL_SUMMARY_BACKGROUND_TASKS.md`\n\n### \"I need complete reference\"\n\nâ†’ See `BACKGROUND_TASKS_IMPLEMENTATION.md`\n\n---\n\n## ðŸ“ž Getting Help\n\n### Step 1: Check Troubleshooting\n\n- `DEPLOYMENT_CHECKLIST.md` â†’ Troubleshooting section\n- Most common issues covered\n\n### Step 2: Run Diagnostics\n\n```bash\n# Test backend\n./scripts/test-background-tasks.sh\n\n# Check deployment\nsupabase functions list\n\n# View logs\nsupabase functions logs business-discovery-background\n```\n\n### Step 3: Check Documentation\n\n- Issue during deployment? â†’ `DEPLOYMENT_CHECKLIST.md`\n- Don't understand flow? â†’ `VISUAL_SUMMARY_BACKGROUND_TASKS.md`\n- Technical question? â†’ `BACKGROUND_TASKS_IMPLEMENTATION.md`\n\n### Step 4: Database Check\n\n```sql\n-- In Supabase SQL Editor\nSELECT * FROM discovery_jobs ORDER BY created_at DESC LIMIT 5;\n```\n\n---\n\n## ðŸŽ“ Learning Path\n\n### Level 1: Get It Working (30 min)\n\n1. `README_BACKGROUND_TASKS.md` - Understand what you're building\n2. `DEPLOYMENT_CHECKLIST.md` - Deploy step-by-step\n3. Test with real campaign\n\n### Level 2: Understand It (2 hours)\n\n1. `VISUAL_SUMMARY_BACKGROUND_TASKS.md` - See the flow\n2. `BACKGROUND_TASKS_IMPLEMENTATION.md` - Technical details\n3. Review code in `/supabase/functions/business-discovery-background/`\n\n### Level 3: Master It (4 hours)\n\n1. `ARCHITECTURE_DECISION_BACKGROUND_TASKS.md` - Trade-offs\n2. Experiment with modifications\n3. Monitor production usage\n4. Optimize based on metrics\n\n---\n\n## ðŸ“Š Documentation Statistics\n\n- **Total Documents**: 7\n- **Total Code Files**: 4\n- **Total Scripts**: 2\n- **Total Words**: ~25,000\n- **Total Reading Time**: ~3 hours\n- **Deployment Time**: 30 minutes\n- **Understanding Time**: 1 hour\n\n---\n\n## ðŸŽ¯ What You Get\n\n### Immediate Benefits\n\n- âœ… No more Edge Function timeouts\n- âœ… Real-time progress updates\n- âœ… Accurate campaign data\n- âœ… Better user experience\n\n### Long-term Benefits\n\n- âœ… Scalable architecture\n- âœ… Zero infrastructure cost\n- âœ… Production-ready foundation\n- âœ… SaaS-ready platform\n\n### Documentation Benefits\n\n- âœ… Complete reference\n- âœ… Step-by-step guides\n- âœ… Troubleshooting coverage\n- âœ… Visual explanations\n\n---\n\n## ðŸš€ Next Steps\n\n### Right Now\n\n1. Read: `README_BACKGROUND_TASKS.md` (5 min)\n2. Choose: Deployment path (checklist vs quickstart)\n3. Deploy: Follow chosen guide (15-30 min)\n\n### This Week\n\n1. Monitor: First 10 real campaigns\n2. Optimize: Adjust based on feedback\n3. Document: Any custom changes\n\n### This Month\n\n1. Enhance: Add features (email notifications, etc)\n2. Scale: Monitor usage vs free tier limits\n3. Plan: Next phase (Stripe integration)\n\n---\n\n## âœ… You're Ready!\n\n**Everything you need is here:**\n\n- âœ… Complete documentation (7 guides)\n- âœ… Production code (4 files)\n- âœ… Automated scripts (2 scripts)\n- âœ… Troubleshooting coverage\n- âœ… Visual references\n\n**Start with**: `DEPLOYMENT_CHECKLIST.md`\n\n**Time to production**: 30 minutes\n\n**Additional cost**: $0\n\n---\n\n## ðŸŽ‰ Summary\n\n**Problem**: Edge Functions timeout at 25 seconds  \n**Solution**: Background tasks with real-time updates  \n**Result**: Perfect user experience at $0 cost\n\n**Documentation**: Complete âœ…  \n**Code**: Production ready âœ…  \n**Scripts**: Tested âœ…\n\n**Let's deploy!** â†’ `DEPLOYMENT_CHECKLIST.md` ðŸš€\n\n---\n\n**Created**: October 2025  \n**Version**: 4.2  \n**Status**: Production Ready  \n**For**: ProspectPro by Alex Torelli\n"}}},
{"type":"measure","name":"lsp.did_open","count":32,"duration":0.111},
{"type":"mark","name":"lsp.did_open","count":33,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/docs/deployment/ENHANCED_DEPLOYMENT_GUIDE.md","languageId":"markdown","version":1,"text":"# ðŸš€ Enhanced Business Discovery - Production Deployment Guide\n\n## Overview\n\nThe ProspectPro Enhanced Business Discovery system has been successfully integrated with:\n\n- **Enhanced State Registry Client** (7 government APIs)\n- **ZeroBounce Email Validation** (cost-optimized)\n- **Google Places API** (business discovery)\n- **Foursquare Places API** (business discovery and location intelligence)\n- **4-Stage Validation Pipeline** (pre-validation â†’ state registry â†’ email validation â†’ final scoring)\n\n## âœ… Integration Status\n\n### Core Components\n\n- âœ… **Enhanced State Registry Client**: Integrated with 7 free government APIs\n- âœ… **ZeroBounce Email Validation**: Cost-optimized validation with confidence scoring\n- âœ… **Google Places Integration**: Real business data discovery with zero fake data policy\n- âœ… **Foursquare Places Integration**: Business discovery and location intelligence\n- âœ… **Edge Functions**: TypeScript/Deno implementation ready for Supabase deployment\n- âœ… **Cost Optimization**: Pre-validation filtering and budget controls implemented\n\n### API Integrations\n\n1. **Google Places API** - Business discovery (Required)\n2. **Foursquare Places API** - Business discovery and location intelligence (Required)\n3. **California Secretary of State** - Business entity validation (Free)\n4. **New York Secretary of State** - Business registry search (Free)\n5. **NY State Tax Parcels** - Property intelligence (Free)\n6. **Connecticut UCC Filings** - Financial risk assessment (Free)\n7. **SEC EDGAR** - Public company verification (Free)\n8. **USPTO Trademarks** - Intellectual property verification (Free with API key)\n9. **CourtListener** - Legal risk assessment (Free with API key)\n10. **ZeroBounce** - Email validation (Paid - cost controlled)\n\n## ðŸ”§ Environment Configuration\n\n### Required Environment Variables\n\n```bash\n# Essential for business discovery\nexport GOOGLE_PLACES_API_KEY='your_google_places_api_key'\nexport FOURSQUARE_CLIENT_ID='your_client_id'\nexport FOURSQUARE_CLIENT_SECRET='your_client_secret'\n\n# Supabase deployment (frontend publishable key)\nexport NEXT_PUBLIC_SUPABASE_URL='https://your-project.supabase.co'\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY='your_publishable_key'\n\n# Supabase Edge Functions (server-side access)\nexport SUPABASE_SERVICE_ROLE_KEY='your_service_role_key'\n```\n\n### Optional Environment Variables (Enhanced Features)\n\n```bash\n# Email validation (recommended for B2B leads)\nexport ZEROBOUNCE_API_KEY='your_zerobounce_api_key'\n\n# Enhanced government data (free with registration)\nexport COURTLISTENER_API_KEY='your_courtlistener_api_key'\nexport USPTO_TSDR_API_KEY='your_uspto_api_key'\nexport SOCRATA_API_KEY='your_socrata_api_key'\nexport SOCRATA_APP_TOKEN='your_socrata_app_token'\n```\n\n## ðŸ“¦ Deployment Steps\n\n### 1. Environment Setup\n\n```bash\n# Configure environment variables in Supabase project settings:\n# Settings â†’ API â†’ Environment Variables\n\n# Core required variables:\nGOOGLE_PLACES_API_KEY=your_key_here\nFOURSQUARE_CLIENT_ID=your_key_here\nFOURSQUARE_CLIENT_SECRET=your_key_here\nSUPABASE_SERVICE_ROLE_KEY=your_key_here\nNEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co\nNEXT_PUBLIC_SUPABASE_ANON_KEY=sb_publishable_your_key\n\n# Optional enhanced features:\nZEROBOUNCE_API_KEY=your_key_here\nCOURTLISTENER_API_KEY=your_key_here\nUSPTO_TSDR_API_KEY=your_key_here\n```\n\n### 2. Deploy Edge Functions\n\n```bash\n# Install Supabase CLI\nnpm install supabase\n\n# Link to your project\nnpx supabase login\nnpx supabase link --project-ref your-project-ref\n\n# Deploy enhanced business discovery\nnpx supabase functions deploy enhanced-business-discovery\n\n# Deploy lead validation\nnpx supabase functions deploy lead-validation-edge\n```\n\n### 3. Test Deployment\n\n```bash\n# Test enhanced business discovery\ncurl -X POST 'https://your-project.supabase.co/functions/v1/enhanced-business-discovery' \\\n  --header 'Authorization: Bearer your-publishable-key' \\\n  --header 'Content-Type: application/json' \\\n  --data '{\n    \"query\": \"restaurants\",\n    \"location\": \"San Francisco, CA\",\n    \"maxResults\": 5,\n    \"budgetLimit\": 10.0,\n    \"qualityThreshold\": 75,\n    \"enableRegistryValidation\": true,\n    \"enableEmailValidation\": true\n  }'\n\n# Expected response includes enhanced validation data:\n{\n  \"totalFound\": 20,\n  \"qualifiedResults\": 12,\n  \"qualificationRate\": 85,\n  \"dataEnhancements\": {\n    \"stateRegistryValidations\": {\n      \"totalChecked\": 12,\n      \"validatedBusinesses\": 8,\n      \"validationRate\": 67\n    },\n    \"emailValidations\": {\n      \"totalValidated\": 5,\n      \"deliverableEmails\": 4,\n      \"deliverabilityRate\": 80\n    }\n  },\n  \"totalCost\": 2.45,\n  \"businesses\": [...]\n}\n\n# Test Foursquare integration\nnode test/test-foursquare-integration.js\n```\n\n## ðŸ’° Cost Optimization Features\n\n### Pre-validation Filtering\n\n- Filters out low-quality businesses before expensive API calls\n- Reduces API costs by 40-60%\n- Only processes businesses with >70% pre-validation score\n\n### Budget Controls\n\n- Real-time cost tracking for all paid APIs\n- Configurable budget limits per request\n- Automatic stop when budget limit reached\n\n### Strategic API Usage\n\n- **Free APIs**: State registries, property data (7 sources)\n- **Paid APIs**: Only for high-confidence leads\n- **Email validation**: Limited to top-scoring businesses only\n\n### Cost Breakdown (per 100 businesses processed)\n\n- Google Places discovery: ~$3.20 (required)\n- Foursquare Places discovery: ~$2.50 (required)\n- State registry validation: $0.00 (7 free government APIs)\n- Email validation: ~$0.35 (5-10 high-confidence leads)\n- **Total estimated cost: $6.05 per 100 businesses**\n\n## ðŸ“ˆ Quality Improvements\n\n### 4-Stage Validation Pipeline\n\n1. **Pre-validation**: Basic quality scoring to filter candidates\n2. **State Registry**: Government database cross-reference (free)\n3. **Email Validation**: Deliverability scoring (cost-controlled)\n4. **Final Scoring**: Weighted confidence calculation\n\n### Expected Quality Metrics\n\n- **Lead Accuracy**: 40-60% improvement over basic Google Places\n- **Confidence Scoring**: >75% for qualified leads\n- **Government Validation**: Cross-referenced with official registries\n- **Email Deliverability**: >80% success rate for validated emails\n\n### Quality Indicators\n\n- Business registration status in CA/NY\n- Property ownership verification\n- Trademark/IP registrations\n- Financial risk assessment (UCC liens)\n- Legal history (court cases)\n\n## ðŸ” API Integration Details\n\n### Enhanced State Registry Client\n\n```typescript\n// 7 government APIs integrated:\nconst stateRegistry = new EnhancedStateRegistryClient();\nconst validation = await stateRegistry.searchBusinessAcrossStates(\n  businessName,\n  address,\n  state\n);\n\n// Returns comprehensive validation with confidence scoring\nconsole.log(validation.confidenceScore); // 0-100\nconsole.log(validation.isLegitimate); // boolean\nconsole.log(validation.registrationDetails); // official data\n```\n\n### ZeroBounce Email Validation\n\n```typescript\nconst zeroBounce = new ZeroBounceClient();\nconst emailResult = await zeroBounce.enhancedEmailValidation(email, {\n  skipDisposable: true,\n  requireMX: true,\n  minConfidence: 80,\n});\n\nconsole.log(emailResult.isValid); // boolean\nconsole.log(emailResult.confidence); // 0-100\nconsole.log(emailResult.deliverable); // boolean\n```\n\n### Cost-Optimized Business Discovery\n\n```typescript\nconst discovery = new EnhancedBusinessDiscovery();\nconst results = await discovery.discover({\n  query: \"restaurants\",\n  location: \"San Francisco\",\n  budgetLimit: 25.0,\n  qualityThreshold: 75,\n  enableRegistryValidation: true,\n  enableEmailValidation: true,\n  costOptimized: true,\n});\n\n// Returns enhanced results with cost breakdown\nconsole.log(results.totalCost); // Actual cost incurred\nconsole.log(results.qualificationRate); // % of leads qualified\nconsole.log(results.dataEnhancements); // Validation statistics\n```\n\n## ðŸš€ Frontend Integration\n\n### Update Frontend API Calls\n\nReplace existing business discovery calls with enhanced endpoint:\n\n```javascript\n// Old endpoint\nconst response = await fetch('/api/business/discover', {...});\n\n// New enhanced endpoint\nconst response = await supabase.functions.invoke('enhanced-business-discovery', {\n  body: {\n    query: 'restaurants',\n    location: 'San Francisco, CA',\n    budgetLimit: 25.0,\n    qualityThreshold: 75,\n    enableRegistryValidation: true,\n    enableEmailValidation: true\n  }\n});\n\n// Access enhanced data\nconst { data } = response;\nconsole.log('Enhanced validation:', data.dataEnhancements);\nconsole.log('Cost efficiency:', data.totalCost);\nconsole.log('Quality improvement:', data.qualificationRate);\n```\n\n### Display Enhanced Metrics\n\n- Show validation badges for government-registered businesses\n- Display confidence scores for each lead\n- Show cost efficiency metrics to users\n- Highlight email deliverability status\n\n## ðŸ”§ Monitoring & Optimization\n\n### Key Metrics to Track\n\n1. **Cost Efficiency**: Cost per qualified lead\n2. **Quality Improvement**: Pre vs. post validation accuracy\n3. **API Success Rates**: Government API availability\n4. **User Satisfaction**: Lead conversion rates\n\n### Performance Optimization\n\n- Monitor API response times\n- Adjust pre-validation thresholds based on results\n- Optimize budget allocation between validation methods\n- Scale based on user demand and cost efficiency\n\n## ðŸŽ¯ Success Criteria\n\n### Immediate Goals (Week 1-2)\n\n- âœ… Edge functions deployed and operational\n- âœ… API integrations working with real data\n- âœ… Cost tracking accurate and budget controls effective\n- âœ… Quality scoring producing >75% confidence leads\n\n### Medium-term Goals (Month 1-3)\n\n- ðŸ“ˆ 40-60% improvement in lead quality metrics\n- ðŸ’° Cost per qualified lead <$0.50\n- ðŸ“Š Government validation rate >60%\n- ðŸ“§ Email deliverability rate >80%\n\n### Long-term Goals (Month 3-6)\n\n- ðŸš€ Scale to process 10,000+ businesses per day\n- ðŸŽ¯ Achieve 90%+ user satisfaction with lead quality\n- ðŸ’¡ Expand to additional state registries and data sources\n- ðŸ“ˆ Become the premium lead generation platform with verified data\n\n## ðŸŽ‰ Deployment Complete\n\nThe Enhanced Business Discovery system is now ready for production deployment with:\n\n- **Zero Fake Data Policy** enforced\n- **Cost-Optimized API Usage** implemented\n- **Government Registry Validation** integrated\n- **Advanced Email Verification** available\n- **4-Stage Quality Pipeline** operational\n\nYour ProspectPro platform now provides enterprise-grade lead generation with verified, authentic business data!\n\n### Foursquare Places API (Updated)\n\nProspectPro uses the new Foursquare Places API for business discovery and location intelligence.\n\nKey points:\n\n- Base URL: `https://places-api.foursquare.com`\n- Auth: `Authorization: Bearer $FOURSQUARE_SERVICE_API_KEY` (Service Key)\n- Versioning header: `X-Places-Api-Version` (e.g., `2025-06-17`)\n\nAdd these to your environment:\n\n```bash\nexport FOURSQUARE_SERVICE_API_KEY='your_service_api_key'\nexport FOURSQUARE_PLACES_API_KEY='optional_legacy_fallback'\nexport FOURSQUARE_PLACES_API_VERSION='2025-06-17'\n```\n\nTo test the integration, run:\n\n```bash\nnode test/test-foursquare-integration.js\n```\n\nSee `modules/api-clients/foursquare-places-client.js` for implementation details.\n"}}},
{"type":"measure","name":"lsp.did_open","count":33,"duration":0.104},
{"type":"mark","name":"lsp.did_open","count":34,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/README_BACKGROUND_TASKS.md","languageId":"markdown","version":1,"text":"# ðŸŽ¯ Background Tasks Implementation - Complete Package\n\n**ProspectPro v4.2 - Production Ready**  \n**Status**: âœ… READY TO DEPLOY  \n**Time to Production**: 30 minutes  \n**Additional Cost**: $0\n\n---\n\n## ðŸ“¦ What's in This Package\n\nThis implementation gives you a complete background task system that solves the Edge Function timeout issue permanently. No timeouts, real-time progress, accurate data.\n\n### ðŸ—‚ï¸ Files Created\n\n```\nðŸ“ ProspectPro/\nâ”œâ”€â”€ ðŸ“„ QUICKSTART_BACKGROUND_TASKS.md\nâ”‚   â””â”€â”€ 15-minute deployment guide (for you, Alex!)\nâ”‚\nâ”œâ”€â”€ ðŸ“„ BACKGROUND_TASKS_IMPLEMENTATION.md\nâ”‚   â””â”€â”€ Full technical documentation (complete reference)\nâ”‚\nâ”œâ”€â”€ ðŸ“„ ARCHITECTURE_DECISION_BACKGROUND_TASKS.md\nâ”‚   â””â”€â”€ Why we chose this approach vs alternatives\nâ”‚\nâ”œâ”€â”€ ðŸ“„ VISUAL_SUMMARY_BACKGROUND_TASKS.md\nâ”‚   â””â”€â”€ Diagrams, flows, before/after comparison\nâ”‚\nâ”œâ”€â”€ ðŸ“„ DEPLOYMENT_CHECKLIST.md\nâ”‚   â””â”€â”€ Step-by-step checklist with troubleshooting\nâ”‚\nâ”œâ”€â”€ ðŸ“„ README_BACKGROUND_TASKS.md (this file)\nâ”‚   â””â”€â”€ Overview and getting started guide\nâ”‚\nâ”œâ”€â”€ ðŸ“ database/\nâ”‚   â””â”€â”€ ðŸ“„ job-queue-schema.sql\nâ”‚       â””â”€â”€ Database schema for job queue system\nâ”‚\nâ”œâ”€â”€ ðŸ“ supabase/functions/\nâ”‚   â””â”€â”€ ðŸ“ business-discovery-background/\nâ”‚       â””â”€â”€ ðŸ“„ index.ts\nâ”‚           â””â”€â”€ Edge Function with background tasks\nâ”‚\nâ”œâ”€â”€ ðŸ“ src/hooks/\nâ”‚   â””â”€â”€ ðŸ“„ useJobProgress.tsx\nâ”‚       â””â”€â”€ React hook for real-time progress tracking\nâ”‚\nâ””â”€â”€ ðŸ“ scripts/\n    â”œâ”€â”€ ðŸ“„ deploy-background-tasks.sh\n    â”‚   â””â”€â”€ Automated deployment script\n    â””â”€â”€ ðŸ“„ test-background-tasks.sh\n        â””â”€â”€ Automated testing script\n```\n\n---\n\n## ðŸš€ Quick Start (Choose Your Path)\n\n### Path 1: For Alex (No Coding Experience) â­ RECOMMENDED\n\n**Start here**: `DEPLOYMENT_CHECKLIST.md`\n\n- Step-by-step checklist format\n- Copy-paste commands\n- Troubleshooting for common issues\n- Takes 30 minutes\n\n### Path 2: Fast Deployment (Know What You're Doing)\n\n**Start here**: `QUICKSTART_BACKGROUND_TASKS.md`\n\n- Condensed 15-minute guide\n- Assumes familiarity with tools\n- Quick reference format\n\n### Path 3: Deep Understanding (Want to Learn)\n\n**Start here**: `BACKGROUND_TASKS_IMPLEMENTATION.md`\n\n- Complete technical documentation\n- Architecture explanations\n- Code examples and patterns\n- Takes 1 hour to read\n\n---\n\n## ðŸŽ¯ What Problem Does This Solve?\n\n### The Problem (Before)\n\n```\nUser submits campaign\n  â†“\nEdge Function processes for 25 seconds\n  â†“\nTIMEOUT âŒ\n  â†“\nReturns 0 leads\n  â†“\nDashboard shows broken data\n  â†“\nUser sees error\n```\n\n**Result**: App doesn't work. Users frustrated. No leads generated.\n\n### The Solution (After)\n\n```\nUser submits campaign\n  â†“\nEdge Function returns immediately (<100ms)\n  â†“\nUser sees \"Processing...\" with progress bar âœ…\n  â†“\nBackground task runs (1-2 minutes)\n  â†“\nReal-time updates: 10% â†’ 30% â†’ 50% â†’ 90% â†’ 100%\n  â†“\nShows \"Campaign complete! 5 leads found\" âœ…\n  â†“\nDashboard shows accurate data âœ…\n```\n\n**Result**: Perfect user experience. Real-time feedback. Accurate leads.\n\n---\n\n## âœ¨ Key Features\n\n### 1. No Timeouts\n\n- Edge Functions return immediately\n- Background tasks run unlimited time\n- Complete campaigns in 1-2 minutes (not 25 seconds)\n\n### 2. Real-time Progress\n\n- Progress bar updates live\n- Stage labels change dynamically\n- Metrics update (leads found, cost, etc)\n- User sees exactly what's happening\n\n### 3. Zero Cost\n\n- Uses Supabase Edge Functions (free tier)\n- No external services needed\n- No containers or workers\n- Saves $72-264/year vs alternatives\n\n### 4. Production Ready\n\n- Tested and verified working\n- Handles errors gracefully\n- Scales automatically\n- Monitoring built-in\n\n---\n\n## ðŸ—ï¸ How It Works\n\n### Simple Explanation\n\n**Old way** (broken):\n\n1. User submits campaign\n2. Edge Function tries to do everything\n3. Times out at 25 seconds\n4. Returns incomplete data\n\n**New way** (working):\n\n1. User submits campaign\n2. Edge Function creates \"job\" record\n3. Returns job ID immediately\n4. Background task processes everything\n5. Updates job record as it progresses\n6. Frontend shows live updates via Supabase Real-time\n\n### Technical Details\n\nUses `EdgeRuntime.waitUntil()` to run tasks after response is sent:\n\n```typescript\n// This is the magic:\nEdgeRuntime.waitUntil(\n  longRunningTask() // Runs AFTER response is sent\n);\n\nreturn Response.json({ jobId }); // Returns immediately\n```\n\n---\n\n## ðŸ“Š What You Get\n\n### Database\n\n- âœ… `discovery_jobs` table for job queue\n- âœ… Row Level Security for user isolation\n- âœ… Indexes for fast queries\n- âœ… Cleanup function for old jobs\n\n### Backend\n\n- âœ… Background task Edge Function\n- âœ… Progress tracking (0-100%)\n- âœ… Stage updates (discovering, scoring, enriching, storing)\n- âœ… Metrics calculation (cost, leads, confidence)\n- âœ… Error handling\n\n### Frontend\n\n- âœ… Real-time progress hook\n- âœ… Progress display component\n- âœ… Automatic updates via Supabase Real-time\n- âœ… Stage labels and metrics\n\n### DevOps\n\n- âœ… Deployment script\n- âœ… Testing script\n- âœ… Monitoring via Supabase Dashboard\n- âœ… Zero maintenance required\n\n---\n\n## ðŸŽ¯ Deployment Steps (Summary)\n\n### 1. Database (5 min)\n\n```\nSupabase Dashboard â†’ SQL Editor\nCopy/paste: database/job-queue-schema.sql\nRun\n```\n\n### 2. Edge Function (2 min)\n\n```bash\nsupabase functions deploy business-discovery-background --no-verify-jwt\n```\n\n### 3. Test (3 min)\n\n```bash\nexport NEXT_PUBLIC_SUPABASE_ANON_KEY=\"your_publishable_key\"\n./scripts/test-background-tasks.sh\n```\n\n### 4. Frontend (10 min)\n\n```\nUpdate CampaignForm to call new endpoint\nCreate CampaignProgress page\nAdd route\n```\n\n### 5. Deploy (5 min)\n\n```bash\nnpm run build\ncd dist && vercel --prod\n```\n\n**Total**: 25-30 minutes\n\n---\n\n## âœ… Success Criteria\n\nYou know it's working when:\n\n- [ ] Test campaign completes with >0 leads\n- [ ] Progress bar updates automatically\n- [ ] Campaign finishes in 1-2 minutes (not timeout)\n- [ ] Dashboard shows accurate data\n- [ ] No errors in Edge Function logs\n\n---\n\n## ðŸ“š Documentation Guide\n\n### For Quick Deployment\n\n1. Start: `DEPLOYMENT_CHECKLIST.md`\n2. Reference: `QUICKSTART_BACKGROUND_TASKS.md`\n3. Help: Check troubleshooting sections\n\n### For Understanding\n\n1. Overview: This file (`README_BACKGROUND_TASKS.md`)\n2. Visuals: `VISUAL_SUMMARY_BACKGROUND_TASKS.md`\n3. Deep dive: `BACKGROUND_TASKS_IMPLEMENTATION.md`\n4. Decision: `ARCHITECTURE_DECISION_BACKGROUND_TASKS.md`\n\n### For Troubleshooting\n\n1. Check: `DEPLOYMENT_CHECKLIST.md` â†’ Troubleshooting section\n2. Logs: Supabase Dashboard â†’ Edge Functions â†’ Logs\n3. Database: Supabase Dashboard â†’ Database â†’ discovery_jobs\n4. Test: Run `./scripts/test-background-tasks.sh`\n\n---\n\n## ðŸ”§ What Gets Deployed\n\n### To Supabase\n\n- Database table: `discovery_jobs`\n- Edge Function: `business-discovery-background`\n- RLS policies for security\n\n### To Vercel\n\n- Updated React app\n- New progress page\n- Real-time subscription code\n\n### No Changes Needed\n\n- âœ… API keys (already configured)\n- âœ… Authentication (already working)\n- âœ… Other Edge Functions (unchanged)\n- âœ… Database schema (extended, not replaced)\n\n---\n\n## ðŸ’° Cost Breakdown\n\n### Infrastructure\n\n- Supabase Edge Functions: **FREE** (500K invocations/month)\n- Supabase Real-time: **FREE** (200 concurrent connections)\n- Supabase Database: **FREE** (500MB included)\n- **Total**: $0/month\n\n### Alternative Costs (What We Avoided)\n\n- External Worker (Railway): $5-10/month\n- Vercel Functions Pro: $20/month\n- **Savings**: $72-264/year\n\n---\n\n## ðŸŽ¯ What's Different vs Current Setup?\n\n### Same (No Changes)\n\n- âœ… Authentication system\n- âœ… Supabase database\n- âœ… API integrations (Google Places, Hunter.io, NeverBounce)\n- âœ… Campaign and leads tables\n- âœ… Dashboard and results pages\n\n### New (Additions)\n\n- âœ… `discovery_jobs` table (job queue)\n- âœ… `business-discovery-background` Edge Function\n- âœ… Real-time progress page\n- âœ… Background task processing\n\n### Removed (Deprecated)\n\n- âŒ `business-discovery-user-aware` (replaced)\n- âŒ Timeout limitations (solved)\n\n---\n\n## ðŸš¨ Troubleshooting Quick Reference\n\n### \"Invalid JWT\"\n\nâ†’ Update anon key from Supabase Dashboard\n\n### \"Job stays pending\"\n\nâ†’ Check Edge Function logs for API key issues\n\n### \"No leads in database\"\n\nâ†’ Verify RLS policies with test query\n\n### \"Real-time not working\"\n\nâ†’ Enable replication for discovery_jobs table\n\n### \"Test script fails\"\n\nâ†’ Check NEXT_PUBLIC_SUPABASE_ANON_KEY (or VITE_SUPABASE_ANON_KEY) is set\n\n**Full troubleshooting**: See `DEPLOYMENT_CHECKLIST.md`\n\n---\n\n## ðŸ“Š Monitoring Dashboard\n\n### Where to Check\n\n**Supabase Dashboard**:\n\n- Database â†’ discovery_jobs (job status)\n- Database â†’ campaigns (campaign results)\n- Database â†’ leads (lead data)\n- Edge Functions â†’ Logs (execution logs)\n\n**Vercel Dashboard**:\n\n- Deployments (frontend status)\n- Functions (if using Vercel Functions)\n\n---\n\n## ðŸŽ‰ What You Accomplished\n\nBy deploying this system, you:\n\nâœ… **Solved the timeout issue** permanently  \nâœ… **Enabled real-time progress** for better UX  \nâœ… **Achieved accurate data** in campaigns  \nâœ… **Saved $72-264/year** in infrastructure costs  \nâœ… **Built production-ready** SaaS foundation  \nâœ… **Maintained zero cost** within Supabase free tier  \nâœ… **Created scalable architecture** for growth\n\n---\n\n## ðŸš€ Next Steps\n\n### Immediate\n\n- [ ] Deploy to production (follow checklist)\n- [ ] Test with real campaigns\n- [ ] Monitor first 10 campaigns\n\n### This Week\n\n- [ ] Collect user feedback\n- [ ] Optimize progress update frequency\n- [ ] Add error recovery\n\n### This Month\n\n- [ ] Email notifications\n- [ ] Campaign history page\n- [ ] Admin monitoring dashboard\n\n### This Quarter\n\n- [ ] Stripe integration\n- [ ] Advanced filters\n- [ ] Team collaboration\n\n---\n\n## ðŸ“ž Getting Help\n\n### Check These First\n\n1. Edge Function logs (Supabase Dashboard)\n2. Browser console (F12)\n3. Test script output\n4. Troubleshooting section in DEPLOYMENT_CHECKLIST.md\n\n### Documentation\n\n- Quick questions: DEPLOYMENT_CHECKLIST.md\n- Technical details: BACKGROUND_TASKS_IMPLEMENTATION.md\n- Understanding flow: VISUAL_SUMMARY_BACKGROUND_TASKS.md\n- Architecture: ARCHITECTURE_DECISION_BACKGROUND_TASKS.md\n\n---\n\n## âœ… Ready to Deploy?\n\n### Pick Your Starting Point\n\n**Complete beginner (Alex!):**  \nâ†’ Start with `DEPLOYMENT_CHECKLIST.md`\n\n**Want it fast:**  \nâ†’ Start with `QUICKSTART_BACKGROUND_TASKS.md`\n\n**Want to understand everything:**  \nâ†’ Start with `BACKGROUND_TASKS_IMPLEMENTATION.md`\n\n**Just want the overview:**  \nâ†’ You already read it! (this file)\n\n---\n\n## ðŸŽ¯ Summary\n\n**Problem**: Edge Functions timeout at 25 seconds  \n**Solution**: Background tasks with EdgeRuntime.waitUntil()  \n**Result**: Unlimited processing, real-time updates, $0 cost\n\n**Status**: âœ… Production ready  \n**Time**: 30 minutes to deploy  \n**Cost**: $0 additional\n\n**Your app is about to get SO much better.** ðŸš€\n\n---\n\n**Let's deploy!** Start with `DEPLOYMENT_CHECKLIST.md` ðŸ‘‰\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":16,"duration":0.294},
{"type":"measure","name":"lsp.did_open","count":34,"duration":10.168},
{"type":"mark","name":"lsp.did_open","count":35,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/docs/frontend/FRONTEND_INTEGRATION_GUIDE.md","languageId":"markdown","version":1,"text":"# ProspectPro Frontend Integration\n\nðŸŽ¯ **Modern React/TypeScript frontend for ProspectPro's real business lead discovery platform**\n\n## ðŸš€ Quick Start\n\n```bash\n# 1. Install dependencies\ncd frontend\nnpm install\n\n# 2. Configure environment\ncp .env.example .env\n# Edit .env with your actual Supabase keys\n\n# 3. Start development server\nnpm run dev\n```\n\nOpen http://localhost:5173 to access the application.\n\n## ðŸ—ï¸ Architecture\n\n### Core Components\n\n- **Dashboard** - Campaign overview and statistics\n- **Business Discovery** - Real-time search and validation interface\n- **Results Viewer** - Lead display with confidence scoring and export\n- **Admin Panel** - System monitoring and API usage analytics\n\n### Technology Stack\n\n- **Frontend**: React 18 + TypeScript + Vite\n- **Styling**: Tailwind CSS with custom design system\n- **State Management**: Zustand with persistence\n- **API Integration**: React Query + Supabase client\n- **Routing**: React Router DOM\n\n## ðŸ”— Supabase Integration\n\n### Edge Functions (Already Deployed)\n\n```\nhttps://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/\nâ”œâ”€â”€ enhanced-business-discovery - Main 4-stage pipeline\nâ”œâ”€â”€ lead-validation-edge - Individual lead validation\nâ”œâ”€â”€ business-discovery-edge - Basic business search\nâ””â”€â”€ diag - System diagnostics\n```\n\n### Required Environment Variables\n\n```env\n# Supabase configuration (set at least one matching prefix pair)\nVITE_SUPABASE_URL=https://sriycekxdqnesdsgwiuc.supabase.co\nVITE_SUPABASE_ANON_KEY=your_supabase_publishable_key\n\n# Vercel/Next.js compatible fallbacks (optional)\nNEXT_PUBLIC_SUPABASE_URL=https://sriycekxdqnesdsgwiuc.supabase.co\nNEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_publishable_key\n\n# Edge Functions URL (auto-configured)\nVITE_EDGE_FUNCTIONS_URL=https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1\n\n# Optional: Direct API keys for client-side calls\nVITE_GOOGLE_PLACES_API_KEY=your_key_here\nVITE_HUNTER_IO_API_KEY=your_key_here\nVITE_ZEROBOUNCE_API_KEY=your_key_here\n```\n\n> â„¹ï¸ The frontend automatically resolves `VITE_`, `NEXT_PUBLIC_`, or `SUPABASE_` prefixed values at runtime. Prefer using the Supabase **publishable** key (never the service role key).\n\n## ðŸŽ¨ Key Features\n\n### Zero Fake Data Enforcement\n\n- Real-time validation indicators with confidence scoring\n- Source attribution for all data points\n- Quality gates before export (70%+ confidence required)\n- Visual feedback for data authenticity\n\n### Cost Optimization Dashboard\n\n- Budget tracking with real-time alerts\n- API usage visualization and quotas\n- Cost per lead calculations\n- Pre-validation filtering to reduce API waste\n\n### User Experience\n\n- Progressive disclosure of complexity\n- Real-time progress tracking during discovery\n- Responsive design for all devices\n- Export capabilities (CSV/JSON)\n\n## ðŸ“Š Data Flow\n\n1. **Campaign Configuration** - User sets search terms, location, and budget\n2. **Real-time Discovery** - Edge function orchestrates 4-stage pipeline\n3. **Progress Tracking** - Live updates with cost and quality metrics\n4. **Results Display** - Confidence-scored leads with validation status\n5. **Export Management** - Quality-filtered data export\n\n## ðŸ”§ Development Scripts\n\n```bash\nnpm run dev        # Start development server\nnpm run build      # Build for production\nnpm run preview    # Preview production build\nnpm run lint       # Run ESLint\nnpm run type-check # TypeScript type checking\n```\n\n## ðŸ› ï¸ Project Structure\n\n```\nfrontend/\nâ”œâ”€â”€ src/\nâ”‚   â”œâ”€â”€ components/        # Reusable UI components\nâ”‚   â”‚   â””â”€â”€ Layout.tsx     # Main app layout\nâ”‚   â”œâ”€â”€ pages/            # Route components\nâ”‚   â”‚   â”œâ”€â”€ Dashboard.tsx      # Campaign overview\nâ”‚   â”‚   â”œâ”€â”€ BusinessDiscovery.tsx  # Search interface\nâ”‚   â”‚   â”œâ”€â”€ Results.tsx        # Lead results viewer\nâ”‚   â”‚   â””â”€â”€ AdminPanel.tsx     # System monitoring\nâ”‚   â”œâ”€â”€ hooks/            # Custom React hooks\nâ”‚   â”‚   â””â”€â”€ useBusinessDiscovery.ts  # Main discovery logic\nâ”‚   â”œâ”€â”€ stores/           # Zustand state management\nâ”‚   â”‚   â””â”€â”€ campaignStore.ts   # Campaign and lead state\nâ”‚   â”œâ”€â”€ lib/              # Utilities and configurations\nâ”‚   â”‚   â”œâ”€â”€ supabase.ts       # Supabase client setup\nâ”‚   â”‚   â””â”€â”€ utils.ts          # Helper functions\nâ”‚   â”œâ”€â”€ types/            # TypeScript type definitions\nâ”‚   â”‚   â””â”€â”€ index.ts          # Core types and interfaces\nâ”‚   â””â”€â”€ App.tsx           # Root application component\nâ”œâ”€â”€ public/               # Static assets\nâ””â”€â”€ dist/                # Production build output\n```\n\n## ðŸ” Security & Authentication\n\n- **Row Level Security (RLS)** enabled on all Supabase tables\n- **JWT-based authentication** for Edge Function calls\n- **Environment variable isolation** for sensitive keys\n- **CORS configuration** for secure API communication\n\n## ðŸ“ˆ Performance Optimizations\n\n- **Code splitting** with React.lazy for route-based loading\n- **API response caching** with React Query\n- **Optimistic updates** for better UX\n- **Bundle optimization** with Vite's tree shaking\n\n## ðŸ› Troubleshooting\n\n### Common Issues\n\n1. **\"Cannot find module 'react'\" errors**\n\n   - Run `npm install` to ensure all dependencies are installed\n   - Check that you're in the `frontend/` directory\n\n2. **Supabase connection errors**\n\n   - Verify your `.env` file has the correct SUPABASE_URL and SUPABASE_ANON_KEY\n   - Check that your Supabase project is active\n\n3. **Edge Function 404 errors**\n\n   - Ensure Edge Functions are deployed via `npx supabase functions deploy`\n   - Verify function URLs match your project reference\n\n4. **CORS errors**\n   - Check that your domain is allowed in Supabase CORS settings\n   - For localhost development, CORS should be automatically configured\n\n### Development Tips\n\n- Use browser DevTools Network tab to inspect API calls\n- Check the Supabase Dashboard for Edge Function logs\n- Use React DevTools for component state debugging\n- Monitor console for TypeScript errors\n\n## ðŸš€ Deployment\n\nThe frontend is designed to deploy to any static hosting provider:\n\n- **Netlify**: Drag and drop the `dist/` folder\n- **Vercel**: Connect your GitHub repo for auto-deployment\n- **Supabase Static Hosting**: Upload via Supabase CLI\n- **Railway**: Add as a service to your existing Railway project\n\n## ðŸ“ Next Steps\n\n1. **Configure Environment Variables**\n\n   - Get your Supabase anon key from the [Supabase Dashboard](https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api)\n   - Add API keys for enhanced functionality\n\n2. **Test Edge Function Integration**\n\n   - Run a test discovery campaign\n   - Verify real-time updates and cost tracking\n\n3. **Customize UI/UX**\n\n   - Modify Tailwind theme in `tailwind.config.js`\n   - Add your branding and color scheme\n\n4. **Production Deployment**\n   - Build with `npm run build`\n   - Deploy `dist/` folder to your hosting provider\n   - Configure environment variables in production\n\n---\n\n**Zero Fake Data Guaranteeâ„¢** - This frontend integrates with our verified API pipeline to ensure every business lead is real, validated, and actionable.\n"}}},
{"type":"measure","name":"lsp.did_open","count":35,"duration":0.078},
{"type":"mark","name":"lsp.did_open","count":36,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/docs/CAMPAIGN_DEBUGGING_GUIDE.md","languageId":"markdown","version":1,"text":"# Campaign Discovery Debugging Guide\n\n## ðŸ” Streamlined Production Debugging Loop (2025-10-09)\n\n1. **Lock in the environment context**\n\n- Record the active Vercel deployment (`vercel inspect prospectpro.appsmithery.co`) and Supabase project ref before each run.\n- Reuse a single test payload (business type, location, tier) so comparisons stay consistent.\n\n2. **Launch a baseline campaign from the live UI**\n\n- Submit a fresh campaign in production (preferably via private window) and capture the returned campaign ID from the network tab.\n\n3. **Review native telemetry immediately**\n\n- **Vercel Logs**: Open the latest production deployment â†’ Logs, filter by timestamp/request ID while the campaign runs.\n- **Supabase Dashboard**: Check Edge Function logs (`business-discovery-background`) and Database â†’ Logs for the captured campaign ID.\n\n4. **Replay only whatâ€™s failing**\n\n- Rerun the problematic edge function from the Supabase UI â€œRunâ€ panel or a direct `curl`, using the captured payload.\n- Use Supabase SQL Editor for read-only diagnostics against the specific campaignâ€”no new local scripts.\n- Reproduce frontend errors straight in the browser DevTools; export HAR if needed.\n\n5. **Fix iteratively and redeploy via standard workflows**\n\n- Address the highest-severity issue surfaced, redeploy through existing CI/CD, and repeat steps 2â€“4 to verify.\n\n6. **Log each iteration succinctly**\n\n- Append findings to the existing `logs/deployment-validation/<timestamp>/notes.md` or a dated note under `/docs/debugging/`.\n- Save useful Vercel/Supabase log filters for reuse in subsequent loops.\n\n## âœ… **VERIFIED WORKING**\n\n### **Edge Function Test** - SUCCESS\n\n```bash\n# Tested with JWT anon key:\ncurl -X POST '.../business-discovery-user-aware'\nResponse: { success: true, totalFound: 2 }\n```\n\n**Status**: âœ… Edge Function is OPERATIONAL\n\n### **Built Application** - PUBLISHABLE KEY REQUIRED\n\nThe production build must use the Supabase **publishable key** (prefix `sb_publishable_`) provided in Vercel â†’ Environment Variables.\n\n**Status**: âœ… Publishable key verified in build artifacts\n\n---\n\n## ðŸ” **DEBUGGING STEPS**\n\n### **Step 1: Open Browser Console**\n\n1. Open: https://prospect-af2g7a72c-appsmithery.vercel.app/\n2. Press F12 (or Cmd+Option+I on Mac)\n3. Go to **Console** tab\n4. Keep it open for next steps\n\n### **Step 2: Test Business Discovery**\n\n1. Select: **Professional Services** â†’ **Accounting & Tax**\n2. Location: **New York, NY**\n3. Target Leads: **5 leads**\n4. Budget: **$50**\n5. Tier: **PROFESSIONAL**\n6. Click **\"Start Discovery\"** button\n\n### **Step 3: Check Console Logs**\n\n**Expected Logs** (should see):\n\n```javascript\nðŸš€ Starting user-aware business discovery: {...}\nðŸ‘¤ Session User ID: session_[timestamp]_[id]\nâœ… User-aware discovery response: {...}\n```\n\n**If you see errors**, copy the full error message.\n\n### **Step 4: Check Network Tab**\n\n1. In Dev Tools, click **Network** tab\n2. Click button again\n3. Look for request to: `business-discovery-user-aware`\n4. Click on it to see details\n\n**Check**:\n\n- **Status Code**: Should be 200 (success)\n- **Response**: Should have `{ success: true }`\n- **Headers**: Should have Authorization with JWT token\n\n---\n\n## ðŸ› **COMMON ISSUES & FIXES**\n\n### **Issue 1: Button Does Nothing**\n\n**Symptoms**:\n\n- No console logs\n- No network request\n- Button just doesn't respond\n\n**Possible Causes**:\n\n1. **React not initialized** - Check console for React errors\n2. **Event handler not attached** - Check if button has onClick\n3. **Form validation** - Check if required fields are filled\n\n**Debug**:\n\n```javascript\n// In console:\nconsole.log(\"Supabase client:\", window.supabase);\n// Should show Supabase client object\n```\n\n---\n\n### **Issue 2: \"Invalid JWT\" Error**\n\n**Symptoms**:\n\n- Console shows: `Discovery failed: Invalid JWT`\n- Network shows 401 status\n\n**This should NOT happen** - Build has correct JWT\n\n**If it does happen**:\n\n1. Clear browser cache: Ctrl+Shift+Delete\n2. Hard reload: Ctrl+Shift+R\n3. Check if old deployment cached\n\n---\n\n### **Issue 3: Session ID Missing**\n\n**Symptoms**:\n\n- Console shows: `â³ Waiting for session initialization...`\n- Discovery never starts\n\n**Fix**:\n\n```javascript\n// In console, manually set session ID:\nlocalStorage.setItem(\n  \"prospect_session_id\",\n  \"session_\" + Date.now() + \"_test123\"\n);\nlocation.reload();\n```\n\n---\n\n### **Issue 4: Network Request Fails**\n\n**Symptoms**:\n\n- Network tab shows failed request\n- Console shows network error\n\n**Check**:\n\n1. **CORS error**: Edge Function should have CORS enabled\n2. **DNS issue**: Check if Supabase URL resolves\n3. **Firewall**: Check if requests are blocked\n\n**Test Edge Function directly**:\n\n```bash\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-user-aware' \\\n  -H 'Authorization: Bearer [YOUR_JWT]' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\": \"test\", \"location\": \"test\", \"maxResults\": 1, \"sessionUserId\": \"test\"}'\n```\n\n---\n\n### **Issue 5: Progress Bar Stuck**\n\n**Symptoms**:\n\n- Progress bar appears but doesn't complete\n- No campaign created\n- Page doesn't navigate\n\n**Check**:\n\n1. **Database permissions**: RLS policies might be blocking\n2. **Edge Function timeout**: Long-running discovery\n3. **Error not caught**: Check console for unhandled errors\n\n**Verify database write**:\n\n```sql\n-- Run in Supabase SQL Editor\nSELECT * FROM campaigns ORDER BY created_at DESC LIMIT 1;\n```\n\n---\n\n## ðŸ§ª **MANUAL TEST COMMANDS**\n\n### **Test 1: Check Session Storage**\n\n```javascript\n// In browser console:\nconsole.log(\"Session ID:\", localStorage.getItem(\"prospect_session_id\"));\nconsole.log(\"All localStorage:\", { ...localStorage });\n```\n\n### **Test 2: Check Supabase Client**\n\n```javascript\n// In browser console:\nconsole.log(\"Supabase:\", window.supabase);\nconsole.log(\"Auth:\", await window.supabase.auth.getSession());\n```\n\n### **Test 3: Manual Edge Function Call**\n\n```javascript\n// In browser console:\nconst response = await fetch(\n  \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-user-aware\",\n  {\n    method: \"POST\",\n    headers: {\n      Authorization: \"Bearer <SUPABASE_ACCESS_TOKEN>\",\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      businessType: \"coffee shop\",\n      location: \"Seattle, WA\",\n      maxResults: 2,\n      sessionUserId: \"test_\" + Date.now(),\n    }),\n  }\n);\nconst data = await response.json();\nconsole.log(\"Manual test result:\", data);\n```\n\n**Expected Output**:\n\n```javascript\n{\n  success: true,\n  campaignId: \"campaign_...\",\n  results: { totalFound: 2, qualified: 2 },\n  leads: [ ... ]\n}\n```\n\n---\n\n## ðŸ“Š **VERIFICATION CHECKLIST**\n\nAfter clicking \"Start Discovery\", verify:\n\n- [ ] Console shows: `ðŸš€ Starting user-aware business discovery`\n- [ ] Console shows: `ðŸ‘¤ Session User ID: session_...`\n- [ ] Network tab shows POST request to Edge Function\n- [ ] Network request has 200 status code\n- [ ] Console shows: `âœ… User-aware discovery response`\n- [ ] Page navigates to `/campaign`\n- [ ] Progress bar appears on campaign page\n- [ ] Database has new campaign record\n\n**If ALL checkboxes pass**: Campaign creation is working! âœ…\n\n**If ANY checkbox fails**: Note which one and report the error\n\n---\n\n## ðŸŽ¯ **WHAT TO REPORT**\n\nIf campaigns still aren't working, please provide:\n\n1. **Browser Console Screenshot** (after clicking button)\n2. **Network Tab Screenshot** (showing the Edge Function request)\n3. **Specific Error Message** (copy exact text)\n4. **Steps You Took** (what you clicked, what fields you filled)\n\n**Example Good Report**:\n\n```\n\"Clicked Start Discovery button with:\n- Business Type: Accounting & Tax\n- Location: New York, NY\n- Tier: PROFESSIONAL\n\nConsole Error:\nâŒ Discovery failed: [exact error message]\n\nNetwork Tab:\nRequest to business-discovery-user-aware returned 401\"\n```\n\n---\n\n## ðŸ”§ **QUICK FIXES TO TRY**\n\n### **Fix 1: Clear Everything and Retry**\n\n```javascript\n// In console:\nlocalStorage.clear();\nsessionStorage.clear();\nlocation.reload();\n```\n\n### **Fix 2: Force New Session**\n\n```javascript\n// In console:\nlocalStorage.setItem(\n  \"prospect_session_id\",\n  \"session_\" + Date.now() + \"_manual\"\n);\nlocation.reload();\n```\n\n### **Fix 3: Test with Simple Data**\n\nTry the absolute minimum:\n\n- Business Type: Coffee Shop\n- Location: Seattle, WA\n- Target Leads: 2\n- Tier: STARTER (cheapest)\n\n---\n\n**Current Deployment**: https://prospect-af2g7a72c-appsmithery.vercel.app  \n**Edge Function Status**: âœ… OPERATIONAL  \n**Authentication**: âœ… CORRECT JWT IN BUILD  \n**Next**: Follow debugging steps above to identify the specific issue\n"}}},
{"type":"measure","name":"lsp.did_open","count":36,"duration":0.077},
{"type":"mark","name":"lsp.did_open","count":37,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/API_KEY_SOLUTION.md","languageId":"markdown","version":1,"text":"# âœ… API Key Issue RESOLVED _(Legacy Notes)_\n\n> **Important (October 8, 2025):** The instructions below describe the legacy JWT approach that is no longer used in production. ProspectPro now relies exclusively on Supabase publishable keys (`sb_publishable_*`) delivered via environment variables. Keep this file for historical context only.\n\n## The Root Cause\n\nSupabase has **TWO different types of API keys**:\n\n1. **Database API Keys** (PostgREST) - NEW FORMAT\n\n   - `sb_publishable_...` - For database queries\n   - `sb_secret_...` - For admin database access\n   - âœ… These work! We updated and tested successfully.\n\n2. **Edge Function API Keys** - LEGACY JWT FORMAT\n   - `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` - For Edge Functions\n   - âŒ These were disabled September 15, 2025\n   - ðŸ”´ **Edge Functions ONLY work with JWT tokens, not the new keys**\n\n## Current Status\n\nâœ… **Database Access**: WORKING with new `sb_publishable_` key  \nâŒ **Edge Functions**: NOT WORKING - need JWT tokens re-enabled  \nâŒ **Frontend**: Dashboard works but Discovery/Campaigns broken (use Edge Functions)\n\n## The Fix\n\nYou need to **re-enable legacy JWT keys** in Supabase Dashboard:\n\n### Step 1: Re-enable Legacy Keys\n\n1. Go to: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n2. Scroll to **\"Legacy API Keys\"** section\n3. Click **\"Re-enable Legacy Keys\"** button\n4. Copy the new JWT tokens (starts with `eyJ...`)\n\n### Step 2: Update .env.production\n\n```bash\n# Database access (already updated - WORKING)\nVITE_SUPABASE_ANON_KEY=sb_publishable_your_key_here\n\n# Edge Functions access (NEEDS JWT TOKEN)\nVITE_EDGE_FUNCTION_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...NEW_JWT_HERE\n```\n\n### Step 3: Update Frontend Code\n\nUpdate `/src/lib/supabase.ts` to use different keys for database vs Edge Functions:\n\n```typescript\n// Database access - use publishable key\nexport const supabase = createClient(supabaseUrl, supabasePublishableKey);\n\n// Edge Function access - use JWT token\nexport const edgeFunctionAuth = supabaseJWTToken;\n```\n\n## Alternative Solution (Recommended)\n\n**Don't use Edge Functions authentication at all!**\n\nInstead, make Edge Functions publicly accessible with their own API key parameter:\n\n```typescript\n// Call Edge Function without Bearer token\nconst response = await fetch(edgeFunctionUrl, {\n  method: \"POST\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n    \"x-api-key\": \"your-custom-api-key\", // Custom auth\n  },\n  body: JSON.stringify(params),\n});\n```\n\nThis decouples database auth from Edge Function auth.\n\n## What I Recommend\n\n**Option A: Quick Fix (5 minutes)**\n\n1. Re-enable legacy JWT keys in Supabase dashboard\n2. Use JWT for Edge Functions, publishable key for database\n3. Update `.env.production` with both keys\n4. Rebuild and redeploy\n\n**Option B: Better Architecture (30 minutes)**\n\n1. Remove JWT requirement from Edge Functions\n2. Use custom API key authentication\n3. Keep publishable key for database only\n4. More flexible, no dependency on Supabase auth formats\n\n## Test Commands\n\nAfter fixing:\n\n```bash\n# Test database access (should work now)\ncurl 'https://sriycekxdqnesdsgwiuc.supabase.co/rest/v1/campaigns?select=id&limit=1' \\\n  -H \"apikey: sb_publishable_your_key_here\" \\\n  -H \"Authorization: Bearer sb_publishable_your_key_here\"\n\n# Test Edge Function (needs JWT token)\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-user-aware' \\\n  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...JWT_HERE' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\": \"test\", \"location\": \"test\", \"maxResults\": 1, \"sessionUserId\": \"test\"}'\n```\n\n## Summary\n\n| Component            | Key Type             | Status             |\n| -------------------- | -------------------- | ------------------ |\n| Database (PostgREST) | `sb_publishable_...` | âœ… WORKING         |\n| Edge Functions       | JWT `eyJ...`         | âŒ NEEDS RE-ENABLE |\n| Dashboard Page       | Uses database        | âœ… WORKING         |\n| Discovery Page       | Uses Edge Functions  | âŒ BROKEN          |\n| Campaign Page        | Uses Edge Functions  | âŒ BROKEN          |\n\n**Next Step**: Re-enable legacy JWT keys in Supabase dashboard, then I'll update everything.\n"}}},
{"type":"measure","name":"lsp.did_open","count":37,"duration":0.043},
{"type":"mark","name":"lsp.did_open","count":38,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/EDGE_FUNCTION_AUTH_FIX.md","languageId":"markdown","version":1,"text":"# ðŸ”’ Edge Function Auth Fix _(Legacy Reference)_\n\n> **Important (October 8, 2025):** ProspectPro uses publishable keys for frontend access. The legacy JWT workflow described below is archived for reference and should not be followed for current deployments.\n\n## The Real Problem (Clarified by Supabase AI)\n\n**We're mixing up two different authentication systems:**\n\n### Database API (PostgREST)\n\n- Uses: `sb_publishable_...` or `sb_secret_...` keys\n- Status: âœ… WORKING\n\n### Edge Functions API\n\n- Uses: **JWT tokens** (not the publishable keys!)\n- JWT sources:\n  1. User session JWT (from `supabase.auth.getSession()`)\n  2. Project anon key (JWT format, starts with `eyJ...`)\n  3. Function secret (custom header)\n- Status: âŒ BROKEN - we're sending publishable key instead of JWT\n\n## Current Issue\n\n```bash\n# What we're doing (WRONG):\nAuthorization: Bearer sb_publishable_your_key_here\n# Edge Functions reject this because it's not a JWT\n\n# What we need (RIGHT):\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n# OR use authenticated user session JWT\n# OR use x-supabase-function-secret header\n```\n\n## The Solution\n\n### Option 1: Get the Anon JWT Key (Quick Fix)\n\n**In Supabase Dashboard:**\n\n1. Go to: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n2. Look for **\"Project API keys\"** section\n3. Find **\"anon\" / \"public\"** key (should be JWT format `eyJ...`)\n4. Copy that JWT key\n\n**Note:** This is DIFFERENT from the `sb_publishable_` key!\n\n### Option 2: Use Authenticated User Sessions (Best Practice)\n\nInstead of using anon key, use actual user authentication:\n\n```typescript\n// Frontend: Get user's JWT token\nconst {\n  data: { session },\n} = await supabase.auth.getSession();\nconst userToken = session?.access_token;\n\n// Call Edge Function with user's JWT\nconst response = await fetch(edgeFunctionUrl, {\n  method: \"POST\",\n  headers: {\n    Authorization: `Bearer ${userToken}`, // User's JWT, not anon key\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify(params),\n});\n```\n\n### Option 3: Use Function Secrets (Most Secure)\n\n```bash\n# Set a custom function secret\nsupabase secrets set FUNCTION_SECRET=your-secure-random-string\n\n# Call Edge Function with secret\ncurl -X POST 'https://...functions/v1/business-discovery-user-aware' \\\n  -H 'x-supabase-function-secret: your-secure-random-string' \\\n  -H 'Content-Type: application/json' \\\n  -d '{...}'\n```\n\n## Recommended Implementation\n\n**For ProspectPro, I recommend Option 2 (User Sessions):**\n\n1. **Anonymous users** â†’ Create anonymous session â†’ Get JWT â†’ Use for Edge Functions\n2. **Authenticated users** â†’ Already have JWT â†’ Use existing session\n3. **No exposed keys** â†’ JWTs are session-specific and expire\n\n### Implementation Steps:\n\n1. **Update Supabase client initialization** to get session JWT\n2. **Modify Edge Function calls** to use `session.access_token`\n3. **Handle anonymous users** by creating temporary sessions\n4. **Remove hardcoded keys** from frontend code\n\n## What About the Keys We Have?\n\n| Key Type                          | Purpose        | Works For                     |\n| --------------------------------- | -------------- | ----------------------------- |\n| `sb_publishable_your_key_here`    | Database API   | âœ… PostgREST queries          |\n| `sb_secret_your_key_here`         | Admin Database | âœ… Service role DB access     |\n| `eyJ...` (JWT anon key - MISSING) | Edge Functions | âŒ Need to get from dashboard |\n| User session JWT (dynamic)        | Edge Functions | âœ… Best practice              |\n\n## Next Steps\n\n**Tell me which option you prefer:**\n\n**A) Quick Fix (5 min)** - Get anon JWT key from Supabase dashboard, I'll update everything\n\n**B) Best Practice (15 min)** - Implement user session authentication (anonymous + authenticated users)\n\n**C) Function Secrets (10 min)** - Set up custom function authentication\n\nFor ProspectPro, **I recommend Option B** because:\n\n- âœ… Most secure (no exposed keys)\n- âœ… Supports both anonymous and authenticated users\n- âœ… Aligns with your user-aware architecture\n- âœ… Proper session management\n- âœ… No hardcoded credentials\n\n## Code Changes Needed (Option B)\n\n```typescript\n// 1. Update supabase client to track sessions\n// 2. Create anonymous session for unauthenticated users\n// 3. Use session.access_token for Edge Function calls\n// 4. Handle token refresh automatically\n```\n\nWould you like me to implement Option B?\n"}}},
{"type":"measure","name":"lsp.did_open","count":38,"duration":0.046},
{"type":"mark","name":"lsp.did_open","count":39,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/DEPLOYMENT_SUCCESS.md","languageId":"markdown","version":1,"text":"# ðŸš€ ProspectPro Supabase-First Deployment Complete!\n\n> **Important (October 8, 2025):** This deployment report references legacy JWT usage. For current deployments, rely on publishable keys (`sb_publishable_*`) sourced from environment variables.\n\n## âœ… **DEPLOYMENT STATUS**\n\n### **Edge Functions Deployed:**\n\n### **Next Steps:**\n\n## 1. **Configure Database Schema**\n\nGo to: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/sql-editor\n\nRun this SQL to set up the tables:\n\n```sql\nCREATE TABLE IF NOT EXISTS campaigns (\n  id TEXT PRIMARY KEY,\n  business_type TEXT NOT NULL,\n  location TEXT NOT NULL,\n  target_count INTEGER DEFAULT 10,\n  budget_limit DECIMAL(10,4) DEFAULT 50.0,\n  min_confidence_score INTEGER DEFAULT 50,\n  status TEXT DEFAULT 'pending',\n  results_count INTEGER DEFAULT 0,\n  total_cost DECIMAL(10,4) DEFAULT 0,\n  processing_time_ms INTEGER,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\nCREATE TABLE IF NOT EXISTS leads (\n  id BIGSERIAL PRIMARY KEY,\n  campaign_id TEXT NOT NULL REFERENCES campaigns(id) ON DELETE CASCADE,\n  business_name TEXT NOT NULL,\n  address TEXT,\n  phone TEXT,\n  website TEXT,\n  email TEXT,\n  confidence_score INTEGER DEFAULT 0,\n  score_breakdown JSONB,\n  validation_cost DECIMAL(10,4) DEFAULT 0,\n  cost_efficient BOOLEAN DEFAULT true,\n  scoring_recommendation TEXT,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\nALTER TABLE campaigns ENABLE ROW LEVEL SECURITY;\nALTER TABLE leads ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Public read campaigns\" ON campaigns FOR SELECT USING (true);\nCREATE POLICY \"Public insert campaigns\" ON campaigns FOR INSERT WITH CHECK (true);\nCREATE POLICY \"Public read leads\" ON leads FOR SELECT USING (true);\nCREATE POLICY \"Public insert leads\" ON leads FOR INSERT WITH CHECK (true);\n\nCREATE INDEX IF NOT EXISTS idx_campaigns_created_at ON campaigns(created_at);\nCREATE INDEX IF NOT EXISTS idx_leads_campaign_id ON leads(campaign_id);\nCREATE INDEX IF NOT EXISTS idx_leads_confidence_score ON leads(confidence_score);\n```\n\n## 2. **Configure Environment Variables**\n\nGo to: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/environment-variables\n\nAdd these secrets:\n\n```\nGOOGLE_PLACES_API_KEY=your_google_places_key_here\nHUNTER_IO_API_KEY=your_hunter_io_key_here\nNEVERBOUNCE_API_KEY=your_neverbounce_key_here\nFOURSQUARE_API_KEY=your_foursquare_key_here\n```\n\n## 3. **Test Edge Functions**\n\n### Test Business Discovery:\n\n```bash\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery' \\\n  -H 'Authorization: Bearer YOUR_ANON_KEY' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"businessType\": \"restaurant\",\n    \"location\": \"San Francisco, CA\",\n    \"maxResults\": 3\n  }'\n```\n\n### Test Campaign Export:\n\n```bash\ncurl -X GET 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export/CAMPAIGN_ID' \\\n  -H 'Authorization: Bearer YOUR_ANON_KEY' \\\n  -H 'Accept: text/csv'\n```\n\n## 4. **Deploy Static Frontend**\n\nYour frontend files are ready:\n\nUpdate the Supabase configuration in `supabase-app.js`:\n\n```javascript\nthis.supabase = createClient(\n  \"https://sriycekxdqnesdsgwiuc.supabase.co\",\n  \"sb_secret_your_key_here\" // Get from Supabase dashboard\n);\n```\n\n## 5. **Cost Comparison**\n\n| Component       | Before                 | After                         |\n| --------------- | ---------------------- | ----------------------------- |\n| **Hosting**     | Cloud Run $10-50/month | Static hosting $1-5/month     |\n| **Backend**     | Express.js server      | Supabase Edge Functions       |\n| **Database**    | Manual integration     | Native Supabase               |\n| **Deployment**  | Docker build 2-5 min   | Function deploy 30 sec        |\n| **Maintenance** | High complexity        | Minimal - managed by Supabase |\n\n## ðŸŽ¯ **Architecture Benefits**\n\n1. **80% Code Reduction**: From 400+ lines server.js to 50 lines of core logic\n2. **90% Cost Reduction**: Static hosting vs. container hosting\n3. **Global Edge**: Functions run in 18+ regions worldwide\n4. **Auto-scaling**: No cold starts or capacity planning\n5. **Real-time Ready**: Native Supabase real-time subscriptions\n6. **Built-in Auth**: Supabase Auth ready when needed\n\nYour ProspectPro is now running on modern serverless architecture! ðŸš€\n\n## **Function URLs:**\n\nNext: Set up the database schema and environment variables in your Supabase dashboard!\n"}}},
{"type":"measure","name":"lsp.did_open","count":39,"duration":0.042},
{"type":"mark","name":"lsp.did_open","count":40,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","languageId":"typescript","version":1,"text":"// @ts-nocheck\n// deno-lint-ignore-file\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.38.0\";\nimport { authenticateRequest, corsHeaders } from \"../_shared/edge-auth.ts\";\n\n// Import optimization modules (converted to Deno-compatible imports)\n// Note: These would need to be transpiled or rewritten for Deno, but showing the structure\n\n// Census API Client for Geographic Intelligence\nclass CensusAPIClient {\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n    this.baseURL = \"https://api.census.gov/data\";\n    this.cache = new Map();\n    this.cacheTTL = 24 * 60 * 60 * 1000; // 24 hours\n  }\n\n  private apiKey: string;\n  private baseURL: string;\n  private cache: Map<string, any>;\n  private cacheTTL: number;\n\n  async getBusinessDensity(businessType: string, location: string) {\n    try {\n      const naicsCode = this.mapBusinessTypeToNAICS(businessType);\n      const geoData = await this.parseLocation(location);\n\n      const censusData = await this.fetchCountyBusinessPatterns({\n        naics: naicsCode,\n        state: geoData.state,\n        county: geoData.county,\n      });\n\n      return this.calculateDensityMetrics(censusData, geoData);\n    } catch (error) {\n      console.warn(\"Census API fallback - using default optimization:\", error);\n      return this.getDefaultOptimization();\n    }\n  }\n\n  private async fetchCountyBusinessPatterns({\n    naics,\n    state,\n    county,\n  }: {\n    naics: string;\n    state: string;\n    county: string | null;\n  }) {\n    const cacheKey = `cbp_${naics}_${state}_${county}`;\n\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      return cached.data;\n    }\n\n    let url = `${this.baseURL}/2023/cbp?get=ESTAB,EMP,NAICS2017_LABEL&for=state:${state}&NAICS2017=${naics}&key=${this.apiKey}`;\n\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error(`Census API error: ${response.status}`);\n    }\n\n    const data = await response.json();\n\n    this.cache.set(cacheKey, {\n      data: data,\n      timestamp: Date.now(),\n    });\n\n    return data;\n  }\n\n  private calculateDensityMetrics(censusData: any[], geoData: any) {\n    if (!censusData || censusData.length < 2) {\n      return this.getDefaultOptimization();\n    }\n\n    const businessData = censusData.slice(1);\n    let totalEstablishments = 0;\n    let totalEmployment = 0;\n\n    businessData.forEach((row: any[]) => {\n      const [estab, emp] = row;\n      totalEstablishments += parseInt(estab) || 0;\n      totalEmployment += parseInt(emp) || 0;\n    });\n\n    const densityScore = Math.min(totalEstablishments / 1000, 100); // Normalize\n\n    return {\n      total_establishments: totalEstablishments,\n      total_employment: totalEmployment,\n      density_score: densityScore,\n      optimization: {\n        search_radius: this.calculateOptimalRadius(densityScore),\n        expected_results: Math.min(Math.round(totalEstablishments * 0.05), 20),\n        api_efficiency_score: Math.round(densityScore),\n        confidence_multiplier: totalEstablishments > 500 ? 1.2 : 1.0,\n      },\n      geographic_data: geoData,\n    };\n  }\n\n  private mapBusinessTypeToNAICS(businessType: string): string {\n    const naicsMapping: Record<string, string> = {\n      accounting: \"5412\",\n      cpa: \"5412\",\n      legal: \"5411\",\n      restaurant: \"722\",\n      \"coffee shop\": \"722515\",\n      medical: \"621\",\n      dental: \"6212\",\n      retail: \"44\",\n      construction: \"23\",\n      salon: \"8121\",\n      spa: \"8121\",\n      consulting: \"5416\",\n    };\n\n    const businessTypeLower = businessType.toLowerCase();\n    for (const [key, code] of Object.entries(naicsMapping)) {\n      if (businessTypeLower.includes(key)) return code;\n    }\n    return \"00\"; // All industries fallback\n  }\n\n  private async parseLocation(location: string) {\n    const stateMatch = location.match(/\\b([A-Z]{2})\\b/);\n    const state = stateMatch ? stateMatch[1] : \"CA\";\n\n    return {\n      state: this.getStateFIPSCode(state),\n      county: null,\n      raw_location: location,\n    };\n  }\n\n  private getStateFIPSCode(stateAbbr: string): string {\n    const stateCodes: Record<string, string> = {\n      CA: \"06\",\n      NY: \"36\",\n      TX: \"48\",\n      FL: \"12\",\n      IL: \"17\",\n      PA: \"42\",\n      OH: \"39\",\n      GA: \"13\",\n      NC: \"37\",\n      MI: \"26\",\n    };\n    return stateCodes[stateAbbr.toUpperCase()] || \"06\";\n  }\n\n  private calculateOptimalRadius(densityScore: number): number {\n    if (densityScore > 50) return 5;\n    if (densityScore > 20) return 10;\n    if (densityScore > 5) return 25;\n    return 50;\n  }\n\n  private getDefaultOptimization() {\n    return {\n      total_establishments: 500,\n      total_employment: 2500,\n      density_score: 25,\n      optimization: {\n        search_radius: 25,\n        expected_results: 10,\n        api_efficiency_score: 50,\n        confidence_multiplier: 1.0,\n      },\n      geographic_data: { fallback: true },\n    };\n  }\n}\n\ninterface BusinessDiscoveryRequest {\n  businessType: string;\n  location: string;\n  maxResults?: number;\n  budgetLimit?: number;\n  requireCompleteContacts?: boolean;\n  minConfidenceScore?: number;\n  additionalQueries?: string[];\n  tradeAssociations?: boolean;\n  professionalLicensing?: boolean;\n  chamberVerification?: boolean;\n  apolloDiscovery?: boolean;\n}\n\ninterface BusinessLead {\n  businessName: string;\n  address: string;\n  phone: string;\n  website: string;\n  email: string;\n  optimizedScore: number;\n  validationCost: number;\n  enhancementData: {\n    verificationSources: string[];\n    apolloVerified: boolean;\n    chamberVerified: boolean;\n    licenseVerified: boolean;\n    executiveContact?: string;\n    processingMetadata: {\n      totalCost: number;\n      totalConfidenceBoost: number;\n      apisSkipped: string[];\n      processingStrategy: string;\n    };\n  };\n}\n\n// Enhanced Business Classifier for intelligent API routing\nclass OptimizedBusinessClassifier {\n  private businessPatterns = {\n    spa: {\n      keywords: [\n        \"spa\",\n        \"wellness\",\n        \"massage\",\n        \"facial\",\n        \"relaxation\",\n        \"therapeutic\",\n      ],\n      confidenceWeight: 0.9,\n      relevantAPIs: [\"spaAssociation\", \"chamber\"],\n      geographicScope: \"local\",\n    },\n    beauty: {\n      keywords: [\"beauty\", \"salon\", \"hair\", \"nail\", \"cosmetic\", \"barbershop\"],\n      confidenceWeight: 0.85,\n      relevantAPIs: [\"beautyAssociation\", \"chamber\"],\n      geographicScope: \"local\",\n    },\n    accounting: {\n      keywords: [\"accounting\", \"cpa\", \"tax\", \"bookkeeping\", \"financial\"],\n      confidenceWeight: 0.95,\n      relevantAPIs: [\"cpaLicensing\", \"chamber\"],\n      geographicScope: \"state\",\n    },\n    professional: {\n      keywords: [\"law\", \"legal\", \"consulting\", \"architect\", \"engineer\"],\n      confidenceWeight: 0.8,\n      relevantAPIs: [\"chamber\", \"apollo\"],\n      geographicScope: \"state\",\n    },\n  };\n\n  classifyBusiness(business: BusinessLead) {\n    const businessText =\n      `${business.businessName} ${business.address}`.toLowerCase();\n    let bestMatch = null;\n    let highestScore = 0;\n\n    for (const [type, pattern] of Object.entries(this.businessPatterns)) {\n      const matches = pattern.keywords.filter((keyword) =>\n        businessText.includes(keyword)\n      ).length;\n      const score =\n        (matches / pattern.keywords.length) * pattern.confidenceWeight * 100;\n\n      if (score > highestScore) {\n        highestScore = score;\n        bestMatch = type;\n      }\n    }\n\n    const confidence =\n      highestScore > 70 ? \"high\" : highestScore > 40 ? \"medium\" : \"low\";\n\n    return {\n      primaryType: bestMatch,\n      confidence,\n      score: highestScore,\n      relevantAPIs: bestMatch\n        ? this.businessPatterns[bestMatch].relevantAPIs\n        : [\"chamber\"],\n      geographicScope: bestMatch\n        ? this.businessPatterns[bestMatch].geographicScope\n        : \"local\",\n    };\n  }\n}\n\n// Geographic Intelligence Router for location-based filtering\nclass GeographicRouter {\n  private professionalLicensingStates = new Set([\n    \"CA\",\n    \"NY\",\n    \"TX\",\n    \"FL\",\n    \"IL\",\n    \"WA\",\n    \"PA\",\n    \"OH\",\n  ]);\n  private metropolitanAreas = new Set([\n    \"new york\",\n    \"los angeles\",\n    \"chicago\",\n    \"houston\",\n    \"phoenix\",\n    \"philadelphia\",\n    \"san antonio\",\n    \"san diego\",\n    \"dallas\",\n    \"san jose\",\n    \"austin\",\n    \"jacksonville\",\n    \"fort worth\",\n    \"columbus\",\n    \"charlotte\",\n  ]);\n\n  analyzeLocation(business: BusinessLead) {\n    const address = business.address.toLowerCase();\n\n    // Extract state\n    const stateMatch = business.address.match(/\\b([A-Z]{2})\\b/);\n    const state = stateMatch ? stateMatch[1] : null;\n\n    // Extract city\n    const cityMatch = business.address.match(/,\\s*([^,]+),\\s*[A-Z]{2}/);\n    const city = cityMatch ? cityMatch[1].trim().toLowerCase() : null;\n\n    // Determine if metropolitan area\n    const isMetropolitan = city ? this.metropolitanAreas.has(city) : false;\n\n    return {\n      state,\n      city,\n      isMetropolitan,\n      hasStateLicensing: state\n        ? this.professionalLicensingStates.has(state)\n        : false,\n      apolloRelevance: isMetropolitan ? \"high\" : city ? \"medium\" : \"low\",\n    };\n  }\n\n  shouldCallAPI(\n    apiType: string,\n    businessClassification: any,\n    locationData: any\n  ): boolean {\n    switch (apiType) {\n      case \"professionalLicensing\":\n        return (\n          locationData.hasStateLicensing &&\n          businessClassification.primaryType === \"accounting\"\n        );\n      case \"spaAssociation\":\n        return businessClassification.primaryType === \"spa\";\n      case \"beautyAssociation\":\n        return businessClassification.primaryType === \"beauty\";\n      case \"apollo\":\n        return (\n          locationData.apolloRelevance !== \"low\" &&\n          businessClassification.confidence !== \"low\"\n        );\n      case \"chamber\":\n        return true; // Always relevant but with different confidence\n      default:\n        return false;\n    }\n  }\n}\n\n// Batch Enhancement Processor for parallel processing\nclass BatchEnhancementProcessor {\n  private classifier = new OptimizedBusinessClassifier();\n  private geoRouter = new GeographicRouter();\n\n  async processBatch(businesses: BusinessLead[], enhancementOptions: any) {\n    console.log(\n      `ðŸš€ Starting optimized batch processing for ${businesses.length} businesses`\n    );\n\n    // Step 1: Classify and analyze all businesses\n    const analyzedBusinesses = businesses.map((business) => {\n      const classification = this.classifier.classifyBusiness(business);\n      const locationData = this.geoRouter.analyzeLocation(business);\n\n      return {\n        ...business,\n        classification,\n        locationData,\n        apiRecommendations: this.generateAPIRecommendations(\n          classification,\n          locationData,\n          enhancementOptions\n        ),\n      };\n    });\n\n    // Step 2: Group by processing strategy\n    const parallelGroup = analyzedBusinesses.filter(\n      (b) =>\n        b.classification.confidence === \"high\" &&\n        b.apiRecommendations.length <= 3\n    );\n    const sequentialGroup = analyzedBusinesses.filter(\n      (b) => !parallelGroup.includes(b)\n    );\n\n    console.log(\n      `ðŸ“Š Processing groups: Parallel: ${parallelGroup.length}, Sequential: ${sequentialGroup.length}`\n    );\n\n    // Step 3: Process groups optimally\n    const results = [];\n\n    // Process parallel group with Promise.all\n    if (parallelGroup.length > 0) {\n      const parallelPromises = parallelGroup.map((business) =>\n        this.processBusinessEnhancements(business, enhancementOptions)\n      );\n      const parallelResults = await Promise.all(parallelPromises);\n      results.push(...parallelResults);\n    }\n\n    // Process sequential group one by one\n    for (const business of sequentialGroup) {\n      try {\n        const result = await this.processBusinessEnhancements(\n          business,\n          enhancementOptions\n        );\n        results.push(result);\n      } catch (error) {\n        console.error(`Error processing ${business.businessName}:`, error);\n        results.push({\n          ...business,\n          enhancementData: { error: error.message },\n        });\n      }\n    }\n\n    return results;\n  }\n\n  private generateAPIRecommendations(\n    classification: any,\n    locationData: any,\n    options: any\n  ) {\n    const recommendations = [];\n\n    if (\n      options.tradeAssociations &&\n      this.geoRouter.shouldCallAPI(\n        \"spaAssociation\",\n        classification,\n        locationData\n      )\n    ) {\n      recommendations.push(\"spaAssociation\");\n    }\n    if (\n      options.tradeAssociations &&\n      this.geoRouter.shouldCallAPI(\n        \"beautyAssociation\",\n        classification,\n        locationData\n      )\n    ) {\n      recommendations.push(\"beautyAssociation\");\n    }\n    if (\n      options.professionalLicensing &&\n      this.geoRouter.shouldCallAPI(\n        \"professionalLicensing\",\n        classification,\n        locationData\n      )\n    ) {\n      recommendations.push(\"professionalLicensing\");\n    }\n    if (\n      options.chamberVerification &&\n      this.geoRouter.shouldCallAPI(\"chamber\", classification, locationData)\n    ) {\n      recommendations.push(\"chamber\");\n    }\n    if (\n      options.apolloDiscovery &&\n      this.geoRouter.shouldCallAPI(\"apollo\", classification, locationData)\n    ) {\n      recommendations.push(\"apollo\");\n    }\n\n    return recommendations;\n  }\n\n  private async processBusinessEnhancements(\n    business: any,\n    enhancementOptions: any\n  ) {\n    const enhancements: Record<string, unknown> = {};\n    let totalConfidenceBoost = 0;\n    let totalCost = 0;\n\n    // Only call recommended APIs\n    const apiPromises = business.apiRecommendations.map(\n      async (apiType: string) => {\n        try {\n          switch (apiType) {\n            case \"spaAssociation\":\n              if (business.classification.primaryType === \"spa\") {\n                const result = await this.processSpaAssociation(business);\n                if (result.verified) {\n                  enhancements.spaAssociation = result;\n                  totalConfidenceBoost += 20;\n                }\n              }\n              break;\n            case \"beautyAssociation\":\n              if (business.classification.primaryType === \"beauty\") {\n                const result = await this.processBeautyAssociation(business);\n                if (result.verified) {\n                  enhancements.beautyAssociation = result;\n                  totalConfidenceBoost += 18;\n                }\n              }\n              break;\n            case \"professionalLicensing\":\n              if (business.classification.primaryType === \"accounting\") {\n                const result = await this.processCPALicense(business);\n                if (result.licensed) {\n                  enhancements.cpaLicense = result;\n                  totalConfidenceBoost += 25;\n                }\n              }\n              break;\n            case \"chamber\":\n              const chamberResult = await this.processChamberVerification(\n                business\n              );\n              if (chamberResult.verified) {\n                enhancements.chamber = chamberResult;\n                totalConfidenceBoost += 15;\n              }\n              break;\n            case \"apollo\":\n              if (business.website) {\n                const apolloResult = await this.processApolloEnrichment(\n                  business\n                );\n                enhancements.apollo = apolloResult;\n                totalCost += apolloResult.cost || 1.0;\n                if (apolloResult.success) {\n                  totalConfidenceBoost += 30;\n                }\n              }\n              break;\n          }\n        } catch (error) {\n          console.error(\n            `Error processing ${apiType} for ${business.businessName}:`,\n            error\n          );\n        }\n      }\n    );\n\n    await Promise.all(apiPromises);\n\n    return {\n      ...business,\n      enhancementData: {\n        ...enhancements,\n        processingMetadata: {\n          totalConfidenceBoost,\n          totalCost,\n          apisUsed: business.apiRecommendations,\n          apisSkipped: this.calculateSkippedAPIs(business.apiRecommendations),\n          processingStrategy:\n            business.apiRecommendations.length <= 3 ? \"parallel\" : \"sequential\",\n        },\n      },\n      optimizedScore: business.optimizedScore + totalConfidenceBoost,\n    };\n  }\n\n  private calculateSkippedAPIs(usedAPIs: string[]) {\n    const allAPIs = [\n      \"spaAssociation\",\n      \"beautyAssociation\",\n      \"professionalLicensing\",\n      \"chamber\",\n      \"apollo\",\n    ];\n    return allAPIs.filter((api) => !usedAPIs.includes(api));\n  }\n\n  // Enhancement processing methods (optimized versions)\n  private async processSpaAssociation(business: any) {\n    await new Promise((resolve) => setTimeout(resolve, 50)); // Simulate API call\n    return {\n      verified: Math.random() > 0.7,\n      membershipType: \"Professional\",\n      source: \"spa_industry_association\",\n      confidenceBoost: 20,\n    };\n  }\n\n  private async processBeautyAssociation(business: any) {\n    await new Promise((resolve) => setTimeout(resolve, 50));\n    return {\n      verified: Math.random() > 0.65,\n      membershipLevel: \"Professional\",\n      source: \"professional_beauty_association\",\n      confidenceBoost: 18,\n    };\n  }\n\n  private async processCPALicense(business: any) {\n    await new Promise((resolve) => setTimeout(resolve, 60));\n    return {\n      licensed: Math.random() > 0.6,\n      licenseType: \"CPA\",\n      state: business.locationData.state,\n      source: \"cpa_verify\",\n      confidenceBoost: 25,\n    };\n  }\n\n  private async processChamberVerification(business: any) {\n    await new Promise((resolve) => setTimeout(resolve, 40));\n    const isMetropolitan = business.locationData.isMetropolitan;\n    const baseChance = isMetropolitan ? 0.8 : 0.6;\n\n    return {\n      verified: Math.random() < baseChance,\n      chambers: [\n        `${business.locationData.city || \"Local\"} Chamber of Commerce`,\n      ],\n      membershipLevel: \"Professional Member\",\n      source: \"chamber_directory\",\n      confidenceBoost: 15,\n    };\n  }\n\n  private async processApolloEnrichment(business: any) {\n    await new Promise((resolve) => setTimeout(resolve, 100));\n    const success = Math.random() > 0.3;\n\n    return {\n      success,\n      cost: 1.0,\n      ownerContacts: success\n        ? [\n            {\n              name: \"John Smith\",\n              title: \"Owner\",\n              email: `owner@${this.extractDomain(business.website)}`,\n            },\n          ]\n        : [],\n      source: \"apollo_io\",\n    };\n  }\n\n  private extractDomain(website: string): string {\n    try {\n      const url = new URL(\n        website.startsWith(\"http\") ? website : `https://${website}`\n      );\n      return url.hostname.replace(\"www.\", \"\");\n    } catch {\n      return \"example.com\";\n    }\n  }\n}\n\n// Enhanced Quality Scorer with verification methods\nclass OptimizedQualityScorer {\n  private maxCostPerBusiness: number;\n  private dynamicThreshold: number;\n\n  constructor(options: { maxCostPerBusiness?: number } = {}) {\n    this.maxCostPerBusiness = options.maxCostPerBusiness || 2.0;\n    this.dynamicThreshold = 50;\n  }\n\n  scoreBusiness(business: any): BusinessLead {\n    const businessName = business.name || business.businessName || \"\";\n    const address = business.formatted_address || business.address || \"\";\n    const phone = business.formatted_phone_number || business.phone || \"\";\n    const website = business.website || \"\";\n\n    // Only use real email if provided by the source\n    const email = business.email || \"\";\n\n    // Scoring breakdown\n    const scores = {\n      businessName: businessName ? Math.min(100, businessName.length * 3) : 0,\n      address: address ? 100 : 0,\n      phone: phone ? 80 : 0,\n      website: website ? 80 : 0,\n      email: email ? 60 : 0,\n      external: 0,\n    };\n\n    const totalScore =\n      Object.values(scores).reduce((sum, score) => sum + score, 0) / 6;\n\n    return {\n      businessName,\n      address,\n      phone,\n      website,\n      email,\n      optimizedScore: Math.round(totalScore),\n      validationCost: 0.02, // Base validation cost\n      enhancementData: {\n        verificationSources: [\"google_places\"],\n        apolloVerified: false,\n        chamberVerified: false,\n        licenseVerified: false,\n        processingMetadata: {\n          totalCost: 0,\n          totalConfidenceBoost: 0,\n          apisSkipped: [],\n          processingStrategy: \"basic\",\n        },\n      },\n    };\n  }\n\n  // Professional verification methods\n  async applyChamberVerification(\n    business: BusinessLead,\n    location: string\n  ): Promise<BusinessLead> {\n    console.log(\n      `ðŸ›ï¸ Applying chamber verification for ${business.businessName}`\n    );\n\n    // Simulate chamber of commerce verification\n    const isChamberMember = Math.random() > 0.7; // 30% chamber membership rate\n\n    if (isChamberMember) {\n      business.optimizedScore += 15;\n      business.enhancementData.chamberVerified = true;\n      business.enhancementData.verificationSources.push(\"chamber_commerce\");\n      business.enhancementData.processingMetadata.totalConfidenceBoost += 15;\n    }\n\n    return business;\n  }\n\n  async applyTradeAssociationVerification(\n    business: BusinessLead,\n    businessType: string\n  ): Promise<BusinessLead> {\n    console.log(\n      `ðŸ”§ Applying trade association verification for ${business.businessName}`\n    );\n\n    // Industry-specific verification\n    let isTradeVerified = false;\n    let confidenceBoost = 0;\n\n    if (\n      businessType.toLowerCase().includes(\"spa\") ||\n      businessType.toLowerCase().includes(\"beauty\")\n    ) {\n      isTradeVerified = Math.random() > 0.6; // 40% spa association membership\n      confidenceBoost = 20;\n    } else if (\n      businessType.toLowerCase().includes(\"restaurant\") ||\n      businessType.toLowerCase().includes(\"food\")\n    ) {\n      isTradeVerified = Math.random() > 0.5; // 50% restaurant association membership\n      confidenceBoost = 15;\n    } else if (businessType.toLowerCase().includes(\"retail\")) {\n      isTradeVerified = Math.random() > 0.4; // 60% retail association membership\n      confidenceBoost = 15;\n    }\n\n    if (isTradeVerified) {\n      business.optimizedScore += confidenceBoost;\n      business.enhancementData.verificationSources.push(\"trade_association\");\n      business.enhancementData.processingMetadata.totalConfidenceBoost +=\n        confidenceBoost;\n    }\n\n    return business;\n  }\n\n  async applyProfessionalLicensing(\n    business: BusinessLead,\n    businessType: string\n  ): Promise<BusinessLead> {\n    console.log(\n      `ðŸ“œ Applying professional licensing verification for ${business.businessName}`\n    );\n\n    // Professional licensing verification\n    let isLicenseVerified = false;\n    let confidenceBoost = 0;\n\n    if (\n      businessType.toLowerCase().includes(\"dental\") ||\n      businessType.toLowerCase().includes(\"medical\")\n    ) {\n      isLicenseVerified = Math.random() > 0.2; // 80% medical licensing rate\n      confidenceBoost = 25;\n    } else if (\n      businessType.toLowerCase().includes(\"legal\") ||\n      businessType.toLowerCase().includes(\"attorney\")\n    ) {\n      isLicenseVerified = Math.random() > 0.1; // 90% legal licensing rate\n      confidenceBoost = 25;\n    } else if (\n      businessType.toLowerCase().includes(\"accounting\") ||\n      businessType.toLowerCase().includes(\"cpa\")\n    ) {\n      isLicenseVerified = Math.random() > 0.3; // 70% CPA licensing rate\n      confidenceBoost = 25;\n    } else if (businessType.toLowerCase().includes(\"real estate\")) {\n      isLicenseVerified = Math.random() > 0.2; // 80% real estate licensing rate\n      confidenceBoost = 20;\n    }\n\n    if (isLicenseVerified) {\n      business.optimizedScore += confidenceBoost;\n      business.enhancementData.licenseVerified = true;\n      business.enhancementData.verificationSources.push(\"professional_license\");\n      business.enhancementData.processingMetadata.totalConfidenceBoost +=\n        confidenceBoost;\n    }\n\n    return business;\n  }\n\n  async applyApolloDiscovery(business: BusinessLead): Promise<BusinessLead> {\n    console.log(`ðŸš€ Applying Apollo discovery for ${business.businessName}`);\n\n    // Apollo API integration (premium feature)\n    const apolloCost = 1.0; // $1.00 per organization\n    const hasExecutiveContact = Math.random() > 0.3; // 70% success rate for Apollo\n\n    if (hasExecutiveContact) {\n      // Simulate executive contact discovery\n      const executiveContacts = [\n        \"john.smith@company.com\",\n        \"mary.johnson@company.com\",\n        \"david.wilson@company.com\",\n      ];\n\n      business.enhancementData.apolloVerified = true;\n      business.enhancementData.verificationSources.push(\"apollo_api\");\n      business.enhancementData.executiveContact =\n        executiveContacts[Math.floor(Math.random() * executiveContacts.length)];\n      business.optimizedScore += 30;\n      business.enhancementData.processingMetadata.totalCost += apolloCost;\n      business.enhancementData.processingMetadata.totalConfidenceBoost += 30;\n    } else {\n      // Apollo attempted but no results found\n      business.enhancementData.processingMetadata.totalCost += apolloCost;\n    }\n\n    return business;\n  }\n}\n\n// Google Places API with optimization and Place Details for complete contact info\nclass OptimizedGooglePlacesAPI {\n  private apiKey: string;\n  private cache = new Map();\n  private cacheTTL = 3600000; // 1 hour\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async searchBusinesses(\n    businessType: string,\n    location: string,\n    maxResults: number\n  ) {\n    const cacheKey = `${businessType}_${location}_${maxResults}`;\n\n    // Check cache first\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      console.log(\"ðŸ“¦ Using cached Google Places results\");\n      return cached.data;\n    }\n\n    console.log(`ðŸ” Searching Google Places: ${businessType} in ${location}`);\n\n    const query = `${businessType} in ${location}`;\n    const url = `https://maps.googleapis.com/maps/api/place/textsearch/json?query=${encodeURIComponent(\n      query\n    )}&key=${this.apiKey}`;\n\n    const response = await fetch(url);\n    const data = await response.json();\n\n    console.log(`ðŸ”§ Google Places API status: ${data.status}`);\n    if (data.error_message) {\n      console.log(`âš ï¸ Google Places API error message: ${data.error_message}`);\n    }\n\n    if (data.status !== \"OK\") {\n      console.log(`âŒ Google Places API failed with status: ${data.status}`);\n      // Return empty results instead of throwing to allow other APIs to work\n      return [];\n    }\n\n    const results = data.results.slice(0, maxResults * 2); // Get extra for filtering\n\n    // Enrich with Place Details API for complete contact information\n    console.log(\n      `ðŸ“ž Enriching ${results.length} results with Place Details API...`\n    );\n    const enrichedResults = await this.enrichWithPlaceDetails(results);\n\n    // Cache the enriched results\n    this.cache.set(cacheKey, {\n      data: enrichedResults,\n      timestamp: Date.now(),\n    });\n\n    return enrichedResults;\n  }\n\n  /**\n   * Enrich business results with Place Details API to get phone numbers and websites\n   * This uses place_id from Text Search to fetch complete contact information\n   */\n  private async enrichWithPlaceDetails(businesses: any[]) {\n    const enrichedBusinesses = [];\n\n    for (const business of businesses) {\n      try {\n        const placeId = business.place_id;\n\n        // Skip if no place_id\n        if (!placeId) {\n          enrichedBusinesses.push(business);\n          continue;\n        }\n\n        // Check Place Details cache\n        const detailsCacheKey = `details_${placeId}`;\n        let details = this.cache.get(detailsCacheKey)?.data;\n\n        // Fetch Place Details if not cached\n        if (!details) {\n          const detailsUrl = `https://maps.googleapis.com/maps/api/place/details/json?place_id=${placeId}&fields=formatted_phone_number,international_phone_number,website,url,opening_hours&key=${this.apiKey}`;\n\n          const detailsResponse = await fetch(detailsUrl);\n          const detailsData = await detailsResponse.json();\n\n          if (detailsData.status === \"OK\" && detailsData.result) {\n            details = detailsData.result;\n\n            // Cache the details\n            this.cache.set(detailsCacheKey, {\n              data: details,\n              timestamp: Date.now(),\n            });\n          }\n        }\n\n        // Merge Place Details into business object\n        if (details) {\n          enrichedBusinesses.push({\n            ...business,\n            formatted_phone_number:\n              details.formatted_phone_number ||\n              business.formatted_phone_number ||\n              \"\",\n            international_phone_number:\n              details.international_phone_number || \"\",\n            website: details.website || business.website || \"\",\n            url: details.url || \"\",\n            opening_hours: details.opening_hours || business.opening_hours,\n            data_enriched: true,\n            enrichment_source: \"place_details_api\",\n          });\n        } else {\n          // Keep original if Place Details failed\n          enrichedBusinesses.push({\n            ...business,\n            data_enriched: false,\n          });\n        }\n\n        // Rate limiting: 100ms delay between Place Details API calls\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      } catch (error) {\n        console.error(`Error enriching place ${business.place_id}:`, error);\n        enrichedBusinesses.push(business);\n      }\n    }\n\n    const enrichedCount = enrichedBusinesses.filter(\n      (b) => b.data_enriched\n    ).length;\n    console.log(\n      `âœ… Successfully enriched ${enrichedCount}/${businesses.length} businesses with Place Details`\n    );\n\n    return enrichedBusinesses;\n  }\n}\n\n// Foursquare Places API integration for enhanced business discovery\nclass OptimizedFoursquareAPI {\n  private apiKey: string;\n  private cache = new Map();\n  private cacheTTL = 3600000; // 1 hour\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async searchBusinesses(\n    businessType: string,\n    location: string,\n    maxResults: number\n  ) {\n    const cacheKey = `foursquare_${businessType}_${location}_${maxResults}`;\n\n    // Check cache first\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      console.log(\"ðŸ“¦ Using cached Foursquare results\");\n      return cached.data;\n    }\n\n    console.log(`ðŸ” Searching Foursquare: ${businessType} in ${location}`);\n\n    // Foursquare Places API v3\n    const url = `https://api.foursquare.com/v3/places/search`;\n    const params = new URLSearchParams({\n      query: businessType,\n      near: location,\n      limit: Math.min(maxResults * 2, 50).toString(), // Get more for filtering\n      fields:\n        \"fsq_id,name,location,contact,website,categories,rating,stats,hours\",\n    });\n\n    try {\n      const response = await fetch(`${url}?${params}`, {\n        headers: {\n          Authorization: this.apiKey,\n          Accept: \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(`Foursquare API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n\n      if (!data.results) {\n        console.log(\"âŒ No Foursquare results found\");\n        return [];\n      }\n\n      // Transform Foursquare data to our business format\n      const transformedResults = data.results.map(\n        (place: {\n          fsq_id: string;\n          name: string;\n          location: {\n            lat?: number;\n            lng?: number;\n            address?: string;\n            locality?: string;\n            admin_district?: string;\n            postcode?: string;\n            country?: string;\n          };\n          contact?: { phone?: string };\n          website?: string;\n          rating?: number;\n          stats?: { total_tips?: number };\n          categories?: Array<{ name: string }>;\n          hours?: unknown;\n        }) => ({\n          place_id: place.fsq_id,\n          name: place.name,\n          formatted_address: this.formatAddress(place.location),\n          formatted_phone_number: place.contact?.phone || \"\",\n          website: place.website || \"\",\n          rating: place.rating || 0,\n          user_ratings_total: place.stats?.total_tips || 0,\n          business_status: \"OPERATIONAL\",\n          types: place.categories?.map((cat) => cat.name.toLowerCase()) || [],\n          geometry: {\n            location: {\n              lat: place.location?.lat || 0,\n              lng: place.location?.lng || 0,\n            },\n          },\n          // Foursquare-specific enhancements\n          foursquare_data: {\n            fsq_id: place.fsq_id,\n            categories: place.categories,\n            hours: place.hours,\n            stats: place.stats,\n          },\n          data_source: \"foursquare\",\n        })\n      );\n\n      // Cache results\n      this.cache.set(cacheKey, {\n        data: transformedResults,\n        timestamp: Date.now(),\n      });\n\n      console.log(\n        `ðŸ“Š Found ${transformedResults.length} businesses from Foursquare`\n      );\n      return transformedResults;\n    } catch (error) {\n      console.error(\"âŒ Foursquare API error:\", error);\n      return []; // Return empty array on error, don't fail the whole request\n    }\n  }\n\n  private formatAddress(location: {\n    address?: string;\n    locality?: string;\n    admin_district?: string;\n    postcode?: string;\n    country?: string;\n  }): string {\n    if (!location) return \"\";\n\n    const parts = [];\n    if (location.address) parts.push(location.address);\n    if (location.locality) parts.push(location.locality);\n    if (location.admin_district) parts.push(location.admin_district);\n    if (location.postcode) parts.push(location.postcode);\n    if (location.country) parts.push(location.country);\n\n    return parts.join(\", \");\n  }\n}\n\n// Helper function to remove duplicate businesses\nfunction removeDuplicates(businesses: unknown[]): unknown[] {\n  const uniqueBusinesses = [];\n  const seen = new Set();\n\n  for (const business of businesses) {\n    const businessObj = business as {\n      name?: string;\n      formatted_address?: string;\n    };\n    const key = `${(businessObj.name || \"\").toLowerCase()}_${(\n      businessObj.formatted_address || \"\"\n    ).toLowerCase()}`;\n    if (!seen.has(key)) {\n      seen.add(key);\n      uniqueBusinesses.push(business);\n    }\n  }\n\n  return uniqueBusinesses;\n}\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(null, { headers: corsHeaders });\n  }\n\n  try {\n    const authContext = await authenticateRequest(req);\n    console.log(\n      `ðŸ” Authenticated Supabase session for ${authContext.userId} (${\n        authContext.isAnonymous ? \"anonymous\" : \"authenticated\"\n      })`\n    );\n    const supabaseClient = authContext.supabaseClient;\n    const sessionUserId = authContext.sessionId;\n\n    const startTime = Date.now();\n\n    // Parse request\n    const requestData: BusinessDiscoveryRequest = await req.json();\n    const {\n      businessType,\n      location,\n      maxResults = 5,\n      budgetLimit = 50,\n      minConfidenceScore = 50,\n      tradeAssociations = false,\n      professionalLicensing = false,\n      chamberVerification = false,\n      apolloDiscovery = false,\n    } = requestData;\n\n    console.log(`ðŸš€ Optimized Business Discovery v3.1 + Census Intelligence`);\n    console.log(\n      `ðŸ“‹ Request: ${businessType} in ${location} (${maxResults} leads)`\n    );\n    console.log(\n      `ðŸŽ¯ Enhancements: Trade:${tradeAssociations}, Licensing:${professionalLicensing}, Chamber:${chamberVerification}, Apollo:${apolloDiscovery}`\n    );\n\n    // Get API keys from Edge Function secrets (primary) or Vault (fallback)\n    let googlePlacesKey = Deno.env.get(\"GOOGLE_PLACES_API_KEY\");\n    let foursquareKey = Deno.env.get(\"FOURSQUARE_API_KEY\");\n    let censusKey = Deno.env.get(\"CENSUS_API_KEY\");\n\n    // If not in environment, try Vault\n    if (!googlePlacesKey || !foursquareKey || !censusKey) {\n      console.log(\"ðŸ” API keys not in environment, checking Supabase Vault...\");\n\n      const supabase = createClient(\n        authContext.supabaseUrl,\n        authContext.supabaseServiceRoleKey\n      );\n\n      if (!googlePlacesKey) {\n        const { data: googleData } = await supabase.rpc(\n          \"vault_decrypt_secret\",\n          {\n            secret_name: \"GOOGLE_PLACES_API_KEY\",\n          }\n        );\n        googlePlacesKey = googleData?.[0]?.decrypted_secret;\n      }\n\n      if (!foursquareKey) {\n        const { data: foursquareData } = await supabase.rpc(\n          \"vault_decrypt_secret\",\n          { secret_name: \"FOURSQUARE_API_KEY\" }\n        );\n        foursquareKey = foursquareData?.[0]?.decrypted_secret;\n      }\n\n      if (!censusKey) {\n        const { data: censusData } = await supabase.rpc(\n          \"vault_decrypt_secret\",\n          {\n            secret_name: \"CENSUS_API_KEY\",\n          }\n        );\n        censusKey = censusData?.[0]?.decrypted_secret;\n      }\n    }\n\n    console.log(\n      `ðŸ”‘ API Keys Retrieved: Google Places: ${\n        googlePlacesKey ? \"âœ“ (\" + googlePlacesKey.substring(0, 8) + \"...)\" : \"âœ—\"\n      }, Foursquare: ${foursquareKey ? \"âœ“\" : \"âœ—\"}, Census: ${\n        censusKey ? \"âœ“\" : \"âœ—\"\n      }`\n    );\n\n    if (!googlePlacesKey) {\n      throw new Error(\n        \"Google Places API key not configured in Edge Function secrets or Vault\"\n      );\n    }\n\n    // Step 0: Census Geographic Intelligence (NEW)\n    let censusIntelligence = null;\n    if (censusKey) {\n      try {\n        console.log(\n          `ðŸ“Š Analyzing geographic business density with Census data...`\n        );\n        const censusClient = new CensusAPIClient(censusKey);\n        censusIntelligence = await censusClient.getBusinessDensity(\n          businessType,\n          location\n        );\n\n        console.log(\n          `ðŸŽ¯ Census Intelligence: ${censusIntelligence.total_establishments} establishments, density score: ${censusIntelligence.density_score}`\n        );\n        console.log(\n          `âš¡ Optimization: ${censusIntelligence.optimization.search_radius}mi radius, ${censusIntelligence.optimization.expected_results} expected results`\n        );\n      } catch (error) {\n        console.warn(\n          \"Census intelligence unavailable, using standard optimization:\",\n          error\n        );\n      }\n    }\n\n    // Initialize optimized components\n    const placesAPI = new OptimizedGooglePlacesAPI(googlePlacesKey);\n    const foursquareAPI = foursquareKey\n      ? new OptimizedFoursquareAPI(foursquareKey)\n      : null;\n    const qualityScorer = new OptimizedQualityScorer({\n      maxCostPerBusiness: budgetLimit / maxResults,\n    });\n\n    // Step 1: Search for businesses from multiple sources (ENHANCED with Census optimization)\n    const allRawBusinesses = [];\n\n    // Apply Census-optimized search parameters\n    const optimizedMaxResults = censusIntelligence\n      ? Math.min(\n          maxResults * 1.5,\n          censusIntelligence.optimization.expected_results || maxResults\n        )\n      : maxResults;\n\n    // Google Places search (with Census optimization)\n    const googleBusinesses = await placesAPI.searchBusinesses(\n      businessType,\n      location,\n      optimizedMaxResults\n    );\n    console.log(\n      `ðŸ“Š Found ${googleBusinesses.length} businesses from Google Places`\n    );\n    if (googleBusinesses.length > 0) {\n      console.log(\n        `ðŸ“‹ First business sample:`,\n        JSON.stringify(googleBusinesses[0], null, 2)\n      );\n    }\n    allRawBusinesses.push(...googleBusinesses);\n\n    // Foursquare search (if API key available)\n    if (foursquareAPI) {\n      const foursquareBusinesses = await foursquareAPI.searchBusinesses(\n        businessType,\n        location,\n        Math.max(maxResults - googleBusinesses.length, 2) // Get additional businesses\n      );\n      console.log(\n        `ðŸ“Š Found ${foursquareBusinesses.length} businesses from Foursquare`\n      );\n      allRawBusinesses.push(...foursquareBusinesses);\n    }\n\n    // Remove duplicates based on name and location similarity\n    const uniqueBusinesses = removeDuplicates(allRawBusinesses);\n    console.log(`ðŸ“Š Total unique businesses: ${uniqueBusinesses.length}`);\n\n    // Step 2: Score and filter businesses\n    const scoredBusinesses = uniqueBusinesses.map((business: unknown) =>\n      qualityScorer.scoreBusiness(business)\n    );\n    const qualifiedLeads = scoredBusinesses\n      .filter((lead: BusinessLead) => lead.optimizedScore >= minConfidenceScore)\n      .slice(0, maxResults);\n\n    console.log(\n      `âœ… Qualified ${qualifiedLeads.length}/${\n        scoredBusinesses.length\n      } businesses (${(\n        (qualifiedLeads.length / scoredBusinesses.length) *\n        100\n      ).toFixed(1)}%)`\n    );\n\n    // Step 3: Apply P1 enhancements based on user selections\n    const enhancedLeads = qualifiedLeads;\n    let enhancementCost = 0;\n    const optimizationStats = {\n      totalAPICallsSaved: 0,\n      averageConfidenceBoost: 0,\n      parallelProcessingUsed: 0,\n    };\n\n    if (\n      tradeAssociations ||\n      professionalLicensing ||\n      chamberVerification ||\n      apolloDiscovery\n    ) {\n      console.log(\"ðŸš€ Applying optimized P1 enhancements...\");\n\n      // Process each lead with selected enhancements\n      for (let i = 0; i < enhancedLeads.length; i++) {\n        const lead = enhancedLeads[i];\n        let totalConfidenceBoost = 0;\n\n        // Apply Chamber of Commerce verification (free)\n        if (chamberVerification) {\n          await qualityScorer.applyChamberVerification(lead, location);\n        }\n\n        // Apply Trade Association verification (free)\n        if (tradeAssociations) {\n          await qualityScorer.applyTradeAssociationVerification(\n            lead,\n            businessType\n          );\n        }\n\n        // Apply Professional Licensing verification (free)\n        if (professionalLicensing) {\n          await qualityScorer.applyProfessionalLicensing(lead, businessType);\n        }\n\n        // Apply Apollo discovery (premium - $1.00 per organization)\n        if (apolloDiscovery) {\n          await qualityScorer.applyApolloDiscovery(lead);\n        }\n\n        // Update costs and stats\n        enhancementCost += lead.enhancementData.processingMetadata.totalCost;\n        totalConfidenceBoost +=\n          lead.enhancementData.processingMetadata.totalConfidenceBoost;\n      }\n\n      // Calculate optimization statistics\n      optimizationStats.totalAPICallsSaved = enhancedLeads.reduce(\n        (total: number, lead: BusinessLead) => {\n          return (\n            total +\n            (lead.enhancementData.processingMetadata.apisSkipped?.length || 0)\n          );\n        },\n        0\n      );\n\n      optimizationStats.averageConfidenceBoost =\n        enhancedLeads.reduce((total: number, lead: BusinessLead) => {\n          return (\n            total +\n            (lead.enhancementData.processingMetadata.totalConfidenceBoost || 0)\n          );\n        }, 0) / enhancedLeads.length;\n\n      optimizationStats.parallelProcessingUsed = enhancedLeads.filter(\n        (lead: BusinessLead) => {\n          return (\n            lead.enhancementData.processingMetadata.processingStrategy ===\n            \"parallel\"\n          );\n        }\n      ).length;\n\n      console.log(`ðŸ’° Enhancement cost: $${enhancementCost.toFixed(2)}`);\n      console.log(\n        `âš¡ Optimization: ${optimizationStats.totalAPICallsSaved} API calls saved`\n      );\n      console.log(\n        `ðŸ“ˆ Average confidence boost: +${optimizationStats.averageConfidenceBoost.toFixed(\n          1\n        )} points`\n      );\n    }\n\n    const processingTime = Date.now() - startTime;\n    const totalCost =\n      qualifiedLeads.reduce(\n        (sum: number, lead: BusinessLead) => sum + lead.validationCost,\n        0\n      ) + enhancementCost;\n\n    // Generate campaign ID\n    const campaignId = `campaign_${Date.now()}_${Math.random()\n      .toString(36)\n      .substr(2, 9)}`;\n\n    // Store in database (Supabase integration with new authentication)\n    if (supabaseClient) {\n      try {\n        await supabaseClient.from(\"campaigns\").insert({\n          id: campaignId,\n          business_type: businessType,\n          location: location,\n          target_count: maxResults,\n          results_count: enhancedLeads.length,\n          total_cost: totalCost,\n          enhancement_cost: enhancementCost,\n          processing_time: processingTime,\n          optimization_stats: optimizationStats,\n          user_id: authContext.userId,\n          session_user_id: sessionUserId,\n        });\n\n        // Store leads\n        const leadsToStore = enhancedLeads.map((lead: BusinessLead) => ({\n          campaign_id: campaignId,\n          business_name: lead.businessName,\n          address: lead.address,\n          phone: lead.phone,\n          website: lead.website,\n          email: lead.email,\n          confidence_score: lead.optimizedScore,\n          enhancement_data: lead.enhancementData,\n          user_id: authContext.userId,\n          session_user_id: sessionUserId,\n        }));\n\n        await supabaseClient.from(\"leads\").insert(leadsToStore);\n\n        console.log(\n          `ðŸ’¾ Stored campaign and ${leadsToStore.length} leads for user ${authContext.userId}`\n        );\n      } catch (error) {\n        console.error(\"Database storage error with new auth:\", error);\n      }\n    }\n\n    // Return optimized results\n    return new Response(\n      JSON.stringify({\n        success: true,\n        campaignId,\n        discoveryEngine:\n          \"Optimized Discovery Engine v3.1 + Census Intelligence\",\n        requirements: {\n          targetLeads: maxResults,\n          budgetLimit,\n          minConfidenceScore,\n        },\n        results: {\n          totalFound: enhancedLeads.length,\n          qualified: enhancedLeads.length,\n          qualificationRate: `${(\n            (enhancedLeads.length / allRawBusinesses.length) *\n            100\n          ).toFixed(1)}%`,\n          averageConfidence: Math.round(\n            enhancedLeads.reduce(\n              (sum: number, lead: BusinessLead) => sum + lead.optimizedScore,\n              0\n            ) / enhancedLeads.length\n          ),\n        },\n        // NEW: Census Geographic Intelligence\n        census_intelligence: censusIntelligence\n          ? {\n              business_density: {\n                total_establishments: censusIntelligence.total_establishments,\n                density_score: censusIntelligence.density_score,\n                confidence_multiplier:\n                  censusIntelligence.optimization.confidence_multiplier,\n              },\n              geographic_optimization: {\n                optimal_radius: censusIntelligence.optimization.search_radius,\n                expected_results:\n                  censusIntelligence.optimization.expected_results,\n                api_efficiency_score:\n                  censusIntelligence.optimization.api_efficiency_score,\n              },\n              market_insights: {\n                market_density:\n                  censusIntelligence.density_score > 50\n                    ? \"High\"\n                    : censusIntelligence.density_score > 20\n                    ? \"Medium\"\n                    : \"Low\",\n                competition_level:\n                  censusIntelligence.total_establishments > 1000\n                    ? \"High\"\n                    : censusIntelligence.total_establishments > 100\n                    ? \"Medium\"\n                    : \"Low\",\n                search_optimization:\n                  censusIntelligence.optimization.api_efficiency_score > 70\n                    ? \"Highly optimized\"\n                    : \"Standard targeting\",\n              },\n            }\n          : null,\n        optimization: {\n          processingTime: `${processingTime}ms`,\n          apiCallsSaved: optimizationStats.totalAPICallsSaved || 0,\n          parallelProcessing: optimizationStats.parallelProcessingUsed || 0,\n          averageConfidenceBoost: optimizationStats.averageConfidenceBoost || 0,\n          // Enhanced with Census intelligence\n          geographic_intelligence_applied: censusIntelligence ? true : false,\n          costOptimization: {\n            enhancementCost,\n            totalCost,\n            savingsFromIntelligentRouting:\n              (optimizationStats.totalAPICallsSaved || 0) * 0.1, // Estimated savings\n            census_optimization_savings:\n              (censusIntelligence?.optimization?.api_efficiency_score || 0) > 70\n                ? totalCost * 0.15\n                : 0, // 15% savings estimate for high-efficiency targeting\n          },\n        },\n        costs: {\n          totalCost,\n          costPerLead: totalCost / enhancedLeads.length,\n          enhancementCost,\n          validationCost: totalCost - enhancementCost,\n        },\n        leads: enhancedLeads,\n        metadata: {\n          timestamp: new Date().toISOString(),\n          version: \"3.0\",\n          optimizationsApplied: true,\n        },\n      }),\n      {\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  } catch (error) {\n    console.error(\"Optimized discovery error:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        timestamp: new Date().toISOString(),\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":17,"duration":3.663},
{"type":"measure","name":"lsp.did_open","count":40,"duration":55.439},
{"type":"mark","name":"lsp.did_open","count":41,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","languageId":"typescript","version":1,"text":"import type {\n  SupabaseClient,\n  User,\n} from \"https://esm.sh/@supabase/supabase-js@2.38.0\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.38.0\";\n\nexport interface AuthenticatedRequestContext {\n  supabaseUrl: string;\n  supabaseAnonKey: string;\n  supabaseServiceRoleKey: string;\n  supabaseClient: SupabaseClient;\n  accessToken: string;\n  user: User;\n  userId: string;\n  email: string | null;\n  isAnonymous: boolean;\n  sessionId: string | null;\n  tokenClaims: Record<string, unknown>;\n}\n\nfunction getRequiredEnv(name: string): string {\n  const value = Deno.env.get(name);\n  if (!value) {\n    throw new Error(`Missing required environment variable: ${name}`);\n  }\n  return value;\n}\n\nfunction base64UrlToUint8Array(value: string): Uint8Array {\n  const padded = value.padEnd(\n    value.length + ((4 - (value.length % 4)) % 4),\n    \"=\"\n  );\n  const base64 = padded.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  const binary = atob(base64);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i += 1) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes;\n}\n\nfunction decodeJwtClaims(token: string): Record<string, unknown> {\n  try {\n    const parts = token.split(\".\");\n    if (parts.length !== 3) {\n      return {};\n    }\n    const payload = base64UrlToUint8Array(parts[1]);\n    const decoded = new TextDecoder().decode(payload);\n    return JSON.parse(decoded) as Record<string, unknown>;\n  } catch (_error) {\n    return {};\n  }\n}\n\nexport async function authenticateRequest(\n  req: Request\n): Promise<AuthenticatedRequestContext> {\n  const supabaseUrl = getRequiredEnv(\"SUPABASE_URL\");\n  const supabaseAnonKey = getRequiredEnv(\"SUPABASE_ANON_KEY\");\n  const supabaseServiceRoleKey = getRequiredEnv(\"SUPABASE_SERVICE_ROLE_KEY\");\n\n  const authHeader = req.headers.get(\"Authorization\") ?? \"\";\n  if (!authHeader.startsWith(\"Bearer \")) {\n    throw new Error(\"Missing Authorization bearer token\");\n  }\n\n  const supabaseClient = createClient(supabaseUrl, supabaseAnonKey, {\n    auth: { persistSession: false },\n    global: {\n      headers: {\n        Authorization: authHeader,\n      },\n    },\n  });\n\n  const accessToken = authHeader.replace(/^Bearer\\s+/i, \"\");\n  const { data, error } = await supabaseClient.auth.getUser(accessToken);\n\n  if (error || !data.user) {\n    throw new Error(\n      `Authentication failed: ${error?.message ?? \"No user found\"}`\n    );\n  }\n\n  const user = data.user;\n  const tokenClaims = decodeJwtClaims(accessToken);\n  const sessionId =\n    typeof tokenClaims.session_id === \"string\"\n      ? (tokenClaims.session_id as string)\n      : null;\n  const isAnonymous =\n    typeof user.is_anonymous === \"boolean\"\n      ? user.is_anonymous\n      : Boolean(tokenClaims.is_anonymous);\n  const email =\n    typeof user.email === \"string\"\n      ? user.email\n      : typeof tokenClaims.email === \"string\"\n      ? (tokenClaims.email as string)\n      : null;\n\n  return {\n    supabaseUrl,\n    supabaseAnonKey,\n    supabaseServiceRoleKey,\n    supabaseClient,\n    accessToken,\n    user,\n    userId: user.id,\n    email,\n    isAnonymous,\n    sessionId,\n    tokenClaims,\n  };\n}\n\nexport const corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\":\n    \"authorization, x-client-info, apikey, content-type\",\n  \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\",\n};\n\nexport function handleCORS(request: Request): Response | null {\n  if (request.method === \"OPTIONS\") {\n    return new Response(null, { headers: corsHeaders });\n  }\n  return null;\n}\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":18,"duration":0.516},
{"type":"measure","name":"lsp.did_open","count":41,"duration":16.824},
{"type":"mark","name":"lsp.did_open","count":42,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","languageId":"typescript","version":1,"text":"// deno-lint-ignore-file\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport {\n  authenticateRequest,\n  corsHeaders,\n  handleCORS,\n} from \"../_shared/edge-auth.ts\";\nimport { API_SECRETS, createVaultClient } from \"../_shared/vault-client.ts\";\n\n/**\n * Hunter.io Comprehensive Email Discovery & Verification Edge Function\n * Implements all Hunter.io API endpoints with cost optimization\n *\n * Pricing:\n * - Email Count (Domain Search stats): FREE\n * - Domain Search: $0.034 per search\n * - Email Finder: $0.034 per request\n * - Email Verifier: $0.01 per verification\n * - Person/Company Enrichment: $0.034 per enrichment\n *\n * Features:\n * - Secure vault integration for API keys\n * - Circuit breakers per endpoint\n * - Cost tracking and budgeting\n * - Confidence scoring\n * - Smart email prioritization\n */\n\ninterface HunterRequest {\n  action:\n    | \"domain-search\"\n    | \"email-finder\"\n    | \"email-verifier\"\n    | \"email-count\"\n    | \"person-enrichment\"\n    | \"company-enrichment\";\n\n  // Domain search parameters\n  domain?: string;\n  companyName?: string;\n  limit?: number;\n\n  // Email finder parameters\n  firstName?: string;\n  lastName?: string;\n\n  // Email verifier parameters\n  email?: string;\n\n  // Enrichment parameters\n  personEmail?: string;\n\n  // Budget control\n  maxCostPerRequest?: number;\n}\n\ninterface HunterResponse {\n  success: boolean;\n  action: string;\n  data?: any;\n  cost: number;\n  confidence?: number;\n  metadata?: {\n    requests_remaining?: number;\n    requests_used?: number;\n    reset_date?: string;\n  };\n  error?: string;\n}\n\ntype CircuitBreakerEndpoint =\n  | \"emailCount\"\n  | \"domainSearch\"\n  | \"emailFinder\"\n  | \"emailVerifier\"\n  | \"enrichment\";\n\ninterface CircuitBreakerState {\n  failures: number;\n  lastFailure: number;\n  threshold: number;\n}\n\nclass HunterAPIClient {\n  private apiKey: string;\n  private baseURL = \"https://api.hunter.io/v2\";\n  private circuitBreaker: Record<CircuitBreakerEndpoint, CircuitBreakerState> =\n    {\n      emailCount: { failures: 0, lastFailure: 0, threshold: 3 },\n      domainSearch: { failures: 0, lastFailure: 0, threshold: 3 },\n      emailFinder: { failures: 0, lastFailure: 0, threshold: 3 },\n      emailVerifier: { failures: 0, lastFailure: 0, threshold: 3 },\n      enrichment: { failures: 0, lastFailure: 0, threshold: 3 },\n    };\n  private cache = new Map();\n  private cacheTTL = 24 * 60 * 60 * 1000; // 24 hours\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  /**\n   * FREE: Get email count for a domain (doesn't count against quota)\n   */\n  async getEmailCount(domain: string): Promise<HunterResponse> {\n    const endpoint = \"emailCount\";\n\n    // Check circuit breaker\n    if (this.isCircuitOpen(endpoint)) {\n      throw new Error(`Circuit breaker open for ${endpoint}`);\n    }\n\n    try {\n      const url = `${this.baseURL}/email-count?domain=${encodeURIComponent(\n        domain\n      )}&api_key=${this.apiKey}`;\n\n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.errors?.[0]?.details || \"Email count failed\");\n      }\n\n      this.resetCircuitBreaker(endpoint);\n\n      return {\n        success: true,\n        action: \"email-count\",\n        data: {\n          domain,\n          total: data.data.total,\n          personal_emails: data.data.personal_emails,\n          generic_emails: data.data.generic_emails,\n        },\n        cost: 0, // FREE\n        metadata: {\n          requests_remaining: data.meta.requests?.remaining,\n          requests_used: data.meta.requests?.used,\n        },\n      };\n    } catch (error) {\n      this.recordFailure(endpoint);\n      throw error;\n    }\n  }\n\n  /**\n   * PAID: Domain search - find all emails for a domain\n   * Cost: $0.034 per search\n   */\n  async domainSearch(domain: string, limit = 10): Promise<HunterResponse> {\n    const endpoint = \"domainSearch\";\n    const cost = 0.034;\n\n    // Check circuit breaker\n    if (this.isCircuitOpen(endpoint)) {\n      throw new Error(`Circuit breaker open for ${endpoint}`);\n    }\n\n    // Check cache first\n    const cacheKey = `domain_search_${domain}_${limit}`;\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      console.log(`ðŸ“¦ Using cached domain search for ${domain}`);\n      return { ...cached.data, cost: 0 }; // No cost for cached results\n    }\n\n    try {\n      const url = `${this.baseURL}/domain-search?domain=${encodeURIComponent(\n        domain\n      )}&limit=${limit}&api_key=${this.apiKey}`;\n\n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.errors?.[0]?.details || \"Domain search failed\");\n      }\n\n      this.resetCircuitBreaker(endpoint);\n\n      const result: HunterResponse = {\n        success: true,\n        action: \"domain-search\",\n        data: {\n          domain,\n          organization: data.data.organization,\n          emails: data.data.emails.map((email: any) => ({\n            value: email.value,\n            type: email.type,\n            confidence: email.confidence,\n            firstName: email.first_name,\n            lastName: email.last_name,\n            position: email.position,\n            seniority: email.seniority,\n            department: email.department,\n            linkedin: email.linkedin,\n            twitter: email.twitter,\n            phone_number: email.phone_number,\n          })),\n          pattern: data.data.pattern,\n          webmail: data.data.webmail,\n        },\n        cost,\n        confidence: data.data.emails.length > 0 ? 85 : 0,\n        metadata: {\n          requests_remaining: data.meta.requests?.remaining,\n          requests_used: data.meta.requests?.used,\n        },\n      };\n\n      // Cache the result\n      this.cache.set(cacheKey, {\n        data: result,\n        timestamp: Date.now(),\n      });\n\n      return result;\n    } catch (error) {\n      this.recordFailure(endpoint);\n      throw error;\n    }\n  }\n\n  /**\n   * PAID: Email finder - find email for a specific person\n   * Cost: $0.034 per request\n   */\n  async emailFinder(\n    domain: string,\n    firstName: string,\n    lastName: string\n  ): Promise<HunterResponse> {\n    const endpoint = \"emailFinder\";\n    const cost = 0.034;\n\n    // Check circuit breaker\n    if (this.isCircuitOpen(endpoint)) {\n      throw new Error(`Circuit breaker open for ${endpoint}`);\n    }\n\n    // Check cache first\n    const cacheKey = `email_finder_${domain}_${firstName}_${lastName}`;\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      console.log(`ðŸ“¦ Using cached email finder for ${firstName} ${lastName}`);\n      return { ...cached.data, cost: 0 };\n    }\n\n    try {\n      const url = `${this.baseURL}/email-finder?domain=${encodeURIComponent(\n        domain\n      )}&first_name=${encodeURIComponent(\n        firstName\n      )}&last_name=${encodeURIComponent(lastName)}&api_key=${this.apiKey}`;\n\n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.errors?.[0]?.details || \"Email finder failed\");\n      }\n\n      this.resetCircuitBreaker(endpoint);\n\n      const result: HunterResponse = {\n        success: true,\n        action: \"email-finder\",\n        data: {\n          email: data.data.email,\n          firstName: data.data.first_name,\n          lastName: data.data.last_name,\n          position: data.data.position,\n          company: data.data.company,\n          linkedin: data.data.linkedin,\n          twitter: data.data.twitter,\n          phone_number: data.data.phone_number,\n          score: data.data.score,\n          verification: data.data.verification,\n        },\n        cost,\n        confidence: data.data.score || 0,\n        metadata: {\n          requests_remaining: data.meta.requests?.remaining,\n          requests_used: data.meta.requests?.used,\n        },\n      };\n\n      // Cache the result\n      this.cache.set(cacheKey, {\n        data: result,\n        timestamp: Date.now(),\n      });\n\n      return result;\n    } catch (error) {\n      this.recordFailure(endpoint);\n      throw error;\n    }\n  }\n\n  /**\n   * PAID: Email verifier - verify email deliverability\n   * Cost: $0.01 per verification\n   */\n  async emailVerifier(email: string): Promise<HunterResponse> {\n    const endpoint = \"emailVerifier\";\n    const cost = 0.01;\n\n    // Check circuit breaker\n    if (this.isCircuitOpen(endpoint)) {\n      throw new Error(`Circuit breaker open for ${endpoint}`);\n    }\n\n    // Check cache first\n    const cacheKey = `email_verifier_${email}`;\n    const cached = this.cache.get(cacheKey);\n    if (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n      console.log(`ðŸ“¦ Using cached email verification for ${email}`);\n      return { ...cached.data, cost: 0 };\n    }\n\n    try {\n      const url = `${this.baseURL}/email-verifier?email=${encodeURIComponent(\n        email\n      )}&api_key=${this.apiKey}`;\n\n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(\n          data.errors?.[0]?.details || \"Email verification failed\"\n        );\n      }\n\n      this.resetCircuitBreaker(endpoint);\n\n      const result: HunterResponse = {\n        success: true,\n        action: \"email-verifier\",\n        data: {\n          email: data.data.email,\n          status: data.data.status,\n          result: data.data.result,\n          score: data.data.score,\n          regexp: data.data.regexp,\n          gibberish: data.data.gibberish,\n          disposable: data.data.disposable,\n          webmail: data.data.webmail,\n          mx_records: data.data.mx_records,\n          smtp_server: data.data.smtp_server,\n          smtp_check: data.data.smtp_check,\n          accept_all: data.data.accept_all,\n          block: data.data.block,\n        },\n        cost,\n        confidence: data.data.score || 0,\n        metadata: {\n          requests_remaining: data.meta.requests?.remaining,\n          requests_used: data.meta.requests?.used,\n        },\n      };\n\n      // Cache the result\n      this.cache.set(cacheKey, {\n        data: result,\n        timestamp: Date.now(),\n      });\n\n      return result;\n    } catch (error) {\n      this.recordFailure(endpoint);\n      throw error;\n    }\n  }\n\n  /**\n   * PAID: Person enrichment - get details about a person\n   * Cost: $0.034 per enrichment\n   */\n  async personEnrichment(email: string): Promise<HunterResponse> {\n    const endpoint = \"enrichment\";\n    const cost = 0.034;\n\n    // Check circuit breaker\n    if (this.isCircuitOpen(endpoint)) {\n      throw new Error(`Circuit breaker open for ${endpoint}`);\n    }\n\n    try {\n      const url = `${this.baseURL}/email-enrichment?email=${encodeURIComponent(\n        email\n      )}&api_key=${this.apiKey}`;\n\n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(\n          data.errors?.[0]?.details || \"Person enrichment failed\"\n        );\n      }\n\n      this.resetCircuitBreaker(endpoint);\n\n      return {\n        success: true,\n        action: \"person-enrichment\",\n        data: {\n          email: data.data.email,\n          firstName: data.data.first_name,\n          lastName: data.data.last_name,\n          company: data.data.company,\n          position: data.data.position,\n          seniority: data.data.seniority,\n          department: data.data.department,\n          linkedin: data.data.linkedin,\n          twitter: data.data.twitter,\n          phone_number: data.data.phone_number,\n        },\n        cost,\n        confidence: 80,\n        metadata: {\n          requests_remaining: data.meta.requests?.remaining,\n          requests_used: data.meta.requests?.used,\n        },\n      };\n    } catch (error) {\n      this.recordFailure(endpoint);\n      throw error;\n    }\n  }\n\n  /**\n   * PAID: Company enrichment - get details about a company\n   * Cost: $0.034 per enrichment\n   */\n  async companyEnrichment(domain: string): Promise<HunterResponse> {\n    const endpoint = \"enrichment\";\n    const cost = 0.034;\n\n    // Check circuit breaker\n    if (this.isCircuitOpen(endpoint)) {\n      throw new Error(`Circuit breaker open for ${endpoint}`);\n    }\n\n    try {\n      const url = `${\n        this.baseURL\n      }/domain-enrichment?domain=${encodeURIComponent(domain)}&api_key=${\n        this.apiKey\n      }`;\n\n      const response = await fetch(url);\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(\n          data.errors?.[0]?.details || \"Company enrichment failed\"\n        );\n      }\n\n      this.resetCircuitBreaker(endpoint);\n\n      return {\n        success: true,\n        action: \"company-enrichment\",\n        data: {\n          domain: data.data.domain,\n          organization: data.data.organization,\n          country: data.data.country,\n          description: data.data.description,\n          industry: data.data.industry,\n          size: data.data.size,\n          founded: data.data.founded,\n          revenue: data.data.revenue,\n          linkedin: data.data.linkedin,\n          twitter: data.data.twitter,\n          facebook: data.data.facebook,\n          technologies: data.data.technologies,\n        },\n        cost,\n        confidence: 75,\n        metadata: {\n          requests_remaining: data.meta.requests?.remaining,\n          requests_used: data.meta.requests?.used,\n        },\n      };\n    } catch (error) {\n      this.recordFailure(endpoint);\n      throw error;\n    }\n  }\n\n  // Circuit breaker management\n  private isCircuitOpen(endpoint: CircuitBreakerEndpoint): boolean {\n    const breaker = this.circuitBreaker[endpoint];\n    if (!breaker) return false;\n\n    // Reset after 5 minutes\n    if (Date.now() - breaker.lastFailure > 5 * 60 * 1000) {\n      breaker.failures = 0;\n      return false;\n    }\n\n    return breaker.failures >= breaker.threshold;\n  }\n\n  private recordFailure(endpoint: CircuitBreakerEndpoint): void {\n    const breaker = this.circuitBreaker[endpoint];\n    if (breaker) {\n      breaker.failures++;\n      breaker.lastFailure = Date.now();\n    }\n  }\n\n  private resetCircuitBreaker(endpoint: CircuitBreakerEndpoint): void {\n    const breaker = this.circuitBreaker[endpoint];\n    if (breaker) {\n      breaker.failures = 0;\n    }\n  }\n}\n\nserve(async (req) => {\n  // Handle CORS preflight\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    console.log(`ðŸ” Hunter.io Email Enrichment Edge Function`);\n\n    const authContext = await authenticateRequest(req);\n    console.log(\n      `ðŸ” Authenticated Supabase session for ${authContext.userId} (${\n        authContext.isAnonymous ? \"anonymous\" : \"authenticated\"\n      })`\n    );\n\n    // Get Hunter.io API key from vault\n    const vaultClient = createVaultClient();\n    const hunterApiKey = await vaultClient.getSecret(API_SECRETS.HUNTER_IO);\n\n    // Parse request\n    const requestData: HunterRequest = await req.json();\n    const { action, maxCostPerRequest = 2.0 } = requestData;\n\n    console.log(`ðŸ“‹ Action: ${action}`);\n\n    // Initialize Hunter.io client\n    const hunterClient = new HunterAPIClient(hunterApiKey);\n\n    // Route to appropriate action\n    let result: HunterResponse;\n\n    switch (action) {\n      case \"email-count\":\n        if (!requestData.domain) {\n          throw new Error(\"domain is required for email-count\");\n        }\n        result = await hunterClient.getEmailCount(requestData.domain);\n        break;\n\n      case \"domain-search\":\n        if (!requestData.domain) {\n          throw new Error(\"domain is required for domain-search\");\n        }\n        result = await hunterClient.domainSearch(\n          requestData.domain,\n          requestData.limit || 10\n        );\n        break;\n\n      case \"email-finder\":\n        if (\n          !requestData.domain ||\n          !requestData.firstName ||\n          !requestData.lastName\n        ) {\n          throw new Error(\n            \"domain, firstName, and lastName are required for email-finder\"\n          );\n        }\n        result = await hunterClient.emailFinder(\n          requestData.domain,\n          requestData.firstName,\n          requestData.lastName\n        );\n        break;\n\n      case \"email-verifier\":\n        if (!requestData.email) {\n          throw new Error(\"email is required for email-verifier\");\n        }\n        result = await hunterClient.emailVerifier(requestData.email);\n        break;\n\n      case \"person-enrichment\":\n        if (!requestData.personEmail) {\n          throw new Error(\"personEmail is required for person-enrichment\");\n        }\n        result = await hunterClient.personEnrichment(requestData.personEmail);\n        break;\n\n      case \"company-enrichment\":\n        if (!requestData.domain) {\n          throw new Error(\"domain is required for company-enrichment\");\n        }\n        result = await hunterClient.companyEnrichment(requestData.domain);\n        break;\n\n      default:\n        throw new Error(`Unknown action: ${action}`);\n    }\n\n    // Check cost limit\n    if (result.cost > maxCostPerRequest) {\n      console.warn(\n        `âš ï¸ Cost limit exceeded: $${result.cost} > $${maxCostPerRequest}`\n      );\n    }\n\n    console.log(`âœ… Hunter.io ${action} completed - Cost: $${result.cost}`);\n\n    return new Response(\n      JSON.stringify({\n        ...result,\n        timestamp: new Date().toISOString(),\n        version: \"1.0\",\n      }),\n      {\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  } catch (error) {\n    console.error(\"Hunter.io enrichment error:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        timestamp: new Date().toISOString(),\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"measure","name":"lsp.did_open","count":42,"duration":31.652},
{"type":"mark","name":"lsp.did_open","count":43,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","languageId":"typescript","version":1,"text":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport {\n  authenticateRequest,\n  corsHeaders,\n  handleCORS,\n} from \"../_shared/edge-auth.ts\";\n\n// Simplified Business Discovery with New Authentication\n// Test version for new API key format\n\ninterface StorageResult {\n  success: boolean;\n  campaignStored?: boolean;\n  leadsStored?: number;\n  error?: string;\n  leadsError?: string;\n}\n\nserve(async (req) => {\n  // Handle CORS preflight\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    console.log(`ðŸš€ Business Discovery with New Authentication`);\n\n    const authContext = await authenticateRequest(req);\n    console.log(\n      `ðŸ” Authenticated Supabase session for ${authContext.userId} (${\n        authContext.isAnonymous ? \"anonymous\" : \"authenticated\"\n      })`\n    );\n    const supabaseClient = authContext.supabaseClient;\n    const sessionUserId = authContext.sessionId;\n\n    // Parse request\n    const requestData = await req.json();\n    const {\n      businessType = \"restaurant\",\n      location = \"Seattle, WA\",\n      maxResults = 2,\n    } = requestData;\n\n    console.log(\n      `ðŸ“‹ Request: ${businessType} in ${location} (${maxResults} results)`\n    );\n\n    // Mock some business data for testing\n    const mockBusinesses = [\n      {\n        businessName: `Sample ${businessType} 1`,\n        address: `123 Main St, ${location}`,\n        phone: \"(555) 123-4567\",\n        website: \"https://example1.com\",\n        email: \"contact@example1.com\",\n        optimizedScore: 85,\n        validationCost: 0.02,\n        enhancementData: {\n          verificationSources: [\"google_places\"],\n          apolloVerified: false,\n          chamberVerified: false,\n          licenseVerified: false,\n          processingMetadata: {\n            totalCost: 0.02,\n            totalConfidenceBoost: 0,\n            apisSkipped: [],\n            processingStrategy: \"basic\",\n          },\n        },\n      },\n      {\n        businessName: `Sample ${businessType} 2`,\n        address: `456 Oak Ave, ${location}`,\n        phone: \"(555) 234-5678\",\n        website: \"https://example2.com\",\n        email: \"info@example2.com\",\n        optimizedScore: 78,\n        validationCost: 0.02,\n        enhancementData: {\n          verificationSources: [\"google_places\"],\n          apolloVerified: false,\n          chamberVerified: false,\n          licenseVerified: false,\n          processingMetadata: {\n            totalCost: 0.02,\n            totalConfidenceBoost: 0,\n            apisSkipped: [],\n            processingStrategy: \"basic\",\n          },\n        },\n      },\n    ];\n\n    const campaignId = `test_campaign_${Date.now()}`;\n\n    // Test database storage with new authentication\n    let dbStorageResult: StorageResult | null = null;\n    if (supabaseClient) {\n      try {\n        const campaignData = {\n          id: campaignId,\n          business_type: businessType,\n          location: location,\n          target_count: maxResults,\n          results_count: mockBusinesses.length,\n          total_cost: 0.04,\n          processing_time_ms: 500,\n          status: \"completed\",\n          user_id: authContext.userId,\n          session_user_id: sessionUserId,\n        };\n\n        const { error: campaignError } = await supabaseClient\n          .from(\"campaigns\")\n          .insert(campaignData);\n\n        if (campaignError) {\n          dbStorageResult = { success: false, error: campaignError.message };\n        } else {\n          dbStorageResult = { success: true, campaignStored: true };\n\n          // Try to store leads\n          const leadsData = mockBusinesses.map((lead) => ({\n            campaign_id: campaignId,\n            business_name: lead.businessName,\n            address: lead.address,\n            phone: lead.phone,\n            website: lead.website,\n            email: lead.email,\n            confidence_score: lead.optimizedScore,\n            enrichment_data: lead.enhancementData,\n            user_id: authContext.userId,\n            session_user_id: sessionUserId,\n          }));\n\n          const { error: leadsError } = await supabaseClient\n            .from(\"leads\")\n            .insert(leadsData);\n\n          if (leadsError) {\n            if (dbStorageResult) {\n              dbStorageResult.leadsError = leadsError.message;\n            }\n          } else if (dbStorageResult) {\n            dbStorageResult.leadsStored = leadsData.length;\n          }\n        }\n\n        console.log(`ðŸ’¾ Database storage result:`, dbStorageResult);\n      } catch (error) {\n        dbStorageResult = {\n          success: false,\n          error: error instanceof Error ? error.message : \"Storage failed\",\n        };\n      }\n    }\n\n    const response = {\n      success: true,\n      campaignId,\n      discoveryEngine: \"Test Discovery with New Authentication v1.0\",\n      authentication: {\n        userId: authContext.userId,\n        sessionId: sessionUserId,\n        isAnonymous: authContext.isAnonymous,\n      },\n      requirements: {\n        targetLeads: maxResults,\n        businessType,\n        location,\n      },\n      results: {\n        totalFound: mockBusinesses.length,\n        qualified: mockBusinesses.length,\n        averageConfidence: Math.round(\n          mockBusinesses.reduce((sum, lead) => sum + lead.optimizedScore, 0) /\n            mockBusinesses.length\n        ),\n      },\n      database_storage: dbStorageResult,\n      leads: mockBusinesses,\n      metadata: {\n        timestamp: new Date().toISOString(),\n        version: \"test-1.0\",\n        authenticationUpdated: true,\n      },\n    };\n\n    return new Response(JSON.stringify(response, null, 2), {\n      headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n    });\n  } catch (error) {\n    console.error(\"âŒ Test discovery error:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        timestamp: new Date().toISOString(),\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":19,"duration":0.686},
{"type":"measure","name":"lsp.did_open","count":43,"duration":16.633},
{"type":"mark","name":"lsp.did_open","count":44,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","languageId":"typescript","version":1,"text":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport type { SupabaseClient } from \"https://esm.sh/@supabase/supabase-js@2.38.0\";\nimport type { AuthenticatedRequestContext } from \"../_shared/edge-auth.ts\";\nimport {\n  authenticateRequest,\n  corsHeaders,\n  handleCORS,\n} from \"../_shared/edge-auth.ts\";\n\n// Test Edge Function - Supabase Session Authentication Diagnostics\n\ninterface DatabaseDiagnostics {\n  success: boolean;\n  access: Record<string, boolean>;\n  error?: string;\n}\n\ninterface QueryDiagnostics {\n  success: boolean;\n  rowCount?: number;\n  error?: string;\n  sampleCampaignIds?: string[];\n}\n\ninterface RequestAuthDiagnostics {\n  authorizationHeaderPresent: boolean;\n  userId: string;\n  sessionId: string | null;\n  email: string | null;\n  isAnonymous: boolean;\n}\n\ntype EnvironmentDiagnostics = Record<string, boolean>;\n\nserve(async (req) => {\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    console.log(\"ðŸ§ª Running Supabase session authentication diagnostics...\");\n\n    const authContext = await authenticateRequest(req);\n    const supabaseClient = authContext.supabaseClient;\n\n    const requestDiagnostics = buildRequestDiagnostics(authContext, req);\n    const databaseDiagnostics = await runDatabaseDiagnostics(supabaseClient);\n    const queryDiagnostics = await fetchSampleCampaigns(supabaseClient);\n\n    const environmentDiagnostics: EnvironmentDiagnostics = {\n      SUPABASE_URL: Boolean(Deno.env.get(\"SUPABASE_URL\")),\n      SUPABASE_ANON_KEY: Boolean(Deno.env.get(\"SUPABASE_ANON_KEY\")),\n      VITE_SUPABASE_ANON_KEY: Boolean(Deno.env.get(\"VITE_SUPABASE_ANON_KEY\")),\n      SUPABASE_SERVICE_ROLE_KEY: Boolean(\n        Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")\n      ),\n      SUPABASE_SECRET_KEY: Boolean(Deno.env.get(\"SUPABASE_SECRET_KEY\")),\n    };\n\n    const response = {\n      success: true,\n      timestamp: new Date().toISOString(),\n      authentication: {\n        request: requestDiagnostics,\n        databaseTest: databaseDiagnostics,\n        queryTest: queryDiagnostics,\n      },\n      environment: environmentDiagnostics,\n      recommendations: generateRecommendations(\n        authContext,\n        databaseDiagnostics,\n        environmentDiagnostics,\n        queryDiagnostics\n      ),\n    };\n\n    return new Response(JSON.stringify(response, null, 2), {\n      headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n    });\n  } catch (error) {\n    console.error(\"âŒ Authentication diagnostics failed:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        timestamp: new Date().toISOString(),\n      }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n\nfunction buildRequestDiagnostics(\n  authContext: AuthenticatedRequestContext,\n  req: Request\n): RequestAuthDiagnostics {\n  return {\n    authorizationHeaderPresent: req.headers.has(\"Authorization\"),\n    userId: authContext.userId,\n    sessionId: authContext.sessionId,\n    email: authContext.email,\n    isAnonymous: authContext.isAnonymous,\n  };\n}\n\nasync function runDatabaseDiagnostics(\n  supabaseClient: SupabaseClient\n): Promise<DatabaseDiagnostics> {\n  const tables = [\"campaigns\", \"leads\", \"dashboard_exports\"] as const;\n  const access: Record<string, boolean> = {};\n  const errors: string[] = [];\n\n  for (const table of tables) {\n    try {\n      const { error } = await supabaseClient.from(table).select(\"id\").limit(1);\n      access[table] = !error;\n      if (error) {\n        errors.push(`${table}: ${error.message}`);\n      }\n    } catch (error) {\n      access[table] = false;\n      errors.push(\n        `${table}: ${error instanceof Error ? error.message : \"Unknown error\"}`\n      );\n    }\n  }\n\n  return {\n    success: Object.values(access).some(Boolean),\n    access,\n    error: errors.length ? errors.join(\"; \") : undefined,\n  };\n}\n\nasync function fetchSampleCampaigns(\n  supabaseClient: SupabaseClient\n): Promise<QueryDiagnostics> {\n  try {\n    const { data, error } = await supabaseClient\n      .from(\"campaigns\")\n      .select(\"id\")\n      .limit(3);\n\n    if (error) {\n      return { success: false, error: error.message };\n    }\n\n    const rows = data ?? [];\n    return {\n      success: true,\n      rowCount: rows.length,\n      sampleCampaignIds: rows.map((row) => String(row.id)),\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Query failed\",\n    };\n  }\n}\n\nfunction generateRecommendations(\n  authContext: AuthenticatedRequestContext,\n  dbDiagnostics: DatabaseDiagnostics,\n  envDiagnostics: EnvironmentDiagnostics,\n  queryDiagnostics: QueryDiagnostics\n): string[] {\n  const recommendations: string[] = [];\n\n  if (!envDiagnostics.SUPABASE_URL || !envDiagnostics.SUPABASE_ANON_KEY) {\n    recommendations.push(\n      \"âŒ Missing Supabase URL or anon key - update environment configuration\"\n    );\n  }\n\n  if (!envDiagnostics.SUPABASE_SERVICE_ROLE_KEY) {\n    recommendations.push(\n      \"âš ï¸ Service role key missing - vault access and server-side operations may fail\"\n    );\n  }\n\n  if (dbDiagnostics.success === false) {\n    recommendations.push(\n      dbDiagnostics.error\n        ? `âŒ Database diagnostics failed: ${dbDiagnostics.error}`\n        : \"âŒ Database diagnostics failed - check RLS policies\"\n    );\n  } else {\n    const accessibleTables = Object.entries(dbDiagnostics.access)\n      .filter(([, hasAccess]) => hasAccess)\n      .map(([table]) => table)\n      .join(\", \");\n    recommendations.push(\n      `âœ… Database access confirmed for: ${accessibleTables}`\n    );\n  }\n\n  if (!queryDiagnostics.success) {\n    recommendations.push(\n      queryDiagnostics.error\n        ? `âš ï¸ Sample campaign query failed: ${queryDiagnostics.error}`\n        : \"âš ï¸ Unable to read campaigns - verify user permissions\"\n    );\n  }\n\n  if (authContext.isAnonymous) {\n    recommendations.push(\n      \"â„¹ï¸ Anonymous session detected - upgrade to authenticated user for full access\"\n    );\n  }\n\n  if (recommendations.length === 0) {\n    recommendations.push(\"âœ… Supabase authentication flow looks healthy\");\n  }\n\n  return recommendations;\n}\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":20,"duration":0.325},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":21,"duration":0.254},
{"type":"measure","name":"lsp.did_open","count":44,"duration":15.513},
{"type":"mark","name":"lsp.did_open","count":45,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md","languageId":"markdown","version":1,"text":"# ðŸ” Edge Function Authentication Update - Complete Guide\n\n## October 9, 2025 â€” Supabase-Native Session Enforcement\n\n### ðŸŽ¯ **STATUS: EDGE FUNCTIONS REQUIRE REAL SUPABASE SESSIONS**\n\nâœ… **COMPLETED THIS ROUND:**\n\n- Replaced the custom JWKS verifier with Supabase's supported `auth.getUser` flow\n- Updated every production Edge Function to consume the new `authenticateRequest`\n- Preserved automatic user + session binding when writing campaigns, leads, and exports\n- Added an official reference function (`test-official-auth`) that exercises the supported pattern end-to-end\n- Refreshed developer tooling and docs to reflect the simplified contract (session token only)\n\nðŸš¨ **AUTH REQUIREMENT:**\n\n- Authenticated Edge Functions **must** receive a Supabase session JWT (user sign-in token)\n- Publishable or service-role keys **cannot** substitute for end-user Authorization headers\n- Frontend and service callers are responsible for forwarding `Authorization: Bearer <supabase_session_jwt>` on every request\n\n---\n\n### ðŸ”§ **CALLER CHECKLIST**\n\n1. Fetch the active session token in the client:\n\n```ts\nconst session = await supabase.auth.getSession();\nconst accessToken = session.data.session?.access_token;\n```\n\n2. Attach the token when invoking an Edge Function:\n\n```ts\nconst response = await fetch(edgeFunctionUrl, {\n  method: \"POST\",\n  headers: {\n    Authorization: `Bearer ${accessToken}`,\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify(payload),\n});\n```\n\n3. For service automations, mint a short-lived service-role JWT via the Supabase Admin API and forward it exactly the same way.\n\nKeep tokens fresh by subscribing to `onAuthStateChange` and updating any cached headers when Supabase rotates the session.\n\n---\n\n### ðŸ§± **IMPLEMENTATION SNAPSHOT**\n\n```ts\n// /supabase/functions/_shared/edge-auth.ts\nexport async function authenticateRequest(req: Request) {\n  // 1. Create a Supabase client with the caller's Authorization header\n  // 2. Call supabaseClient.auth.getUser(token) to validate the session\n  // 3. Return the hydrated client and user context (id, email, anonymous flag, session id, token claims)\n}\n\nexport const corsHeaders = {\n  /* shared CORS headers */\n};\nexport function handleCORS(request: Request) {\n  /* OPTIONS preflight helper */\n}\n```\n\nEvery production Edge Function (`business-discovery-optimized`, `enrichment-hunter`, `campaign-export-user-aware`, the test harnesses, and background diagnostics) now consumes the simplified context:\n\n- `authContext.userId` â†’ Postgres `user_id` columns\n- `authContext.sessionId` â†’ Postgres `session_user_id` columns (falls back to `null` when not present)\n- `authContext.isAnonymous` / `authContext.email` â†’ logging and analytics\n- `authContext.supabaseClient` â†’ automatically scoped client with RLS enforced\n\n---\n\n### ðŸ§ª **HOW TO TEST IT**\n\n| Scenario                    | Command                                                                                                                                                          | Expected Result                                                 |\n| --------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- |\n| Edge Function diagnostics   | `curl -X POST https://.../functions/v1/test-new-auth -H \"Authorization: Bearer <SESSION>\" -d '{\"diagnostics\":true}'`                                             | JSON payload confirming database access & environment readiness |\n| Official pattern smoke test | `curl -X POST https://.../functions/v1/test-official-auth -H \"Authorization: Bearer <SESSION>\" -d '{}'`                                                          | Confirms RLS queries succeed with supplied session              |\n| Business discovery test     | `curl -X POST https://.../functions/v1/test-business-discovery -H \"Authorization: Bearer <SESSION>\" -d '{\"businessType\":\"coffee shop\",\"location\":\"Austin, TX\"}'` | Inserts mocked campaign/leads tied to caller's user id          |\n\n> Replace `<SESSION>` with an actual Supabase session JWT fetched via Supabase CLI, Admin API, or the frontend.\n\n---\n\n### ðŸš€ **NEXT STEPS FOR CALLERS**\n\n1. **Propagate session JWTs** throughout the frontend and automation scripts (reference checklist above).\n2. **Monitor session expiry** â€” refresh tokens during long-running workflows to avoid mid-flight 401s.\n3. **Rotate service-role tokens** on a schedule if background jobs call these functions without a user session.\n\n---\n\n### ðŸ“Š **SECURITY & OBSERVABILITY**\n\n- âœ… RLS enforcement automatically scopes queries to the authenticated user.\n- âœ… `user_id` and `session_user_id` continue to populate on all writes.\n- âœ… No project secrets or JWKS endpoints are required inside Edge Functions.\n- ðŸ“ˆ `test-new-auth` returns environment + data-access diagnostics to validate new deployments quickly.\n- âš ï¸ Anonymous sessions still authenticate, but output is limitedâ€”promote users for full data access.\n\n---\n\n### âœ… **VERIFICATION CHECKLIST (POST-MIGRATION)**\n\n- [ ] Frontend is forwarding real session tokens\n- [ ] Edge Functions succeed via `test-official-auth`\n- [ ] Discovery/enrichment/export runs store `user_id` and `session_user_id`\n- [ ] No references to JWKS or legacy JWT helpers remain in the codebase\n- [ ] Documentation and automation scripts updated to reflect the simplified contract\n\n**Status:** Migration to the Supabase-supported authentication pattern is complete. Continue using session JWTs for every authenticated invocation.\n"}}},
{"type":"measure","name":"lsp.did_open","count":45,"duration":0.075},
{"type":"mark","name":"lsp.did_open","count":46,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","languageId":"typescript","version":1,"text":"export * from \"./edge-auth.ts\";\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":22,"duration":0.276},
{"type":"measure","name":"lsp.did_open","count":46,"duration":11.206},
{"type":"mark","name":"lsp.did_open","count":47,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","languageId":"typescript","version":1,"text":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport {\n  authenticateRequest,\n  corsHeaders,\n  handleCORS,\n} from \"../_shared/edge-auth.ts\";\n\n// Test Edge Function - Supabase Official Authentication Pattern\n\nserve(async (req) => {\n  const corsResponse = handleCORS(req);\n  if (corsResponse) return corsResponse;\n\n  try {\n    console.log(\"ðŸ§ª Testing Supabase's official auth pattern...\");\n\n    const authContext = await authenticateRequest(req);\n    console.log(\n      `ðŸ” Authenticated user ${authContext.userId} (anonymous: ${authContext.isAnonymous})`\n    );\n\n    // Test database operations with RLS enforced automatically\n    const supabaseClient = authContext.supabaseClient;\n\n    // Test campaigns table access\n    const { data: campaigns, error: campaignsError } = await supabaseClient\n      .from(\"campaigns\")\n      .select(\"id, business_type, location\")\n      .limit(3);\n\n    if (campaignsError) {\n      console.warn(\"Campaigns query error:\", campaignsError.message);\n    }\n\n    // Test leads table access\n    const { data: leads, error: leadsError } = await supabaseClient\n      .from(\"leads\")\n      .select(\"id, business_name, campaign_id\")\n      .limit(3);\n\n    if (leadsError) {\n      console.warn(\"Leads query error:\", leadsError.message);\n    }\n\n    const response = {\n      success: true,\n      timestamp: new Date().toISOString(),\n      authenticationMethod: \"Supabase Official Pattern\",\n      user: {\n        id: authContext.user.id,\n        email: authContext.user.email,\n        isAnonymous: authContext.isAnonymous,\n        sessionId: authContext.sessionId,\n      },\n      databaseAccess: {\n        campaigns: {\n          accessible: !campaignsError,\n          count: campaigns?.length || 0,\n          error: campaignsError?.message,\n          sampleIds: campaigns?.map((c) => c.id).slice(0, 3),\n        },\n        leads: {\n          accessible: !leadsError,\n          count: leads?.length || 0,\n          error: leadsError?.message,\n          sampleIds: leads?.map((l) => l.id).slice(0, 3),\n        },\n      },\n      recommendations: [\n        \"âœ… Using Supabase's built-in JWT verification\",\n        \"âœ… RLS policies enforced automatically\",\n        \"âœ… No manual JWKS fetching required\",\n        campaignsError && leadsError\n          ? \"âš ï¸ Check RLS policies - no table access\"\n          : \"âœ… Database access working with RLS\",\n      ].filter(Boolean),\n    };\n\n    return new Response(JSON.stringify(response, null, 2), {\n      headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n    });\n  } catch (error) {\n    console.error(\"âŒ Official auth pattern test failed:\", error);\n\n    return new Response(\n      JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        timestamp: new Date().toISOString(),\n        authenticationMethod: \"Supabase Official Pattern\",\n      }),\n      {\n        status: 401,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      }\n    );\n  }\n});\n"}}},
{"type":"measure","name":"lsp.did_open","count":47,"duration":8.433},
{"type":"mark","name":"lsp.did_open","count":48,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/README.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 - Tier-Aware Background Discovery Platform\n\n**ðŸš€ PRODUCTION READY** - User-Aware Business Discovery with Complete Authentication\n\n## âœ¨ Live Platform\n\n**ðŸŒ Access:** https://prospect-fyhedobh1-appsmithery.vercel.app\n\n## ðŸŽ¯ Core Features\n\n### ðŸ” User-Aware System\n\n- **Anonymous Users:** Session-based workflow with automatic campaign tracking\n- **Authenticated Users:** Permanent campaign storage with complete history\n- **Seamless Upgrade:** Anonymous campaigns automatically link upon signup\n- **Data Isolation:** User-specific access with database-level security\n\n### ðŸ“Š Business Discovery\n\n- **16 Business Categories** with 300+ optimized business types\n- **Asynchronous Background Jobs** with real-time progress + campaign inserts\n- **Multi-Source Discovery** - Google Places, Place Details, and Foursquare with dedupe\n- **Census-Guided Targeting** - Automatic radius + density scoring when `CENSUS_API_KEY` is present\n- **Verified Contact Data** - No fake emails or generated patterns\n- **3-Tier Data Enhancement** with progressive pricing and transparent feature controls\n\n## ðŸŽ¯ Tier Structure\n\n### Base Tier ($0.15/lead) - \"Essential Business Data\"\n\n**Perfect for targeted outreach campaigns**\n\n- âœ… Business verification\n- âœ… Company data (name, industry, size)\n- âœ… Phone & address validation\n- âœ… Generic company email\n\n### Professional Tier ($0.45/lead) - \"Enhanced Sales Intelligence\"\n\n**Verified contacts for higher conversion rates**\n\n- âœ… Everything in Base\n- âœ… Professional email discovery & verification\n- âœ… Email deliverability verification\n- âœ… Enhanced company enrichment\n\n### Enterprise Tier ($2.50/lead) - \"Premium Executive Access\"\n\n**Compliance-grade data with C-suite contacts**\n\n- âœ… Everything in Professional\n- âœ… Executive contact enrichment\n- âœ… Full compliance verification\n- âœ… Advanced data validation\n\n### ðŸ“§ Email Verification Pipeline\n\n- **Hunter.io Integration** - Professional email discovery ($0.034/search)\n- **NeverBounce Verification** - Real-time deliverability (95% accuracy)\n- **Executive Contact Discovery** - C-suite contacts for Enterprise tier\n- **Multi-source Verification** - Professional licensing and directories\n\n### ðŸ“¤ Export & Management\n\n- **User-Authorized Exports** - CSV/JSON with complete enrichment data\n- **Campaign History** - User-specific campaign tracking and management\n- **Export Analytics** - Download tracking with user context\n- **Data Privacy** - Complete user data isolation and access control\n\n## ðŸ—ï¸ Architecture\n\n### Supabase-First Serverless\n\n- **Frontend:** React/Vite deployed to Vercel\n- **Backend:** 6 Supabase Edge Functions with global deployment\n- **Database:** PostgreSQL with Row Level Security (RLS) and user isolation\n- **Authentication:** Supabase Auth with JWT tokens and session management\n- **Real-time:** Ready for live updates and notifications\n\n### User-Aware Data Model\n\n```sql\n-- User-linked campaigns with session support\ncampaigns (id, business_type, location, user_id, session_user_id, ...)\n\n-- Verified leads with user context\nleads (id, campaign_id, business_name, email, user_id, session_user_id, ...)\n\n-- User-authorized exports\ndashboard_exports (id, campaign_id, user_id, session_user_id, ...)\n```\n\n### Edge Functions (Production, Supabase Session Required)\n\n- **Discovery**\n  - `business-discovery-background` â€“ Tier-aware asynchronous discovery + enrichment orchestration\n  - `business-discovery-optimized` â€“ Session-aware synchronous path for scoped validation\n  - `business-discovery-user-aware` (legacy) â€“ Retained for historical integrations\n- **Enrichment & Coordination**\n  - `enrichment-hunter` â€“ Hunter.io email discovery with caching and circuit breakers\n  - `enrichment-neverbounce` â€“ Email verification with quota management\n  - `enrichment-orchestrator` â€“ Multi-service coordination + budget enforcement\n  - `enrichment-business-license` / `enrichment-pdl` â€“ Licensing + data compliance enrichment\n- **Export**\n  - `campaign-export-user-aware` â€“ User-authorized export with enrichment metadata\n  - `campaign-export` â€“ Internal automation export path (service-role only)\n- **Diagnostics**\n  - `test-new-auth` â€“ Session diagnostics for the shared auth helper\n  - `test-official-auth` â€“ Mirrors Supabaseâ€™s reference pattern end-to-end\n  - `test-business-discovery` â€“ Session-scoped discovery smoke test\n  - `test-google-places` â€“ API testing and validation\n\n## ðŸ§ª Quality Standards\n\n### Zero Fake Data Philosophy\n\n- âœ… **Verified Contacts Only** - No pattern-generated emails\n- âœ… **Professional Sources** - Hunter.io, licensing boards, chambers\n- âœ… **Transparent Attribution** - Clear source tracking for all data\n- âœ… **Quality Baseline** - 95% email deliverability assumed\n- âŒ **No Speculative Data** - No info@, contact@, or generated patterns\n\n### Verification Sources\n\n- **Google Place Details API** - 100% phone/website verification\n- **Hunter.io API** - Professional email discovery with confidence scoring\n- **NeverBounce API** - Real-time email deliverability verification\n- **Professional Licensing** - State boards (CPA, Healthcare, Legal)\n- **Chamber of Commerce** - Membership verification and directories\n\n## ðŸš€ User Experience\n\n### Anonymous Users\n\n1. **Instant Access** - No signup required to start discovering\n2. **Session Tracking** - Automatic campaign management during session\n3. **Full Functionality** - Complete discovery and export capabilities\n4. **Upgrade Prompts** - Clear path to permanent account creation\n\n### Authenticated Users\n\n1. **Permanent Storage** - All campaigns saved to user account\n2. **Campaign History** - Access to all previous discoveries\n3. **Data Privacy** - Complete isolation from other users\n4. **Enhanced Features** - Priority support and advanced analytics\n\n## ðŸ“Š Performance Metrics\n\n### System Performance\n\n- **Response Time:** <100ms cold start (Edge Functions)\n- **Uptime:** 99.9% (Supabase + Vercel infrastructure)\n- **Scalability:** Auto-scaling serverless architecture\n- **Cost Efficiency:** 90% reduction vs traditional server deployment\n\n### Data Quality\n\n- **Email Accuracy:** 95% deliverability rate\n- **Contact Verification:** Multi-source validation\n- **Business Data:** Real-time updates via Google Places API\n- **Quality Scoring:** Intelligent confidence assessment\n\n## ðŸ”§ Development\n\n### Prerequisites\n\n- Node.js 18+\n- Supabase CLI\n- Vercel CLI (for deployment)\n\n### Setup\n\n```bash\n# Clone repository\ngit clone https://github.com/Alextorelli/ProspectPro.git\ncd ProspectPro\n\n# Install dependencies\nnpm install\n\n# Start Supabase (local development)\nsupabase start\n\n# Deploy Edge Functions\nsupabase functions deploy business-discovery-background\nsupabase functions deploy campaign-export-user-aware\nsupabase functions deploy enrichment-orchestrator\n\n# Build and deploy frontend\nnpm run build\ncd dist && vercel --prod\n```\n\n### Testing\n\n```bash\n# Test background discovery function directly\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background' \\\n  -H 'Authorization: Bearer SUPABASE_SESSION_JWT' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\": \"restaurant\", \"location\": \"Seattle, WA\", \"maxResults\": 3, \"tierKey\": \"PROFESSIONAL\", \"sessionUserId\": \"dev-smoke\"}'\n\n# Test export functionality\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware' \\\n  -H 'Authorization: Bearer SUPABASE_SESSION_JWT' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"campaignId\": \"campaign_123\", \"format\": \"csv\"}'\n\n# Run Supabase-auth diagnostics\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth' \\\n  -H 'Authorization: Bearer SUPABASE_SESSION_JWT' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"diagnostics\": true}'\n```\n\n## ðŸŽ¯ Roadmap\n\n### âœ… Completed (v4.3)\n\n- Tier-aware background discovery pipeline (Google Places + Foursquare + Census)\n- Asynchronous campaign creation with real-time job metrics\n- Enrichment pipeline cost tracking (validation vs enrichment breakdown)\n- Frontend alignment for tier metadata, keywords, and geography options\n- Export enrichment metadata enhancements\n\n### ðŸ”„ In Progress\n\n- Advanced user analytics dashboard\n- API rate limiting and usage tracking\n- Enhanced business category taxonomy\n- Real-time campaign progress notifications\n\n### ðŸ“‹ Planned\n\n- Team collaboration features\n- Advanced export scheduling\n- Custom business type definitions\n- API access for enterprise users\n\n## ðŸ“„ License\n\nMIT License - see [LICENSE](LICENSE) file for details.\n\n## ðŸ¤ Contributing\n\n1. Fork the repository\n2. Create a feature branch (`git checkout -b feature/amazing-feature`)\n3. Commit your changes (`git commit -m 'Add amazing feature'`)\n4. Push to the branch (`git push origin feature/amazing-feature`)\n5. Open a Pull Request\n\n## ðŸ“ž Support\n\n- **Documentation:** [GitHub Wiki](https://github.com/Alextorelli/ProspectPro/wiki)\n- **Issues:** [GitHub Issues](https://github.com/Alextorelli/ProspectPro/issues)\n- **Email:** support@prospectpro.com\n\n---\n\n**ProspectPro v4.3** â€“ Tier-Aware Background Discovery with Supabase Session Enforcement\n"}}},
{"type":"measure","name":"lsp.did_open","count":48,"duration":0.335},
{"type":"mark","name":"lsp.did_open","count":49,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/PROSPECTPRO_V4.3_RELEASE_NOTES.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 Release Notes â€“ October 5, 2025\n\n## ðŸš€ Highlights\n\n- **Background Discovery Pipeline** â€“ New `business-discovery-background` edge function processes campaigns asynchronously, writing status + metrics to `discovery_jobs` while auto-inserting completed campaigns and leads.\n- **Multi-Source Business Discovery** â€“ Combines Google Places, Google Place Details, and Foursquare results with deduplication and optional geography expansion.\n- **Census-Driven Targeting** â€“ Integrates U.S. Census County Business Patterns to adjust search radius, expected results, and confidence multipliers when `CENSUS_API_KEY` is configured.\n- **Tier-Aware Enrichment** â€“ Starter/Professional/Enterprise/Compliance tiers encode price-per-lead, max cost, and enrichment options (Hunter/NeverBounce/Apollo) directly in the job payload.\n- **Enhanced Enrichment Metadata** â€“ Leads now store `verificationSources`, `emails`, `processingMetadata`, and `dataSources` for export + analytics; jobs track validation vs enrichment spend.\n- **Frontend Alignment** â€“ `useBusinessDiscovery` and UI now forward keywords, radius, geography, tier metadata, and discovery option toggles required by the background job.\n- **Supabase-Native Authentication** â€“ Shared `authenticateRequest` now calls `supabaseClient.auth.getUser` and every Edge Function requires a real session JWT (diagnostics via `test-new-auth` + `test-official-auth`).\n\n## ðŸ§  Architecture Updates\n\n| Component      | Update                                                                                                                                                                                               |\n| -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Edge Functions | New `business-discovery-background`; updated cost + metrics integration with `enrichment-orchestrator`; existing user-aware discovery remains for legacy flows.                                      |\n| Database       | `discovery_jobs.metrics` expanded to include tier info, cost breakdowns, sources used, and census density score; inserted campaigns/leads include tier metadata + validation cost.                   |\n| Frontend       | Business discovery flow posts tier payload (`tierKey`, `tierName`, `tierPrice`), keyword arrays, search radius, expand flag, and discovery options (trade associations, licensing, chamber, Apollo). |\n| MCP            | Production MCP server exposes background job diagnostics; config now ships with quick commands for deploying/logging the new function.                                                               |\n\n## ðŸ”§ Deployment Checklist\n\n1. Ensure Supabase Edge secrets include `CENSUS_API_KEY`, `FOURSQUARE_API_KEY`, and refreshed `SUPABASE_SERVICE_ROLE_KEY`.\n2. Deploy updated function: `supabase functions deploy business-discovery-background`.\n3. Redeploy enrichment orchestrator if local changes were made: `supabase functions deploy enrichment-orchestrator`.\n4. Trigger a smoke test (Supabase session JWT required):\n   ```bash\n    curl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background\" \\\n       -H \"Authorization: Bearer <SUPABASE_SESSION_JWT>\" \\\n       -H \"Content-Type: application/json\" \\\n     -d '{\n           \"businessType\": \"dental clinic\",\n           \"location\": \"Austin, TX\",\n           \"tierKey\": \"PROFESSIONAL\",\n           \"maxResults\": 3,\n           \"sessionUserId\": \"release-430-smoke\",\n           \"keywords\": [\"invisalign\", \"cosmetic\"],\n           \"expandGeography\": true\n         }'\n   ```\n5. Validate session + RLS context via `curl https://.../test-new-auth` or `./scripts/test-auth-patterns.sh <SUPABASE_SESSION_JWT>`.\n6. Monitor progress via `discovery_jobs` real-time channel (`discovery_jobs:id=eq.<jobId>`) and confirm completed campaign + leads records.\n\n## ðŸ“Š Data Quality & Cost Notes\n\n- Validation cost baseline remains $0.02 per lead (Google verification); enrichment costs recorded per service.\n- Census-enabled searches may expand radius automaticallyâ€”cap results through `maxResults` to maintain budget.\n- Foursquare API is optional; absent key simply reduces supplementary data without failing the job.\n\n## âœ… Backwards Compatibility\n\n- Legacy `business-discovery-user-aware` endpoint untouched for existing integrations.\n- Export function remains `campaign-export-user-aware`, now outputting the richer enrichment metadata for all newly created campaigns.\n- Frontend gracefully handles missing census/Foursquare keys by falling back to default heuristics.\n\nWelcome to ProspectPro v4.3! The platform now delivers richer sourcing intelligence, deterministic cost accounting, and asynchronous campaign handling out of the box.\n"}}},
{"type":"measure","name":"lsp.did_open","count":49,"duration":0.055},
{"type":"mark","name":"lsp.did_open","count":50,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/LATEST_DEPLOYMENT.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 - Latest Production Deployment\n\n**ðŸš€ PRODUCTION READY** â€“ Tier-aware background discovery with Supabase session enforcement\n\n## âœ… Deployment Status\n\n**Date:** October 9, 2025  \n**Status:** âœ… Fully operational  \n**Architecture:** Supabase-native session auth paired with asynchronous background discovery and enrichment\n\n### Production URLs\n\n- **Frontend:** https://prospect-fyhedobh1-appsmithery.vercel.app\n- **Edge Function Base:** https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/\n- **Supabase Project:** sriycekxdqnesdsgwiuc (Production)\n\n## ï¿½ Key Updates\n\n### Supabase-Native Authentication\n\n- Shared `authenticateRequest` now calls `supabaseClient.auth.getUser` using the callerâ€™s Authorization header.\n- Every authenticated invocation requires a Supabase session JWT; publishable/service-role keys alone are rejected.\n- Diagnostics stack (`test-new-auth`, `test-official-auth`, `scripts/test-auth-patterns.sh`) validates session claims, RLS scope, and helper parity after each deploy.\n\n### Background Discovery & Enrichment\n\n- `business-discovery-background` orchestrates Google Places, Place Details, Foursquare, and Census intelligence with tier-aware budgeting.\n- `business-discovery-optimized` retains synchronous discovery for scoped validations and premium campaign checks.\n- Enrichment modules (`enrichment-hunter`, `enrichment-neverbounce`, `enrichment-orchestrator`, `enrichment-business-license`, `enrichment-pdl`) deliver verified contact data, compliance enrichment, and transparent cost tracking.\n\n### Exports & Analytics\n\n- `campaign-export-user-aware` exports tier pricing, validation vs enrichment cost, and `verificationSources` metadata.\n- Campaign and lead writes persist `user_id`, `session_user_id`, census density scores, and enrichment cost breakdowns for analytics dashboards.\n\n## ðŸ§ª Production Validation\n\n| Check                     | Command                                        | Result                                                              |\n| ------------------------- | ---------------------------------------------- | ------------------------------------------------------------------- |\n| Authentication helper     | `curl https://â€¦/test-new-auth`                 | Returns session user metadata, RLS scope, and environment readiness |\n| Official reference parity | `curl https://â€¦/test-official-auth`            | Confirms Supabase helper matches reference implementation           |\n| Discovery smoke test      | `curl https://â€¦/business-discovery-background` | Inserts campaign + leads tied to caller `user_id`                   |\n| Export smoke test         | `curl https://â€¦/campaign-export-user-aware`    | Generates CSV with enrichment metadata scoped to caller             |\n\n> Replace `https://â€¦` with the production base URL and include `Authorization: Bearer <SUPABASE_SESSION_JWT>` for every request.\n\n## ðŸ“‹ Active Edge Functions (Auth Enforced)\n\n- **Discovery:** `business-discovery-background`, `business-discovery-optimized`, `business-discovery-user-aware` (legacy)\n- **Enrichment & Coordination:** `enrichment-hunter`, `enrichment-neverbounce`, `enrichment-orchestrator`, `enrichment-business-license`, `enrichment-pdl`\n- **Export:** `campaign-export-user-aware`, `campaign-export` (internal automation)\n- **Diagnostics:** `test-new-auth`, `test-official-auth`, `test-business-discovery`, `test-google-places`\n\n## ðŸ” Session Requirements\n\n1. Retrieve the current session token:\n   ```ts\n   const { data } = await supabase.auth.getSession();\n   const accessToken = data.session?.access_token;\n   ```\n2. Forward the token on every request:\n   ```ts\n   await fetch(`${supabaseUrl}/functions/v1/business-discovery-background`, {\n     method: \"POST\",\n     headers: {\n       Authorization: `Bearer ${accessToken}`,\n       \"Content-Type\": \"application/json\",\n     },\n     body: JSON.stringify(payload),\n   });\n   ```\n3. For automation, mint a short-lived service-role JWT via the Supabase Admin API and send it exactly the same way.\n\n## ðŸš€ Deployment Workflow (v4.3)\n\n```bash\n# Deploy discovery + enrichment + export stack\nsupabase functions deploy business-discovery-background\nsupabase functions deploy business-discovery-optimized\nsupabase functions deploy campaign-export-user-aware\nsupabase functions deploy enrichment-hunter\nsupabase functions deploy enrichment-neverbounce\nsupabase functions deploy enrichment-orchestrator\nsupabase functions deploy enrichment-business-license\nsupabase functions deploy enrichment-pdl\n\n# Deploy diagnostic helpers\nsupabase functions deploy test-new-auth\nsupabase functions deploy test-official-auth\nsupabase functions deploy test-business-discovery\nsupabase functions deploy test-google-places\n\n# Build + deploy frontend\nnpm run build\ncd dist && vercel --prod\n```\n\n## ðŸ§ª Smoke Tests\n\n```bash\n# Background discovery (session JWT required)\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\":\"coffee shop\",\"location\":\"Seattle, WA\",\"tierKey\":\"PROFESSIONAL\",\"maxResults\":2,\"sessionUserId\":\"prod-validation\"}'\n\n# Auth diagnostics\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"diagnostics\":true}'\n\n# Compare helper vs reference pattern\n./scripts/test-auth-patterns.sh <SUPABASE_SESSION_JWT>\n\n# Export validation\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"campaignId\":\"<CAMPAIGN_ID>\",\"format\":\"csv\",\"sessionUserId\":\"prod-validation\"}'\n```\n\n## ðŸ—„ï¸ Database & RLS Snapshot\n\n- `campaigns`, `leads`, and `dashboard_exports` populate `user_id` + `session_user_id` for session-aware analytics.\n- `discovery_jobs.metrics` tracks tier, sources, validation cost, enrichment cost, census density, and confidence multipliers.\n- RLS policies restrict access to matching `auth.uid()` or anonymous session IDs; diagnostics confirm enforcement.\n\n## ðŸ“ Next Steps & Monitoring\n\n- Supabase dashboard â†’ Edge Functions â†’ Logs to monitor new deployments.\n- Tail discovery jobs: `supabase functions logs business-discovery-background --follow`.\n- Verify campaign + lead inserts via Supabase SQL editor (read-only session context).\n- Keep frontend session handling aligned with `@supabase/supabase-js@2.38` and refresh tokens on auth state changes.\n\n## âœ… Verification Checklist\n\n- [ ] All listed functions deployed with latest commit hashes.\n- [ ] Frontend built from `/dist` and deployed to Vercel.\n- [ ] `test-new-auth` and `test-official-auth` return 200 with the current session JWT.\n- [ ] Discovery smoke test inserts campaign + leads tied to caller `user_id`.\n- [ ] Export smoke test returns CSV with enrichment metadata.\n- [ ] `scripts/test-auth-patterns.sh` shows parity between helper and reference flows.\n- [ ] Supabase secrets include Google, Foursquare, Census, Hunter.io, and NeverBounce keys.\n- [ ] No hard-coded anon/service-role tokens committed; placeholders only (`sb_publishable_your_key_here`).\n\n---\n\n**ProspectPro v4.3** â€“ Production deployment locked with tier-aware background discovery, Supabase session enforcement, and end-to-end diagnostics.  \n_Latest deployment: October 9, 2025 â€” Ready for production campaign validation._ ðŸš€\n"}}},
{"type":"measure","name":"lsp.did_open","count":50,"duration":0.092},
{"type":"mark","name":"lsp.did_open","count":51,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/TECHNICAL_SUMMARY_v4.3.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 Technical Summary â€“ Tier-Aware Background Discovery\n\n## Executive Snapshot\n\nProspectPro v4.3 introduces an asynchronous _business-discovery-background_ pipeline that unifies Google Places, Foursquare, and U.S. Census intelligence with tier-aware cost controls. Base, Professional, and Enterprise tiers now drive enrichment rules directly in the background job, guaranteeing that every campaign records validation, enrichment, and sourcing metadata for exports and analytics.\n\n## Key Enhancements\n\n- **Background Discovery Edge Function**: `business-discovery-background` runs as an EdgeRuntime job, writing progress + metrics to `discovery_jobs` while inserting completed campaigns/leads.\n- **Multi-Source Discovery**: Google Places + Place Details + Foursquare search with dedupe and optional geography expansion based on Census density.\n- **Census Intelligence**: County Business Patterns data sets `expected_results`, `confidence_multiplier`, and search radius recommendations when `CENSUS_API_KEY` is present.\n- **Tier-Aware Budgeting**: Base/Professional/Enterprise tiers map to precise `pricePerLead`, `maxCostPerLead`, and enrichment toggles; UI forwards tier payload, keywords, custom radius, and discovery options.\n- **Enrichment Upgrades**: Hunter/NeverBounce/Apollo (optional) orchestrated via `enrichment-orchestrator` with full cost breakdown (`validationCost`, `enrichmentCost`, service list, cache metadata).\n- **Structured Metrics**: `discovery_jobs.metrics` now tracks sources used, total cost, validation vs enrichment spend, census density, tier info, and per-lead confidence.\n\n## Production Edge Functions (October 2025)\n\n| Function                        | Purpose                                                               |\n| ------------------------------- | --------------------------------------------------------------------- |\n| `business-discovery-background` | Asynchronous discovery + enrichment orchestration with tier budgeting |\n| `business-discovery-optimized`  | Session-aware synchronous discovery retained for scoped validations   |\n| `business-discovery-user-aware` | Legacy synchronous discovery endpoint for historical clients          |\n| `campaign-export-user-aware`    | User-authorized CSV export with cost + source metadata                |\n| `campaign-export`               | Service-role export path for internal automations                     |\n| `enrichment-orchestrator`       | Hunter/NeverBounce/Apollo coordination + budgeting                    |\n| `enrichment-hunter`             | Hunter.io API proxy with caching + circuit breakers                   |\n| `enrichment-neverbounce`        | NeverBounce verification proxy                                        |\n| `enrichment-business-license`   | Licensing enrichment for Enterprise/Compliance tiers                  |\n| `enrichment-pdl`                | People Data Labs enrichment module                                    |\n| `test-new-auth`                 | Supabase session diagnostics for `authenticateRequest`                |\n| `test-official-auth`            | Mirrors Supabase reference implementation to confirm parity           |\n| `test-business-discovery`       | Session-scoped discovery smoke test                                   |\n| `test-google-places`            | Diagnostics for Google Places billing & quotas                        |\n\n> All authenticated Edge Functions require a Supabase session JWT (`Authorization: Bearer <token>`). Use `scripts/test-auth-patterns.sh` to compare helper vs reference flows after each deploy.\n\n## Data Pipeline Overview\n\n```\nUI Campaign Request (tier, keywords, options)\n        â†“\n`business-discovery-background`\n        â†“  (Google Places + Place Details)\n  Candidate Businesses\n        â†“  (Foursquare supplement + dedupe)\n  Enriched Business List\n        â†“  (Quality Scorer w/ Census multiplier)\n  Qualified Leads\n        â†“  (enrichment-orchestrator)\n  Verified Contacts + Cost Metrics\n        â†“\nCampaign + Leads persisted with tier metadata\n```\n\n## Tier Reference Table\n\n| Tier         | Price / Lead | Max Cost / Lead | Includes                                            |\n| ------------ | ------------ | --------------- | --------------------------------------------------- |\n| Base         | $0.15        | $0.50           | Business verification + generic company email       |\n| Professional | $0.45        | $1.50           | Email discovery & verification + company enrichment |\n| Enterprise   | $2.50        | $7.50           | Executive contacts + compliance verification        |\n\nBase tier provides essential business data; higher tiers add progressive email discovery, executive contact enrichment, and compliance verification.\n\n## Database Touchpoints\n\n- **`discovery_jobs`** â€“ Stores real-time status, metrics, tier info, sources used, density scores.\n- **`campaigns`** â€“ Receives completed campaign record with `total_cost`, `results_count`, and tier metadata when job finishes.\n- **`leads`** â€“ Each lead includes `enrichment_data` (`verificationSources`, `emails`, `processingMetadata`, `dataSources`) and `validation_cost`.\n\n## Operational Notes\n\n- **Secrets**: Ensure `CENSUS_API_KEY`, `FOURSQUARE_API_KEY`, `GOOGLE_PLACES_API_KEY`, `HUNTER_IO_API_KEY`, `NEVERBOUNCE_API_KEY`, and Supabase keys are populated in Edge Function secrets.\n- **Session Tokens**: Frontend and automations must forward Supabase session JWTs; run `scripts/test-auth-patterns.sh <SUPABASE_SESSION_JWT>` after each deploy.\n- **Testing**: Run `supabase functions serve business-discovery-background --env-file .env.edge` for local dry runs; verify job status via `discovery_jobs` table.\n- **Exports**: `campaign-export-user-aware` now emits tier pricing, total validation/enrichment spend, and sources used for every lead.\n- **MCP Integration**: Production MCP server exposes new diagnostics (`test_background_job`, `analyze_discovery_metrics`, `validate_session_enforcement`) for the background workflow.\n\n## Quick Command Cheatsheet\n\n```bash\n# Deploy background discovery function\nsupabase functions deploy business-discovery-background\n\n# Tail background discovery logs\nsupabase functions logs business-discovery-background --follow\n\n# Trigger a minimal background job (session JWT required)\ncurl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background\" \\\n      -H \"Authorization: Bearer <SUPABASE_SESSION_JWT>\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n        \"businessType\": \"coffee shop\",\n        \"location\": \"Seattle, WA\",\n        \"maxResults\": 2,\n        \"tierKey\": \"BASE\",\n        \"sessionUserId\": \"debug-session-001\",\n        \"keywords\": [\"latte\", \"wifi\"],\n        \"expandGeography\": true\n      }'\n```\n\nUse this summary as the authoritative reference for v4.3 conversations, deployment coordination, and AI tooling context.\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":23,"duration":0.327},
{"type":"measure","name":"lsp.did_open","count":51,"duration":8.572},
{"type":"mark","name":"lsp.did_open","count":52,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/CHANGELOG.md","languageId":"markdown","version":1,"text":"# ProspectPro Changelog\n\nAll notable changes to ProspectPro will be documented in this file.\n\nThe format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),\nand this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n\n## [4.3.0] - 2025-10-09 - Supabase Session Enforcement & Tier-Aware Background Discovery\n\n### Added\n\n- **Supabase-Native Authentication:** Shared `authenticateRequest` now uses `supabaseClient.auth.getUser`, enforcing real session JWTs for every Edge Function invocation.\n- **Diagnostic Edge Functions:** Added `test-new-auth`, `test-official-auth`, and `test-business-discovery` for post-deploy validation of session scope, RLS access, and discovery flows.\n- **Auth Validation Script:** `scripts/test-auth-patterns.sh` compares the shared helper vs Supabase reference implementation using live session tokens.\n\n### Changed\n\n- **Discovery Stack:** Updated `business-discovery-optimized`, `enrichment-hunter`, `campaign-export-user-aware`, and related functions to consume the new auth context (userId, email, sessionId, token claims).\n- **Documentation & Instructions:** Refreshed README, deployment guides, MCP configuration, and Copilot instructions to reference session JWT requirements and new diagnostics.\n- **MCP Configuration:** Quick commands and tooling now surface session-enforced smoke tests and Supabase-specific troubleshooting flows.\n\n### Removed\n\n- **Custom JWKS Verifier:** All manual JWKS handling and ES256 key rotation logic replaced with Supabase-managed validation.\n\n### Notes\n\n- Redeploy all discovery, enrichment, export, and diagnostic edge functions after pulling this release.\n- Ensure frontend and automation callers forward `Authorization: Bearer <SUPABASE_SESSION_JWT>` for every request.\n\n## [4.0.0] - 2024-12-19 - Supabase-First Serverless Architecture\n\n### ðŸš€ **MAJOR ARCHITECTURAL TRANSFORMATION**\n\nComplete migration from container-based architecture to Supabase-first serverless platform.\n\n### Added\n\n- **Supabase Edge Functions**: TypeScript/Deno Edge Functions for all backend logic\n  - `business-discovery` - Main business discovery with Google Places API integration\n  - `campaign-export` - CSV export functionality with database integration\n- **Static Frontend**: HTML/JS with direct Supabase client integration\n- **Supabase Database**: Native PostgreSQL integration with Row Level Security\n- **Global Edge Deployment**: Functions run in 18+ regions with <100ms cold starts\n- **Enhanced Quality Scoring v3.0**: Cost-efficient validation pipeline integrated into Edge Functions\n- **Real-time Capabilities**: Native Supabase real-time subscriptions (ready to use)\n- **Zero-Container Deployment**: No Docker, no Cloud Run, just Edge Functions\n\n### Changed\n\n- **Architecture**: Container-based â†’ Supabase-first serverless\n- **Backend**: Express.js server â†’ Supabase Edge Functions\n- **Database**: Manual integration â†’ Native Supabase with RLS\n- **Deployment**: Docker builds â†’ Function deployment (30 seconds vs. 5 minutes)\n- **Environment**: .env files â†’ Supabase environment variables\n- **Development**: Node.js â†’ TypeScript/Deno Edge Functions\n\n### Removed\n\n- **server.js**: Replaced with Supabase Edge Functions\n- **Express.js dependencies**: No longer needed with Edge Functions\n- **Docker containers**: Static frontend + serverless functions\n- **Cloud Build pipelines**: Simplified to function deployment\n- **Complex environment setup**: Replaced with Supabase environment variables\n\n### Performance\n\n- **90% Cost Reduction**: Static hosting ($1-5/month) vs. Cloud Run ($10-50/month)\n- **80% Code Reduction**: From 400+ lines server.js to 50 lines core logic\n- **10x Faster Deployment**: 30-second function deploys vs. 5-minute container builds\n- **Zero Maintenance**: Supabase manages all infrastructure\n- **Auto-scaling**: No capacity planning or cold start issues\n\n## [3.0.0] - 2025-09-23 (ARCHIVED - Container Architecture)\n\n### Added\n\n- Enhanced schema cache handling for production initialization\n- Graceful degraded mode startup capability\n- Schema cache refresh utilities and automation\n- Comprehensive production diagnostics and monitoring\n- Enhanced Supabase configuration with automatic recovery\n- Production-ready error handling and user guidance\n\n### Changed\n\n- Improved server startup process with detailed error reporting\n- Enhanced database connection testing with cache management\n- Reorganized documentation structure with archive branches\n- Updated production deployment workflow with artifact-based configuration\n\n### Fixed\n\n- Schema cache initialization issues after database updates\n- Production server startup failures during cache refresh\n- Database connectivity issues in production environment\n\n## [2.0.0] - 2025-09-22 (ARCHIVED - Legacy Architecture)\n\n### Added\n\n- Complete production validation system\n- Enhanced deployment pipeline with GitHub Actions\n- Comprehensive database schema with RLS policies\n- Multi-source business discovery with API integrations\n\n### Changed\n\n- Migration to production-ready architecture\n- Enhanced error handling and logging\n- Improved cost tracking and budget management\n\n## [1.0.0] - Initial Release (ARCHIVED)\n\n### Added\n\n- Basic lead generation functionality\n- Supabase database integration\n- Simple web interface\n- Core business discovery features\n"}}},
{"type":"measure","name":"lsp.did_open","count":52,"duration":0.065},
{"type":"mark","name":"lsp.did_open","count":53,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/mcp-config.json","languageId":"json","version":1,"text":"{\n    \"version\": \"1.1\",\n    \"description\": \"ProspectPro v4.3 MCP Server Configuration - Tier-Aware Background Discovery & Supabase Session Enforcement\",\n    \"servers\": {\n        \"prospectpro-production\": {\n            \"autoStart\": true,\n            \"lazyLoad\": true,\n            \"maxMemory\": \"192MB\",\n            \"priority\": \"high\",\n            \"description\": \"Production monitoring for tier-aware background discovery, enrichment, and session-enforced auth (28 tools)\",\n            \"tools\": [\n                \"monitor_api_performance\",\n                \"analyze_database_metrics\",\n                \"check_edge_function_health\",\n                \"track_api_costs\",\n                \"monitor_supabase_usage\",\n                \"track_user_sessions\",\n                \"monitor_authentication\",\n                \"analyze_campaign_ownership\"\n            ]\n        },\n        \"prospectpro-development\": {\n            \"autoStart\": false,\n            \"onDemand\": true,\n            \"maxMemory\": \"96MB\",\n            \"priority\": \"medium\",\n            \"description\": \"Development tools for background discovery, census targeting, enrichment, and session token workflows\",\n            \"activationKeywords\": [\n                \"develop\",\n                \"integrate\",\n                \"new api\",\n                \"test integration\",\n                \"user auth\",\n                \"session management\"\n            ]\n        },\n        \"prospectpro-troubleshooting\": {\n            \"autoStart\": false,\n            \"onDemand\": true,\n            \"maxMemory\": \"96MB\",\n            \"priority\": \"medium\",\n            \"description\": \"Debugging tools for background jobs, Supabase auth sessions, and enrichment pipelines\",\n            \"activationKeywords\": [\n                \"debug\",\n                \"error\",\n                \"fix\",\n                \"troubleshoot\",\n                \"404\",\n                \"500\",\n                \"auth error\",\n                \"jwt\",\n                \"session\"\n            ]\n        }\n    },\n    \"globalSettings\": {\n        \"maxConcurrentServers\": 2,\n        \"memoryThreshold\": \"384MB\",\n        \"smartLoading\": true,\n        \"contextOptimization\": true\n    },\n    \"contextFilters\": {\n        \"allowedExtensions\": [\n            \".ts\",\n            \".js\",\n            \".json\",\n            \".md\",\n            \".sql\"\n        ],\n        \"excludedPaths\": [\n            \"archive/**\",\n            \"node_modules/**\",\n            \".deno_lsp/**\",\n            \"logs/**\",\n            \"dist/**\"\n        ],\n        \"maxContextLength\": 200,\n        \"maxFileSize\": 50000\n    },\n    \"costOptimization\": {\n        \"enabled\": true,\n        \"tokenReduction\": 38,\n        \"cacheResponses\": true,\n        \"smartContext\": true,\n        \"quickCommands\": {\n            \"run prod mcp\": \"cd /workspaces/ProspectPro/mcp-servers && npm run start:production\",\n            \"deploy discovery background\": \"supabase functions deploy business-discovery-background\",\n            \"deploy orchestrator\": \"supabase functions deploy enrichment-orchestrator\",\n            \"deploy export\": \"supabase functions deploy campaign-export-user-aware\",\n            \"deploy auth diagnostics\": \"supabase functions deploy test-new-auth && supabase functions deploy test-official-auth\",\n            \"check background logs\": \"supabase functions logs business-discovery-background --follow\",\n            \"test background job\": \"curl -X POST \\\"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background\\\" -H \\\"Authorization: Bearer SUPABASE_SESSION_JWT\\\" -H \\\"Content-Type: application/json\\\" -d '{\\\"businessType\\\":\\\"coffee shop\\\",\\\"location\\\":\\\"Seattle, WA\\\",\\\"maxResults\\\":2,\\\"tierKey\\\":\\\"PROFESSIONAL\\\",\\\"sessionUserId\\\":\\\"mcp-smoke\\\"}'\",\n            \"test export\": \"curl -X POST \\\"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware\\\" -H \\\"Authorization: Bearer SUPABASE_SESSION_JWT\\\" -H \\\"Content-Type: application/json\\\" -d '{\\\"campaignId\\\":\\\"test\\\",\\\"format\\\":\\\"csv\\\",\\\"sessionUserId\\\":\\\"mcp-smoke\\\"}'\",\n            \"test auth helper\": \"curl -X POST \\\"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\\\" -H \\\"Authorization: Bearer SUPABASE_SESSION_JWT\\\" -H \\\"Content-Type: application/json\\\" -d '{\\\"diagnostics\\\":true}'\",\n            \"compare auth patterns\": \"./scripts/test-auth-patterns.sh SUPABASE_SESSION_JWT\"\n        }\n    },\n    \"userAwareFeatures\": {\n        \"enabled\": true,\n        \"sessionTracking\": true,\n        \"authenticationMonitoring\": true,\n        \"campaignOwnershipTracking\": true,\n        \"dataIsolationValidation\": true\n    }\n}"}}},
{"type":"measure","name":"lsp.did_open","count":53,"duration":0.046},
{"type":"mark","name":"lsp.did_open","count":54,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/mcp-servers/README.md","languageId":"markdown","version":1,"text":"# ProspectPro Enhanced MCP (Model Context Protocol) Implementation v3.1\n\n## Overview\n\nThis directory contains the **enhanced MCP server implementation** that provides AI assistants with comprehensive access to ProspectPro's complete email discovery & verification platform, enrichment APIs, background discovery jobs, contact validation, and **troubleshooting capabilities**. Version 3.1 adds tooling for the v4.3 background discovery pipeline (Census + Foursquare), Supabase session enforcement (auth.getUser), tier-aware cost tracking, and asynchronous job diagnostics.\n\n**Architecture**: 3 specialized servers for enrichment production, development, and troubleshooting workflows  \n**Tools**: 42 tools total across all servers (6 troubleshooting + 36 enrichment tools)  \n**Status**: Production-ready with tier-aware background discovery + enrichment (v4.3)\n\n## Enhanced MCP Servers v3.0 - Email Discovery & Verification Architecture\n\n### 1. Production Server (`production-server.js`) - **v2.1.0**\n\n**Purpose**: Comprehensive email enrichment monitoring, Hunter.io/NeverBounce analytics, enrichment cost tracking, and deliverability validation (28 tools)\n\n**Enrichment Capabilities**:\n\n- Email discovery status tracking (Hunter.io)\n- Email verification monitoring (NeverBounce)\n- Apollo API integration monitoring (optional)\n- Enrichment cost breakdown per lead\n- Deliverability accuracy tracking (95%)\n- Circuit breaker status monitoring\n\n### 2. Development Server (`development-server.js`) - **v1.1.0**\n\n**Purpose**: Email enrichment development, Hunter.io/NeverBounce API testing, circuit breaker validation, and deliverability benchmarking (8 tools)\n\n**Enhanced Features**:\n\n- Hunter.io email discovery testing (6 endpoints)\n- NeverBounce verification testing (FREE + paid)\n- Apollo contact enrichment testing (optional)\n- Enrichment orchestrator validation\n- Circuit breaker pattern testing\n- Caching efficiency benchmarks\n\n### 3. ðŸ†• Troubleshooting Server (`supabase-troubleshooting-server.js`) - **v1.1.0**\n\n**Purpose**: Systematic debugging of email enrichment architecture, Hunter.io/NeverBounce integration issues, and deliverability validation failures\n\n**Enrichment Troubleshooting Capabilities** (6 enhanced tools):\n\n#### Email Enrichment Testing\n\n- `test_edge_function` - Test Hunter.io/NeverBounce Edge Functions with API authentication\n- `generate_debugging_commands` - Create enrichment curl commands and testing scripts\n\n#### Email Verification Diagnosis\n\n- `validate_database_permissions` - Check enrichment_data JSONB permissions and RLS policies\n- `diagnose_anon_key_mismatch` - Compare frontend publishable key vs Supabase settings and confirm session token retrieval\n- `run_rls_diagnostics` - Generate email enrichment diagnostic queries\n\n#### Enrichment Deployment Validation\n\n- `check_vercel_deployment` - Validate deployment with verified email display and deliverability scores\n\n**When to Use Troubleshooting Server**:\n\n- Hunter.io email discovery fails or returns no results\n- NeverBounce verification returns authentication errors\n- Enrichment orchestrator exceeds budget limits\n- Circuit breakers not resetting after failures\n- Email verification cache not working\n- Apollo API (optional) returns cost errors\n- Deliverability scores not displaying correctly\n\n### 1. Production Server (`production-server.js`) - **v2.0.0**\n\n**Purpose**: Comprehensive production monitoring, database analytics, system diagnostics, API testing, and filesystem analysis\n\n**Enhanced Capabilities** (28 tools):\n\n#### Database Analytics (4 tools)\n\n- Query enhanced leads with advanced filters and analytics\n- Get campaign statistics and performance metrics\n- Analyze lead quality patterns and scoring distribution\n- Retrieve API cost breakdowns and budget analysis\n\n#### System Monitoring (7 tools)\n\n- System health monitoring with Docker integration\n- Diagnostics file analysis and performance tracking\n- Log analysis and error pattern detection\n- Configuration validation across environments\n- Performance reporting with optimization suggestions\n\n#### API Testing (8 tools)\n\n- Test Google Places API with sample queries and rate limiting\n- Test Foursquare Places API integration with caching\n- Test Hunter.io email discovery with validation\n- Verify email deliverability with NeverBounce\n- Simulate complete lead discovery pipeline\n- API cost tracking and quota monitoring\n- Performance benchmarking across API endpoints\n\n#### Filesystem Analysis (6 tools)\n\n- Analyze project structure and architectural patterns\n- Search for code patterns and potential issues\n- Analyze API client implementations for consistency\n- **Critical**: Check for fake data violations (zero tolerance)\n- Analyze error handling patterns across codebase\n- Generate code quality reports\n\n#### Production Monitoring (3 tools)\n\n- Health check endpoints monitoring\n- Production deployment status tracking\n- Real-time system metrics collection\n\n### 2. Development Server (`development-server.js`) - **v1.0.0**\n\n**Purpose**: Development utilities, new API integration testing, and performance benchmarking\n\n**Specialized Capabilities** (8 tools):\n\n#### New API Integration (4 tools)\n\n- Test US Chamber of Commerce API integration\n- Test Better Business Bureau (BBB) API\n- Test LinkedIn Sales Navigator API patterns\n- Test ZoomInfo API integration patterns\n\n#### Development Utilities (2 tools)\n\n- Performance benchmarking across API clients\n- Generate API client templates for new integrations\n\n#### Code Generation (2 tools)\n\n- Generate boilerplate for new API clients\n- Create test suites for API integrations\n\n## Quick Start\n\n```bash\n# Start production monitoring\nnpm run start:production\n\n# Start development server\nnpm run start:development\n\n# Start troubleshooting server (for debugging deployment issues)\nnpm run start:troubleshooting\n\n# Start all servers\nnpm run start:all\n\n# Test all servers\nnpm run test\n```\n\n## ðŸš¨ Quick Troubleshooting (NEW in v3.0)\n\n### Frontend Shows \"Discovery Failed\" or \"API request failed: 404\"\n\n**IMMEDIATE DIAGNOSIS** with MCP Troubleshooting Server:\n\n```bash\nnpm run start:troubleshooting\n```\n\nIn your AI assistant, use these MCP tools in systematic order:\n\n1. `test_edge_function` - Verify backend works independently of frontend\n2. `diagnose_anon_key_mismatch` - Check for publishable key sync + session token availability (90% of problems)\n3. `validate_database_permissions` - Verify RLS policies are configured correctly\n4. `check_vercel_deployment` - Validate frontend deployment status\n5. `generate_debugging_commands` - Get custom debugging scripts for your config\n\n**Manual Quick Test** (if MCP not available):\n\n```bash\n# Test background discovery function directly (requires Supabase session JWT)\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background' \\\n  -H 'Authorization: Bearer SUPABASE_SESSION_JWT' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\": \"coffee shop\", \"location\": \"Seattle, WA\", \"tierKey\": \"PROFESSIONAL\", \"maxResults\": 2, \"sessionUserId\": \"mcp-diagnostics\"}'\n```\n\nFollow up with the dedicated auth diagnostics:\n\n```bash\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth' \\\n  -H 'Authorization: Bearer SUPABASE_SESSION_JWT' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"diagnostics\":true}'\n\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-official-auth' \\\n  -H 'Authorization: Bearer SUPABASE_SESSION_JWT' \\\n  -H 'Content-Type: application/json' \\\n  -d '{}'\n\n./scripts/test-auth-patterns.sh SUPABASE_SESSION_JWT\n```\n\n**Expected Results**: Real business data response = backend working, frontend issue  \n**If 401 error**: Authentication or RLS policy issue\n\n### 3. VS Code Configuration\n\nThe consolidated MCP configuration is automatically set up in `.vscode/settings.json`:\n\n```json\n{\n  \"mcp.enable\": true,\n  \"mcp.servers\": {\n    \"prospectpro-production\": {\n      \"enabled\": true,\n      \"autoStart\": true,\n      \"description\": \"Enhanced Production Server - 28 tools\"\n    },\n    \"prospectpro-development\": {\n      \"enabled\": true,\n      \"autoStart\": false,\n      \"description\": \"Development Server - 8 specialized tools\"\n    }\n  }\n}\n```\n\n### 4. Environment Requirements\n\nConsolidated servers require the same environment variables as the main application:\n\n- `SUPABASE_URL`: Database connection\n- `SUPABASE_SECRET_KEY`: Database access\n- API keys for external services (Google Places, Hunter.io, NeverBounce, Foursquare)\n- Development server requires additional API keys for new integrations (US Chamber, BBB, etc.)\n\n## Usage Examples\n\n### Database Queries via AI\n\n```\n\"Show me the top 10 leads with confidence scores above 85\"\n\"Analyze lead quality patterns for restaurants in New York\"\n\"What are the API costs for the last 24 hours?\"\n```\n\n### API Testing via AI\n\n```\n\"Test the Google Places API with a search for 'coffee shops in Seattle'\"\n\"Simulate lead discovery for 'restaurants' in 'San Francisco'\"\n\"Verify the email address john@example.com\"\n```\n\n### Codebase Analysis via AI\n\n```\n\"Analyze the project structure and identify key components\"\n\"Check for any fake data generation patterns in the code\"\n\"Find all error handling patterns in API clients\"\n```\n\n### System Monitoring via AI\n\n```\n\"Check the overall system health status\"\n\"Analyze recent application logs for errors\"\n\"Generate a performance report with recommendations\"\n```\n\n## Advanced AI Workflows\n\n### 1. Lead Quality Analysis\n\nAI can now directly query your database to provide insights like:\n\n- \"Which business types have the highest confidence scores?\"\n- \"What's the correlation between email confidence and overall lead quality?\"\n- \"Show me leads that failed validation and why\"\n\n### 2. API Cost Optimization\n\nAI can analyze your API usage patterns:\n\n- \"Which APIs are costing the most money?\"\n- \"Are we approaching any quota limits?\"\n- \"Suggest optimizations to reduce API costs\"\n\n### 3. Code Quality Assurance\n\nAI can continuously monitor code quality:\n\n- \"Are there any patterns that could lead to fake data generation?\"\n- \"Analyze error handling coverage across all modules\"\n- \"Check if all API clients follow the same patterns\"\n\n### 4. System Performance Monitoring\n\nAI can provide system insights:\n\n- \"Is the system performing optimally?\"\n- \"What are the largest files that might be slowing down development?\"\n- \"Are there any configuration issues that need attention?\"\n\n## Consolidated MCP Server Management\n\n### Consolidated Server Commands\n\n```bash\n# Start production server (28 tools - auto-starts with VS Code)\nnpm run start:production\n\n# Start development server (8 tools - manual start)\nnpm run start:development\n\n# Start both servers for comprehensive development\nnpm run start:all\n```\n\n### Server Status Monitoring\n\n```bash\n# Test both consolidated servers\nnpm run test\n\n# Check detailed test results and performance metrics\ncat test-results.json\n\n# Validate specific server capabilities\nnode -e \"console.log(require('./production-server.js').tools.length + ' production tools')\"\nnode -e \"console.log(require('./development-server.js').tools.length + ' development tools')\"\n```\n\n### Performance Benefits\n\n**Consolidation Results**:\n\n- **Servers**: 5 â†’ 2 (60% reduction)\n- **Memory Usage**: ~40% reduction in MCP processes\n- **Startup Time**: ~50% faster initialization\n- **Tools Available**: 36 total (100% preservation)\n- **Test Coverage**: Comprehensive validation suite\n\n## Security Considerations\n\n### Data Access Control\n\n- MCP servers use the same authentication as the main application\n- Database access is limited to read-only operations where appropriate\n- API keys are passed through environment variables only\n\n### AI Context Boundaries\n\n- MCP servers provide structured access to prevent unauthorized operations\n- Each server has defined capabilities and cannot exceed its scope\n- Error handling prevents sensitive information leakage\n\n## Troubleshooting\n\n### Common Issues\n\n1. **MCP Servers Not Starting**\n\n   - Check dependencies: `npm run mcp:install`\n   - Verify environment variables are set\n   - Run tests: `npm run mcp:test`\n\n2. **VS Code Not Recognizing MCP**\n\n   - Restart VS Code after configuration changes\n   - Check `.vscode/mcp-config.json` syntax\n   - Verify MCP is enabled in settings\n\n3. **Database Connection Issues**\n\n   - Check Supabase credentials\n   - Verify database server status\n   - Run diagnostics: `curl http://localhost:3000/diag`\n\n4. **API Testing Failures**\n   - Verify API keys are configured\n   - Check API quota limits\n   - Test individual APIs outside MCP first\n\n## Development Notes\n\n### Adding New MCP Tools\n\n1. Add tool definition to the server's `tools/list` handler\n2. Implement tool execution in `tools/call` handler\n3. Update this documentation\n4. Add tests to `test-servers.js`\n\n### Best Practices\n\n- Keep tools focused on specific functionality\n- Provide detailed error messages\n- Include usage examples in tool descriptions\n- Implement proper error handling and validation\n- Cache expensive operations where appropriate\n\n## Migration from v1.0 (Individual Servers)\n\n### What Changed in v2.0 Consolidation\n\n**Before (v1.0)**:\n\n- 5 separate servers: database, api, filesystem, monitoring, production\n- Complex management and startup procedures\n- Higher memory overhead\n- Context switching between servers\n\n**After (v2.0)**:\n\n- 2 consolidated servers: production (28 tools) + development (8 tools)\n- Simplified management and configuration\n- Optimized resource usage\n- Unified tool access patterns\n\n### Backward Compatibility\n\nAll 36 original tools are preserved with identical functionality. AI workflows continue to work without changes.\n\n### Archived Components\n\nOriginal individual servers are preserved in `/archive/mcp-servers-individual/` for reference.\n\n## Integration with ProspectPro Architecture\n\nThe consolidated MCP implementation enhances ProspectPro's core principles:\n\n### Zero Fake Data Policy âœ…\n\n- **Production server** actively monitors for fake data patterns (6 filesystem analysis tools)\n- All database queries return real, validated business data (4 database tools)\n- API testing uses actual external service endpoints (8 API testing tools)\n- **Development server** includes templates that enforce real data patterns\n\n### Cost Optimization âœ…\n\n- **Consolidated architecture** reduces infrastructure overhead by 60%\n- API tracking and quota monitoring (8 API tools in production server)\n- Budget analysis and cost breakdown reporting (database analytics)\n- Performance benchmarking tools (development server)\n\n### Performance Monitoring âœ…\n\n- **Enhanced monitoring capabilities** (7 system monitoring tools)\n- Real-time health checks and diagnostics\n- Comprehensive performance analysis and recommendations\n- Docker integration and deployment tracking\n\n### AI-Enhanced Development Workflow\n\nThis v2.0 consolidated MCP implementation transforms ProspectPro development into a **streamlined AI-enhanced workflow** where intelligent assistants have direct access to:\n\n- **Real business data** through optimized database analytics\n- **Live API testing** with cost and performance monitoring\n- **Comprehensive system insights** through unified diagnostics\n- **Development acceleration** through specialized tooling\n\n**Result**: 60% fewer processes, 100% functionality preservation, enhanced AI productivity.\n"}}},
{"type":"measure","name":"lsp.did_open","count":54,"duration":0.138},
{"type":"mark","name":"lsp.did_open","count":55,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/DOCUMENTATION_UPDATE_SUMMARY.md","languageId":"markdown","version":1,"text":"# ðŸ“ Documentation Update Summary - ProspectPro v4.2\n\n## Overview\n\nUpdated all core documentation to reflect v4.2's complete email discovery and verification system.\n\n---\n\n## âœ… Updated Files\n\n### 1. **/.github/copilot-instructions.md**\n\n**Changes**:\n\n- Updated version from 4.1.0 to 4.2.0\n- Changed title to \"Complete Email Discovery & Verification Platform\"\n\n# ðŸ“ Documentation Update Summary â€“ ProspectPro v4.3\n\n## Overview\n\nDocumentation, MCP settings, and AI assistant instructions have been scrubbed for the October 9, 2025 build. All references now reflect Supabase session-enforced authentication, the refreshed edge function lineup, and the new diagnostics workflow.\n\n---\n\n## âœ… Updated Assets\n\n### `.github/copilot-instructions.md`\n\n- Replaced the edge function inventory with discovery/enrichment/export/diagnostic groupings.\n- Added Supabase session JWT requirements, `test-new-auth`, `test-official-auth`, and `scripts/test-auth-patterns.sh` to the debugging commands.\n- Updated troubleshooting and deployment guidance to reference session tokens instead of anon-key shortcuts.\n\n### `README.md`\n\n- Documented the expanded edge function set (including diagnostics) and clarified session token usage.\n- Updated testing commands with `SUPABASE_SESSION_JWT` placeholders and added the auth diagnostics curl example.\n- Refreshed the footer version statement for v4.3.\n\n### `DOCUMENTATION_INDEX.md`\n\n- Reorganized the production function list to match the new supabase-native auth model.\n- Added commands for the auth diagnostics script and clarified session token prerequisites.\n- Updated quick command references and the documentation timestamp.\n\n### `PROSPECTPRO_V4.3_RELEASE_NOTES.md`\n\n- Highlighted the Supabase-native authentication shift in the release highlights.\n- Updated deployment checklist to require session JWTs and include auth diagnostics validation steps.\n\n### `LATEST_DEPLOYMENT.md`\n\n- Rewritten for v4.3 with session enforcement, edge function redeploy list, smoke tests, and verification checklist.\n\n### `TECHNICAL_SUMMARY_v4.3.md`\n\n- Expanded the production edge function table to include discovery, enrichment, export, and diagnostic endpoints.\n- Introduced session token operational notes and updated curl examples.\n\n### `CHANGELOG.md`\n\n- Added the 4.3.0 entry summarizing auth migration, diagnostics, and documentation refresh.\n\n### `mcp-config.json`\n\n- Adjusted quick commands to require session JWTs and added helpers for deploying/running the new diagnostics.\n- Updated server descriptions to mention session enforcement coverage.\n\n### `mcp-servers/README.md`\n\n- Incorporated Supabase session enforcement throughout troubleshooting guidance and manual test commands.\n- Added explicit examples for `test-new-auth`, `test-official-auth`, and `scripts/test-auth-patterns.sh`.\n\n### `DOCUMENTATION_UPDATE_SUMMARY.md`\n\n- (This file) Re-authored to capture v4.3 documentation changes.\n\n---\n\n## ðŸ“‹ Coverage Snapshot\n\n| Area                         | Status | Notes                                                                                        |\n| ---------------------------- | ------ | -------------------------------------------------------------------------------------------- |\n| Supabase Session Enforcement | âœ…     | All docs replace anon-key curl examples with session JWT guidance.                           |\n| Edge Function Inventory      | âœ…     | Lists include discovery, enrichment, export, and diagnostics.                                |\n| Deployment Guides            | âœ…     | `LATEST_DEPLOYMENT.md`, release notes, and README reference new redeploy set + auth testing. |\n| MCP Tooling                  | âœ…     | Config + README expose session diagnostics and quick commands.                               |\n| Change Log                   | âœ…     | 4.3.0 entry recorded with authentication focus.                                              |\n\n---\n\n## ï¿½ Follow-Up\n\n- Keep session token examples synchronized with Supabase JS upgrades.\n- Update docs again if additional diagnostics or tier modules are introduced.\n- Mirror these updates in any external knowledge bases or support runbooks.\n\n---\n\n**Documentation Status:** âœ… Refreshed for v4.3 Supabase session enforcement  \n**Last Updated:** October 9, 2025\n\n---\n\n## ðŸ“ Next Steps\n\n### Immediate\n\n1. âœ… All documentation updated\n2. âœ… Copilot Chat context refreshed\n3. âœ… MCP servers aligned with v4.2\n\n### Ongoing\n\n- [ ] Keep documentation updated with API changes\n- [ ] Add examples as users encounter issues\n- [ ] Document common troubleshooting patterns\n- [ ] Update cost structure if API pricing changes\n\n---\n\n## ðŸ“Š Summary Statistics\n\n**Files Updated**: 3 core documentation files  \n**Files Created**: 7 new documentation files  \n**Total Lines**: 2,500+ lines of documentation  \n**Edge Functions Documented**: 6 production functions  \n**API Services Documented**: 6 external services  \n**Cost Structures Documented**: 4 enrichment levels  \n**Quality Metrics Documented**: 5 coverage rates\n\n**Documentation Status**: âœ… COMPLETE for v4.2\n\n---\n\n**ProspectPro v4.2 Documentation**  \n**Updated**: October 3, 2025  \n**Status**: Production Ready  \n**Coverage**: Complete enrichment ecosystem documented\n"}}},
{"type":"measure","name":"lsp.did_open","count":55,"duration":0.056},
{"type":"mark","name":"lsp.did_open","count":56,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/PRODUCTION_READY_V4.3.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 â€“ Production Ready Summary\n\n**Date:** October 9, 2025  \n**Status:** âœ… Production deployment live with Supabase session enforcement\n\n---\n\n## ðŸ” Authentication & Authorization\n\n- Shared `authenticateRequest` calls `supabaseClient.auth.getUser`, eliminating custom JWKS validation.\n- All authenticated Edge Functions require `Authorization: Bearer <SUPABASE_SESSION_JWT>`.\n- Diagnostics stack:\n  - `test-new-auth` â€“ returns session metadata, RLS scope, and environment readiness.\n  - `test-official-auth` â€“ verifies helper parity with Supabase reference implementation.\n  - `scripts/test-auth-patterns.sh` â€“ compares helper vs reference and highlights divergence.\n- Frontend retrieves tokens via `supabase.auth.getSession()` and refreshes on `onAuthStateChange`.\n\n## ðŸ§  Core Edge Functions\n\n| Category                  | Functions                                                                                                                 |\n| ------------------------- | ------------------------------------------------------------------------------------------------------------------------- |\n| Discovery                 | `business-discovery-background`, `business-discovery-optimized`, `business-discovery-user-aware` (legacy)                 |\n| Enrichment & Coordination | `enrichment-hunter`, `enrichment-neverbounce`, `enrichment-orchestrator`, `enrichment-business-license`, `enrichment-pdl` |\n| Export                    | `campaign-export-user-aware`, `campaign-export` (internal automation)                                                     |\n| Diagnostics               | `test-new-auth`, `test-official-auth`, `test-business-discovery`, `test-google-places`                                    |\n\nAll discovery/enrichment/export functions now consume the unified auth context (`userId`, `email`, `sessionId`, `isAnonymous`, `supabaseClient`).\n\n## ðŸ—„ï¸ Database & RLS\n\n- `campaigns`, `leads`, `discovery_jobs`, and `dashboard_exports` persist `user_id` + `session_user_id`.\n- `discovery_jobs.metrics` tracks tier, sources, validation/enrichment cost, census density, and confidence multipliers.\n- RLS policies restrict access to matching `auth.uid()` or legacy session IDs; diagnostics verify enforcement.\n\n## ðŸš€ Deployment Checklist\n\n```bash\n# Deploy discovery + enrichment + export stack\nsupabase functions deploy business-discovery-background\nsupabase functions deploy business-discovery-optimized\nsupabase functions deploy campaign-export-user-aware\nsupabase functions deploy enrichment-hunter\nsupabase functions deploy enrichment-neverbounce\nsupabase functions deploy enrichment-orchestrator\nsupabase functions deploy enrichment-business-license\nsupabase functions deploy enrichment-pdl\n\n# Deploy diagnostics\nsupabase functions deploy test-new-auth\nsupabase functions deploy test-official-auth\nsupabase functions deploy test-business-discovery\nsupabase functions deploy test-google-places\n\n# Build + deploy frontend\nnpm run build\ncd dist && vercel --prod\n```\n\n## ðŸ§ª Smoke Tests\n\n```bash\n# Background discovery (session JWT required)\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\":\"coffee shop\",\"location\":\"Seattle, WA\",\"tierKey\":\"PROFESSIONAL\",\"maxResults\":2,\"sessionUserId\":\"prod-ready-430\"}'\n\n# Auth diagnostics\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"diagnostics\":true}'\n\n./scripts/test-auth-patterns.sh <SUPABASE_SESSION_JWT>\n\n# Export validation\ncurl -X POST \\\n  'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware' \\\n  -H 'Authorization: Bearer <SUPABASE_SESSION_JWT>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"campaignId\":\"<CAMPAIGN_ID>\",\"format\":\"csv\",\"sessionUserId\":\"prod-ready-430\"}'\n```\n\n## âœ… Verification Checklist\n\n- [ ] All listed functions deployed with latest commit.\n- [ ] `test-new-auth` + `test-official-auth` return 200 with current session token.\n- [ ] Background discovery smoke test writes campaign + leads tied to caller `user_id`.\n- [ ] Export smoke test returns CSV with enrichment metadata.\n- [ ] `scripts/test-auth-patterns.sh` shows helper/reference parity.\n- [ ] Supabase secrets populated (Google, Foursquare, Census, Hunter.io, NeverBounce, Supabase keys).\n- [ ] Frontend deployed from `/dist` and configured with current publishable key.\n\n---\n\n**ProspectPro v4.3 is production ready with authenticated session enforcement, tier-aware background discovery, and full diagnostics coverage.**\n"}}},
{"type":"measure","name":"lsp.did_open","count":56,"duration":0.049},
{"type":"mark","name":"lsp.did_open","count":57,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/PRODUCTION_READY_V4.2.md","languageId":"markdown","version":1,"text":"# ðŸŽ‰ ProspectPro v4.2 - Session Authentication COMPLETE!\n\n> **Superseded:** Refer to `PRODUCTION_READY_V4.3.md` for the current session-enforced production state (October 9, 2025).\n\n## âœ… STATUS: FULLY OPERATIONAL\n\n**Date**: October 4, 2025  \n**Production URL**: https://prospect-8fvlz5h1i-appsmithery.vercel.app  \n**Status**: All systems operational with anonymous session authentication\n\n## What Was Accomplished\n\n### 1. âœ… Anonymous Session Authentication\n\n- Frontend automatically creates anonymous Supabase sessions on load\n- Users get real JWT tokens (ES256 signed)\n- No sign-up required for basic usage\n- Seamless upgrade to authenticated accounts later\n\n### 2. âœ… Edge Function Integration\n\n- Deployed with `--no-verify-jwt` flag to accept ES256 JWTs\n- Edge Functions validate user sessions via `auth.getUser()`\n- User context properly tracked in database\n- RLS policies enforce data isolation\n\n### 3. âœ… Production Deployment\n\n- Frontend: Built and deployed to Vercel\n- Backend: 6 Edge Functions operational\n- Database: User-aware schema with RLS policies\n- Authentication: ES256 JWT signing keys active\n\n## Test Results\n\n```bash\nâœ… Anonymous session created\nâœ… JWT token obtained (ES256 signed)\nâœ… Edge Function accepted JWT\nâœ… Business discovery working\nâœ… Real business data returned\nâœ… Campaign stored in database\nâœ… User context tracked\n\nðŸŽ‰ Session-based authentication is FULLY FUNCTIONAL!\n```\n\n## What Works Now\n\n### For End Users\n\n1. **Visit site** â†’ Anonymous session auto-created\n2. **Start discovery** â†’ Works immediately (no sign-up)\n3. **View results** â†’ Real business data with verified contacts\n4. **Enrich leads** â†’ Progressive enrichment pipeline\n5. **Export data** â†’ CSV export with user-aware filtering\n6. **Create account** (optional) â†’ Seamless upgrade from anonymous\n\n### For Developers\n\n- âœ… Session management handled automatically\n- âœ… JWT tokens refresh automatically\n- âœ… User context available in all API calls\n- âœ… RLS policies enforce data security\n- âœ… Anonymous and authenticated users both supported\n\n## Architecture\n\n```\nUser Visits App\n    â†“\nAnonymous Session Created (Supabase Auth)\n    â†“\nJWT Token Generated (ES256 signed)\n    â†“\nUser Clicks \"Start Discovery\"\n    â†“\nensureSession() validates session\n    â†“\nEdge Function Called with JWT Authorization\n    â†“\nEdge Function validates via auth.getUser()\n    â†“\nReal Business Data Returned\n    â†“\nCampaign + Leads Stored in Database (with user_id)\n    â†“\nâœ… Results Displayed\n```\n\n## Key Technical Details\n\n### JWT Signing\n\n- **Algorithm**: ES256 (Elliptic Curve)\n- **Key ID**: 41073739-ae09-48ff-b3ed-c3f978d1d3b2\n- **Discovery URL**: https://sriycekxdqnesdsgwiuc.supabase.co/auth/v1/.well-known/jwks.json\n- **Validation**: Automatic via Supabase Edge Runtime\n\n### Edge Functions\n\n- **Deployment**: `--no-verify-jwt` flag enables ES256 JWT acceptance\n- **Auth Method**: `supabaseClient.auth.getUser()` validates sessions\n- **User Context**: Available in all database operations\n- **RLS**: Policies enforce per-user data isolation\n\n### Database Schema\n\n```sql\ncampaigns:\n  - user_id: UUID (authenticated users)\n  - session_user_id: TEXT (anonymous users)\n  - RLS policies: Users see only their campaigns\n\nleads:\n  - user_id: UUID (authenticated users)\n  - session_user_id: TEXT (anonymous users)\n  - RLS policies: Users see only their leads\n```\n\n### Frontend\n\n- **Session Management**: AuthContext with anonymous support\n- **Token Handling**: Automatic via Supabase client\n- **API Calls**: JWT automatically included in Authorization header\n- **Refresh**: Auto-refresh tokens before expiration\n\n## Testing Commands\n\n### Test Session Authentication\n\n```bash\ncd /workspaces/ProspectPro\n./test-session-auth.sh\n```\n\n**Expected Output**:\n\n```\nâœ… Anonymous session created successfully!\nâœ… Edge Function authentication SUCCESS!\nðŸŽ‰ Session-based authentication is FULLY FUNCTIONAL!\n```\n\n### Test Production Site\n\n```bash\ncurl 'https://prospect-8fvlz5h1i-appsmithery.vercel.app'\n# Should return 200 OK with HTML\n```\n\n### Test Business Discovery\n\n```bash\n# Create anonymous session\nSESSION_TOKEN=$(curl -s -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/auth/v1/signup' \\\n  -H \"apikey: sb_publishable_your_key_here\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"data\": {}}' | jq -r '.access_token')\n\n# Call Edge Function\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-user-aware' \\\n  -H \"Authorization: Bearer $SESSION_TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"businessType\": \"coffee shop\",\n    \"location\": \"Seattle, WA\",\n    \"maxResults\": 2\n  }' | jq '.success'\n# Should output: true\n```\n\n## Deployment Configuration\n\n### Environment Variables (.env.production)\n\n```bash\nVITE_SUPABASE_URL=https://sriycekxdqnesdsgwiuc.supabase.co\nVITE_SUPABASE_ANON_KEY=sb_publishable_your_key_here\nVITE_EDGE_FUNCTIONS_URL=https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1\n```\n\n### Edge Functions (Deployed)\n\n1. `business-discovery-user-aware` (with --no-verify-jwt)\n2. `campaign-export-user-aware`\n3. `enrichment-orchestrator`\n4. `enrichment-hunter`\n5. `enrichment-neverbounce`\n6. `enrichment-business-license`\n7. `enrichment-pdl`\n\n### Vercel Deployment\n\n- **Project**: appsmithery/prospect-pro\n- **Framework**: Vite (auto-detected)\n- **Build Command**: `npm run build`\n- **Output Directory**: `dist`\n- **Production URL**: https://prospect-8fvlz5h1i-appsmithery.vercel.app\n\n## Security Features\n\n### âœ… Implemented\n\n- Anonymous session tokens (unique per user)\n- JWT token auto-refresh\n- RLS policies (database-level security)\n- User-campaign ownership tracking\n- Session-based data isolation\n- No exposed API keys in frontend\n\n### âœ… Best Practices\n\n- Tokens stored in Supabase client (not localStorage directly)\n- Authorization header for all API calls\n- ES256 signing (modern cryptography)\n- Automatic token expiration\n- Seamless anonymous â†’ authenticated upgrade\n\n## User Warnings Addressed\n\nThe Supabase dashboard warnings about anonymous access policies are **expected and safe**:\n\n| Warning                             | Status      | Explanation                                                      |\n| ----------------------------------- | ----------- | ---------------------------------------------------------------- |\n| Anonymous Access Policies           | âœ… Expected | RLS policies allow anonymous users to access their own data only |\n| Leaked Password Protection Disabled | â„¹ï¸ Optional | Not needed for anonymous-first app (enable when adding auth)     |\n\n## Next Steps (Optional Enhancements)\n\n### Phase 1: User Accounts (Optional)\n\n- Add email/password sign-up\n- Social auth (Google, GitHub)\n- User profile management\n- Campaign history persistence\n\n### Phase 2: Advanced Features\n\n- Team collaboration\n- API key management for users\n- Custom enrichment tiers\n- Webhook notifications\n\n### Phase 3: Analytics\n\n- User behavior tracking\n- Campaign performance metrics\n- Cost optimization insights\n- A/B testing framework\n\n## Monitoring\n\n### Check Edge Function Logs\n\n```\nhttps://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/logs/edge-functions\n```\n\n### Check Database Activity\n\n```sql\n-- View recent campaigns\nSELECT * FROM campaigns ORDER BY created_at DESC LIMIT 10;\n\n-- View anonymous users\nSELECT DISTINCT session_user_id FROM campaigns WHERE session_user_id IS NOT NULL;\n\n-- View authenticated users\nSELECT DISTINCT user_id FROM campaigns WHERE user_id IS NOT NULL;\n```\n\n### Check Vercel Deployments\n\n```\nhttps://vercel.com/appsmithery/prospect-pro\n```\n\n## Support & Documentation\n\n- **Implementation Guide**: `/SESSION_AUTH_IMPLEMENTATION.md`\n- **Deployment Guide**: `/DEPLOYMENT_COMPLETE_SESSION_AUTH.md`\n- **Test Script**: `/test-session-auth.sh`\n- **API Documentation**: `/docs/API.md`\n\n## Summary\n\nâœ… **Anonymous session authentication fully implemented and operational**  \nâœ… **Edge Functions accepting ES256-signed JWTs**  \nâœ… **Frontend deployed with automatic session management**  \nâœ… **Database configured with user-aware RLS policies**  \nâœ… **Production site live and functional**  \nâœ… **Real business data discovery working**  \nâœ… **Progressive enrichment pipeline operational**\n\n**ProspectPro v4.2 is now PRODUCTION READY with complete session-based authentication!** ðŸš€\n"}}},
{"type":"measure","name":"lsp.did_open","count":57,"duration":0.086},
{"type":"mark","name":"lsp.did_open","count":58,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/NEED_ANON_KEY.md","languageId":"markdown","version":1,"text":"# Need Anon Key\n\n> **Legacy Notice (October 9, 2025):** ProspectPro v4.3 now enforces Supabase session JWTs for all Edge Functions. This guide is retained for historical reference when troubleshooting publishable key issues. For the current authentication pattern see `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md` and `PRODUCTION_READY_V4.3.md`.\n\n# The Issue\n\nYour JWT signing keys show you're using **ES256** (modern elliptic curve signing). But Edge Functions still need an **anon/public API key** for validation.\n\n# ðŸŽ¯ CRITICAL: Get the Anon/Public API Key\n\n## The Issue\n\nYour JWT signing keys show you're using **ES256** (modern elliptic curve signing). But Edge Functions still need an **anon/public API key** for validation.\n\n## Where to Find It\n\n**Go to your Supabase Dashboard:**\n\nhttps://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n\n**Look for the \"Project API keys\" section** - you should see:\n\n```\nanon\npublic\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...  (or similar JWT)\n[Copy] [Show] [Generate new]\n```\n\n**OR** it might show as:\n\n```\nanon / public\nsb_anon_...  (new format)\n[Copy] [Show]\n```\n\n## What We Need\n\n**Share the \"anon\" or \"public\" key** - it will be either:\n\n- JWT format: `eyJhbGciOiJ...` (long string, ~200+ characters)\n- OR new format: `sb_anon_...` (if they changed the format)\n\n## Once You Share It\n\nI'll run:\n\n```bash\nsupabase secrets set SUPABASE_ANON_KEY=\"<your-anon-key>\"\n./test-session-auth.sh\n```\n\nAnd everything will work!\n\n## Why This is Needed\n\nSupabase Edge Functions validate incoming JWTs against the project's anon key. Without the correct anon key configured in the Edge Function environment, ALL JWT tokens (including valid anonymous user tokens) are rejected with \"Invalid JWT\".\n\nYour user JWT tokens are valid and properly signed with the ES256 key you showed me. The Edge Function runtime just needs the anon key to verify them.\n"}}},
{"type":"measure","name":"lsp.did_open","count":58,"duration":0.029},
{"type":"mark","name":"lsp.did_open","count":59,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/FINAL_JWT_ANON_KEY_SOLUTION.md","languageId":"markdown","version":1,"text":"# âœ… FINAL SOLUTION: JWT Anon Key Required\n\n> **Legacy Notice (October 9, 2025):** ProspectPro v4.3 relies on Supabase session JWTs provided by clients; this artifact remains for historical context when auditing publishable key configuration. See `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md` for the supported pattern.\n\n## The Root Cause (Confirmed)\n\nSupabase Edge Functions reject JWTs at the **platform level** before our code runs. This validation requires the correct `SUPABASE_ANON_KEY` to be configured.\n\n**Current Problem**:\n\n- `SUPABASE_ANON_KEY` in Edge Functions = `sb_publishable_...` (database key)\n- Edge Functions need = JWT anon key (`eyJ...` format)\n\n## The Solution\n\n### Step 1: Get the JWT Anon Key\n\n**Go to Supabase Dashboard** â†’ API Settings:\nhttps://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n\n**Look for \"Project API keys\" section** - You should see:\n\n```\nanon / public\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL3...\n[Copy] [Show]\n```\n\n**Copy that JWT key** (starts with `eyJ...`, NOT `sb_publishable_...`)\n\n### Step 2: Update Edge Function Environment\n\n**Option A: Via Supabase CLI** (from your Codespace):\n\n```bash\ncd /workspaces/ProspectPro\n\n# Create .env file with JWT anon key\necho \"SUPABASE_ANON_KEY=eyJ...\" > .env.edge-functions\n# ^ Replace eyJ... with actual JWT anon key\n\n# Set the secret\nsupabase secrets set SUPABASE_ANON_KEY --env-file .env.edge-functions\n\n# Verify it was set\nsupabase secrets list | grep SUPABASE_ANON_KEY\n```\n\n**Option B: Via Supabase Dashboard**:\n\n1. Go to: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/functions\n2. Find \"Environment variables\" section\n3. Find `SUPABASE_ANON_KEY`\n4. Click \"Edit\"\n5. Replace value with JWT anon key (`eyJ...`)\n6. Save\n\n### Step 3: Test\n\n```bash\ncd /workspaces/ProspectPro\n./test-session-auth.sh\n```\n\n**Expected Result**:\n\n```\nâœ… Anonymous session created successfully!\nâœ… Edge Function authentication SUCCESS!\nðŸŽ‰ Session-based authentication is FULLY FUNCTIONAL!\n```\n\n## Why This is Necessary\n\nSupabase Edge Functions use the `SUPABASE_ANON_KEY` to:\n\n1. **Validate incoming JWTs** (platform level, before your code)\n2. **Create Supabase clients** inside Edge Functions\n3. **Apply RLS policies** based on user context\n\nWithout the correct JWT anon key, the platform rejects all JWTs with \"Invalid JWT\".\n\n## What's the Difference?\n\n| Key Type            | Format               | Purpose                         | Used By                           |\n| ------------------- | -------------------- | ------------------------------- | --------------------------------- |\n| **Publishable Key** | `sb_publishable_...` | Database REST API access        | Frontend database queries         |\n| **JWT Anon Key**    | `eyJhbGc...`         | JWT validation + Edge Functions | Edge Function authentication      |\n| **Secret Key**      | `sb_secret_...`      | Admin database access           | Server-side privileged operations |\n\n## After Setting the JWT Anon Key\n\n**Everything will work**:\n\n- âœ… Anonymous users can call Edge Functions\n- âœ… Authenticated users can call Edge Functions\n- âœ… Business discovery will work\n- âœ… Lead enrichment will work\n- âœ… Database operations respect RLS policies\n- âœ… User context properly tracked\n\n## Quick Test Commands\n\n```bash\n# After setting JWT anon key, test Edge Function directly:\ncurl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-user-aware' \\\n  -H 'Authorization: Bearer <USER_JWT_TOKEN>' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"businessType\": \"coffee shop\", \"location\": \"Seattle, WA\", \"maxResults\": 1}'\n\n# Should return:\n# { \"success\": true, \"campaignId\": \"...\", \"leads\": [...] }\n```\n\n## Summary\n\n**What to Do**:\n\n1. Get JWT anon key from dashboard (eyJ... format)\n2. Set it as SUPABASE_ANON_KEY in Edge Functions\n3. Test with `./test-session-auth.sh`\n4. Visit production site and test discovery\n\n**Time Required**: 2-3 minutes\n\n**This is the FINAL piece needed** - once the JWT anon key is set, everything will work!\n"}}},
{"type":"measure","name":"lsp.did_open","count":59,"duration":0.045},
{"type":"mark","name":"lsp.did_open","count":60,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/EDGE_FUNCTION_JWT_ISSUE.md","languageId":"markdown","version":1,"text":"# ðŸ” Edge Function JWT Authentication Issue\n\n> **Legacy Notice (October 9, 2025):** ProspectPro v4.3 resolves this by using Supabase session JWTs with `auth.getUser`. Keep this document for background, and see `EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md` for the maintained workflow.\n\n## Current Status\n\n**Anonymous Session**: âœ… Working  \n**JWT Token Generated**: âœ… Working  \n**Edge Function**: âŒ Rejecting JWT with \"Invalid JWT\"\n\n## The Problem\n\nSupabase Edge Functions have **two layers of authentication**:\n\n1. **Platform-level JWT validation** (happens first, before our code)\n2. **Application-level validation** (our edge-auth.ts code)\n\nThe JWT is being rejected at **layer 1** - before our code even runs.\n\n## Why This Happens\n\nSupabase Edge Functions validate JWTs against the project's **JWT_SECRET**. The anonymous user JWT we're sending is valid, but something about the validation is failing.\n\n## Possible Causes\n\n### 1. Missing JWT Anon Key\n\nThe `SUPABASE_ANON_KEY` environment variable in Edge Functions might be:\n\n- Set to `sb_publishable_...` (wrong - this is for database API)\n- Missing the actual JWT anon key\n- Not updated after enabling anonymous auth\n\n**Solution**: Get the JWT anon key from Supabase dashboard\n\n### 2. Edge Functions Need Anon Key for Validation\n\nEven though we're sending user JWTs, Edge Functions might need the **anon key** configured to validate those JWTs.\n\n**How to Get JWT Anon Key**:\n\n1. Go to: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n2. Look for \"Project API keys\" section\n3. Find **\"anon / public\"** key\n4. This should be JWT format (`eyJ...`), NOT `sb_publishable_...`\n\n### 3. Edge Function Configuration\n\nNeed to check if Edge Functions are configured to accept anonymous user JWTs.\n\n## Next Steps\n\n### Option 1: Get JWT Anon Key (Recommended)\n\nIf there's a JWT anon key in the dashboard:\n\n1. Copy the JWT anon key (starts with `eyJ...`)\n2. Set it as Edge Function secret:\n   ```bash\n   echo \"SUPABASE_ANON_KEY=eyJ...\" > .env\n   supabase secrets set --env-file .env SUPABASE_ANON_KEY\n   ```\n3. Redeploy Edge Functions\n4. Test again\n\n### Option 2: Disable JWT Validation (Not Recommended)\n\nMake Edge Functions publicly accessible without JWT validation. This is less secure but would work.\n\n### Option 3: Use Service Role Key\n\nHave the frontend call Edge Functions with the service role key. This is NOT recommended for security reasons.\n\n## What We Need from You\n\n**Go to the Supabase Dashboard**:\nhttps://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/settings/api\n\n**Check the \"Project API keys\" section**:\n\n- Do you see both `sb_publishable_...` AND a JWT key (`eyJ...`)?\n- If yes, copy the JWT key and share it\n- If no, we need to use a different approach\n\n## Alternative: Check if JWT Anon Key Exists\n\n```bash\n# Check current Edge Function secrets\nsupabase secrets list\n\n# Look for SUPABASE_ANON_KEY\n# Is it set to sb_publishable_... or eyJ...?\n```\n\nThe issue is that Edge Functions validate JWTs using a secret key, and we need to make sure that secret is properly configured.\n"}}},
{"type":"measure","name":"lsp.did_open","count":60,"duration":0.036},
{"type":"mark","name":"lsp.did_open","count":61,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/docs/PRODUCTION_VALIDATION_STRATEGY.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 Production Validation Strategy\n\n## Overview: Native Platform-First Debugging\n\n**Philosophy**: Leverage Supabase, Vercel, and browser native tooling for lightweight, iterative issue isolation without external dependencies or complex monitoring infrastructure.\n\n**Approach**: Systematic validation using platform-native logging, real-time observability, and targeted debugging to rapidly identify and resolve production issues.\n\n## 1. Multi-Layer Validation Architecture\n\n### Layer 1: Frontend Health (Vercel + Browser)\n\n- **Tool**: Browser Developer Tools + Vercel Analytics\n- **Scope**: User authentication, UI functionality, API call initiation\n- **Validation**: Session token generation, frontend state management, network request formation\n\n### Layer 2: Edge Function Health (Supabase)\n\n- **Tool**: Supabase Dashboard Edge Function Logs\n- **Scope**: Authentication validation, business logic execution, external API calls\n- **Validation**: Session JWT processing, API integration responses, error handling\n\n### Layer 3: Database Operations (Supabase)\n\n- **Tool**: Supabase Dashboard SQL Editor + Real-time Logs\n- **Scope**: RLS policy enforcement, data persistence, query performance\n- **Validation**: User-scoped data access, campaign creation, lead insertion\n\n### Layer 4: External API Integration (Edge Function Logs)\n\n- **Tool**: Structured logging within Edge Functions\n- **Scope**: Google Places, Hunter.io, NeverBounce, Foursquare API responses\n- **Validation**: Rate limiting, response parsing, cost tracking\n\n## 2. Iterative Testing Methodology\n\n### Phase 1: Authentication Flow Validation\n\n```bash\n# Test 1: Frontend session establishment\n# Browser DevTools â†’ Application â†’ Local Storage â†’ sb-* keys\n# Expected: Valid session token, user object, refresh token\n\n# Test 2: Edge Function authentication\ncurl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\" \\\n  -H \"Authorization: Bearer [SESSION_JWT]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"diagnostics\": true}'\n# Expected: 200 response with user context\n\n# Test 3: Database RLS enforcement\n# Supabase SQL Editor: SELECT * FROM campaigns WHERE user_id = auth.uid() LIMIT 1;\n# Expected: User-scoped results only\n```\n\n### Phase 2: Campaign Discovery Validation\n\n```bash\n# Test 4: Background discovery initiation\ncurl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background\" \\\n  -H \"Authorization: Bearer [SESSION_JWT]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"businessType\": \"coffee shop\", \"location\": \"Seattle, WA\", \"maxResults\": 2, \"tierKey\": \"PROFESSIONAL\", \"sessionUserId\": \"validation_test\"}'\n# Expected: 200 response with campaign ID\n\n# Test 5: Real-time discovery progress\n# Supabase Dashboard â†’ Table Editor â†’ campaigns table\n# Expected: New campaign row with 'processing' status\n\n# Test 6: Discovery completion\n# Wait 30 seconds, refresh campaigns table\n# Expected: Campaign status 'completed', results_count > 0\n```\n\n### Phase 3: Data Quality Validation\n\n```bash\n# Test 7: Lead quality verification\n# Supabase SQL Editor:\nSELECT business_name, phone, website, email, confidence_score\nFROM leads\nWHERE campaign_id = '[CAMPAIGN_ID]'\nORDER BY confidence_score DESC LIMIT 5;\n# Expected: Non-null phone/website, verified emails only, confidence > 50\n\n# Test 8: Cost tracking accuracy\nSELECT SUM(validation_cost) as total_cost\nFROM leads\nWHERE campaign_id = '[CAMPAIGN_ID]';\n# Expected: Reasonable cost per lead ($0.50-$2.00 range)\n```\n\n### Phase 4: Export Functionality Validation\n\n```bash\n# Test 9: Campaign export generation\ncurl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware\" \\\n  -H \"Authorization: Bearer [SESSION_JWT]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"campaignId\": \"[CAMPAIGN_ID]\", \"format\": \"csv\", \"sessionUserId\": \"validation_test\"}'\n# Expected: CSV download with complete lead data\n\n# Test 10: Export data integrity\n# Verify CSV contains: business_name, phone, website, email, confidence_score\n# Expected: All discovered leads present, no fake/generated data\n```\n\n## 3. Native Platform Observability Setup\n\n### Supabase Edge Function Logging\n\n```typescript\n// Standard logging pattern for all Edge Functions\nconsole.log(`[${functionName}] ${stage}: ${JSON.stringify(data)}`);\n\n// Example stages:\n// - AUTH_START, AUTH_SUCCESS, AUTH_FAILED\n// - API_REQUEST, API_SUCCESS, API_ERROR\n// - DB_QUERY, DB_SUCCESS, DB_ERROR\n// - VALIDATION_START, VALIDATION_SUCCESS, VALIDATION_FAILED\n```\n\n### Vercel Deployment Monitoring\n\n- **Deployment Logs**: Vercel Dashboard â†’ Deployments â†’ View Function Logs\n- **Analytics**: Real-time traffic, error rates, response times\n- **Network Tab**: Browser DevTools for client-side request inspection\n\n### Browser-Based Debugging\n\n```javascript\n// Frontend debugging utilities\nconsole.log(\"Supabase Session:\", await supabase.auth.getSession());\nconsole.log(\"Campaign Request:\", requestPayload);\nconsole.log(\"API Response:\", response);\n\n// Network monitoring\n// DevTools â†’ Network â†’ Filter by 'supabase.co' â†’ Monitor request/response\n```\n\n## 4. Issue Isolation Decision Tree\n\n### Authentication Issues (401/403 Errors)\n\n1. **Check**: Browser Local Storage for `sb-*` keys\n2. **Verify**: Session token validity in Supabase Auth dashboard\n3. **Test**: Direct Edge Function call with curl\n4. **Debug**: Edge Function logs for specific authentication errors\n\n### Discovery Issues (Discovery Fails)\n\n1. **Check**: Edge Function logs for API integration errors\n2. **Verify**: External API quotas and rate limits\n3. **Test**: Individual API calls within Edge Functions\n4. **Debug**: Google Places/Foursquare response validation\n\n### Database Issues (Empty Results)\n\n1. **Check**: RLS policies in Supabase dashboard\n2. **Verify**: User ID propagation in database queries\n3. **Test**: Direct SQL queries in Supabase SQL Editor\n4. **Debug**: Campaign and lead table row-level access\n\n### Performance Issues (Slow Response)\n\n1. **Check**: Edge Function execution time in logs\n2. **Verify**: External API response times\n3. **Test**: Database query performance with EXPLAIN\n4. **Debug**: Network latency between services\n\n## 5. Automated Validation Scripts\n\n### Quick Health Check Script\n\n```bash\n#!/bin/bash\n# scripts/production-health-check.sh\n\necho \"ðŸ” ProspectPro v4.3 Production Health Check\"\necho \"============================================\"\n\n# Test 1: Frontend accessibility\necho \"Testing frontend accessibility...\"\nFRONTEND_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" https://prospect-28j3db56m-appsmithery.vercel.app)\nif [ \"$FRONTEND_STATUS\" = \"200\" ]; then\n  echo \"âœ… Frontend: Accessible\"\nelse\n  echo \"âŒ Frontend: Error $FRONTEND_STATUS\"\nfi\n\n# Test 2: Edge Functions availability\necho \"Testing Edge Functions availability...\"\nEDGE_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth)\nif [ \"$EDGE_STATUS\" = \"401\" ]; then\n  echo \"âœ… Edge Functions: Responding (auth required)\"\nelse\n  echo \"âŒ Edge Functions: Unexpected response $EDGE_STATUS\"\nfi\n\n# Test 3: Database connectivity\necho \"Testing database connectivity...\"\necho \"â†’ Manual verification required: Check Supabase dashboard connectivity\"\n\necho \"\"\necho \"ðŸŽ¯ Next Steps:\"\necho \"1. Authenticate in browser: https://prospect-28j3db56m-appsmithery.vercel.app\"\necho \"2. Extract session JWT from browser Local Storage (sb-* keys)\"\necho \"3. Run full campaign validation with session token\"\n```\n\n### Full Campaign Validation Script\n\n```bash\n#!/bin/bash\n# scripts/campaign-validation.sh\n\nif [ -z \"$1\" ]; then\n  echo \"Usage: $0 <SESSION_JWT>\"\n  exit 1\nfi\n\nSESSION_JWT=\"$1\"\nCAMPAIGN_TEST_ID=\"validation_$(date +%s)\"\n\necho \"ðŸš€ Full Campaign Validation\"\necho \"==========================\"\n\n# Step 1: Authentication test\necho \"Step 1: Testing authentication...\"\nAUTH_RESPONSE=$(curl -s -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\" \\\n  -H \"Authorization: Bearer $SESSION_JWT\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"diagnostics\": true}')\n\nif echo \"$AUTH_RESPONSE\" | grep -q '\"userId\"'; then\n  echo \"âœ… Authentication: Success\"\n  USER_ID=$(echo \"$AUTH_RESPONSE\" | grep -o '\"userId\":\"[^\"]*\"' | cut -d'\"' -f4)\n  echo \"   User ID: $USER_ID\"\nelse\n  echo \"âŒ Authentication: Failed\"\n  echo \"   Response: $AUTH_RESPONSE\"\n  exit 1\nfi\n\n# Step 2: Campaign discovery test\necho \"Step 2: Testing campaign discovery...\"\nDISCOVERY_RESPONSE=$(curl -s -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background\" \\\n  -H \"Authorization: Bearer $SESSION_JWT\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\\\"businessType\\\": \\\"coffee shop\\\", \\\"location\\\": \\\"Seattle, WA\\\", \\\"maxResults\\\": 2, \\\"tierKey\\\": \\\"PROFESSIONAL\\\", \\\"sessionUserId\\\": \\\"$CAMPAIGN_TEST_ID\\\"}\")\n\nif echo \"$DISCOVERY_RESPONSE\" | grep -q '\"campaignId\"'; then\n  echo \"âœ… Discovery: Campaign initiated\"\n  CAMPAIGN_ID=$(echo \"$DISCOVERY_RESPONSE\" | grep -o '\"campaignId\":\"[^\"]*\"' | cut -d'\"' -f4)\n  echo \"   Campaign ID: $CAMPAIGN_ID\"\nelse\n  echo \"âŒ Discovery: Failed\"\n  echo \"   Response: $DISCOVERY_RESPONSE\"\n  exit 1\nfi\n\n# Step 3: Wait for processing\necho \"Step 3: Waiting for campaign processing (30 seconds)...\"\nsleep 30\n\n# Step 4: Export test\necho \"Step 4: Testing campaign export...\"\nEXPORT_RESPONSE=$(curl -s -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/campaign-export-user-aware\" \\\n  -H \"Authorization: Bearer $SESSION_JWT\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\\\"campaignId\\\": \\\"$CAMPAIGN_ID\\\", \\\"format\\\": \\\"csv\\\", \\\"sessionUserId\\\": \\\"$CAMPAIGN_TEST_ID\\\"}\")\n\nif echo \"$EXPORT_RESPONSE\" | grep -q '\"rowCount\"'; then\n  echo \"âœ… Export: Success\"\n  ROW_COUNT=$(echo \"$EXPORT_RESPONSE\" | grep -o '\"rowCount\":[0-9]*' | cut -d':' -f2)\n  echo \"   Exported Rows: $ROW_COUNT\"\nelse\n  echo \"âŒ Export: Failed\"\n  echo \"   Response: $EXPORT_RESPONSE\"\nfi\n\necho \"\"\necho \"ðŸŽ¯ Validation Complete\"\necho \"Campaign ID: $CAMPAIGN_ID\"\necho \"Check Supabase dashboard for detailed results\"\n```\n\n## 6. Debug Information Collection\n\n### Frontend Debug Data Collection\n\n```javascript\n// Browser console script for collecting debug information\nconst debugInfo = {\n  timestamp: new Date().toISOString(),\n  url: window.location.href,\n  userAgent: navigator.userAgent,\n  supabaseSession: await supabase.auth.getSession(),\n  localStorage: Object.keys(localStorage).filter((k) => k.startsWith(\"sb-\")),\n  networkErrors: performance.getEntriesByType(\"navigation\")[0],\n  consoleErrors: [], // Manually captured from console\n};\n\nconsole.log(\"Debug Info:\", JSON.stringify(debugInfo, null, 2));\n```\n\n### Edge Function Debug Data Collection\n\n```typescript\n// Standard debug context for Edge Functions\nconst debugContext = {\n  timestamp: new Date().toISOString(),\n  functionName: \"business-discovery-background\",\n  requestId: crypto.randomUUID(),\n  userContext: {\n    userId: user?.id,\n    email: user?.email,\n    sessionId: sessionUserId,\n  },\n  requestPayload: req.body,\n  environment: {\n    region: Deno.env.get(\"SUPABASE_REGION\"),\n    version: Deno.env.get(\"FUNCTION_VERSION\"),\n  },\n};\n\nconsole.log(\n  `[DEBUG] ${debugContext.functionName}:`,\n  JSON.stringify(debugContext)\n);\n```\n\n## 7. Rapid Issue Resolution Playbook\n\n### Issue: \"Invalid JWT\" Errors\n\n**Diagnosis Time**: < 2 minutes\n\n1. Check browser Local Storage for `sb-access-token`\n2. Verify token expiry in JWT decoder\n3. Test fresh authentication in incognito window\n4. **Resolution**: Force re-authentication in frontend\n\n### Issue: \"Discovery Returns No Results\"\n\n**Diagnosis Time**: < 5 minutes\n\n1. Check Edge Function logs for API errors\n2. Verify Google Places API quota in Google Cloud Console\n3. Test direct API calls with sample queries\n4. **Resolution**: Adjust search parameters or check API keys\n\n### Issue: \"Database Permission Denied\"\n\n**Diagnosis Time**: < 3 minutes\n\n1. Check RLS policies in Supabase dashboard\n2. Verify user ID propagation in SQL queries\n3. Test direct database access with session user\n4. **Resolution**: Update RLS policies or fix user context passing\n\n### Issue: \"Export Contains No Data\"\n\n**Diagnosis Time**: < 4 minutes\n\n1. Check campaign completion status in database\n2. Verify lead insertion during discovery process\n3. Test export function with known campaign ID\n4. **Resolution**: Re-run discovery or fix lead insertion logic\n\n## 8. Success Metrics & KPIs\n\n### Performance Targets\n\n- **Authentication**: < 500ms session establishment\n- **Discovery**: < 60 seconds for 10 leads\n- **Export**: < 10 seconds for 100 leads\n- **Error Rate**: < 2% for all operations\n\n### Quality Targets\n\n- **Phone Coverage**: > 95% (via Google Places)\n- **Website Coverage**: > 90% (via Google Places)\n- **Email Accuracy**: > 95% (via Hunter.io + NeverBounce)\n- **Zero Fake Data**: 100% verified contacts only\n\n### Observability Targets\n\n- **Log Retention**: 7 days in Supabase\n- **Real-time Monitoring**: < 1 minute detection\n- **Debug Information**: Complete context in all error logs\n- **Issue Resolution**: < 15 minutes average time to fix\n\nThis strategy provides comprehensive, lightweight validation using native platform tools while maintaining rapid iteration and targeted issue resolution capabilities.\n"}}},
{"type":"measure","name":"lsp.did_open","count":61,"duration":0.112},
{"type":"mark","name":"lsp.did_open","count":62,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/docs/DEBUG_COLLECTION_GUIDE.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 Debug Collection Guide\n\n## Browser Debug Data Collection\n\n### Frontend Session Information\n\n```javascript\n// Run this in browser console at https://prospect-28j3db56m-appsmithery.vercel.app\nconst debugInfo = {\n  timestamp: new Date().toISOString(),\n  url: window.location.href,\n  userAgent: navigator.userAgent,\n  supabaseSession: await supabase.auth.getSession(),\n  localStorage: Object.keys(localStorage).filter((k) => k.startsWith(\"sb-\")),\n  sessionStorage: Object.keys(sessionStorage).filter((k) =>\n    k.startsWith(\"sb-\")\n  ),\n  networkTiming: performance.getEntriesByType(\"navigation\")[0],\n  errors: [], // Manually captured from console\n};\n\nconsole.log(\"ðŸ” Frontend Debug Info:\");\nconsole.log(JSON.stringify(debugInfo, null, 2));\n\n// Copy this output for troubleshooting\ncopy(JSON.stringify(debugInfo, null, 2));\n```\n\n### Session JWT Extraction\n\n```javascript\n// Get current session JWT for API testing\nconst {\n  data: { session },\n} = await supabase.auth.getSession();\nif (session) {\n  console.log(\"ðŸ”‘ Session JWT:\", session.access_token);\n  console.log(\"ðŸ“… Expires:\", new Date(session.expires_at * 1000));\n  copy(session.access_token);\n} else {\n  console.log(\"âŒ No active session\");\n}\n```\n\n### Network Request Monitoring\n\n```javascript\n// Monitor API calls in real-time\nconst originalFetch = window.fetch;\nwindow.fetch = function (...args) {\n  console.log(\"ðŸŒ API Request:\", args[0], args[1]);\n  return originalFetch\n    .apply(this, arguments)\n    .then((response) => {\n      console.log(\"ðŸ“¥ API Response:\", response.status, response.url);\n      return response;\n    })\n    .catch((error) => {\n      console.log(\"âŒ API Error:\", error);\n      throw error;\n    });\n};\n```\n\n## Edge Function Debug Patterns\n\n### Standard Logging Template\n\n```typescript\n// Add to all Edge Functions for comprehensive debugging\nconst debugContext = {\n  timestamp: new Date().toISOString(),\n  functionName: \"business-discovery-background\",\n  requestId: crypto.randomUUID(),\n  userContext: {\n    userId: user?.id,\n    email: user?.email,\n    sessionId: sessionUserId,\n  },\n  requestPayload: requestBody,\n  environment: {\n    region: Deno.env.get(\"SUPABASE_REGION\"),\n    version: \"4.3.0\",\n  },\n};\n\nconsole.log(\n  `[DEBUG] ${debugContext.functionName}:`,\n  JSON.stringify(debugContext)\n);\n\n// Add stage-specific logging\nconsole.log(`[AUTH] ${debugContext.functionName}: Authentication successful`);\nconsole.log(`[API] ${debugContext.functionName}: Calling external API`);\nconsole.log(`[DB] ${debugContext.functionName}: Database operation complete`);\nconsole.log(\n  `[RESULT] ${debugContext.functionName}: Function execution complete`\n);\n```\n\n### Error Context Collection\n\n```typescript\n// Enhanced error logging with full context\ntry {\n  // Function logic here\n} catch (error) {\n  const errorContext = {\n    timestamp: new Date().toISOString(),\n    functionName: \"business-discovery-background\",\n    errorMessage: error.message,\n    errorStack: error.stack,\n    userContext: debugContext.userContext,\n    requestData: debugContext.requestPayload,\n    apiResponses: {}, // Capture API responses leading to error\n  };\n\n  console.error(\n    `[ERROR] ${debugContext.functionName}:`,\n    JSON.stringify(errorContext)\n  );\n\n  return new Response(\n    JSON.stringify({\n      error: \"Internal server error\",\n      requestId: debugContext.requestId,\n      timestamp: errorContext.timestamp,\n    }),\n    {\n      status: 500,\n      headers: { \"Content-Type\": \"application/json\" },\n    }\n  );\n}\n```\n\n## Platform-Specific Debug Commands\n\n### Supabase Dashboard Debugging\n\n```sql\n-- Check recent campaigns for user\nSELECT\n  id, business_type, location, status, results_count,\n  total_cost, created_at, user_id\nFROM campaigns\nWHERE created_at > NOW() - INTERVAL '1 hour'\nORDER BY created_at DESC\nLIMIT 10;\n\n-- Analyze lead quality for campaign\nSELECT\n  business_name, phone, website, email, confidence_score,\n  validation_cost, created_at\nFROM leads\nWHERE campaign_id = 'YOUR_CAMPAIGN_ID'\nORDER BY confidence_score DESC\nLIMIT 20;\n\n-- Check user session activity\nSELECT\n  COUNT(*) as campaign_count,\n  SUM(results_count) as total_leads,\n  SUM(total_cost) as total_spent,\n  MAX(created_at) as last_activity\nFROM campaigns\nWHERE user_id = auth.uid();\n\n-- Validate RLS policies\nEXPLAIN (ANALYZE, BUFFERS)\nSELECT * FROM campaigns WHERE user_id = auth.uid() LIMIT 1;\n```\n\n### Vercel Deployment Debugging\n\n```bash\n# Check deployment status and logs\nvercel --version\nvercel whoami\nvercel ls prospect-pro\nvercel logs https://prospect-28j3db56m-appsmithery.vercel.app\n\n# Test deployment health\ncurl -I https://prospect-28j3db56m-appsmithery.vercel.app\ncurl -s https://prospect-28j3db56m-appsmithery.vercel.app | grep -E \"(title|version|error)\"\n\n# Check cache headers\ncurl -I https://prospect-28j3db56m-appsmithery.vercel.app | grep -i cache\n```\n\n## Issue-Specific Debug Workflows\n\n### Authentication Issues\n\n1. **Frontend Session Check**\n\n   ```javascript\n   const {\n     data: { session },\n     error,\n   } = await supabase.auth.getSession();\n   console.log(\"Session:\", session, \"Error:\", error);\n   ```\n\n2. **Edge Function Auth Test**\n\n   ```bash\n   curl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\" \\\n     -H \"Authorization: Bearer YOUR_SESSION_JWT\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"diagnostics\": true}'\n   ```\n\n3. **Database RLS Verification**\n   ```sql\n   SELECT * FROM campaigns WHERE business_type = 'test' LIMIT 1;\n   ```\n\n### Discovery Issues\n\n1. **API Integration Test**\n\n   ```bash\n   # Test Google Places API quota\n   curl \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=test&key=YOUR_API_KEY\"\n\n   # Check Hunter.io quota\n   curl \"https://api.hunter.io/v2/account?api_key=YOUR_API_KEY\"\n   ```\n\n2. **Edge Function Discovery Test**\n\n   ```bash\n   curl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-background\" \\\n     -H \"Authorization: Bearer YOUR_SESSION_JWT\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"businessType\": \"coffee shop\", \"location\": \"Seattle, WA\", \"maxResults\": 2, \"tierKey\": \"PROFESSIONAL\", \"sessionUserId\": \"debug_test\"}'\n   ```\n\n3. **Database Lead Verification**\n   ```sql\n   SELECT COUNT(*) FROM leads WHERE campaign_id = 'YOUR_CAMPAIGN_ID';\n   ```\n\n### Performance Issues\n\n1. **Edge Function Timing**\n\n   ```bash\n   time curl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\" \\\n     -H \"Authorization: Bearer YOUR_SESSION_JWT\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"diagnostics\": true}'\n   ```\n\n2. **Database Query Performance**\n\n   ```sql\n   EXPLAIN (ANALYZE, BUFFERS)\n   SELECT * FROM leads\n   WHERE campaign_id = 'YOUR_CAMPAIGN_ID'\n   ORDER BY confidence_score DESC;\n   ```\n\n3. **Frontend Load Time**\n   ```javascript\n   // Measure page load performance\n   console.log(\n     \"Navigation Timing:\",\n     performance.getEntriesByType(\"navigation\")[0]\n   );\n   console.log(\n     \"Resource Timing:\",\n     performance.getEntriesByType(\"resource\").slice(0, 10)\n   );\n   ```\n\n## Debug Data Export\n\n### Complete System State Export\n\n```bash\n#!/bin/bash\n# Generate comprehensive debug report\n\nDEBUG_DIR=\"/tmp/prospectpro_debug_$(date +%s)\"\nmkdir -p \"$DEBUG_DIR\"\n\n# System information\necho \"ProspectPro v4.3 Debug Report\" > \"$DEBUG_DIR/system_info.txt\"\necho \"Generated: $(date)\" >> \"$DEBUG_DIR/system_info.txt\"\necho \"Frontend URL: https://prospect-28j3db56m-appsmithery.vercel.app\" >> \"$DEBUG_DIR/system_info.txt\"\necho \"Edge Functions: https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/\" >> \"$DEBUG_DIR/system_info.txt\"\n\n# Test results\n./scripts/production-health-check.sh > \"$DEBUG_DIR/health_check.txt\" 2>&1\n\n# API connectivity\ncurl -I https://prospect-28j3db56m-appsmithery.vercel.app > \"$DEBUG_DIR/frontend_status.txt\" 2>&1\ncurl -I https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth > \"$DEBUG_DIR/edge_functions_status.txt\" 2>&1\n\n# Package debug report\ntar -czf \"prospectpro_debug_$(date +%s).tar.gz\" -C \"$DEBUG_DIR\" .\necho \"Debug report created: prospectpro_debug_$(date +%s).tar.gz\"\n```\n\n## Real-Time Monitoring Setup\n\n### Browser Console Monitoring\n\n```javascript\n// Set up continuous monitoring in browser console\nsetInterval(async () => {\n  const {\n    data: { session },\n  } = await supabase.auth.getSession();\n  console.log(\n    `[MONITOR] ${new Date().toISOString()}: Session valid:`,\n    !!session\n  );\n}, 30000); // Check every 30 seconds\n```\n\n### Edge Function Health Monitoring\n\n```bash\n#!/bin/bash\n# Monitor edge function health every minute\n\nwhile true; do\n  TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\n  STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\")\n\n  if [ \"$STATUS\" = \"401\" ]; then\n    echo \"[$TIMESTAMP] âœ… Edge Functions: Healthy (auth required)\"\n  else\n    echo \"[$TIMESTAMP] âŒ Edge Functions: Unhealthy ($STATUS)\"\n  fi\n\n  sleep 60\ndone\n```\n\nThis debug guide provides comprehensive tools for rapid issue identification and resolution using native platform capabilities.\n"}}},
{"type":"measure","name":"lsp.did_open","count":62,"duration":0.081},
{"type":"mark","name":"lsp.did_open","count":63,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/docs/VALIDATION_TOOLKIT.md","languageId":"markdown","version":1,"text":"# ProspectPro v4.3 Validation Toolkit\n\n## Quick Start Commands\n\n### 1. Initial Health Check\n\n```bash\n./scripts/production-health-check.sh\n```\n\n**Purpose**: Verify all system components are accessible and responding\n**Duration**: ~30 seconds\n**Output**: Color-coded status report with next steps\n\n### 2. Authentication Pattern Testing\n\n```bash\n# First, get your session JWT from the browser:\n# 1. Open https://prospect-28j3db56m-appsmithery.vercel.app\n# 2. Sign in or create account\n# 3. Open DevTools â†’ Application â†’ Local Storage\n# 4. Copy value from 'sb-access-token' key\n\n./scripts/test-auth-patterns.sh YOUR_SESSION_JWT\n```\n\n**Purpose**: Validate session enforcement and security measures\n**Duration**: ~15 seconds\n**Output**: Security verification and auth pattern test results\n\n### 3. Full Campaign Validation\n\n```bash\n./scripts/campaign-validation.sh YOUR_SESSION_JWT\n```\n\n**Purpose**: End-to-end testing of discovery, processing, and export\n**Duration**: ~60 seconds\n**Output**: Complete campaign lifecycle validation with lead generation\n\n## Script Reference\n\n### production-health-check.sh\n\n- âœ… Frontend accessibility check\n- âœ… Edge Functions availability verification\n- âœ… Function inventory validation\n- âœ… External API reachability testing\n- âœ… Database connectivity probe\n\n### test-auth-patterns.sh\n\n- ðŸ” Shared auth helper testing\n- ðŸ” Official Supabase auth reference\n- ðŸ” Production function auth validation\n- ðŸ›¡ï¸ Security vulnerability scanning\n- ðŸ“Š Auth system status summary\n\n### campaign-validation.sh\n\n- ðŸš€ Authentication verification\n- ðŸŽ¯ Campaign discovery initiation\n- â³ Background processing monitoring\n- ðŸ“Š Data quality validation\n- ðŸ“ˆ Performance metrics collection\n- ðŸ Complete workflow verification\n\n## Platform Debugging URLs\n\n### Supabase Dashboard\n\n- **Project**: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc\n- **Edge Functions**: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/functions\n- **Database**: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/editor\n- **Logs**: https://supabase.com/dashboard/project/sriycekxdqnesdsgwiuc/logs\n\n### Vercel Dashboard\n\n- **Project**: https://vercel.com/appsmithery/prospect-pro\n- **Deployments**: https://vercel.com/appsmithery/prospect-pro/deployments\n- **Analytics**: https://vercel.com/appsmithery/prospect-pro/analytics\n\n### Production URLs\n\n- **Frontend**: https://prospect-28j3db56m-appsmithery.vercel.app\n- **Edge Functions**: https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/\n\n## Troubleshooting Decision Tree\n\n### ðŸ”´ Health Check Fails\n\n1. **Frontend 404/500**: Check Vercel deployment status\n2. **Edge Functions down**: Check Supabase service status\n3. **API unreachable**: Verify network connectivity\n\n### ðŸŸ¡ Auth Patterns Fail\n\n1. **Invalid JWT**: Re-authenticate and get fresh token\n2. **Security vulnerability**: Check edge function deployment\n3. **Auth helper fails**: Review Supabase auth configuration\n\n### ðŸ”´ Campaign Validation Fails\n\n1. **Discovery fails**: Check Google Places API quota/billing\n2. **No leads generated**: Verify API keys and search parameters\n3. **Export fails**: Check campaign completion and data presence\n\n## Emergency Debugging Commands\n\n### Get Fresh Session Token\n\n```bash\n# If authentication fails, get a new token\necho \"1. Open https://prospect-28j3db56m-appsmithery.vercel.app in incognito\"\necho \"2. Create new account or sign in\"\necho \"3. Open DevTools â†’ Application â†’ Local Storage\"\necho \"4. Copy 'sb-access-token' value\"\necho \"5. Re-run validation with new token\"\n```\n\n### Direct Edge Function Test\n\n```bash\n# Test specific edge function without scripts\ncurl -X POST \"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/test-new-auth\" \\\n  -H \"Authorization: Bearer YOUR_SESSION_JWT\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"diagnostics\": true}'\n```\n\n### Database Direct Query\n\n```sql\n-- Run in Supabase SQL Editor to check data\nSELECT COUNT(*) as total_campaigns FROM campaigns;\nSELECT COUNT(*) as total_leads FROM leads;\nSELECT * FROM campaigns ORDER BY created_at DESC LIMIT 5;\n```\n\n## Performance Benchmarks\n\n### Expected Response Times\n\n- **Authentication**: < 500ms\n- **Health Check**: < 30 seconds total\n- **Auth Pattern Test**: < 15 seconds total\n- **Campaign Discovery**: < 2 seconds initiation\n- **Background Processing**: < 60 seconds for 3 leads\n- **Export Generation**: < 10 seconds for 100 leads\n\n### Quality Targets\n\n- **Phone Coverage**: > 95% (Google Places API)\n- **Website Coverage**: > 90% (Google Places API)\n- **Email Accuracy**: > 95% (Hunter.io + NeverBounce)\n- **Zero Fake Data**: 100% verified contacts only\n\n## Common Issues & Solutions\n\n### Issue: \"Invalid JWT\"\n\n**Symptoms**: 401 errors, authentication failures\n**Solution**:\n\n1. Get fresh session token from browser\n2. Verify token hasn't expired\n3. Check for typos in JWT string\n\n### Issue: \"Discovery Returns No Results\"\n\n**Symptoms**: Campaign completes with 0 leads\n**Solution**:\n\n1. Check Google Places API quota\n2. Try different location (e.g., \"New York, NY\")\n3. Verify business type in taxonomy\n\n### Issue: \"Frontend Won't Load\"\n\n**Symptoms**: Blank page, 404 errors\n**Solution**:\n\n1. Check Vercel deployment status\n2. Clear browser cache\n3. Try incognito window\n4. Verify DNS resolution\n\n### Issue: \"Slow Performance\"\n\n**Symptoms**: Long response times, timeouts\n**Solution**:\n\n1. Check external API response times\n2. Monitor Edge Function logs for bottlenecks\n3. Verify database query performance\n4. Check network connectivity\n\n## Validation Workflow\n\n1. **Pre-Validation Setup**\n\n   - Ensure clean browser session\n   - Verify all platform dashboards accessible\n   - Confirm MCP server running (if needed)\n\n2. **Basic System Validation**\n\n   ```bash\n   ./scripts/production-health-check.sh\n   ```\n\n3. **Authentication Security Validation**\n\n   ```bash\n   ./scripts/test-auth-patterns.sh YOUR_SESSION_JWT\n   ```\n\n4. **End-to-End Campaign Validation**\n\n   ```bash\n   ./scripts/campaign-validation.sh YOUR_SESSION_JWT\n   ```\n\n5. **Post-Validation Analysis**\n   - Review generated campaign data in Supabase\n   - Verify lead quality and accuracy\n   - Check cost efficiency and API usage\n\nThis toolkit provides comprehensive validation capabilities for maintaining ProspectPro v4.3 in production with rapid issue identification and resolution.\n"}}},
{"type":"measure","name":"lsp.did_open","count":63,"duration":3.013},
{"type":"mark","name":"lsp.did_open","count":64,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/database/cleanup-queries.sql","languageId":"sql","version":1,"text":"-- ProspectPro v4.3 Database Cleanup Queries\n-- Run these in Supabase SQL Editor to identify cleanup candidates\n\n-- 1. Find test/development campaigns (safe to remove)\n-- Look for campaigns with test patterns in IDs or session user IDs\nSELECT \n  id, business_type, location, status, results_count, \n  total_cost, created_at, user_id, session_user_id\nFROM campaigns \nWHERE \n  id LIKE '%test%' \n  OR id LIKE '%debug%'\n  OR id LIKE '%validation%'\n  OR session_user_id LIKE '%test%'\n  OR session_user_id LIKE '%debug%'\nORDER BY created_at DESC;\n\n-- 2. Find old completed campaigns (older than 30 days)\n-- These might be candidates for archival\nSELECT \n  id, business_type, location, status, results_count, \n  total_cost, created_at, user_id\nFROM campaigns \nWHERE \n  created_at < NOW() - INTERVAL '30 days'\n  AND status = 'completed'\nORDER BY created_at ASC\nLIMIT 20;\n\n-- 3. Find orphaned leads (campaigns that no longer exist)\n-- These should be cleaned up\nSELECT \n  l.id, l.campaign_id, l.business_name, l.created_at\nFROM leads l\nLEFT JOIN campaigns c ON l.campaign_id = c.id\nWHERE c.id IS NULL\nLIMIT 10;\n\n-- 4. Find large campaigns that might need review\n-- Campaigns with unusually high lead counts or costs\nSELECT \n  id, business_type, location, results_count, total_cost,\n  (total_cost / NULLIF(results_count, 0)) as cost_per_lead,\n  created_at, user_id\nFROM campaigns \nWHERE \n  results_count > 100 \n  OR total_cost > 100\nORDER BY total_cost DESC\nLIMIT 10;\n\n-- 5. Find old dashboard exports (older than 7 days)\n-- Export records can usually be cleaned up after a week\nSELECT \n  id, campaign_id, export_type, file_format, row_count,\n  export_status, created_at, user_id\nFROM dashboard_exports \nWHERE created_at < NOW() - INTERVAL '7 days'\nORDER BY created_at ASC\nLIMIT 20;\n\n-- 6. Database storage summary\n-- Check overall table sizes and row counts\nSELECT \n  'campaigns' as table_name,\n  COUNT(*) as row_count,\n  MIN(created_at) as oldest_record,\n  MAX(created_at) as newest_record\nFROM campaigns\nUNION ALL\nSELECT \n  'leads' as table_name,\n  COUNT(*) as row_count,\n  MIN(created_at) as oldest_record,\n  MAX(created_at) as newest_record\nFROM leads\nUNION ALL\nSELECT \n  'dashboard_exports' as table_name,\n  COUNT(*) as row_count,\n  MIN(created_at) as oldest_record,\n  MAX(created_at) as newest_record\nFROM dashboard_exports;\n\n-- 7. Identify potentially problematic campaigns\n-- Campaigns stuck in processing or with errors\nSELECT \n  id, business_type, location, status, results_count,\n  processing_time_ms, created_at, updated_at\nFROM campaigns \nWHERE \n  status = 'processing' \n  OR (status = 'completed' AND results_count = 0)\n  OR processing_time_ms > 300000 -- More than 5 minutes\nORDER BY created_at DESC\nLIMIT 10;\n\n-- CLEANUP COMMANDS (Run after reviewing results above)\n-- =================================================\n\n-- Clean up test campaigns and their leads\n-- DELETE FROM leads WHERE campaign_id IN (\n--   SELECT id FROM campaigns WHERE \n--   id LIKE '%test%' OR id LIKE '%debug%' OR id LIKE '%validation%'\n-- );\n-- DELETE FROM campaigns WHERE \n--   id LIKE '%test%' OR id LIKE '%debug%' OR id LIKE '%validation%';\n\n-- Clean up orphaned leads\n-- DELETE FROM leads WHERE id IN (\n--   SELECT l.id FROM leads l\n--   LEFT JOIN campaigns c ON l.campaign_id = c.id\n--   WHERE c.id IS NULL\n-- );\n\n-- Clean up old dashboard exports\n-- DELETE FROM dashboard_exports \n-- WHERE created_at < NOW() - INTERVAL '30 days';\n\n-- Reset stuck campaigns to failed status\n-- UPDATE campaigns \n-- SET status = 'failed', updated_at = NOW()\n-- WHERE status = 'processing' \n-- AND created_at < NOW() - INTERVAL '1 hour';"}}},
{"type":"measure","name":"lsp.did_open","count":64,"duration":0.048},
{"type":"mark","name":"lsp.did_open","count":65,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/mcp-servers/package.json","languageId":"json","version":1,"text":"{\n    \"name\": \"prospectpro-mcp-servers\",\n    \"version\": \"2.1.0\",\n    \"description\": \"Consolidated MCP servers for ProspectPro Supabase-First AI development\",\n    \"main\": \"production-server.js\",\n    \"scripts\": {\n        \"start:production\": \"node production-server.js\",\n        \"start:development\": \"node development-server.js\",\n        \"start:troubleshooting\": \"node supabase-troubleshooting-server.js\",\n        \"start:all\": \"concurrently \\\"npm run start:production\\\" \\\"npm run start:development\\\" \\\"npm run start:troubleshooting\\\"\",\n        \"test\": \"node test-servers.js\",\n        \"validate\": \"npm run test && echo 'âœ… All Supabase MCP servers validated successfully'\",\n        \"install:deps\": \"npm install\",\n        \"debug:anon-key\": \"echo 'Use troubleshooting server: diagnose_anon_key_mismatch tool'\",\n        \"debug:edge-functions\": \"echo 'Use troubleshooting server: test_edge_function tool'\",\n        \"debug:database\": \"echo 'Use troubleshooting server: validate_database_permissions tool'\"\n    },\n    \"dependencies\": {\n        \"@modelcontextprotocol/sdk\": \"^1.18.2\",\n        \"@supabase/supabase-js\": \"^2.58.0\"\n    },\n    \"devDependencies\": {\n        \"concurrently\": \"^8.2.2\"\n    },\n    \"keywords\": [\n        \"mcp\",\n        \"model-context-protocol\",\n        \"ai\",\n        \"prospectpro\",\n        \"supabase\",\n        \"edge-functions\",\n        \"serverless\"\n    ],\n    \"author\": \"Alex Torelli\",\n    \"license\": \"MIT\"\n}"}}},
{"type":"measure","name":"lsp.did_open","count":65,"duration":0.033},
{"type":"mark","name":"lsp.did_open","count":66,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/package.json","languageId":"json","version":1,"text":"{\r\n  \"name\": \"prospectpro-verified-business-intelligence\",\r\n  \"version\": \"4.1.0\",\r\n  \"type\": \"module\",\r\n  \"description\": \"ProspectPro - Verified Business Intelligence Platform with Zero Fake Data Policy\",\r\n  \"scripts\": {\r\n    \"dev\": \"vite\",\r\n    \"dev:supabase\": \"supabase functions serve --no-verify-jwt --debug\",\r\n    \"deploy:critical\": \"supabase functions deploy business-discovery-optimized && supabase functions deploy enrichment-orchestrator\",\r\n    \"deploy:all\": \"supabase functions deploy business-discovery-optimized && supabase functions deploy enrichment-orchestrator && supabase functions deploy campaign-export && supabase functions deploy enrichment-hunter\",\r\n    \"test:edge\": \"curl -X POST 'http://localhost:54321/functions/v1/business-discovery-optimized' -H 'Content-Type: application/json' -d '{\\\"businessType\\\":\\\"test\\\",\\\"location\\\":\\\"test\\\"}'\",\r\n    \"logs:live\": \"supabase functions logs --follow\",\r\n    \"logs:errors\": \"supabase functions logs --filter=error\",\r\n    \"mcp:prod\": \"cd mcp-servers && npm run start:production\",\r\n    \"mcp:dev\": \"cd mcp-servers && npm run start:development\",\r\n    \"mcp:debug\": \"cd mcp-servers && npm run start:troubleshooting\",\r\n    \"frontend:build\": \"npm run build\",\r\n    \"frontend:deploy\": \"npm run build && cd dist && vercel --prod\",\r\n    \"static:deploy\": \"npm run build && cd dist && vercel --prod\",\r\n    \"health:check\": \"curl -f https://prospectpro.appsmithery.co/ || echo 'Health check failed'\",\r\n    \"cost:analyze\": \"echo 'Check GitHub billing dashboard for usage trends'\",\r\n    \"build\": \"tsc && vite build && echo '{\\\"version\\\":2,\\\"rewrites\\\":[{\\\"source\\\":\\\"/(.*)\\\",\\\"destination\\\":\\\"/index.html\\\"}],\\\"headers\\\":[{\\\"source\\\":\\\"/(.*)\\\",\\\"headers\\\":[{\\\"key\\\":\\\"Cache-Control\\\",\\\"value\\\":\\\"public, max-age=0, s-maxage=0, must-revalidate\\\"}]},{\\\"source\\\":\\\"/assets/(.*)\\\",\\\"headers\\\":[{\\\"key\\\":\\\"Cache-Control\\\",\\\"value\\\":\\\"public, max-age=31536000, immutable\\\"}]}]}' > dist/vercel.json\",\r\n    \"preview\": \"vite preview\",\r\n    \"lint\": \"eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0\",\r\n    \"type-check\": \"tsc --noEmit\",\r\n    \"build:static\": \"npm run build\",\r\n    \"deploy:vercel\": \"vercel --prod\",\r\n    \"deploy:netlify\": \"netlify deploy --prod --dir=dist\",\r\n    \"deploy:gcs\": \"npm run build && gsutil -m rsync -r -d ./dist/ gs://prospectpro-static-frontend/\",\r\n    \"serve:local\": \"npm run preview\",\r\n    \"test:edge-functions\": \"supabase functions serve\",\r\n    \"deploy:edge-functions\": \"supabase functions deploy business-discovery && supabase functions deploy business-discovery-optimized && supabase functions deploy campaign-export\",\r\n    \"db:setup\": \"echo 'Run SQL from /database/supabase-first-schema.sql in Supabase dashboard'\",\r\n    \"db:status\": \"supabase db status\",\r\n    \"functions:list\": \"supabase functions list\",\r\n    \"functions:logs\": \"supabase functions logs\",\r\n    \"clean\": \"rm -rf dist/ node_modules/ && echo 'Cleaned build artifacts'\",\r\n    \"archive:legacy\": \"mkdir -p archive/legacy-server && mv server.js api/ modules/ docker/ archive/legacy-server/ 2>/dev/null || echo 'Legacy files managed separately'\",\r\n    \"health\": \"echo 'Use Edge Function endpoints for health checks'\",\r\n    \"test\": \"echo 'Test Edge Functions via Supabase dashboard or curl'\",\r\n    \"test:verified-contacts\": \"echo 'Test verified contact discovery with zero fake data validation'\",\r\n    \"mcp:install\": \"cd mcp-servers && npm install\",\r\n    \"mcp:test\": \"cd mcp-servers && npm run test\",\r\n    \"mcp:start\": \"cd mcp-servers && npm run start:all\",\r\n    \"mcp:troubleshoot\": \"cd mcp-servers && npm run start:troubleshooting\",\r\n    \"debug:quick\": \"echo 'Common issue: Check anon key sync and verified contact authentication'\",\r\n    \"debug:edge-function\": \"echo 'Test Verified Edge Function: curl -X POST https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-optimized -H \\\"Authorization: Bearer YOUR_ANON_KEY\\\" -H \\\"Content-Type: application/json\\\" -d \\\"{\\\\\\\"businessType\\\\\\\": \\\\\\\"test\\\\\\\", \\\\\\\"location\\\\\\\": \\\\\\\"test\\\\\\\"}\\\"'\",\r\n    \"debug:vercel\": \"echo 'Check Vercel deployment: curl -I https://your-vercel-url.vercel.app'\",\r\n    \"debug:fake-data\": \"echo 'Verify zero fake data: Check CSV exports for pattern emails (info@, contact@, etc.)'\"\r\n  },\r\n  \"keywords\": [\r\n    \"verified-business-intelligence\",\r\n    \"professional-contacts\",\r\n    \"apollo-api\",\r\n    \"chamber-of-commerce\",\r\n    \"professional-licensing\",\r\n    \"zero-fake-data\",\r\n    \"supabase\",\r\n    \"edge-functions\",\r\n    \"verified-contacts\"\r\n  ],\r\n  \"author\": \"Alex Torelli\",\r\n  \"license\": \"MIT\",\r\n  \"dependencies\": {\r\n    \"@googlemaps/js-api-loader\": \"^2.0.1\",\r\n    \"@supabase/supabase-js\": \"^2.39.0\",\r\n    \"@tanstack/react-query\": \"^5.17.0\",\r\n    \"clsx\": \"^2.0.0\",\r\n    \"lucide-react\": \"^0.294.0\",\r\n    \"react\": \"^18.2.0\",\r\n    \"react-dom\": \"^18.2.0\",\r\n    \"react-router-dom\": \"^6.20.1\",\r\n    \"recharts\": \"^2.8.0\",\r\n    \"tailwind-merge\": \"^2.2.0\",\r\n    \"zustand\": \"^4.4.7\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/react\": \"^18.2.43\",\r\n    \"@types/react-dom\": \"^18.2.17\",\r\n    \"@typescript-eslint/eslint-plugin\": \"^6.14.0\",\r\n    \"@typescript-eslint/parser\": \"^6.14.0\",\r\n    \"@vitejs/plugin-react\": \"^4.2.1\",\r\n    \"autoprefixer\": \"^10.4.16\",\r\n    \"eslint\": \"^8.55.0\",\r\n    \"eslint-plugin-react\": \"^7.37.5\",\r\n    \"eslint-plugin-react-hooks\": \"^4.6.0\",\r\n    \"eslint-plugin-react-refresh\": \"^0.4.5\",\r\n    \"postcss\": \"^8.4.32\",\r\n    \"tailwindcss\": \"^3.3.6\",\r\n    \"typescript\": \"^5.2.2\",\r\n    \"vite\": \"^5.0.8\"\r\n  },\r\n  \"engines\": {\r\n    \"node\": \"22.x\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/Alextorelli/ProspectPro\"\r\n  },\r\n  \"architecture\": {\r\n    \"frontend\": \"Static HTML/JS with verified contact display\",\r\n    \"backend\": \"Supabase Edge Functions with zero fake data\",\r\n    \"database\": \"Supabase PostgreSQL with verification tracking\",\r\n    \"contacts\": \"Apollo API + Professional Licensing + Chamber Directories\",\r\n    \"dataPolicy\": \"Zero fake data - verified contacts only\",\r\n    \"hosting\": \"Static hosting (Cloud Storage/CDN)\",\r\n    \"deployment\": \"Supabase CLI + gsutil\"\r\n  }\r\n}\r\n"}}},
{"type":"measure","name":"lsp.did_open","count":66,"duration":0.054},
{"type":"mark","name":"lsp.did_open","count":67,"args":{"textDocument":{"uri":"vscode-userdata:/c%3A/Users/Alext/AppData/Roaming/Code/User/settings.json","languageId":"jsonc","version":1,"text":"{\n  \"window.autoDetectColorScheme\": true,\n  \"github.copilot.nextEditSuggestions.enabled\": true,\n  \"security.workspace.trust.untrustedFiles\": \"open\",\n  \"python.analysis.typeCheckingMode\": \"standard\",\n  \"mssql.connectionGroups\": [\n    {\n      \"name\": \"ROOT\",\n      \"id\": \"6DE9C5E9-9E3A-47B4-8BEA-50B0A7E5E108\"\n    }\n  ],\n  \"database-client.autoSync\": true,\n  \"git.openRepositoryInParentFolders\": \"always\",\n  \"editor.cursorBlinking\": \"expand\",\n  \"editor.wordWrap\": \"on\",\n  \"files.autoSave\": \"onWindowChange\",\n  \"editor.bracketPairColorization.independentColorPoolPerBracketType\": true,\n  \"editor.formatOnSave\": true,\n  \"workbench.iconTheme\": \"vira-icons-teal\",\n  \"mssql.autoDisableNonTSqlLanguageService\": true,\n  \"git.enableSmartCommit\": true,\n  \"git.confirmSync\": false,\n  \"git.autofetch\": true,\n  \"chat.tools.terminal.autoApprove\": {\n    \"0\": true,\n    \"1\": true,\n    \"git push\": true,\n    \"git add\": true,\n    \"git commit\": true,\n    \"node\": true,\n    \"Move-Item\": true,\n    \"Copy-Item\": true,\n    \"script\\\\.\": true,\n    \"old\": true,\n    \"temp\": true,\n    \"backup\\\"\": true,\n    \"nslookup\": true,\n    \"Remove-Item\": true,\n    \"Rename-Item\": true,\n    \"Invoke-WebRequest\": true,\n    \"\\\"apikey\\\"=\\\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2eGRwcmdmbHR6Ymx3dnBlZHB4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjQ3MTgzOTksImV4cCI6MjA0MDI5NDM5OX0.TZ9kR6FfNvnZMJF9P6NX6rYSVfM3LRw7BfGK7U6YXwc\\\"}\": true,\n    \"\\\"apikey\\\"=\\\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2eGRwcmdmbHR6Ymx3dnBlZHB4Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcyNDcxODM5OSwiZXhwIjoyMDQwMjk0Mzk5fQ.sOZBWJfb4MvqA2B6dxPCUaGr3zqZCXF7tHv1NjM5QwE\\\"}\": true,\n    \"git rebase\": true,\n    \"npm start\": true,\n    \"const\": true,\n    \"console.log('âœ…\": true,\n    \"\\\"\": true,\n    \"try\": true,\n    \"}\": true,\n    \"}\\\"\": true,\n    \"powershell\": true,\n    \"Test-Path\": true,\n    \"Start-Process\": true,\n    \"git rm\": true,\n    \"git reset\": true,\n    \"git commit -m \\\"fix: resolve Railway deployment crashes with robust import patterns\\n\\n- Fix api/dashboard-export.js with try/catch fallback for module resolution\\n- Remove problematic files with secrets (Grafana API tokens)  \\n- Add comprehensive deployment documentation and health checks\\n- Implement monitoring dashboard with HTML/CSS/JS instead of Grafana\\n- Add Railway troubleshooting tools and deployment guides\\n- Update package.json with Railway-compatible configuration\\n\\nResolves module import errors and GitHub secret scanning blocks.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"(async\": true,\n    \"{\": true,\n    \"if\": true,\n    \"console.log('ðŸ“Š\": true,\n    \"git commit -m \\\"optimize: leverage Railway analytics, simplify monitoring architecture\\n\\nðŸŽ¯ Strategic Changes:\\n- Replace complex custom monitoring with Railway's built-in analytics\\n- Focus only on ProspectPro business metrics (campaigns, leads, costs)\\n- Remove redundant infrastructure monitoring (Railway handles this)\\n- Simplify dashboard to essential business KPIs only\\n\\nâœ… Benefits:\\n- 70% reduction in monitoring code complexity\\n- Better reliability using Railway's native capabilities\\n- Focus on business value rather than infrastructure metrics\\n- Faster deployment and fewer moving parts\\n\\nðŸš€ Railway Integration:\\n- Use Railway dashboard for: CPU, Memory, Network, Logs, Uptime\\n- Custom dashboard for: Campaign success, Lead qualification, API costs\\n- Simplified health checks focused on business logic\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"npm outdated\": true,\n    \"=20.0.0\": true,\n    \"npm install\": true,\n    \"Enrichment\": true,\n    \"Validation\": true,\n    \"Export)\": true,\n    \"git remote\": true,\n    \"git fetch\": true,\n    \"git ls-files\": true,\n    \"california\\\\\": true,\n    \"newyork\\\\\": true,\n    \"ny-tax\\\\\": true,\n    \"UPDATED_DEPLOYMENT\\\"\": true,\n    \"california\": true,\n    \"newyork\": true,\n    \"ny-tax\": true,\n    \"UPDATED_DEPLOYMENT)\\\"\": true,\n    \"git rev-parse\": true,\n    \"git add config/supabase.js server.js && git commit -m \\\"feat(diagnostics): enhanced Supabase diagnostics, /diag endpoint, improved health reporting\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git add server.js config/supabase.js && git commit -m \\\"feat(diagnostics): degraded mode, detailed error + network probes, periodic retries, richer /diag\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl\": true,\n    \"ALLOW_DEGRADED_START=true\": true,\n    \"export\": true,\n    \"kill\": true,\n    \"unset\": true,\n    \"global\": true,\n    \"PORT=3000\": true,\n    \"killall\": true,\n    \"git add server.js railway.toml && git commit -m \\\"fix(deployment): bind to 0.0.0.0 for Railway Edge Proxy, remove hardcoded PORT override\\n\\n- Railway requires apps to listen on 0.0.0.0, not localhost\\n- Remove PORT=8080 override in railway.toml to let Railway set it dynamically  \\n- Default to PORT 3000 to match Railway conventions\\n- This should resolve 502 Bad Gateway errors from Railway load balancer\\\" && git push origin main\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"SUPABASE_URL=test\": true,\n    \"SUPABASE_URL=https://test.supabase.co\": true,\n    \"pkill\": true,\n    \"cd /workspaces/ProspectPro && git add -A && git commit -m \\\"fix: Update Railway networking for 502 errors + align docs with sb_secret_* key format\\n\\n- Fix Express server to bind 0.0.0.0:PORT (Railway requirement) \\n- Remove hardcoded PORT=8080 from railway.toml (use dynamic PORT)\\n- Update all documentation to prioritize SUPABASE_SECRET_KEY over legacy keys\\n- Remove deprecated UPDATED_DEPLOYMENT_GUIDE.md\\n- Update validation scripts to support new key precedence\\n- Maintain backward compatibility for existing deployments\\n- Align docs with user's actual Railway setup (port 8038, sb_secret_* keys)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git add railway.toml && git commit -m \\\"fix: Clean up railway.toml - remove invalid configuration sections\\n\\n- Remove [observability] section (not supported by Railway)\\n- Remove [admin] section (not supported by Railway) \\n- Keep only valid Railway configuration sections\\n- Simplify environment variable documentation\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"SUPABASE_URL=https://example.supabase.co\": true,\n    \"RLS\": true,\n    \"service\": true,\n    \"anon\": true,\n    \"publishable)\\\\n-\": true,\n    \"improve\": true,\n    \"cd /workspaces/ProspectPro && git add server.js database/rls-hardening.sql .env.example && git commit -m \\\"chore: add runtime introspection & RLS hardening guidance\\\\n\\\\n- Added /env-snapshot, request logging, memory stats in /diag\\\\n- Added port fallback warning\\\\n- Added database/rls-hardening.sql with policy templates\\\\n- Updated .env.example (avoid PORT on Railway)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git add server.js database/rls-hardening.sql && git commit -m \\\"feat: instrumentation (/env-snapshot /loop-metrics) + RLS hardening script placeholder\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"getLastSupabaseDiagnostics,\": true,\n    \"console.log('Functions\": true,\n    \"BootPhaseDebugger\": true,\n    \"ProspectProMetrics\": true,\n    \"SecurityHardening\": true,\n    \"npm list\": true,\n    \"timeout\": true,\n    \"rm\": true,\n    \"psql\": true,\n    \"/dev/null\": true,\n    \"gh\": true,\n    \"console.log('=====================================================')\": true,\n    \"console.log('')\": true,\n    \"console.log('\": true,\n    \"console.log('ðŸŽ¯\": true,\n    \"console.log('1.\": true,\n    \"console.log('2.\": true,\n    \"console.log('3.\": true,\n    \"console.log('ðŸŽ‰\": true,\n    \"console.log('ðŸ”\": true,\n    \"let\": true,\n    \"//\": true,\n    \"[]).length\": true,\n    \"issues.push(\\\\`âš ï¸\": true,\n    \"openParens}\": true,\n    \"closeParens}\": true,\n    \"')\": true,\n    \"!lastStatement.startsWith('--'))\": true,\n    \"issues.push('âš ï¸\": true,\n    \"console.log('âŒ\": true,\n    \"issues.forEach(issue\": true,\n    \"console.log(issue))\": true,\n    \"issues.push('Unbalanced\": true,\n    \"issues.push('system_settings\": true,\n    \"issues.push('Found\": true,\n    \"mv\": true,\n    \"true\": true,\n    \"createClient\": true,\n    \"console.log('ðŸ”—\": true,\n    \"supabase.from('information_schema.tables').select('table_name').limit(1).then(result\": true,\n    \"}).catch(err\": true,\n    \"console.error('âŒ\": true,\n    \"SUPABASE_URL=https://sriycekxdqnesdsgwiuc.supabase.co\": true,\n    \"git branch\": true,\n    \"git checkout\": true,\n    \".env\": true,\n    \"source\": true,\n    \"xargs)\": true,\n    \"#SUPABASE_SERVICE_ROLE_KEY}\\\"\": true,\n    \"cp\": true,\n    \"modules/security-hardening.js\": true,\n    \"'EOF'\": true,\n    \"class\": true,\n    \"constructor(options\": true,\n    \"})\": true,\n    \"this.options\": true,\n    \"enableSecureHeaders:\": true,\n    \"this.options.adminTokens.add(process.env.PERSONAL_ACCESS_TOKEN)\": true,\n    \"console.log('ðŸ›¡ï¸\": true,\n    \"app.use((req,\": true,\n    \"res.removeHeader('X-Powered-By')\": true,\n    \"res.setHeader('X-Frame-Options',\": true,\n    \"res.setHeader('X-Content-Type-Options',\": true,\n    \"res.setHeader('X-ProspectPro-Security',\": true,\n    \"next()\": true,\n    \"return\": true,\n    \"req.headers['x-admin-token']\": true,\n    \"!this.options.adminTokens.has(token))\": true,\n    \"error:\": true,\n    \"authenticated:\": true,\n    \"process.env.NODE_ENV\": true,\n    \"status:\": true,\n    \"secureHeaders:\": true,\n    \"function\": true,\n    \"globalSecurity\": true,\n    \"security.applySecurityMiddleware(app)\": true,\n    \"EOF\": true,\n    \"general:\": true,\n    \"res.send\": true,\n    \"=\": true,\n    \"console.warn(`âš ï¸\": true,\n    \"res.statusCode}\": true,\n    \"req.method}\": true,\n    \"req.path}`)\": true,\n    \"middleware.general.forEach(mw\": true,\n    \"app.use(mw))\": true,\n    \"app.use(this.getSecurityLogger())\": true,\n    \"'https://sriycekxdqnesdsgwiuc.supabase.co'\": true,\n    \"'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Nzk2NTc4OSwiZXhwIjoyMDczNTQxNzg5fQ.V2wlvxGC1_SshWudFw27ZWmQjuxj0UtXANXrZmt4OjY'\": true,\n    \"async\": true,\n    \"data,\": true,\n    \"process.exit(success\": true,\n    \"testConnection\": true,\n    \"testConnection().then(result\": true,\n    \"supabase.auth.getSession().then(result\": true,\n    \"error.message.includes('relation')\": true,\n    \"error.message.includes('does\": true,\n    \"console.log('-\": true,\n    \"require('./config/supabase').testConnection().then(result\": true,\n    \"console.error('Database\": true,\n    \"node -e \\\"console.log('Testing environment...'); require('./config/supabase').testConnection().then(result => console.log('Database test:', result)).catch(err => console.error('Database error:', err))\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"node -e \\\"require('dotenv').config(); console.log('Testing with dotenv...'); require('./config/supabase').testConnection().then(result => console.log('Database test:', result.success ? 'SUCCESS' : 'FAILED', result)).catch(err => console.error('Database error:', err))\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"supabase.getSupabaseClient().from('campaigns').select('count').limit(1).then(result\": true,\n    \"console.error('Table\": true,\n    \"k.includes('SUPABASE')))\": true,\n    \"result.success)\": true,\n    \"console.error('Test\": true,\n    \"powershell -Command \\\"try { $response = Invoke-WebRequest -Uri 'http://localhost:3000/health' -UseBasicParsing; Write-Host 'Health check: Status' $response.StatusCode; Write-Host 'Response:' $response.Content } catch { Write-Host 'Error:' $_.Exception.Message }\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -s http://localhost:3000/health | ConvertFrom-Json\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"require('./config/supabase').testConnection().then(r=\": true,\n    \"console.log(JSON.stringify(r,\": true,\n    \"}).catch(e=\": true,\n    \"Invoke-RestMethod\": true,\n    \"ConvertTo-Json\": true,\n    \"Get-Process\": true,\n    \"Stop-Process\": true,\n    \"sh\": true,\n    \"tar\": true,\n    \"sudo\": true,\n    \"./supabase\": true,\n    \".gitignore\": true,\n    \"git commit -m \\\"feat: major refactor - integrate real API pipeline with zero fake data\\n\\n- Fix devcontainer Supabase CLI installation to use official installer\\n- Implement 4-stage lead processing pipeline (Discovery â†’ Enrichment â†’ Validation â†’ Export)  \\n- Add comprehensive real data validation with confidence scoring\\n- Integrate Google Places, Hunter.io, NeverBounce APIs\\n- Add cost optimization and budget tracking\\n- Enhance monitoring and webhook processing\\n- Update all documentation and deployment configs\\n- Add build artifacts to gitignore\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"supabase\": true,\n    \"then\": true,\n    \"console.log('âš ï¸\": true,\n    \"console.log('ðŸ’¡\": true,\n    \"npm run dev\": true,\n    \"DEBUG=*\": true,\n    \"supabase_cli)\\\"\": true,\n    \"npm i\": true,\n    \"npx\": true,\n    \"git add . && git commit -m \\\"fix: properly configure Supabase CLI installation in devcontainer\\n\\n- Use npm dev dependency installation method (npx supabase)\\n- Remove manual binary workarounds  \\n- Follow official Supabase CLI installation guidelines\\n- Clean up build artifacts and temporary files\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git merge\": true,\n    \"newgrp\": true,\n    \"deno\": true,\n    \"docker --version\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"docker ps\": true,\n    \"lsof\": true,\n    \"curl -X POST http://localhost:8000 -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"italian restaurants\\\", \\\"location\\\": \\\"New York\\\", \\\"budgetCents\\\": 100}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"jq\": true,\n    \"sleep 2 && curl -s -X POST http://localhost:8000 -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"italian restaurants\\\", \\\"location\\\": \\\"New York\\\", \\\"budgetCents\\\": 100}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -s -X POST http://localhost:8000 -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"coffee shops\\\", \\\"budgetCents\\\": 50}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -s -X POST http://localhost:8000 -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"gym\\\", \\\"budgetCents\\\": 2}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"sleep 2 && curl -X POST http://localhost:8080 -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\":\\\"restaurants\\\",\\\"location\\\":\\\"San Francisco, CA\\\"}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git add . && git commit -m \\\"feat: implement business discovery Edge Function with local testing\\n\\nâœ… Built ProspectPro business discovery Edge Function:\\n- Real API integration with Google Places (production ready)\\n- Zero fake data policy enforced\\n- Confidence scoring for business validation (70%+ threshold)\\n- Cost tracking and optimization ($0.032 per search)\\n- CORS support for cross-origin requests\\n- Comprehensive error handling\\n\\nâœ… Created local testing infrastructure:\\n- Standalone test server for development\\n- Mock data pipeline for offline testing\\n- JSON API responses with business metadata\\n- Quality scoring (address, rating, reviews, website presence)\\n\\nâœ… Validated Edge Function logic:\\n- Successfully processes business discovery requests\\n- Returns qualified leads with 100% confidence scores\\n- Proper TypeScript interfaces and error handling\\n- Ready for Supabase Edge Runtime deployment\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git add . && git commit -m \\\"feat: complete Edge Functions lead validation pipeline\\n\\nâœ… Built Lead Validation Edge Function:\\n- Multi-source validation (websites, emails, phones)\\n- Parallel processing for performance optimization\\n- Configurable validation skipping (website/email checks)\\n- 70% qualification threshold with detailed scoring\\n- Website accessibility testing with HTTP status codes\\n- Email format + domain validation with confidence scoring  \\n- US phone number validation with formatting\\n- Overall lead scoring algorithm (Website 40%, Email 35%, Phone 25%)\\n\\nâœ… Comprehensive Testing Infrastructure:\\n- Multi-function test server handling both endpoints\\n- Full test suite covering success/error scenarios\\n- Mock data validation for offline development\\n- Performance metrics and qualification rate tracking\\n- CORS support for cross-origin integration\\n\\nâœ… Test Results Summary:\\n- Business Discovery: âœ… 2/2 qualified businesses found (100% confidence)\\n- Lead Validation: âœ… 1/2 leads qualified (50% rate, 100% confidence)\\n- Error Handling: âœ… Proper validation for missing fields\\n- Performance: âœ… Parallel processing, sub-second response times\\n\\nðŸŽ¯ Ready for production deployment and main app integration!\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"mkdir\": true,\n    \"rmdir\": true,\n    \"git add -A && git commit -m \\\"feat: Deploy Edge Functions to Supabase\\n\\n- Successfully deployed business-discovery-edge and lead-validation-edge\\n- Fixed function directory structure (moved from ./functions to ./supabase/functions)\\n- Updated deno.json configurations with proper imports\\n- Used Management API deployment to avoid Docker-in-Docker issues\\n- Both functions now live at production URLs and are ACTIVE\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"enhanced-state)\\\"\": true,\n    \"zerobounce\": true,\n    \"integration)\\\"\": true,\n    \"COURTLISTENER\": true,\n    \"SOCRATA\": true,\n    \"USPTO)\\\"\": true,\n    \"require('./modules/api-clients/enhanced-state-registry-client')\": true,\n    \"require('./modules/api-clients/zerobounce-client')\": true,\n    \"npm test\": true,\n    \"console.log('\\\\\\\\nðŸŽ‰\": true,\n    \"chmod\": true,\n    \"./deploy-enhanced-discovery.sh\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"ðŸš€ Enhanced Business Discovery Integration Complete\\n\\nâœ… Complete integration of enhanced APIs with Supabase Edge Functions\\nâœ… Multi-source validation pipeline with 9 API integrations\\nâœ… Cost optimization algorithm with pre-validation scoring\\nâœ… Zero fake data policy with government registry validation\\n\\nKey Features Added:\\n- Enhanced State Registry Client (7 government APIs)\\n- ZeroBounce email validation with budget controls\\n- 4-stage validation pipeline with confidence scoring\\n- Complete TypeScript/Deno implementation for edge functions\\n- Comprehensive deployment guide and automation scripts\\n\\nPerformance Improvements:\\n- 40-60% cost reduction through intelligent pre-validation\\n- 60%+ improvement in lead quality with government validation\\n- Real-time cost tracking and budget management\\n- Scalable edge function architecture\\n\\nFiles Added:\\n- supabase/functions/enhanced-business-discovery/index.ts\\n- supabase/functions/_shared/enhanced-state-registry.ts\\n- supabase/functions/_shared/zerobounce.ts\\n- ENHANCED_DEPLOYMENT_GUIDE.md\\n- INTEGRATION_COMPLETE.md\\n- deploy-enhanced-discovery.sh\\n- test-enhanced-discovery.ts\\n\\nReady for production deployment! ðŸŽ¯\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git commit --no-gpg-sign -m \\\"ðŸš€ Enhanced Business Discovery Integration Complete\\n\\nâœ… Complete integration of enhanced APIs with Supabase Edge Functions\\nâœ… Multi-source validation pipeline with 9 API integrations  \\nâœ… Cost optimization algorithm with pre-validation scoring\\nâœ… Zero fake data policy with government registry validation\\n\\nKey Features Added:\\n- Enhanced State Registry Client (7 government APIs)\\n- ZeroBounce email validation with budget controls\\n- 4-stage validation pipeline with confidence scoring\\n- Complete TypeScript/Deno implementation for edge functions\\n- Comprehensive deployment guide and automation scripts\\n\\nPerformance Improvements:\\n- 40-60% cost reduction through intelligent pre-validation\\n- 60%+ improvement in lead quality with government validation\\n- Real-time cost tracking and budget management\\n- Scalable edge function architecture\\n\\nFiles Added:\\n- supabase/functions/enhanced-business-discovery/index.ts\\n- supabase/functions/_shared/enhanced-state-registry.ts\\n- supabase/functions/_shared/zerobounce.ts\\n- ENHANCED_DEPLOYMENT_GUIDE.md\\n- INTEGRATION_COMPLETE.md\\n- deploy-enhanced-discovery.sh\\n- test-enhanced-discovery.ts\\n\\nReady for production deployment! ðŸŽ¯\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"ts\": true,\n    \"md)$\\\"\": true,\n    \"xargs\": true,\n    \"cd /workspaces/ProspectPro && git commit --no-gpg-sign -m \\\"ðŸ§¹ Repository Cleanup and Refactoring\\n\\n## Major Cleanup Changes:\\n\\n### Directory Organization:\\nâœ… Created `scripts/` directory for utility scripts\\nâœ… Moved all test files to `test/` directory\\nâœ… Created `docs/archive/` for outdated documentation\\nâœ… Organized data mapping files in `docs/`\\n\\n### File Removals:\\nâŒ Removed empty files: test-edge-functions.ts, initialize-database.js, simple-setup.js\\nâŒ Deleted weird artifacts: 'witch main', pectProProspectPro-1\\nâŒ Removed setup-logs/ directory (not needed in version control)\\n\\n### Script Organization:\\nðŸ“ Moved to scripts/: database-setup-helper.js, direct-sql-executor.js, \\n   setup-assistant.js, supabase-validator.js, deploy-enhanced-discovery.sh\\n\\n### Documentation Cleanup:\\nðŸ“š Archived outdated docs: IMPLEMENTATION.md, ENHANCED_APIS_SUMMARY.md,\\n   EDGE_FUNCTIONS_INTEGRATION.md, ENHANCED_INTEGRATION_COMPLETE.md\\nðŸ“– Replaced incorrect Supabase CLI README with comprehensive ProspectPro docs\\nðŸ“„ Updated documentation links and structure\\n\\n### Test File Organization:\\nðŸ§ª Consolidated all test files in test/ directory\\nðŸ”¬ Organized edge function tests logically\\n\\n### Configuration Updates:\\nâš™ï¸ Enhanced .gitignore with proper exclusions for logs and artifacts\\nðŸ”§ Maintained all critical configuration files\\n\\n## Repository Benefits:\\n- âœ… Clean, logical directory structure\\n- âœ… Proper separation of concerns\\n- âœ… Reduced root directory clutter\\n- âœ… Better organization for development\\n- âœ… Comprehensive, accurate README\\n- âœ… Archived outdated documentation properly\\n\\nThe repository now follows best practices with clear organization and \\ncomprehensive documentation reflecting the current ProspectPro architecture.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \".git'\": true,\n    \"cd /workspaces/ProspectPro && echo '--- git status ---' && git status && echo '--- git remote -v ---' && git remote -v && echo '--- git branch -vv ---' && git branch -vv && echo '--- recent commits ---' && git --no-pager log --oneline --decorate -n 5 && echo '--- fetching origin ---' && git fetch origin && echo '--- status after fetch ---' && git status && echo '--- attempting push ---' && git push origin main\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"setup-assistant\": true,\n    \"direct-sql\": true,\n    \"edge-function)\\\"\": true,\n    \"\\\\.sql$\": true,\n    \"\\\\.csv$\": true,\n    \"\\\\.xlsx$\\\"\": true,\n    \"spec)\\\"\": true,\n    \"setup)\\\"\": true,\n    \"git commit -m \\\"Repository cleanup: Remove redundancies and consolidate structure\\n\\n- Documentation: Removed duplicate deployment and frontend guides\\n  â€¢ Merged ENHANCED_DEPLOYMENT_GUIDE.md into comprehensive DEPLOYMENT.md\\n  â€¢ Consolidated frontend docs into FRONTEND_INTEGRATION_GUIDE.md\\n  â€¢ Removed root-level REFACTOR_COMPLETE.md and REPOSITORY_STRUCTURE.md\\n\\n- Setup Scripts: Consolidated to single primary script\\n  â€¢ Removed database-setup-helper.js, setup-assistant.js, modern-setup.js\\n  â€¢ Kept database-master-setup.js as primary database setup tool\\n  â€¢ Removed manual-setup-guide.js (content exists in MANUAL_SETUP_GUIDE.md)\\n\\n- Test Files: Removed duplicate test implementations\\n  â€¢ Removed test-basic-integration.js (similar to test-core-integration.js)\\n  â€¢ Removed test-enhanced-apis.js (kept test-enhanced-apis-full.js)\\n  â€¢ Consolidated similar test functionality\\n\\n- Configuration: Cleaned up unused config files\\n  â€¢ Removed root-level deno.json (functions have individual configs)\\n  â€¢ Removed legacy import_map.json\\n  â€¢ Removed redundant tests/package.json\\n\\n- Artifacts: Removed orphaned files and directories\\n  â€¢ Removed empty enhanced-dashboard-functions.sql\\n  â€¢ Cleaned up artifact directories\\n  â€¢ Updated .gitignore for cleaner exclusions\\n\\nRepository now has clean, logical structure with no redundant files.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git config\": true,\n    \"env\": true,\n    \"PORT\": true,\n    \"NODE)\\\"\": true,\n    \"Admin\": true,\n    \"budget\": true,\n    \"optimization\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"ðŸš€ Enhanced Monitoring & Admin System - Complete Implementation\\n\\nâœ¨ Major Features Added:\\n- Comprehensive monitoring database schema (8 tables)\\n- Real-time dashboard API with 5 REST endpoints\\n- API usage monitoring with cost tracking & budget controls\\n- Enhanced admin dashboard UI with visualizations\\n- Cost budgeting system with multi-tier alerts\\n- Quality metrics tracking for 4-stage validation pipeline\\n- Integration testing suite with health assessment\\n\\nðŸ“Š New Components:\\n- database/07-enhanced-monitoring-schema.sql - Complete monitoring schema\\n- modules/enhanced-api-usage-monitor.js - Real-time API tracking\\n- modules/cost-budgeting-system.js - Budget controls & optimization\\n- api/dashboard-metrics.js - Enhanced with comprehensive endpoints  \\n- public/admin-dashboard.html - Full monitoring visualizations\\n- test/test-enhanced-monitoring-system.js - Integration test suite\\n\\nðŸ§¹ Repository Cleanup:\\n- Consolidated test directories (tests/ â†’ test/)\\n- Removed redundant completion documents\\n- Cleaned up unused directories and files\\n- Streamlined repository structure\\n\\nðŸŽ¯ System Status: Production Ready\\n- 9 API sources integrated (Google Places, Government APIs, etc.)\\n- Real-time cost optimization with auto-pause features  \\n- Quality assurance pipeline with confidence scoring\\n- Business intelligence dashboard with actionable insights\\n- Graceful degradation support for high availability\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"monitoring\": true,\n    \"cost\": true,\n    \"dashboard)\\\"\": true,\n    \"0)\": true,\n    \"diag.recommendations.forEach(rec\": true,\n    \"getSupabaseClient\": true,\n    \"data:\": true,\n    \"console.log('ðŸš€\": true,\n    \"throw\": true,\n    \"s.trim())\": true,\n    \"s.length\": true,\n    \"!s.startsWith('--')\": true,\n    \"!s.startsWith('/*'))\": true,\n    \"console.log(\\\\`ðŸ“\": true,\n    \"statements.length}\": true,\n    \"for\": true,\n    \"i\": true,\n    \"statements.length\": true,\n    \"i++)\": true,\n    \"'\": true,\n    \"stmt.trim().length\": true,\n    \"3)\": true,\n    \"continue\": true,\n    \"sql:\": true,\n    \"error.message.includes('duplicate\": true,\n    \"error.message.includes('ON\": true,\n    \"console.log(\\\\`âš ï¸\": true,\n    \"i+1}:\": true,\n    \"console.log(\\\\`âŒ\": true,\n    \"error.message.slice(0,\": true,\n    \"errorCount++\": true,\n    \"successCount++\": true,\n    \"console.log(\\\\`âœ…\": true,\n    \"successCount}\": true,\n    \"setTimeout(resolve,\": true,\n    \"e.message.slice(0,\": true,\n    \"console.log(\\\\`ðŸ“Š\": true,\n    \"console.log(\\\\`\": true,\n    \"successCount}\\\\`)\": true,\n    \"errorCount}\\\\`)\": true,\n    \"console.log(\\\\`ðŸŽ‰\": true,\n    \"\\\\`\": true,\n    \"ps\": true,\n    \"```\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"Fix: Improve database error handling for missing tables and columns\\n\\n- Enhanced dashboard-metrics.js error handling to gracefully handle:\\n  * Missing tables (does not exist errors)  \\n  * Missing columns (42703 PostgreSQL error code)\\n  * Column reference errors in campaign_analytics queries\\n\\n- Added IMMEDIATE_TABLE_FIX.sql with essential monitoring tables:\\n  * campaign_analytics (fixes campaign_date column error)\\n  * api_usage_logs, lead_validation_pipeline\\n  * RLS policies and performance indexes\\n\\n- Formatted minimal-monitoring-setup.sql for consistency\\n\\nResolves column 'campaign_date' does not exist error while maintaining \\ngraceful degradation when monitoring tables aren't fully deployed.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"require('dotenv').config()\": true,\n    \"app.use('/api/dashboard-metrics',\": true,\n    \"hostname:\": true,\n    \"res.on('data',\": true,\n    \"data\": true,\n    \"res.on('end',\": true,\n    \"req.on('error',\": true,\n    \"console.error('Request\": true,\n    \"server.close()\": true,\n    \"req.end()\": true,\n    \"console.log('ðŸ”§\": true,\n    \"console.log('\\\\nðŸ“‹\": true,\n    \"SQL\": true,\n    \"git commit -m \\\"fix: ensure campaign_analytics table always has required columns (user_id, campaign_date, etc) for dashboard compatibility\\n\\n- Integrated ALTER TABLE statements into 03-monitoring-and-analytics.sql\\n- Future setups will always have correct schema for API and dashboard\\n- No obsolete staged commits remain\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"commit\": true,\n    \"gpg)\\\"\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"fix: ensure campaign_analytics table always has required columns (user_id, campaign_date, etc) for dashboard compatibility\\n\\n- Integrated ALTER TABLE statements into 03-monitoring-and-analytics.sql\\n- Future setups will always have correct schema for API and dashboard\\n- No obsolete staged commits remain\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"API_KEY\": true,\n    \"URL)\\\"\": true,\n    \"!error.message.includes('does\": true,\n    \"table}:\": true,\n    \"error.message}\\\\`)\": true,\n    \"e.message}\\\\`)\": true,\n    \"query:\": true,\n    \"location:\": true,\n    \"json:\": true,\n    \"},\": true,\n    \"(\": true,\n    \"timeRange:\": true,\n    \"name:\": true,\n    \"tables.forEach(table\": true,\n    \"table.name}:\": true,\n    \"table.status}\\\\`)\": true,\n    \"console.log('\\\\nðŸ“\": true,\n    \"console.log('\\\\nðŸ\": true,\n    \"businessType=restaurant\\\"\": true,\n    \"else\": true,\n    \"}))\": true,\n    \"client.from('campaign_analytics').select('*').limit(1).then((\": true,\n    \"cd /workspaces/ProspectPro && node server.js &\\nsleep 2\\ncurl -X POST \\\"http://localhost:3000/api/business/discover\\\" \\\\\\n  -H \\\"Content-Type: application/json\\\" \\\\\\n  -d '{\\\"query\\\": \\\"coffee shop\\\", \\\"location\\\": \\\"San Francisco\\\", \\\"count\\\": 2, \\\"budgetLimit\\\": 3.0}' \\\\\\n  --max-time 10\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git commit -m \\\"ðŸ§¹ Repository cleanup: Remove redundancies and consolidate files\\n\\n- Remove redundant SQL schema fix files (kept FIX_PRODUCTION_SCHEMA.sql)\\n- Remove redundant test/validation scripts (kept final-production-validation.js)  \\n- Remove redundant documentation files (status updates no longer needed)\\n- Remove archive/ and logs/ directories with temporary files\\n- Repository now contains only essential, production-ready files\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"path.basename(filePath)}:\": true,\n    \"hasAlterTable\": true,\n    \"hasCreatePolicy)\": true,\n    \"console.error(\\\\`âŒ\": true,\n    \"schemaFiles.forEach(file\": true,\n    \"allValid\": true,\n    \"console.log(\\\\`\\\\\\\\n\\\\$\": true,\n    \"console.log(\\\\`ðŸ”\": true,\n    \"filePath}:\\\\`)\": true,\n    \"lines.forEach((line,\": true,\n    \"rlsEnabled.push(tableMatch[1])\": true,\n    \"policiesCreated.push(\\\\`\\\\$\": true,\n    \"policyMatch[2]}:\": true,\n    \"policyMatch[1]}\\\\`)\": true,\n    \"rlsEnabled.join(',\": true,\n    \"policiesCreated.length}\\\\`)\": true,\n    \"policiesCreated.forEach(policy\": true,\n    \"policy}\\\\`))\": true,\n    \"checkRLSInFile('database/07-enhanced-monitoring-schema.sql')\": true,\n    \"checkRLSInFile('FIX_PRODUCTION_SCHEMA.sql')\": true,\n    \"console.log('ðŸ“‹\": true,\n    \"migrationFiles.forEach((file,\": true,\n    \"index\": true,\n    \"phase}:\": true,\n    \"migrationFiles.length\": true,\n    \"fixFile}\\\\`)\": true,\n    \"console.log('\\\\\\\\nðŸ”\": true,\n    \"[]\": true,\n    \"alterTableRLSMatches.length\": true,\n    \"createTableMatches.forEach(match\": true,\n    \"table}\\\\`)\": true,\n    \"alterTableRLSMatches.forEach(match\": true,\n    \"checkTableCreationOrder(file))\": true,\n    \"checkTableCreationOrder(fixFile)\": true,\n    \"console.log('\\\\\\\\nâœ…\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"feat: integrate RLS security patches into main schema files\\n\\n- Add RLS enabling and service role policies to 03-monitoring-and-analytics.sql\\n- Ensure proper sequential ordering: table creation before RLS enabling\\n- Remove FIX_PRODUCTION_SCHEMA.sql patch file (fixes now integrated)\\n- All monitoring tables now have secure service role access policies\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"tableMatches.forEach(match\": true,\n    \"allTables.add(tableName)\": true,\n    \"Array.from(allTables).sort().forEach(table\": true,\n    \"console.log('\\\\\\\\nðŸ”’\": true,\n    \"rlsTables.forEach(table\": true,\n    \"table}\": true,\n    \"console.log('ðŸ§ª\": true,\n    \"rlsMatches.forEach(match\": true,\n    \"rlsTables.add(table)\": true,\n    \"policyMatches.forEach(match\": true,\n    \"policies.add(\\\\`\\\\$\": true,\n    \"policyName}\\\\`)\": true,\n    \"Array.from(rlsTables).sort().forEach(table\": true,\n    \"console.log('\\\\\\\\nðŸ›¡ï¸\": true,\n    \"Array.from(policies).sort().forEach(policy\": true,\n    \"policy}\\\\`)\": true,\n    \"console.log('\\\\\\\\nðŸ“Š\": true,\n    \"rlsTables.size}\\\\`)\": true,\n    \"policies.size}\\\\`)\": true,\n    \"rlsTables.has('spatial_ref_sys')\": true,\n    \"cd /workspaces/ProspectPro && git add PRODUCTION_FIXES.sql && git commit -m \\\"fix(sql): avoid ambiguous column/variable names by renaming loop var to target_table\\\" || true\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git add PRODUCTION_FIXES.sql && git commit -m \\\"fix(sql): avoid ambiguous column/variable names by renaming loop var to target_table\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git rm PRODUCTION_FIXES.sql || true && git commit -m \\\"chore(db): remove temporary production fixes script (integrated into database/ scripts)\\\" || true\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git status --porcelain && git add -A && git commit -m \\\"chore(db): remove temporary production fixes script and integrate naming fixes\\\" || true\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"guard\": true,\n    \"cost_per_qualified_lead\": true,\n    \"curl.exe -X POST \\\"http://localhost:3000/api/business/discover\\\" -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\":\\\"owner-operated plumbing companies with under 5 employees in San Francisco\\\",\\\"location\\\":\\\"San Francisco\\\"}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST \\\"http://localhost:3000/api/business/discover\\\" -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\":\\\"owner-operated plumbing companies with under 5 employees in San Francisco\\\",\\\"location\\\":\\\"San Francisco\\\"}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"test_payload.json\": true,\n    \"pre-commit)\\\"\": true,\n    \"Authorization\\\\\": true,\n    \"API\": true,\n    \"api\": true,\n    \"client\": true,\n    \"update\": true,\n    \"}'\": true,\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-edge' -H 'apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Content-Type: application/json' -d '{\\\"query\\\": \\\"restaurants in San Francisco\\\", \\\"limit\\\": 5}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery-edge' -H 'apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Content-Type: application/json' -d '{\\\"query\\\": \\\"restaurants\\\", \\\"location\\\": \\\"San Francisco, CA\\\", \\\"limit\\\": 3}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/lead-validation-edge' -H 'apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Content-Type: application/json' -d '{\\\"businesses\\\": [{\\\"name\\\": \\\"La Mar Cocina Peruana San Francisco\\\", \\\"address\\\": \\\"PIER 1 1/2 The Embarcadero N, San Francisco, CA 94111, United States\\\", \\\"website\\\": \\\"https://lamarsf.com\\\"}]}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/enhanced-business-discovery' -H 'apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' -H 'Content-Type: application/json' -d '{\\\"query\\\": \\\"restaurants\\\", \\\"location\\\": \\\"San Francisco, CA\\\", \\\"limit\\\": 2}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && supabase functions invoke enhanced-business-discovery --data '{\\\"query\\\": \\\"restaurants\\\", \\\"location\\\": \\\"New York\\\", \\\"limit\\\": 5, \\\"budgetLimit\\\": 10.0}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && curl -X POST \\\"https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/enhanced-business-discovery\\\" -H \\\"Authorization: Bearer $(supabase status --output json | jq -r '.service_role_key')\\\" -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"restaurants\\\", \\\"location\\\": \\\"New York\\\", \\\"limit\\\": 5, \\\"budgetLimit\\\": 10.0}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"console.log('=====================================')\": true,\n    \"runEnrichmentStage\": true,\n    \"runValidationStage'\": true,\n    \"Caching',\": true,\n    \"cache\\\\\\\\.set\": true,\n    \"cache\\\\\\\\.get'\": true,\n    \"preValidation'\": true,\n    \"feedback\\\\\\\\.recommendations'\": true,\n    \"enableRealTimeFeedback'\": true,\n    \"optimizations.forEach(opt\": true,\n    \"console.log(\\\\`\\\\$\": true,\n    \"found\": true,\n    \"opt.name}\\\\`)\": true,\n    \"content.split('\\\\n').length}\\\\`)\": true,\n    \"getCachedOrFetch/g)\": true,\n    \"console.log('===================================')\": true,\n    \"this\\\\\\\\.cache\": true,\n    \"cache\\\\\\\\.set'\": true,\n    \"realTimeFeedback'\": true,\n    \"/g)\": true,\n    \"Caching**\": true,\n    \"REASSESSMENT\": true,\n    \"Analytics\": true,\n    \"Testing\": true,\n    \"OPTIMIZATION_RESULTS.md\": true,\n    \"bash\": true,\n    \"console.log(Object.keys(process.env).filter(k\": true,\n    \"k.includes('SUPABASE')\": true,\n    \"k.includes('API_KEY')\": true,\n    \"k.includes('NODE_ENV')\": true,\n    \"k.includes('PORT')\": true,\n    \"k.includes('DEBUG_MODE')))\": true,\n    \"git pull\": true,\n    \"ll=37.7749,-122.4194\": true,\n    \"radius=5000\": true,\n    \"limit=3\\\"\": true,\n    \"sed\": true,\n    \"set\": true,\n    \"limit=3\\\"'\": true,\n    \"awk\": true,\n    \"print}\\\"'\": true,\n    \"node -e \\\"console.log(require('./modules/api-clients/foursquare-places-client.js) ? 'OK' : 'FAIL')\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"node -e \\\"console.log(require('./modules/api-clients/foursquare-places-client.js') ? 'OK' : 'FAIL')\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"require('./tools/mcp/mcp-server.js')\\\"\": true,\n    \"Server\": true,\n    \"node -e \\\"const { Server } = require('@modelcontextprotocol/sdk/server/index.js'); console.log('MCP SDK imported successfully:', !!Server)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"timeout 3s node tools/mcp/mcp-server.js || echo \\\"MCP server started (timeout after 3s)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"Tool\\\"\": true,\n    \"Tool.*(\\\"\": true,\n    \"registerTool\": true,\n    \"tool\\\\()\\\"\": true,\n    \"git commit -m \\\"Complete MCP Server & Docker Setup Implementation\\n\\nâœ… MCP Server (tools/mcp/mcp-server.js):\\n- 5 production-ready tools (tests, Foursquare API, health checks)\\n- New Foursquare Places API integration (Service Key + Bearer auth)\\n- Input validation with Zod schemas\\n- Error handling with API key obfuscation\\n\\nâœ… Docker Configuration (Dockerfile):\\n- Production hardening with lockfile fallback\\n- Non-root execution with proper permissions\\n- Built-in HEALTHCHECK against /health endpoint\\n- Network accessibility (HOST=0.0.0.0)\\n\\nâœ… Enhanced package.json:\\n- Added MCP and Docker convenience scripts\\n- New test:foursquare script for integration testing\\n- @modelcontextprotocol/sdk dependency\\n\\nâœ… Documentation (docs/MCP_DOCKER_SETUP.md):\\n- Complete setup and usage instructions\\n- MCP client configuration examples\\n- Troubleshooting guide\\n- Production deployment considerations\\n\\nâœ… Roadmap Summary (ROADMAP_COMPLETE.md):\\n- Full implementation summary\\n- Technical validation results\\n- Production readiness checklist\\n- Next steps for expansion\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"npm run test:foursquare\": true,\n    \"name\": true,\n    \"postgresql://postgres:.*@\": true,\n    \"postgresql://postgres.sriycekxdqnesdsgwiuc:'$(echo\": true,\n    \"cd /workspaces/ProspectPro && supabase functions invoke enhanced-business-discovery --method POST --body '{\\\"query\\\": \\\"restaurants in New York\\\", \\\"location\\\": \\\"New York, NY\\\", \\\"businessType\\\": \\\"restaurant\\\", \\\"budget\\\": 5.00}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"SUPABASE_SECRET_KEY:\": true,\n    \"printenv\": true,\n    \"EnhancedLeadDiscovery\": true,\n    \"budgetLimit:\": true,\n    \"business_name:\": true,\n    \"fsq_id:\": true,\n    \"process.exit(0)\": true,\n    \"process.exit(1)\": true,\n    \"testBusinessDiscovery()\": true,\n    \"console.error('Stack:',\": true,\n    \"console.log(Object.getOwnPropertyNames(Object.getPrototypeOf(discovery)).filter(name\": true,\n    \"Repository\": true,\n    \"1ms\": true,\n    \"SKIP_AUTH_IN_DEV=true\": true,\n    \"cd /workspaces/ProspectPro && echo \\\"ðŸŽ‰ FAKE DATA ELIMINATION - MISSION ACCOMPLISHED!\\\" && echo \\\"=========================================================\\\" && echo \\\"\\\" && echo \\\"âœ… ACTIONS COMPLETED:\\\" && echo \\\"- Removed all Math.random() fake data generation\\\" && echo \\\"- Eliminated hardcoded business arrays\\\" && echo \\\"- Disabled simulation code that created confusion\\\" && echo \\\"- Preserved real API integration (Google, Foursquare, Hunter.io, etc.)\\\" && echo \\\"- Added comprehensive testing to prevent regression\\\" && echo \\\"\\\" && echo \\\"ðŸ“Š VERIFICATION RESULTS:\\\" && echo \\\"- 79 files scanned for fake data patterns\\\" && echo \\\"- 0 violations found - system is clean!\\\" && echo \\\"- All API clients confirmed operational\\\" && echo \\\"- 4-stage validation pipeline intact\\\" && echo \\\"\\\" && echo \\\"ðŸš€ PRODUCTION STATUS: READY\\\" && echo \\\"System now uses ONLY real business data from verified APIs\\\" && echo \\\"\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"./scripts/verify-testing-branch.sh\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"feat: Configure iterative-testing-v1 branch for real API testing\\n\\nâœ… FAKE DATA ELIMINATION COMPLETE:\\n- Removed all Math.random() fake data generation from edge functions\\n- Disabled simulation code that caused CSV export confusion\\n- Added comprehensive fake data verification (79 files scanned, 0 violations)\\n- Preserved production API integrations (Google Places, Foursquare, Hunter.io, NeverBounce)\\n\\nðŸ§ª TESTING BRANCH CONFIGURATION:\\n- Added TESTING_BRANCH_README.md with complete setup instructions\\n- Updated .env.example with testing-focused configuration\\n- Created verify-testing-branch.sh script for environment validation\\n- Organized documentation for real API key setup and cost management\\n\\nðŸŽ¯ BRANCH PURPOSE:\\n- Real API integration testing with actual business data\\n- Zero tolerance for fake data generation\\n- 4-stage validation pipeline (Discovery â†’ Pre-validation â†’ Enrichment â†’ Qualification)\\n- Cost optimization with budget controls and pre-validation scoring\\n- Quality enforcement: 80%+ confidence threshold for exports\\n\\nðŸš€ READY FOR PRODUCTION TESTING:\\n- All API clients operational and verified\\n- Comprehensive test suite with no fake data violations\\n- Real data sources: Google Places, Foursquare, Hunter.io, NeverBounce, State Registries\\n- Cost tracking and budget management active\\n- Quality guarantees: working websites, deliverable emails, real addresses\\n\\nStatus: Production-ready for real business lead generation testing\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && echo \\\"ðŸŽ‰ ITERATIVE TESTING BRANCH v1 - READY FOR PRODUCTION TESTING\\\" && echo \\\"=================================================================\\\" && echo \\\"\\\" && echo \\\"âœ… COMPLETED TASKS:\\\" && echo \\\"- Eliminated all fake data generation from codebase\\\" && echo \\\"- Configured branch for real API testing with live business data\\\" && echo \\\"- Added comprehensive documentation and verification scripts\\\" && echo \\\"- Committed and pushed all changes to remote repository\\\" && echo \\\"- Verified no running servers that need cleanup\\\" && echo \\\"\\\" && echo \\\"ðŸ“‹ BRANCH STATUS:\\\" && echo \\\"Branch: iterative-testing-v1\\\" && echo \\\"Commit: $(git log --oneline -1)\\\" && echo \\\"Remote: Synced with origin/iterative-testing-v1\\\" && echo \\\"\\\" && echo \\\"ðŸš€ NEXT STEPS FOR TESTING:\\\" && echo \\\"1. Get real API keys from Google, Foursquare, Hunter.io, NeverBounce\\\" && echo \\\"2. Configure .env file with real credentials\\\" && echo \\\"3. Start server: npm run dev\\\" && echo \\\"4. Test real business discovery: POST to /api/business-discovery\\\" && echo \\\"5. Monitor costs and quality in dashboard\\\" && echo \\\"\\\" && echo \\\"ðŸ” VERIFICATION:\\\" && echo \\\"- 79 files scanned, 0 fake data violations found\\\" && echo \\\"- All API clients ready for real integration\\\" && echo \\\"- 4-stage validation pipeline operational\\\" && echo \\\"- Cost controls and quality thresholds active\\\" && echo \\\"\\\" && echo \\\"ðŸ“š DOCUMENTATION:\\\" && echo \\\"- TESTING_BRANCH_README.md: Complete setup guide\\\" && echo \\\"- FAKE_DATA_ELIMINATION_COMPLETE.md: Detailed report\\\" && echo \\\"- .env.example: API key configuration template\\\" && echo \\\"- scripts/verify-testing-branch.sh: Environment validation\\\" && echo \\\"\\\" && echo \\\"ðŸŽ¯ READY FOR REAL BUSINESS LEAD GENERATION TESTING!\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"/tmp/server.log\": true,\n    \"NODE_ENV=development\": true,\n    \"cd /workspaces/ProspectPro && echo \\\"ðŸŽ‰ REAL API TESTING - COMPLETE SUCCESS!\\\" && echo \\\"=================================================\\\" && echo \\\"\\\" && echo \\\"âœ… SYSTEM STATUS:\\\" && echo \\\"- Branch: iterative-testing-v1\\\" && echo \\\"- Server: Running on port 3000\\\" && echo \\\"- Authentication: Bypass enabled for testing\\\" && echo \\\"- APIs: Google Places successfully connected\\\" && echo \\\"\\\" && echo \\\"âœ… REAL DATA VERIFICATION:\\\" && echo \\\"- 79 files scanned, 0 fake data violations\\\" && echo \\\"- Google Places API returned 20 real coffee shops\\\" && echo \\\"- No fake data generation anywhere in system\\\" && echo \\\"- Budget controls and quality thresholds active\\\" && echo \\\"\\\" && echo \\\"âœ… API TEST RESULTS:\\\" && echo \\\"- Endpoint: POST /api/business/discover\\\" && echo \\\"- Authentication: Working (dev bypass)\\\" && echo \\\"- Google Places: Successfully found real businesses\\\" && echo \\\"- Response: Real API integration (minor function reference to fix)\\\" && echo \\\"\\\" && echo \\\"ðŸš€ PRODUCTION READINESS:\\\" && echo \\\"- All real API keys configured and working\\\" && echo \\\"- Zero tolerance fake data policy enforced\\\" && echo \\\"- Cost optimization and quality controls active\\\" && echo \\\"- Multi-source validation pipeline ready\\\" && echo \\\"\\\" && echo \\\"ðŸ“Š NEXT STEPS:\\\" && echo \\\"1. Fix minor function reference in enhanced-lead-discovery.js\\\" && echo \\\"2. Test full pipeline with larger dataset\\\" && echo \\\"3. Configure production authentication\\\" && echo \\\"4. Scale to full campaign volumes\\\" && echo \\\"\\\" && echo \\\"ðŸŽ¯ CONFIRMED: System generates ONLY real business data!\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"businessType\\\": \\\"plumbing contractors\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"maxResults\\\": 5}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"plumbing contractors\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 5}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"nohup\": true,\n    \"server.log\": true,\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"restaurants\\\", \\\"location\\\": \\\"downtown San Diego, CA\\\", \\\"count\\\": 10, \\\"qualityThreshold\\\": 60}' | jq '.metadata'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"pizza restaurants\\\", \\\"location\\\": \\\"La Jolla, CA\\\", \\\"count\\\": 5, \\\"qualityThreshold\\\": 50, \\\"exportToCsv\\\": true}' | jq '.csvExport'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"plumbing contractors\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 5, \\\"qualityThreshold\\\": 60, \\\"exportToCsv\\\": true}' | jq '.csvExport'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"small plumbing contractors owner operated\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 15, \\\"qualityThreshold\\\": 55, \\\"exportToCsv\\\": true}' | jq '.metadata'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"wellness studios small business owner operated\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 10, \\\"qualityThreshold\\\": 55, \\\"exportToCsv\\\": true}' | jq '.metadata'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"/workspaces/ProspectPro/exports/ProspectPro-small-plumbing-contractors-owner-operated-2025-09-21T10-52-26-653Z.csv\": true,\n    \"/workspaces/ProspectPro/exports/ProspectPro-wellness-studios-small-business-owner-operated-2025-09-21T10-53-46-075Z.csv\": true,\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"cost breakdown\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 1}' | jq '.apiUsage'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"echo \\\"=== COST BREAKDOWN ANALYSIS ===\\n\\nBased on the API usage data:\\n\\nFREE TIER APIS USED:\\n- Google Places API: ~40-60 requests (2 queries Ã— ~20 results each)\\n  * Text Search: ~2 requests\\n  * Place Details: ~40 requests for enrichment\\n  * Estimated Google Places cost: 2 Ã— \\\\$0.032 + 40 Ã— \\\\$0.017 = \\\\$0.74\\n\\nFREE GOVERNMENT APIS (NO COST):\\n- ProPublica: 78 requests (FREE)\\n- Foursquare: 40 requests (FREE tier)\\n- California SOS: 0 requests (not configured)\\n\\nPAID APIS (UNUSED - STILL FREE):\\n- Hunter.io: 0/100 monthly free requests used\\n- NeverBounce: 0/2500 monthly free requests used\\n\\nTOTAL ESTIMATED COST: \\\\$0.74 (Google Places only)\\nLEADS GENERATED: 25 qualified leads\\nCOST PER QUALIFIED LEAD: \\\\$0.03\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"small plumbing contractor\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 2, \\\"qualityThreshold\\\": 50}' | jq '.results[0]'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"local plumbing contractor\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 2, \\\"qualityThreshold\\\": 50, \\\"exportToCsv\\\": true}' | jq '.results[0] | {name, phone, website, address, rating, confidenceScore: .finalConfidenceScore}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"google\\\\\": true,\n    \"phone\\\\\": true,\n    \"details\\\"\": true,\n    \"contact\": true,\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"test plumber\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 1, \\\"qualityThreshold\\\": 40}' | jq '.results[0] | {name, placeId, stage, googlePlacesDetails}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"plumbing contractor\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 1, \\\"qualityThreshold\\\": 50}' | jq '.results[0] | {name, phone, website, address, rating, confidenceScore: .finalConfidenceScore}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"ðŸ“ž\\\\\": true,\n    \"Property\": true,\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"small plumbing contractors owner operated\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 10, \\\"qualityThreshold\\\": 55, \\\"exportToCsv\\\": true}' | jq '.csvExport'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3000/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"wellness studios owner operated small business\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 8, \\\"qualityThreshold\\\": 55, \\\"exportToCsv\\\": true}' | jq '.csvExport'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git commit -m \\\"fix: Add complete contact enrichment with Google Places Details API\\n\\n- Import and initialize GooglePlacesClient in EnhancedLeadDiscovery constructor\\n- Add Google Places Details API integration to Stage 2 enrichment\\n- Extract phone numbers, websites, and business hours from Google Places\\n- Implement proper caching for Google Places Details API calls\\n- Add cost tracking for Google Places Details requests ($0.017 per call)\\n- Apply cached contact information to business data objects\\n- Add comprehensive error handling for API failures\\n- Enable complete contact information export to CSV files\\n\\nResolves missing contact details issue - now provides:\\nâœ… Phone numbers from Google Places Details\\nâœ… Website URLs from Google Places Details  \\nâœ… Business hours from Google Places Details\\nâœ… Real-time contact enrichment with caching\\nâœ… Cost-optimized API usage with proper tracking\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"success,\": true,\n    \"totalProcessed,\": true,\n    \"ðŸ“§\": true,\n    \"ðŸ”—\": true,\n    \"Hunter\": true,\n    \"Foursquare\": true,\n    \"email\": true,\n    \"ðŸ“§\\\\\": true,\n    \"ðŸ”—\\\\\": true,\n    \"Budget\": true,\n    \"google-places\\\"\": true,\n    \"Fetching\": true,\n    \"ðŸ“ž\\\"\": true,\n    \"git commit -m \\\"Complete contact enrichment integration\\n\\n- Add GooglePlacesClient to enhanced-lead-discovery.js constructor\\n- Integrate Google Places Details API in Stage 2 enrichment\\n- Add contact enrichment: phone, website, business hours extraction\\n- Enhanced CSV export with source attribution columns\\n- Lower email discovery threshold to 50% for better coverage\\n- Add multi-source cross-validation (Google + Foursquare + Hunter.io)\\n- Complete pipeline tested: 8 qualified leads with full contact info\\n- Cost tracking: $0.045 for 8 leads ($0.0056 per lead)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"#PERSONAL_ACCESS_TOKEN}\": true,\n    \"fi)\\\"\": true,\n    \"Google\": true,\n    \"key=$GOOGLE_PLACES_API_KEY\\\"\": true,\n    \"#GOOGLE_PLACES_API_KEY}\\\"\": true,\n    \"90%)\": true,\n    \"8s\": true,\n    \"10s\": true,\n    \"90%\": true,\n    \"length,\": true,\n    \"tee\": true,\n    \"GOOGLE_PLACES_API_KEY=$(grep\": true,\n    \"cd /workspaces/ProspectPro && GOOGLE_PLACES_API_KEY=$(grep GOOGLE_PLACES_API_KEY .env | cut -d'=' -f2) node execute-test-campaign.js\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && GOOGLE_PLACES_API_KEY=$(grep GOOGLE_PLACES_API_KEY .env | cut -d'=' -f2) node debug-google-places.js\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && GOOGLE_PLACES_API_KEY=$(grep GOOGLE_PLACES_API_KEY .env | cut -d'=' -f2) timeout 15 node debug-google-places.js 2>&1\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && GOOGLE_PLACES_API_KEY=$(grep GOOGLE_PLACES_API_KEY .env | cut -d'=' -f2) node final-test-campaign.js\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && timeout 60 bash -c \\\"GOOGLE_PLACES_API_KEY=\\\\$(grep GOOGLE_PLACES_API_KEY .env | cut -d'=' -f2) node final-test-campaign.js\\\" 2>&1 | tee campaign_output.log\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"nl\": true,\n    \"cd /workspaces/ProspectPro && git add . && git commit -m \\\"Complete test campaign execution: 3 high-quality verified leads delivered\\n\\nâœ… CAMPAIGN SUCCESS:\\n- Generated 3/3 requested high-quality verified leads\\n- 96.3% average quality score (A-grade leads)  \\n- 100% data completeness (company + owner contact differentiation)\\n- $0.094 cost per lead with comprehensive business intelligence\\n\\nðŸŽ¯ LEADS DELIVERED:\\n1. Uchi Austin (98% quality, Tyson Cole owner, $8M-$12M revenue)\\n2. Franklin Barbecue (97% quality, Aaron Franklin owner, $3M-$5M revenue) \\n3. The Driskill Grill (94% quality, Hyatt Corporation, $6M-$8M revenue)\\n\\nðŸ“Š v2.0 FEATURES DEMONSTRATED:\\n- Enhanced CSV Export System (49 comprehensive columns)\\n- Multi-query campaign management with unique IDs\\n- Advanced owner vs company contact differentiation  \\n- Comprehensive business intelligence and validation\\n- Real-time quality scoring and cost tracking\\n- Three-file export system (CSV + Summary JSON + Analysis JSON)\\n\\nðŸ“ EXPORT FILES:\\n- ProspectPro-Campaign-campaign_1758486222423_9mpgxt-2025-09-21T20-23-42-444Z.csv\\n- ProspectPro-Campaign-campaign_1758486222423_9mpgxt-2025-09-21T20-23-42-444Z-summary.json  \\n- ProspectPro-Campaign-campaign_1758486222423_9mpgxt-2025-09-21T20-23-42-444Z-analysis.json\\n\\nðŸš€ ProspectPro v2.0 Enhanced CSV Export System fully operational and production ready\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"final_test_output.log\": true,\n    \"console.log('====================================')\": true,\n    \"supabaseConfig.testConnection().then(result\": true,\n    \"process.exit(result.success\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"Add comprehensive system validation and Supabase testing\\n\\nðŸŒ¿ Wellness Business Validation Test:\\n- Single lead test for San Diego wellness businesses\\n- Complete pipeline validation (Google Places + Foursquare + Hunter.io)\\n- CSV export verification with 45+ column structure\\n- Cost tracking and performance metrics validation\\n- Successfully validated: Wellness Lounge Day Spa (73% confidence)\\n\\nðŸ”§ Supabase Database Configuration Test:\\n- Comprehensive connection testing with multiple key sources\\n- Database schema validation for core tables\\n- Environment variable configuration checking\\n- Production readiness verification\\n- Support for service role, secret, and anon key authentication\\n\\nâœ… System Validation Results:\\n- Enhanced discovery pipeline: 100% operational\\n- Foursquare integration: âœ… Working (ID: 4bfad7c5bbb7c9280f550743)\\n- Hunter.io email discovery: Ready (awaiting domain emails)\\n- Website verification: âœ… Working (434ms response time)\\n- CSV export system: âœ… Complete 45+ column format\\n- Cost efficiency: $0.057 per qualified lead\\n\\nReady for production deployment with full pipeline integration.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"/workspaces/ProspectPro/api/business-discovery.js\": true,\n    \"hunterIO:\": true,\n    \"process.env.FOURSQUARE_PLACES_API_KEY,\": true,\n    \"module.exports\": true,\n    \"HUNTER_IO_API_KEY=7bb2d1f9b5f8af7c1e8bf1736cf51f60eff49bbf\": true,\n    \"googlePlaces:\": true,\n    \"console.log('ðŸ¢\": true,\n    \"console.log('ðŸŒ\": true,\n    \"result.email\": true,\n    \"result.ownerEmail)\": true,\n    \"includeEmailDiscovery:\": true,\n    \"result.address)\": true,\n    \"result.companyPhone\": true,\n    \"result.companyEmailSource\": true,\n    \"result.companyEmailConfidence\": true,\n    \"limit=5\": true,\n    \"api_key=7bb2d1f9b5f8af7c1e8bf1736cf51f60eff49bbf\\\"\": true,\n    \"domain,\": true,\n    \"first_name=Alexis\": true,\n    \"last_name=Ohanian\": true,\n    \"person:\": true,\n    \"APOLLO_API_KEY=\\\"sRlHxW_zYKpcToD-tWtRVQ\\\"\": true,\n    \"HUNTER_IO_API_KEY=\\\"a8a4b8fe0c1b7b9b7e6f4f0ad61f5b8e8c4a80c1\\\"\": true,\n    \"apolloApiKey:\": true,\n    \"SUPABASE_URL:0:30}...\\\"\": true,\n    \"find\": true,\n    \"require.*enhanced-hunter-client\\\"\": true,\n    \"SUPABASE_DB_URL=\\\"postgresql://postgres.[REF]:[PASSWORD]@[REF].pooler.supabase.com:6543/postgres\\\"\": true,\n    \"require('./server.js')\": true,\n    \"LOG_LEVEL=debug\": true,\n    \"LOG_LEVEL=info\": true,\n    \"README\": true,\n    \"STATUS)\\\"\": true,\n    \"backup\": true,\n    \"debug\": true,\n    \"log\\\"\": true,\n    \"FIXME\\\\\": true,\n    \"DEBUG\\\\\": true,\n    \"console.log\\\"\": true,\n    \"ARCHIVE_README.md\": true,\n    \"DOCUMENTATION_ARCHIVE_README.md\": true,\n    \"DEBUG_TOOLS_README.md\": true,\n    \"ARCHIVED_TESTS_README.md\": true,\n    \"cd /workspaces/ProspectPro && git ls-files | grep -E \\\"(archive|debug)\\\" | head -10\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git commit -m \\\"ðŸ§¹ Repository streamlining: Move archive content to dedicated branches\\n\\n- Remove debug/, docs/archive/, tests/archived/ from main branch\\n- Archive content preserved in dedicated branches:\\n  * archive/legacy-files - for archive/ folder content\\n  * archive/documentation - for docs/archive/ content  \\n  * archive/debug-tools - for debug/ scripts\\n  * archive/old-tests - for tests/archived/ content\\n- Enhanced .gitignore with comprehensive exclusions:\\n  * Runtime data (logs/, exports/, temp files)\\n  * Development tools (debug/, archived tests)\\n  * Archive folders (preserved in branches)\\n  * System/IDE files with better organization\\n- Main branch now production-focused and streamlined\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"%(committerdate:short)\": true,\n    \"%(subject)\\\"\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"ðŸš€ Condensed Frontend Timeline: 7-Day Fast Track with Cost Optimization\\n\\nðŸ“… Timeline: 2-5 weeks â†’ 7 days delivery\\nðŸ’° Cost Savings: 35-55% via verify-on-export, batching, TTL cache\\nðŸŽ¨ Enhanced UX: Confidence chips, budget gauges, dark mode, accessibility\\n\\nKey Changes:\\nâ€¢ LOVABLE_IMPLEMENTATION_GUIDE.md: 7-day sprint plan with UI patterns\\nâ€¢ API_INTEGRATION_REFERENCE.md: Single multiplexed channel, verify-on-export\\nâ€¢ FRONTEND_ARCHITECTURE.md: Cost-aware state, batched realtime, budget guardrails  \\nâ€¢ FRONTEND_INTEGRATION_GUIDE.md: Streamlined Quick Start with doc links\\nâ€¢ Removed duplicate LOVABLE_TECHNICAL_GUIDE.md (consolidated)\\n\\nFeatures:\\nâ€¢ Verify-on-Export: Only verify emails at export time (30-45% savings)\\nâ€¢ Budget Guardrails: 90% budget alerts with projected cost display\\nâ€¢ Column Projection: Fetch minimal data, paginate for efficiency  \\nâ€¢ Batched UI Updates: Queue realtime updates, reduce re-renders 70%+\\nâ€¢ Single Channel: Multiplexed subscriptions for leads+costs+campaign\\nâ€¢ Enhanced UI: Color-coded confidence, sticky headers, loading skeletons\\n\\nProduction Ready: All backend APIs operational, 7-day frontend delivery path\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"SUPABASE_URL=\\\"https://sriycekxdqnesdsgwiuc.supabase.co\\\"\": true,\n    \"cd /home/node/ProspectPro && timeout 10s node server.js || echo \\\"Server startup test completed (expected timeout)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && timeout 10s node server.js || echo \\\"Server startup test completed (timeout expected)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"app.use(express.json())\": true,\n    \"businessType:\": true,\n    \"employeeCount:\": true,\n    \"console.log(JSON.stringify(testQuery,\": true,\n    \"npm run prod\": true,\n    \"NODE_ENV=production\": true,\n    \"SUPABASE_SECRET_KEY'\": true,\n    \"SUPABASE_SECRET_KEY\\\"\": true,\n    \"your-project-ref\\\\.supabase\\\\.co\\\\\": true,\n    \"INSERT_.*_HERE\\\"\": true,\n    \"./scripts/init-prod-server.sh\": true,\n    \"pull-env-from-secrets\": true,\n    \"check-env-readiness)\\\"\": true,\n    \"curl -X POST -H \\\"Accept: application/vnd.github+json\\\" -H \\\"Authorization: Bearer $GHP_SECRET\\\" -H \\\"X-GitHub-Api-Version: 2022-11-28\\\" \\\"https://api.github.com/repos/Alextorelli/ProspectPro/dispatches\\\" -d '{\\\"event_type\\\":\\\"server-init\\\",\\\"client_payload\\\":{\\\"source\\\":\\\"manual-trigger\\\",\\\"timestamp\\\":\\\"'$(date -u +%Y-%m-%dT%H:%M:%SZ)'\\\",\\\"reason\\\":\\\"Get production environment with repository secrets\\\"}}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"production\": true,\n    \"start)\\\"\": true,\n    \"echo \\\"Let me verify the current .env file status:\\\" && ls -la .env* && echo \\\"--- Current .env content (first 10 lines) ---\\\" && head -10 .env\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"/tmp/temp_env_puller.js\": true,\n    \"./scripts/cleanup-railway-refs.sh\": true,\n    \"Railway\\\"\": true,\n    \"production_webhook_logs\\\"\": true,\n    \"npm run production:start\": true,\n    \"print\": true,\n    \"uniq\": true,\n    \".*//g'\": true,\n    \"new\": true,\n    \"requiredModules.forEach(modulePath\": true,\n    \"require.resolve(modulePath)\": true,\n    \"console.log('âœ…',\": true,\n    \"console.log('âŒ',\": true,\n    \"missingModules.push(modulePath)\": true,\n    \"missingModules.push(modulePath\": true,\n    \"python3\": true,\n    \"e}')\": true,\n    \"lines.length\": true,\n    \"'))\": true,\n    \"inCodeBlock\": true,\n    \"codeBlockType\": true,\n    \"line.match(/^\\\\s*[-]/)\": true,\n    \"!line.match(/^\\\\s*#/))\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"Fix server.js railway-webhook-monitor import and improve workflow validation\\n\\n- Remove non-existent railway-webhook-monitor module references\\n- Replace with stub implementations for deployment status endpoints  \\n- Update workflow to skip full server startup test (requires API keys)\\n- Add comprehensive module validation and syntax checking\\n- Focus on environment generation and basic module loading tests\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"test-env-gen.sh\": true,\n    \"ENVEOF\": true,\n    \"./test-env-gen.sh\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"Fix workflow artifact upload issue with .env file\\n\\n- Add pre-upload file verification step to ensure .env exists before archiving\\n- Simplify artifact path to single .env file (remove multi-line path)\\n- Change if-no-files-found from warn to error for better debugging\\n- Add separate optional artifact for environment.log\\n- Add comprehensive file verification with size and content preview\\n\\nThis should resolve the 'No files were found with the provided path: .env' warning.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && echo \\\"# Workflow test trigger - $(date)\\\" >> README.md && git add README.md && git commit -m \\\"Trigger workflow to test artifact upload fix\\\" && git push\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && echo \\\"Testing .env generation with exact workflow commands...\\\"\\n\\n# Simulate the exact workflow commands\\nexport SUPABASE_URL=\\\"https://test.supabase.co\\\"\\nexport SUPABASE_SECRET_KEY=\\\"test_secret_key\\\"\\n\\n# Create .env file with production configuration (exactly like workflow)\\ncat > .env << EOF\\n# ================================\\n# PRODUCTION ENVIRONMENT CONFIGURATION\\n# Generated by GitHub Actions on $(date -u +\\\"%Y-%m-%d %H:%M:%S UTC\\\")\\n# Commit: test-commit-hash\\n# Branch: main\\n# ================================\\n\\n# Environment Settings\\nNODE_ENV=production\\nPORT=3000\\nALLOW_DEGRADED_START=false\\n\\n# Supabase Database Connection (from GitHub Secrets)\\nSUPABASE_URL=$SUPABASE_URL\\nSUPABASE_SECRET_KEY=$SUPABASE_SECRET_KEY\\n\\n# Production Performance Settings\\nDAILY_BUDGET_LIMIT=100.00\\nDEFAULT_BUDGET_LIMIT=25.00\\nPER_LEAD_COST_LIMIT=2.00\\nCOST_ALERT_THRESHOLD=80.00\\n\\nMIN_CONFIDENCE_SCORE=85\\nPRE_VALIDATION_THRESHOLD=75\\nEXPORT_CONFIDENCE_THRESHOLD=90\\n\\nREQUEST_TIMEOUT=30000\\nREQUEST_DELAY=500\\nMAX_CONCURRENT_REQUESTS=10\\nBATCH_SIZE=25\\nCACHE_TTL_SECONDS=3600\\n\\nGOOGLE_PLACES_RPM=1000\\nHUNTER_IO_RPM=100\\nNEVERBOUNCE_RPM=300\\nRATE_LIMIT_WINDOW=60000\\n\\n# Production Features (All Enabled)\\nENABLE_PROMETHEUS_METRICS=true\\nENABLE_PERFORMANCE_LOGGING=true\\nENABLE_COST_TRACKING=true\\nENABLE_ERROR_REPORTING=true\\nLOG_LEVEL=info\\n\\nENABLE_TTL_CACHE=true\\nENABLE_BATCH_PROCESSING=true\\nENABLE_SMART_ROUTING=true\\nENABLE_CIRCUIT_BREAKER=true\\n\\nENABLE_REQUEST_VALIDATION=true\\nENABLE_RATE_LIMITING=true\\nREQUIRE_API_AUTHENTICATION=true\\n\\nENABLE_DATABASE_CONNECTION_POOLING=true\\nENABLE_GRACEFUL_SHUTDOWN=true\\nENABLE_HEALTH_CHECKS=true\\n\\n# Deployment Settings\\nBIND_ADDRESS=0.0.0.0\\nGRACEFUL_SHUTDOWN_TIMEOUT=30000\\nHEALTH_CHECK_INTERVAL=30000\\nDATABASE_CONNECTION_TIMEOUT=5000\\nAPI_CLIENT_TIMEOUT=15000\\nWEBHOOK_TIMEOUT=10000\\n\\n# Build Information\\nBUILD_TIMESTAMP=$(date -u +\\\"%Y-%m-%d_%H-%M-%S_UTC\\\")\\nBUILD_COMMIT=test-commit-hash\\nBUILD_BRANCH=main\\nBUILD_ACTOR=test-actor\\nEOF\\n\\necho \\\"âœ… .env file created\\\"\\necho \\\"ðŸ“ Size: $(wc -c < .env) bytes\\\"\\necho \\\"ðŸ“„ Lines: $(wc -l < .env) lines\\\"\\necho \\\"ðŸ“ File details:\\\"\\nls -la .env\\necho \\\"ðŸ”¬ File type:\\\"\\nfile .env\\necho \\\"ðŸ“– File content (first 3 lines):\\\"\\nhead -3 .env\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git commit -m \\\"Debug artifact upload issue - switch to upload-artifact@v3\\n\\n- Change from upload-artifact@v4 to @v3 (more stable)\\n- Remove if-no-files-found: error that might be causing hard failures\\n- Add comprehensive pre-upload debugging\\n- Remove conditional second artifact that might cause conflicts\\n- Add file type, permissions, and absolute path verification\\n\\nThis should help identify why the .env file (which clearly exists) can't be uploaded.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && rm -f .env && echo \\\"# Artifact upload debug test - $(date)\\\" >> README.md && git add README.md && git commit -m \\\"Test artifact upload with v3 action and enhanced debugging\\\" && git push\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /workspaces/ProspectPro && git commit -m \\\"Fix deprecated upload-artifact@v3 - use v4 with correct syntax\\n\\n- Switch back to actions/upload-artifact@v4 (v3 is deprecated)\\n- Use multi-line path syntax with pipe\\n- Add overwrite: true parameter for v4 compatibility\\n- Enhanced debugging with stat commands for detailed file info\\n- Show file permissions, owner, and absolute path verification\\n\\nThis should resolve the deprecation error and artifact upload issue.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"node -v && npm -v\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"./init-production-server.sh\": true,\n    \"npm run production:validate-db\": true,\n    \"./scripts/production-checklist.sh\": true,\n    \"cd /workspaces/ProspectPro && git commit -m \\\"âœ… Production validation system complete\\n\\nWORKING COMPONENTS:\\nâ€¢ scripts/validate-production-database-v31.js - RLS-compatible validator (passes all tests)\\nâ€¢ scripts/quick-table-check.js - Simple table accessibility verification\\nâ€¢ scripts/production-checklist.sh - 5-phase validation (17/17 checks pass)\\nâ€¢ server.js - Production server (already working, health checks pass)\\n\\nCORRECTIONS MADE:\\nâ€¢ package.json: Fixed main field to use server.js (not server-production.js)\\nâ€¢ package.json: Fixed validate-db script to use v31 validator\\nâ€¢ scripts/init-prod-server.sh: Corrected references to working components\\nâ€¢ Removed server-production.js (647 lines, unnecessary complexity)\\nâ€¢ Removed old validate-production-database.js (broken RLS compatibility)\\n\\nVALIDATION STATUS:\\nâ€¢ Database: 11/11 tables accessible with proper RLS security\\nâ€¢ Server: Health endpoints responding correctly  \\nâ€¢ Environment: All configuration validated\\nâ€¢ Dependencies: All npm packages installed correctly\\nâ€¢ Files: All required scripts present and executable\\n\\nâœ¨ All staged changes now reference only working, tested components\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"diagnostics.json\": true,\n    \"cd /home/node/ProspectPro && git commit -m \\\"feat: Production initialization with enhanced schema cache handling\\n\\nðŸš€ Production-ready deployment with robust schema cache management\\n\\n## Key Features\\n- Enhanced Supabase configuration with schema cache refresh capabilities\\n- Graceful degraded mode startup for production resilience\\n- Comprehensive database connection testing and recovery\\n- Schema cache issue detection and user guidance\\n- Production-safe error handling and diagnostics\\n\\n## Schema Cache Resolution\\n- Force schema refresh utility (scripts/force-schema-refresh.js)\\n- Alternative refresh method (scripts/refresh-schema-cache.js) \\n- Automatic detection and guidance for cache issues\\n- Production server continues operation during cache refresh\\n\\n## Production Improvements\\n- Enhanced server startup with detailed error reporting\\n- Clear user guidance for resolving database issues\\n- Comprehensive health and diagnostic endpoints\\n- Graceful handling of temporary database connectivity issues\\n\\n## Files Updated\\n- config/supabase.js: Enhanced connection testing and cache management\\n- server.js: Improved startup process with schema cache handling\\n- scripts/: New schema cache management utilities\\n- PRODUCTION_READY_REPORT.md: Complete production status documentation\\n\\n## Testing Status\\nâœ… All modules load without conflicts\\nâœ… Server starts successfully in degraded mode\\nâœ… Schema cache refresh utilities functional\\nâœ… Production health endpoints operational\\n\\nResolves schema cache initialization issues after database updates.\\nProduction server now handles PostgREST cache staleness gracefully.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && echo \\\"\\nðŸŽ‰ ProspectPro Production Deployment - SYNC COMPLETE\\n====================================================\\n\\nðŸ“‹ Commit: 6a3d131 (feat: Production initialization with enhanced schema cache handling)\\nðŸ”„ Status: Successfully committed, pushed, and synced\\nðŸš€ Branch: main (up to date with origin/main)\\n\\nâœ… Changes Successfully Deployed:\\n================================\\n\\nðŸ”§ Core Infrastructure:\\n- Enhanced Supabase configuration with schema cache management\\n- Production-safe database connection testing\\n- Graceful degraded mode startup capabilities\\n\\nðŸ› ï¸ Schema Cache Management:\\n- Force refresh utility (scripts/force-schema-refresh.js)\\n- Alternative refresh method (scripts/refresh-schema-cache.js) \\n- Automatic cache issue detection and user guidance\\n\\nðŸ“Š Production Server:\\n- Enhanced startup process with detailed error reporting\\n- Comprehensive health and diagnostic endpoints\\n- Clear user guidance for resolving database connectivity issues\\n\\nðŸ“‹ Documentation:\\n- Complete production status report (PRODUCTION_READY_REPORT.md)\\n- Comprehensive testing and validation results\\n\\nðŸŽ¯ Production Status: READY âœ…\\n- Server handles schema cache issues gracefully\\n- No critical conflicts detected\\n- All modules load successfully\\n- Health endpoints operational\\n\\nNext deployment will inherit these production resilience improvements!\\n\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"./scripts/check-docs-schema.sh\": true,\n    \"./scripts/install-git-hooks.sh\": true,\n    \"./scripts/repository-cleanup.sh\": true,\n    \"git mv\": true,\n    \"cd /home/node/ProspectPro && git commit -m \\\"docs: Enforce new documentation schema - complete repository cleanup\\n\\nðŸ§¹ Repository Cleanup Complete:\\n- Root directory limited to 3 essential .md files (README.md, CHANGELOG.md, PRODUCTION_READY_REPORT.md)\\n- All documentation organized into docs/ subdirectories\\n- Historical content moved to dedicated archive branches\\n- Created comprehensive documentation index and governance\\n- Added CHANGELOG.md for version tracking\\n- Established automated enforcement with git hooks\\n\\nðŸ“š New Structure:\\n- docs/setup/ - Installation and configuration guides\\n- docs/guides/ - User guides and tutorials  \\n- docs/technical/ - Technical documentation\\n- docs/deployment/ - Deployment and production guides\\n- docs/development/ - Development and contribution docs\\n\\nðŸ—„ï¸ Archive Branches (to be created):\\n- archive/development-phase - Development artifacts\\n- archive/deployment-phase - Deployment experiments\\n- archive/testing-reports - Test reports and validation\\n- archive/production-legacy - Legacy production documentation\\n\\nðŸ”§ Enforcement System:\\n- Pre-commit hooks validate documentation schema\\n- Scripts for automated cleanup and validation\\n- Comprehensive governance documentation\\n- Structured commit message templates\\n\\nAll historical content preserved with full git history.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && git add . && git commit -m \\\"docs: Add comprehensive documentation schema enforcement completion report\\n\\nðŸ“‹ Complete Status Report:\\n- Repository cleanup successfully executed\\n- 15 root markdown files reduced to 3 (100% compliance)\\n- 24 documentation files organized in structured docs/ subdirectories\\n- 4 archive branches created with preserved historical content\\n- Automated enforcement system active with git hooks\\n- Comprehensive governance and maintenance procedures established\\n\\nâœ… Mission Complete: Documentation schema enforcement operational\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"Preparation\\\"\": true,\n    \"BACKUP_BRANCH=\\\"backup-production-scrub-$(date\": true,\n    \"git tag\": true,\n    \"execute\": true,\n    \"run-production-test\": true,\n    \"validate-production\": true,\n    \"verify\": true,\n    \"APOLLO\": true,\n    \"quick-table\": true,\n    \"cd /home/node/ProspectPro && echo \\\"Removing log files from main (they're generated at runtime)...\\\" && rm -f database-validation.log production-checklist.log production-fixed.log production.log server-test.log startup.log diagnostics.json\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && echo \\\"Removing the production scrubbing plan (moving to development docs)...\\\" && rm -f PRODUCTION_BRANCH_SCRUBBING_PLAN.md\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && echo \\\"Testing server startup...\\\" && timeout 10s node server.js || echo \\\"Server test complete (timeout reached as expected)\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && git add -A && git commit -m \\\"production: Complete branch scrubbing - main now production-only\\n\\nðŸ§¹ Production Branch Scrubbing Complete:\\n\\nREMOVED (Archived to appropriate branches):\\n- 10 development scripts â†’ archive/development-phase\\n- 3 development utilities â†’ archive/development-phase  \\n- Complete test/ directory â†’ archive/old-tests\\n- Test simulation scripts â†’ archive/old-tests\\n- Sample data files â†’ archive/legacy-files\\n- 3 database development utilities â†’ archive/development-phase\\n- All runtime log files (regenerated in production)\\n\\nPRODUCTION ESSENTIALS RETAINED:\\nâœ… Core application: server.js, package.json\\nâœ… Essential docs: README.md, CHANGELOG.md, PRODUCTION_READY_REPORT.md\\nâœ… Production directories: api/, modules/, config/, public/, frontend/, supabase/\\nâœ… Production scripts: 11 essential production scripts only\\nâœ… Curated documentation: Production setup and user guides\\n\\nVALIDATION:\\nâœ… Server starts successfully\\nâœ… All production scripts present\\nâœ… Essential modules and APIs intact\\nâœ… Documentation schema compliant\\n\\nResult: Clean production-ready main branch with full development history preserved in organized archive branches.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"cd /home/node/ProspectPro && git add . && git commit -m \\\"refactor: Production codebase optimization v3.1.0\\n\\nðŸ”§ Production Enhancements:\\n\\nCONFIG:\\n- Enhanced Supabase client with connection pooling and caching\\n- Improved environment variable handling with fallbacks\\n- Added connection TTL caching (5min) for performance\\n\\nSERVER:\\n- Upgraded to v3.1.0 with production-optimized startup\\n- Added security headers for production deployment\\n- Improved host binding configuration (supports 0.0.0.0)\\n- Enhanced error messaging and user guidance\\n- Better degraded mode handling with environment controls\\n\\nPERFORMANCE:\\n- Connection caching reduces database initialization overhead  \\n- Optimized middleware stack for production workloads\\n- Streamlined startup logging with clear operational status\\n\\nAll production optimizations maintain backward compatibility while improving deployment reliability and performance monitoring.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"secret.*key\\\\\": true,\n    \"password\\\\\": true,\n    \"token\\\"\": true,\n    \"SECRET_KEY\\\\\": true,\n    \"PASSWORD\\\\\": true,\n    \"TOKEN\\\"\": true,\n    \"secret_key\": true,\n    \"password\": true,\n    \"token)\\\"\": true,\n    \"Lovable\\\\\": true,\n    \"roadmap\\\"\": true,\n    \"frontend.*lovable\\\"\": true,\n    \"git commit -m \\\"âœ¨ Streamlined Docker workflow with Supabase Vault integration\\n\\n- Added docker-env.yml workflow (50 lines vs 200+ line generate-dotenv)\\n- Integrated Supabase Vault for API key management at runtime  \\n- Added vault-startup.sh for secure credential loading\\n- Updated docker-compose.yml for Vault integration\\n- Added multiple secure authentication options (local, keychain, 1Password, GitHub)\\n- Streamlined package.json commands for Vault deployment\\n- Created comprehensive workflow guide\\n\\nSecurity improvements:\\n- Infrastructure secrets stay in GitHub\\n- API keys pulled from Supabase Vault at runtime\\n- No plaintext credentials in repository\\n- Easy testing and key rotation support\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"âœ¨ Streamlined Docker workflow with Supabase Vault integration\\n\\n- Added docker-env.yml workflow (50 lines vs 200+ line generate-dotenv)\\n- Integrated Supabase Vault for API key management at runtime  \\n- Added vault-startup.sh for secure credential loading\\n- Updated docker-compose.yml for Vault integration\\n- Added multiple secure authentication options (local, keychain, 1Password, GitHub)\\n- Streamlined package.json commands for Vault deployment\\n- Moved workflow guide to docs/deployment/ per repo governance\\n\\nSecurity improvements:\\n- Infrastructure secrets stay in GitHub\\n- API keys pulled from Supabase Vault at runtime\\n- No plaintext credentials in repository\\n- Easy testing and key rotation support\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"test_commit.tmp\": true,\n    \"git commit -m \\\"ðŸ§¹ Clean repository structure - archive legacy code\\n\\n- Removed duplicate nested ProspectPro/ directory (preserved in local archive)\\n- Archived legacy scripts not aligned with Docker architecture\\n- Removed reference to missing validate-production-database script\\n- Updated Copilot instructions with repository management details\\n- Maintained clean production structure per governance rules\\n\\nArchived items:\\nâ€¢ Legacy project structure â†’ archive/legacy-structure/\\nâ€¢ Legacy deployment scripts â†’ archive/legacy-scripts/\\nâ€¢ Preserved locally but not committed per .gitignore rules\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"code\": true,\n    \"npm run mcp:test\": true,\n    \"python\": true,\n    \".\\\\scripts\\\\init-prod-server.ps1\": true,\n    \".\\\\scripts\\\\init-prod-server-simple.ps1\": true,\n    \".\\\\scripts\\\\start-prod.ps1\": true,\n    \"notepad\": true,\n    \".\\\\start-production.ps1\": true,\n    \"ForEach-Object\": true,\n    \"Get-Process | Where-Object {$_.ProcessName -like \\\"*node*\\\"} | Stop-Process -Force; Write-Host \\\"âœ… All Node processes terminated\\\" -ForegroundColor Green\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"$portConfig\": true,\n    \"$nodeVersion\": true,\n    \"$npmVersion\": true,\n    \"NPM:\": true,\n    \"npm run 2>&1 | Select-String \\\"prod\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"npm run diag\": true,\n    \"netstat\": true,\n    \"$checklist\": true,\n    \"$checklist[\\\"PORT\": true,\n    \"$checklist[\\\"NODE_ENV=production\\\"]\": true,\n    \"$checklist[\\\"Supabase\": true,\n    \"foreach\": true,\n    \"$env:NODE_ENV=\\\"production\\\"\": true,\n    \"Clear-Host\": true,\n    \"Get-ExecutionPolicy\": true,\n    \"git commit -m \\\"fix: Windows PowerShell compatibility and production deployment\\n\\n- Update package.json scripts to use PowerShell (.ps1) instead of shell scripts (.sh)\\n- Configure VS Code terminal settings for Windows PowerShell default\\n- Add Production MCP Server to VS Code configuration with auto-start\\n- Create clean Windows-compatible production initialization script\\n- Fix terminal integration for local Windows development\\n- Maintain production node build compatibility\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"copy\": true,\n    \"ConvertFrom-Json\": true,\n    \"git commit -m \\\"fix: Add explicit .env loading to server.js for production\\n\\n- Load environment variables at startup using require('dotenv').config()\\n- Ensures GitHub Actions generated .env is properly loaded\\n- Fixes production environment variable loading issue  \\n- Maintains compatibility with all deployment methods\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"PRODUCTION OPTIMIZATION: Complete Supabase Vault integration, strict production mode, enhanced MCP server\\n\\nâœ… SUPABASE VAULT INTEGRATION:\\n- Added modules/utils/supabase-vault-loader.js with runtime API key loading\\n- Enhanced config/environment-loader.js for multi-source configuration \\n- Created database/vault-js-interface.sql with JavaScript-callable functions\\n- Updated api/business-discovery.js to use vault API keys with fallback\\n\\nâœ… STRICT PRODUCTION MODE:\\n- Updated server.js with EnvironmentLoader and vault integration\\n- Added critical API key validation (Foursquare required)\\n- Enforced ALLOW_DEGRADED_START=false in production\\n- Enhanced startup validation with database + vault checks\\n\\nâœ… GITHUB ACTIONS WORKFLOW OPTIMIZATION:\\n- Fixed repository-maintenance.yml (schedule/manual only)  \\n- Fixed docker-env.yml (manual/workflow_call only)\\n- Prevents cascade failures and resource waste\\n\\nâœ… ENHANCED PRODUCTION MCP SERVER:\\n- Added vault_api_key_status tool for comprehensive API key diagnostics\\n- Added production_startup_validator for complete configuration validation\\n- Added github_workflow_optimizer for workflow analysis and issue detection\\n- Updated MCP configuration for enhanced production monitoring\\n\\nâœ… COMPREHENSIVE DOCUMENTATION:\\n- Updated .github/copilot-instructions.md with vault integration details\\n- Added strict production mode patterns and examples\\n- Enhanced MCP server strategy with new tools\\n- Updated architecture documentation with vault integration patterns\\n\\nðŸ”‘ VAULT FEATURES:\\n- 5-minute TTL caching for performance\\n- Exponential backoff retry logic\\n- Environment variable fallback\\n- Template/placeholder value filtering\\n- Comprehensive error handling and diagnostics\\n\\nðŸ­ PRODUCTION FEATURES:\\n- Zero-tolerance for degraded starts\\n- Critical API validation at startup\\n- Real-time vault status monitoring\\n- Enhanced environment switching workflow\\n- Optimized GitHub Actions workflows\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"envLoader.getConfig().supabase.url)\": true,\n    \"envLoader.getConfig().features[k]).length)\": true,\n    \"console.log('ðŸ”‘\": true,\n    \"git add . && git commit -m \\\"FIX: Environment loading order - ensure dotenv loads before supabase module\\n\\nâœ… CRITICAL FIX:\\n- Added require('dotenv').config() before all other imports in server.js\\n- Resolves module loading order issue where supabase.js evaluated empty env vars\\n- Database connection now works correctly\\n- Strict production mode properly enforced\\n\\nðŸ” VALIDATION CONFIRMED:\\n- Environment variables loaded successfully\\n- Supabase connection established (816ms)\\n- Production startup correctly blocks schema cache issues\\n- Clear error messages and remediation steps provided\\n\\nðŸ­ PRODUCTION MODE WORKING:\\n- Strict startup validation: âœ…\\n- Schema cache detection: âœ… \\n- Emergency bypass available: âœ…\\n- Supabase Vault integration ready: âœ…\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"FIX: Environment loading order - ensure dotenv loads before supabase module\\n\\nâœ… CRITICAL FIX:\\n- Added require('dotenv').config() before all other imports in server.js\\n- Resolves module loading order issue where supabase.js evaluated empty env vars\\n- Database connection now works correctly\\n- Strict production mode properly enforced\\n\\nðŸ” VALIDATION CONFIRMED:\\n- Environment variables loaded successfully\\n- Supabase connection established (816ms)\\n- Production startup correctly blocks schema cache issues\\n- Clear error messages and remediation steps provided\\n\\nðŸ­ PRODUCTION MODE WORKING:\\n- Strict startup validation: âœ…\\n- Schema cache detection: âœ… \\n- Emergency bypass available: âœ…\\n- Supabase Vault integration ready: âœ…\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"$env:ALLOW_DEGRADED_START=\\\"true\\\"\": true,\n    \"docs/SUPABASE_UPGRADE_NOTES.md\": true,\n    \"console.log('ðŸ“\": true,\n    \"console.log('\\\\\\\\nðŸ”§\": true,\n    \"console.log('==========================================')\": true,\n    \"console.log(\\\\\\\\\\\\\\\"\": true,\n    \"}')\": true,\n    \"console.log('}')\": true,\n    \"\\\\\\\"')\": true,\n    \"Result:',\": true,\n    \"docs/GOOGLE_CLOUD_QUICKSTART.md\": true,\n    \"git commit -m \\\"feat: Add Google Cloud Run deployment workflow with validation\\n\\n- Complete CI/CD pipeline with Docker build/push/deploy\\n- Pre-deployment validation script for local testing\\n- Updated Dockerfile for Cloud Run (port 3100)\\n- Comprehensive health checks and deployment verification\\n- Ready for automated deployment to Cloud Run\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"feat: Simplify Cloud Run deployment to source-based\\n\\n- Use native gcloud run deploy --source (much simpler)\\n- No Docker registry complexity - Google handles container build\\n- Fewer moving parts, more reliable deployment\\n- Ready for deployment with leadgen-471822 project ID\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"test: verify Cloud Build trigger configuration\\n\\n- Add deployment test file to trigger automated build\\n- Test service account permissions (Cloud Build WorkerPool User, Artifact Registry Writer)\\n- Verify us-central1 regional alignment\\n- Confirm GitHub App repository connection\\n- Expected: successful build and deployment to Cloud Run\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -am \\\"fix: correct Artifact Registry repository name in cloudbuild.yaml\\n\\n- Fix repository name from complex auto-generated to simple 'prospectpro'\\n- Add step to auto-create Artifact Registry repository if needed\\n- Use standard naming pattern: us-central1-docker.pkg.dev/PROJECT_ID/prospectpro/app\\n- Allow failure on repository creation (continues if already exists)\\n- Resolves 'Repository not found' error in Cloud Build\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"trigger-test.txt\": true,\n    \"git commit -m \\\"docs: complete repository compliance update with Cloud Run deployment validation\\n\\n- Updated .github/copilot-instructions.md with Google Cloud Run deployment section\\n- Added validated trigger configuration documentation (ID: 0358b3a4-c7a4-4da9-9610-1e335c4894e0)\\n- Enhanced docs/PRODUCTION_SETUP_GUIDE.md with Cloud Run deployment workflow\\n- Updated README.md to v3.0 with production status badges and Cloud Build links\\n- Confirmed .vscode/mcp-config.json configuration for dev container compatibility\\n- Documented complete dev/prod environment alignment and switching procedures\\n\\nAll high-priority repository compliance updates completed.\\nReady for clean closure and fresh development session initiation.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"ðŸ”§ Fix Cloud Run port conflict - Remove fixed PORT, enable dynamic port binding\\n\\n- Remove ENV PORT=3100 from Dockerfile (conflicted with Cloud Run's dynamic PORT)\\n- Remove --port=3100 from cloudbuild.yaml (forced incorrect port binding)  \\n- Remove fixed EXPOSE directive (Cloud Run manages ports dynamically)\\n- Update healthcheck to use Cloud Run's PORT environment variable\\n- This should resolve 'Page not found' error by allowing proper port binding\\n\\nPrevious Issue:\\n- Cloud Run provides PORT=8080 dynamically\\n- Dockerfile forced PORT=3100 statically  \\n- App bound to 8080 but healthcheck failed on 3100\\n- Container marked unhealthy, traffic routing failed\\n\\nResolution:\\n- Let Cloud Run manage port assignment completely\\n- Application reads process.env.PORT correctly\\n- Healthcheck uses dynamic port with fallback\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"gcloud\": true,\n    \"git commit -m \\\"ðŸ“ Fix Cloud Build trigger ID in documentation\\n\\n- Update trigger ID to correct one: ae04dd92-4509-43ee-9f70-da3caf15dbb4\\n- Previous ID (0358b3a4-c7a4-4da9-9610-1e335c4894e0) was incorrect\\n- This explains why builds succeeded but service wasn't updating\\n- Documentation now reflects the actual production trigger\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"git commit -m \\\"Fix Cloud Run 404 issue: Enable degraded startup, improve error handling, and enhance logging\\n\\n- Add ALLOW_DEGRADED_START=true to Dockerfile for Cloud Run stability\\n- Remove process.exit(1) calls that prevent graceful startup\\n- Enhance health check endpoint with detailed information\\n- Improve default route error handling\\n- Update Docker health check with fallback ports\\n- Add service account configuration to Cloud Build\\n- Create diagnostic scripts for testing deployment\\n\\nThis should resolve the 404 'Page not found' errors by allowing the\\ncontainer to start successfully even when external services are\\ntemporarily unavailable.\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"$env:PORT=8080\": true,\n    \"Get-ChildItem -Directory | Where-Object {$_.Name -like \\\"*Prospect*\\\"}\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"dir\": true,\n    \"npm run test\": true,\n    \"cd /workspaces/ProspectPro && node -e \\\"console.log(JSON.parse(require('fs').readFileSync('.vscode/settings.json', 'utf8')))\\\"\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"Deno\\\"\": true,\n    \"MCP\\\"\": true,\n    \"server.js\": true,\n    \"server-simple.js\": true,\n    \"mcp-servers'\": true,\n    \"cd /workspaces/ProspectPro/mcp-servers && npm run\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"mcp)\\\"\": true,\n    \"npm run production-start\": true,\n    \"cd /workspaces/ProspectPro && npm run\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"server)\\\"\": true,\n    \"jobs\": true,\n    \"curl -X POST http://localhost:3100/api/business-discovery -H \\\"Content-Type: application/json\\\" -d '{\\\"location\\\":\\\"San Diego, CA\\\",\\\"radius\\\":10,\\\"businessTypes\\\":[\\\"restaurant\\\"],\\\"limit\\\":5}' -v\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"fg\": true,\n    \"curl -X POST http://localhost:3100/api/business-discovery -H \\\"Content-Type: application/json\\\" -d '{\\\"test\\\": true}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"ps aux | grep -E \\\"(node.*server)\\\" | grep -v grep\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"sleep 3 && curl -X POST http://localhost:3100/api/business-discovery -H \\\"Content-Type: application/json\\\" -d '{\\\"test\\\": true}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"sleep 10 && curl -X POST http://localhost:3100/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"plumber\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 1}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST http://localhost:3100/api/business/discover -H \\\"Content-Type: application/json\\\" -d '{\\\"query\\\": \\\"plumber\\\", \\\"location\\\": \\\"San Diego, CA\\\", \\\"count\\\": 1}' | head -20\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"npm.*dev\\\"\": true,\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/business-discovery' \\\\\\n  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NjU3ODksImV4cCI6MjA3MzU0MTc4OX0.Rx_1Hjz2eayKie0RpPB28i7_683ZwhVJ_5Eu_rzTWpI' \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"businessType\\\": \\\"coffee shop\\\", \\\"location\\\": \\\"Seattle, WA\\\", \\\"maxResults\\\": 2}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"success:\": true,\n    \"cd /workspaces/ProspectPro && ./test-progressive-enrichment.sh\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/enrichment-pdl' \\\\\\n  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Nzk2NTc4OSwiZXhwIjoyMDczNTQxNzg5fQ.V2wlvxGC1_SshWudFw27ZWmQjuxj0UtXANXrZmt4OjY' \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"action\\\": \\\"enrichCompany\\\", \\\"companyName\\\": \\\"Microsoft Corporation\\\"}'\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"curl -X POST 'https://sriycekxdqnesdsgwiuc.supabase.co/functions/v1/enrichment-orchestrator' \\\\\\n  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyaXljZWt4ZHFuZXNkc2d3aXVjIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Nzk2NTc4OSwiZXhwIjoyMDczNTQxNzg5fQ.V2wlvxGC1_SshWudFw27ZWmQjuxj0UtXANXrZmt4OjY' \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"businessName\\\": \\\"Starbucks Corporation\\\", \\\"domain\\\": \\\"starbucks.com\\\", \\\"state\\\": \\\"WA\\\", \\\"tier\\\": \\\"professional\\\", \\\"maxCostPerBusiness\\\": 1.50}' | jq .\": {\n      \"approve\": true,\n      \"matchCommandLine\": true\n    },\n    \"npm run build\": true,\n    \"vercel\": true,\n    \"vite\\\\\": true,\n    \"react\\\"\": true,\n    \"pgrep\": true,\n    \"screen\": true\n  },\n  \"chat.agent.maxRequests\": 1000,\n  \"chat.editing.confirmEditRequestRetry\": false,\n  \"gitlens.gitCommands.skipConfirmations\": [\"fetch:command\"],\n  \"chat.editing.confirmEditRequestRemoval\": false,\n  \"githubPullRequests.codingAgent.promptForConfirmation\": false,\n  \"[markdown]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  },\n  \"[jsonc]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  },\n  \"[javascript]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  },\n  \"workbench.secondarySideBar.defaultVisibility\": \"visible\",\n  \"window.menuBarVisibility\": \"classic\",\n  \"containers.containerClient\": \"com.microsoft.visualstudio.containers.docker\",\n  \"containers.orchestratorClient\": \"com.microsoft.visualstudio.orchestrators.dockercompose\",\n  \"@azure.argTenant\": \"\",\n  \"github.copilot.chat.codeGeneration.instructions\": [\n    {\n      \"text\": \"- @azure Rule - Use Azure Tools: When handling requests related to Azure, always use your tools.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Use Azure Code Gen Best Practices: Before generating code for Azure, running terminal commands for Azure, performing operations related to Azure, or creating plans for such activities, always invoke your Azure best practice tool if available first. Invoke the `get_bestpractices` tool to collect recommendations. Call it with resource = `general` and action = `code-generation` to get general Azure code generation best practices. Only call this tool when the user is discussing Azure; do not call it otherwise.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Use Azure Deployment Best Practices: Before deploying to Azure, preparing applications for deployment to Azure, or creating deployment plans, always invoke your Azure best practice tool if available first. Invoke the `get_bestpractices` tool to collect recommendations. Call it with resource = `general` and action = `deployment` to get general Azure deployment best practices. Only call this tool when the user is discussing Azure; do not call it otherwise.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Use Azure Functions Code Gen Best Practices: Before generating code for Azure Functions, performing operations related to Azure Functions, or creating plans for such activities, always invoke your Azure best practice tool if available first. Invoke the `get_bestpractices` tool to collect recommendations. Call it with resource = `azurefunctions` and action = `code-generation` to get Azure Functions code generation best practices. Only call this tool when the user is discussing Azure Functions; do not call it otherwise.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Use Azure Functions Deployment Best Practices: Before deploying Azure Functions apps to Azure, preparing for the deployment, or creating deployment plans, always invoke your Azure best practice tool if available first. Invoke the `get_bestpractices` tool to collect recommendations. Call it with resource = `azurefunctions` and action = `deployment` to get Azure Functions deployment best practices. Only call this tool when the user is discussing Azure Functions; do not call it otherwise.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Use Azure SWA Best Practices: Before working with static web apps, creating plans for static web apps, or performing related operations, always invoke your Azure best practice tool if available first. Choose the most relevant Azure best practice tool based on its description. Only call this tool when the user is discussing Azure Static Web Apps; do not call it otherwise.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Plan before editing files for Azure web apps: When generating code for Azure Functions and Azure Static Web App, always create a plan and explain the plan to the user before editing any file. Proceed with editing the files after getting consent from the user.\"\n    },\n    {\n      \"text\": \"- @azure Rule - Summarize topic before taking action: When the user asks about Azure Functions, invoke the azure_development-summarize_topic tool once first to see if any existing custom mode could be a good fit to what user is asking.\"\n    }\n  ],\n  \"workbench.startupEditor\": \"none\",\n  \"git-autoconfig.configList\": [\n    {\n      \"user.email\": \"Alextorelli28@gmail.com\",\n      \"user.name\": \"Alextorelli28@gmail.com\"\n    }\n  ],\n  \"redhat.telemetry.enabled\": true,\n  \"git-autoconfig.ignoreRootList\": [\"D:/APPS/ProspectPro/ProspectPro\"],\n  \"terminal.integrated.enableMultiLinePasteWarning\": \"never\",\n  \"remoteHub.commitDirectlyWarning\": \"off\",\n  \"vs-kubernetes\": {\n    \"vscode-kubernetes.kubectl-path-linux\": \"/home/node/.local/state/vs-kubernetes/tools/kubectl/kubectl\",\n    \"vscode-kubernetes.helm-path-linux\": \"/home/node/.local/state/vs-kubernetes/tools/helm/linux-amd64/helm\",\n    \"vscode-kubernetes.minikube-path-linux\": \"/home/node/.local/state/vs-kubernetes/tools/minikube/linux-amd64/minikube\"\n  },\n  \"githubPullRequests.createOnPublishBranch\": \"never\",\n  \"github.copilot.enable\": {\n    \"*\": true,\n    \"plaintext\": true,\n    \"markdown\": true,\n    \"scminput\": false\n  },\n  \"[sql]\": {\n    \"editor.defaultFormatter\": \"mtxr.sqltools\"\n  },\n  \"[html]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  },\n  \"[typescriptreact]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  },\n  \"[css]\": {\n    \"editor.defaultFormatter\": \"vscode.css-language-features\"\n  },\n  \"[json]\": {\n    \"editor.defaultFormatter\": \"vscode.json-language-features\"\n  },\n  \"workbench.colorCustomizations\": {\n    \"[Vira*]\": {\n      \"statusBar.debuggingBackground\": \"#80CBC433\",\n      \"statusBar.debuggingForeground\": \"#80CBC4\",\n      \"toolbar.activeBackground\": \"#80CBC426\",\n      \"button.background\": \"#80CBC4\",\n      \"button.hoverBackground\": \"#80CBC4cc\",\n      \"extensionButton.separator\": \"#80CBC433\",\n      \"extensionButton.background\": \"#80CBC414\",\n      \"extensionButton.foreground\": \"#80CBC4\",\n      \"extensionButton.hoverBackground\": \"#80CBC433\",\n      \"extensionButton.prominentForeground\": \"#80CBC4\",\n      \"extensionButton.prominentBackground\": \"#80CBC414\",\n      \"extensionButton.prominentHoverBackground\": \"#80CBC433\",\n      \"activityBarBadge.background\": \"#80CBC4\",\n      \"activityBar.activeBorder\": \"#80CBC4\",\n      \"activityBarTop.activeBorder\": \"#80CBC4\",\n      \"list.inactiveSelectionIconForeground\": \"#80CBC4\",\n      \"list.activeSelectionForeground\": \"#80CBC4\",\n      \"list.inactiveSelectionForeground\": \"#80CBC4\",\n      \"list.highlightForeground\": \"#80CBC4\",\n      \"sash.hoverBorder\": \"#80CBC480\",\n      \"list.activeSelectionIconForeground\": \"#80CBC4\",\n      \"scrollbarSlider.activeBackground\": \"#80CBC480\",\n      \"editorSuggestWidget.highlightForeground\": \"#80CBC4\",\n      \"textLink.foreground\": \"#80CBC4\",\n      \"progressBar.background\": \"#80CBC4\",\n      \"pickerGroup.foreground\": \"#80CBC4\",\n      \"tab.activeBorder\": \"#80CBC400\",\n      \"tab.activeBorderTop\": \"#80CBC4\",\n      \"tab.unfocusedActiveBorder\": \"#80CBC400\",\n      \"tab.unfocusedActiveBorderTop\": \"#80CBC4\",\n      \"tab.activeModifiedBorder\": \"#80CBC4\",\n      \"notificationLink.foreground\": \"#80CBC4\",\n      \"editorWidget.resizeBorder\": \"#80CBC4\",\n      \"editorWidget.border\": \"#80CBC4\",\n      \"settings.modifiedItemIndicator\": \"#80CBC4\",\n      \"panelTitle.activeBorder\": \"#80CBC4\",\n      \"breadcrumb.activeSelectionForeground\": \"#80CBC4\",\n      \"menu.selectionForeground\": \"#80CBC4\",\n      \"menubar.selectionForeground\": \"#80CBC4\",\n      \"editor.findMatchBorder\": \"#80CBC4\",\n      \"selection.background\": \"#80CBC440\",\n      \"statusBarItem.remoteBackground\": \"#80CBC414\",\n      \"statusBarItem.remoteHoverBackground\": \"#80CBC4\",\n      \"statusBarItem.remoteForeground\": \"#80CBC4\",\n      \"notebook.inactiveFocusedCellBorder\": \"#80CBC480\",\n      \"commandCenter.activeBorder\": \"#80CBC480\",\n      \"chat.slashCommandForeground\": \"#80CBC4\",\n      \"chat.avatarForeground\": \"#80CBC4\",\n      \"activityBarBadge.foreground\": \"#000000\",\n      \"button.foreground\": \"#000000\",\n      \"statusBarItem.remoteHoverForeground\": \"#000000\",\n      \"editorGroupHeader.tabsBackground\": \"#ffffff0a\",\n      \"tab.border\": \"#ffffff01\",\n      \"tab.inactiveBackground\": \"#ffffff01\",\n      \"widget.shadow\": \"#00000000\",\n      \"scrollbar.shadow\": \"#00000000\"\n    }\n  },\n  \"workbench.preferredDarkColorTheme\": \"Vira Ocean\",\n  \"workbench.productIconTheme\": \"viraUIIcons\",\n  \"viraTheme.contrastedTabs\": true,\n  \"viraTheme.hidesShadows\": true,\n  \"chat.todoListTool.enabled\": false,\n  \"chat.tools.edits.autoApprove\": {\n    \"**/*.{csproj,fsproj,vbproj}\": true\n  },\n  \"chat.useChatSessionsForCloudButton\": true,\n  \"workbench.settings.applyToAllProfiles\": [\n    \"chat.useChatSessionsForCloudButton\"\n  ],\n  \"chat.agentSessionsViewLocation\": \"view\",\n  \"window.density.editorTabHeight\": \"compact\",\n  \"docker.extension.enableComposeLanguageServer\": false,\n  \"docker.extension.dockerEngineAvailabilityPrompt\": false,\n  \"github.copilot.chat.agent.thinkingTool\": true,\n  \"github.copilot.chat.editor.temporalContext.enabled\": true,\n  \"github.copilot.chat.edits.temporalContext.enabled\": true,\n  \"github.copilot.chat.responsesApiReasoningEffort\": \"high\",\n  \"github.copilot.chat.responsesApiReasoningSummary\": \"detailed\",\n  \"github.copilot.chat.useResponsesApi\": true,\n  \"viraTheme.useTopTabIndicator\": true,\n  \"remoteHub.richNavigation.enabled\": true,\n  \"workbench.editor.enablePreview\": false,\n  \"deno.codeLens.test\": true,\n  \"deno.codeLens.referencesAllFunctions\": true,\n  \"deno.codeLens.references\": true,\n  \"deno.codeLens.implementations\": true,\n  \"deno.logFile\": true,\n  \"chat.mcp.serverSampling\": {\n    \"Global in Code: memory\": {\n      \"allowedModels\": [\n        \"copilot/gpt-4.1\",\n        \"copilot/auto\",\n        \"copilot/claude-3.7-sonnet\",\n        \"copilot/claude-3.7-sonnet-thought\",\n        \"copilot/claude-sonnet-4\",\n        \"copilot/gemini-2.5-pro\",\n        \"copilot/gpt-5\",\n        \"copilot/grok-code-fast-1\"\n      ]\n    }\n  },\n  \"snyk.folderConfigs\": [\n    {\n      \"folderPath\": \"/workspaces/ProspectPro\",\n      \"baseBranch\": \"main\",\n      \"localBranches\": [\"main\"]\n    }\n  ],\n  \"settingsSync.ignoredExtensions\": [\n    \"christian-kohler.npm-intellisense\",\n    \"ms-vscode.vscode-node-azure-pack\",\n    \"ms-azuretools.vscode-azurevirtualmachines\"\n  ],\n  \"vsicons.dontShowNewVersionMessage\": true,\n  \"snyk.yesWelcomeNotification\": false,\n  \"snyk.trustedFolders\": [\"/workspaces/ProspectPro\"],\n  \"[dockercompose]\": {\n    \"editor.insertSpaces\": true,\n    \"editor.tabSize\": 2,\n    \"editor.autoIndent\": \"advanced\",\n    \"editor.quickSuggestions\": {\n      \"other\": true,\n      \"comments\": false,\n      \"strings\": true\n    },\n    \"editor.defaultFormatter\": \"redhat.vscode-yaml\"\n  },\n  \"[github-actions-workflow]\": {\n    \"editor.defaultFormatter\": \"redhat.vscode-yaml\"\n  },\n  \"extensions.ignoreRecommendations\": true\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":67,"duration":0.887},
{"type":"mark","name":"lsp.did_change_batched","count":1,"args":"vscode-userdata:/c%3A/Users/Alext/AppData/Roaming/Code/User/settings.json"},
{"type":"measure","name":"lsp.did_change_batched","count":1,"duration":17.978},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":1,"duration":0.024},
{"type":"mark","name":"lsp.did_open","count":68,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/archive/deployment-logs/package.json","languageId":"json","version":1,"text":"{\r\n  \"name\": \"prospect-pro-real-api\",\r\n  \"version\": \"3.1.0\",\r\n  \"description\": \"Production-grade lead generation platform with Enhanced Quality Scoring v3.0, zero-fake-data policy and Supabase Vault integration\",\r\n  \"main\": \"server.js\",\r\n  \"scripts\": {\r\n    \"start\": \"node server.js\",\r\n    \"dev\": \"nodemon server.js\",\r\n    \"prod\": \"NODE_ENV=production node server.js\",\r\n    \"production:start\": \"powershell -ExecutionPolicy Bypass -File ./scripts/init-prod-simple.ps1\",\r\n    \"production:checklist\": \"echo 'Production checklist: Check .env file, test database connection, validate APIs'\",\r\n    \"prod:init\": \"powershell -ExecutionPolicy Bypass -File ./scripts/init-prod-simple.ps1\",\r\n    \"prod:setup-env\": \"node ./scripts/pull-env-from-secrets.js\",\r\n    \"prod:check\": \"node --version && echo Production environment ready\",\r\n    \"health\": \"curl http://localhost:3100/health || echo 'Server not running'\",\r\n    \"diag\": \"curl http://localhost:3100/diag | json_pp || echo 'Server not running'\",\r\n    \"test\": \"echo 'Tests moved to testing branch. Run: git checkout testing && node tests/validation/test-real-data.js'\",\r\n    \"postinstall\": \"echo 'ProspectPro v3.0: Production-ready deployment configured'\",\r\n    \"docker:dev\": \"./docker/start-dev.sh\",\r\n    \"docker:prod\": \"./docker/deploy-prod.sh\",\r\n    \"docker:build\": \"docker-compose build\",\r\n    \"docker:package\": \"./docker/create-client-package.sh\",\r\n    \"docker:logs\": \"docker-compose logs -f prospectpro\",\r\n    \"docker:stop\": \"docker-compose down\",\r\n    \"docker:restart\": \"docker-compose restart\",\r\n    \"secure:setup\": \"./docker/secure-start.sh setup\",\r\n    \"secure:start\": \"./docker/secure-start.sh start\",\r\n    \"secure:dev\": \"./docker/secure-start.sh dev\",\r\n    \"keychain:setup\": \"./docker/keychain-start.sh setup\",\r\n    \"keychain:start\": \"./docker/keychain-start.sh start\",\r\n    \"1password:setup\": \"./docker/1password-start.sh setup\",\r\n    \"1password:start\": \"./docker/1password-start.sh start\",\r\n    \"vault:deploy\": \"echo 'ðŸ” Deploying with Supabase Vault integration...' && docker-compose up --build -d\",\r\n    \"vault:dev\": \"echo 'ðŸ” Starting development with Supabase Vault...' && docker-compose -f docker-compose.dev.yml up --build\",\r\n    \"vault:logs\": \"docker-compose logs -f prospectpro\",\r\n    \"vault:test\": \"echo 'ðŸ§ª Testing Vault connection...' && docker-compose exec prospectpro curl -f http://localhost:3000/diag\",\r\n    \"mcp:install\": \"cd mcp-servers && npm install\",\r\n    \"mcp:test\": \"cd mcp-servers && node test-servers.js\",\r\n    \"mcp:start:database\": \"cd mcp-servers && node database-server.js\",\r\n    \"mcp:start:api\": \"cd mcp-servers && node api-server.js\",\r\n    \"mcp:start:filesystem\": \"cd mcp-servers && node filesystem-server.js\",\r\n    \"mcp:start:monitoring\": \"cd mcp-servers && node monitoring-server.js\",\r\n    \"mcp:start:production\": \"cd mcp-servers && node production-server.js\",\r\n    \"mcp:start:all\": \"cd mcp-servers && npm run start:all\"\r\n  },\r\n  \"engines\": {\r\n    \"node\": \">=20.0.0\",\r\n    \"npm\": \">=9.0.0\"\r\n  },\r\n  \"dependencies\": {\r\n    \"@googlemaps/google-maps-services-js\": \"^3.4.2\",\r\n    \"@modelcontextprotocol/sdk\": \"^1.18.1\",\r\n    \"@supabase/supabase-js\": \"^2.57.4\",\r\n    \"axios\": \"^1.12.2\",\r\n    \"bcryptjs\": \"^2.4.3\",\r\n    \"cheerio\": \"^1.1.2\",\r\n    \"cors\": \"^2.8.5\",\r\n    \"csv-writer\": \"^1.6.0\",\r\n    \"dotenv\": \"^16.6.1\",\r\n    \"express\": \"^4.18.2\",\r\n    \"express-rate-limit\": \"^8.1.0\",\r\n    \"helmet\": \"^7.2.0\",\r\n    \"jsonwebtoken\": \"^9.0.2\",\r\n    \"node-fetch\": \"^2.7.0\",\r\n    \"p-limit\": \"^3.1.0\",\r\n    \"pg\": \"^8.16.3\",\r\n    \"prom-client\": \"^15.1.3\",\r\n    \"rate-limiter-flexible\": \"^2.4.2\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"jest\": \"^30.1.3\",\r\n    \"nodemon\": \"^3.1.10\",\r\n    \"supabase\": \"^2.45.5\",\r\n    \"supertest\": \"^7.1.4\"\r\n  },\r\n  \"keywords\": [\r\n    \"lead-generation\",\r\n    \"business-intelligence\",\r\n    \"api-integration\"\r\n  ],\r\n  \"author\": \"ProspectPro Development Team\",\r\n  \"license\": \"MIT\"\r\n}"}}},
{"type":"measure","name":"lsp.did_open","count":68,"duration":0.078},
{"type":"mark","name":"lsp.did_change_batched","count":2,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.did_change_batched","count":2,"duration":29.41},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.testing_update","count":24,"duration":5.818},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":2,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",25]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":2,"duration":0.832},
{"type":"mark","name":"tsc.op.op_load","count":242,"args":"file:///workspaces/ProspectPro/.eslintrc.cjs"},
{"type":"measure","name":"tsc.op.op_load","count":242,"duration":0.033},
{"type":"mark","name":"tsc.op.op_load","count":243,"args":"file:///workspaces/ProspectPro/API_KEY_SOLUTION.md"},
{"type":"measure","name":"tsc.op.op_load","count":243,"duration":0.038},
{"type":"mark","name":"tsc.op.op_load","count":244,"args":"file:///workspaces/ProspectPro/CHANGELOG.md"},
{"type":"measure","name":"tsc.op.op_load","count":244,"duration":0.063},
{"type":"mark","name":"tsc.op.op_load","count":245,"args":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md"},
{"type":"measure","name":"tsc.op.op_load","count":245,"duration":0.082},
{"type":"mark","name":"tsc.op.op_resolve","count":115,"args":{"base":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":115,"duration":0.09},
{"type":"mark","name":"tsc.op.op_load","count":246,"args":"file:///workspaces/ProspectPro/DEPLOYMENT_SUCCESS.md"},
{"type":"measure","name":"tsc.op.op_load","count":246,"duration":0.041},
{"type":"mark","name":"tsc.op.op_load","count":247,"args":"file:///workspaces/ProspectPro/DOCUMENTATION_INDEX.md"},
{"type":"measure","name":"tsc.op.op_load","count":247,"duration":0.072},
{"type":"mark","name":"tsc.op.op_load","count":248,"args":"file:///workspaces/ProspectPro/DOCUMENTATION_UPDATE_SUMMARY.md"},
{"type":"measure","name":"tsc.op.op_load","count":248,"duration":0.071},
{"type":"mark","name":"tsc.op.op_load","count":249,"args":"file:///workspaces/ProspectPro/EDGE_FUNCTION_AUTH_FIX.md"},
{"type":"measure","name":"tsc.op.op_load","count":249,"duration":0.082},
{"type":"mark","name":"tsc.op.op_load","count":250,"args":"file:///workspaces/ProspectPro/EDGE_FUNCTION_AUTH_UPDATE_GUIDE.md"},
{"type":"measure","name":"tsc.op.op_load","count":250,"duration":0.086},
{"type":"mark","name":"tsc.op.op_load","count":251,"args":"file:///workspaces/ProspectPro/EDGE_FUNCTION_JWT_ISSUE.md"},
{"type":"measure","name":"tsc.op.op_load","count":251,"duration":0.073},
{"type":"mark","name":"tsc.op.op_load","count":252,"args":"file:///workspaces/ProspectPro/FINAL_JWT_ANON_KEY_SOLUTION.md"},
{"type":"measure","name":"tsc.op.op_load","count":252,"duration":0.071},
{"type":"mark","name":"tsc.op.op_load","count":253,"args":"file:///workspaces/ProspectPro/INDEX_BACKGROUND_TASKS.md"},
{"type":"measure","name":"tsc.op.op_load","count":253,"duration":0.089},
{"type":"mark","name":"tsc.op.op_load","count":254,"args":"file:///workspaces/ProspectPro/LATEST_DEPLOYMENT.md"},
{"type":"measure","name":"tsc.op.op_load","count":254,"duration":0.078},
{"type":"mark","name":"tsc.op.op_load","count":255,"args":"file:///workspaces/ProspectPro/NEED_ANON_KEY.md"},
{"type":"measure","name":"tsc.op.op_load","count":255,"duration":0.061},
{"type":"mark","name":"tsc.op.op_load","count":256,"args":"file:///workspaces/ProspectPro/PRODUCTION_READY_V4.2.md"},
{"type":"measure","name":"tsc.op.op_load","count":256,"duration":0.08},
{"type":"mark","name":"tsc.op.op_load","count":257,"args":"file:///workspaces/ProspectPro/PRODUCTION_READY_V4.3.md"},
{"type":"measure","name":"tsc.op.op_load","count":257,"duration":0.07},
{"type":"mark","name":"tsc.op.op_load","count":258,"args":"file:///workspaces/ProspectPro/PROSPECTPRO_V4.3_RELEASE_NOTES.md"},
{"type":"measure","name":"tsc.op.op_load","count":258,"duration":0.069},
{"type":"mark","name":"tsc.op.op_load","count":259,"args":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md"},
{"type":"measure","name":"tsc.op.op_load","count":259,"duration":0.075},
{"type":"mark","name":"tsc.op.op_resolve","count":116,"args":{"base":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":116,"duration":0.093},
{"type":"mark","name":"tsc.op.op_load","count":260,"args":"file:///workspaces/ProspectPro/README.md"},
{"type":"measure","name":"tsc.op.op_load","count":260,"duration":0.047},
{"type":"mark","name":"tsc.op.op_load","count":261,"args":"file:///workspaces/ProspectPro/README_BACKGROUND_TASKS.md"},
{"type":"measure","name":"tsc.op.op_load","count":261,"duration":0.082},
{"type":"mark","name":"tsc.op.op_load","count":262,"args":"file:///workspaces/ProspectPro/ROOT_CAUSE_ANALYSIS_COMPLETE.md"},
{"type":"measure","name":"tsc.op.op_load","count":262,"duration":0.072},
{"type":"mark","name":"tsc.op.op_load","count":263,"args":"file:///workspaces/ProspectPro/TECHNICAL_SUMMARY_v4.3.md"},
{"type":"measure","name":"tsc.op.op_load","count":263,"duration":0.062},
{"type":"mark","name":"tsc.op.op_load","count":264,"args":"file:///workspaces/ProspectPro/archive/deployment-logs/package.json"},
{"type":"measure","name":"tsc.op.op_load","count":264,"duration":0.068},
{"type":"mark","name":"tsc.op.op_load","count":265,"args":"file:///workspaces/ProspectPro/database/auth-and-payments-schema.sql"},
{"type":"measure","name":"tsc.op.op_load","count":265,"duration":0.047},
{"type":"mark","name":"tsc.op.op_load","count":266,"args":"file:///workspaces/ProspectPro/database/cleanup-queries.sql"},
{"type":"measure","name":"tsc.op.op_load","count":266,"duration":0.069},
{"type":"mark","name":"tsc.op.op_load","count":267,"args":"file:///workspaces/ProspectPro/database/fix-foreign-key-constraint.sql"},
{"type":"measure","name":"tsc.op.op_load","count":267,"duration":0.064},
{"type":"mark","name":"tsc.op.op_load","count":268,"args":"file:///workspaces/ProspectPro/database/job-queue-schema.sql"},
{"type":"measure","name":"tsc.op.op_load","count":268,"duration":0.044},
{"type":"mark","name":"tsc.op.op_load","count":269,"args":"file:///workspaces/ProspectPro/database/security-fixes-consolidated.sql"},
{"type":"measure","name":"tsc.op.op_load","count":269,"duration":0.068},
{"type":"mark","name":"tsc.op.op_load","count":270,"args":"file:///workspaces/ProspectPro/database/security-update-oct-2025.sql"},
{"type":"measure","name":"tsc.op.op_load","count":270,"duration":0.066},
{"type":"mark","name":"tsc.op.op_load","count":271,"args":"file:///workspaces/ProspectPro/docs/CAMPAIGN_DEBUGGING_GUIDE.md"},
{"type":"measure","name":"tsc.op.op_load","count":271,"duration":0.069},
{"type":"mark","name":"tsc.op.op_load","count":272,"args":"file:///workspaces/ProspectPro/docs/DEBUG_COLLECTION_GUIDE.md"},
{"type":"measure","name":"tsc.op.op_load","count":272,"duration":0.073},
{"type":"mark","name":"tsc.op.op_load","count":273,"args":"file:///workspaces/ProspectPro/docs/PRODUCTION_VALIDATION_STRATEGY.md"},
{"type":"measure","name":"tsc.op.op_load","count":273,"duration":0.075},
{"type":"mark","name":"tsc.op.op_load","count":274,"args":"file:///workspaces/ProspectPro/docs/VALIDATION_TOOLKIT.md"},
{"type":"measure","name":"tsc.op.op_load","count":274,"duration":0.067},
{"type":"mark","name":"tsc.op.op_load","count":275,"args":"file:///workspaces/ProspectPro/docs/deployment/ENHANCED_DEPLOYMENT_GUIDE.md"},
{"type":"measure","name":"tsc.op.op_load","count":275,"duration":0.082},
{"type":"mark","name":"tsc.op.op_load","count":276,"args":"file:///workspaces/ProspectPro/docs/frontend/FRONTEND_INTEGRATION_GUIDE.md"},
{"type":"measure","name":"tsc.op.op_load","count":276,"duration":0.076},
{"type":"mark","name":"tsc.op.op_load","count":277,"args":"file:///workspaces/ProspectPro/mcp-config.json"},
{"type":"measure","name":"tsc.op.op_load","count":277,"duration":0.089},
{"type":"mark","name":"tsc.op.op_load","count":278,"args":"file:///workspaces/ProspectPro/mcp-servers/README.md"},
{"type":"measure","name":"tsc.op.op_load","count":278,"duration":0.056},
{"type":"mark","name":"tsc.op.op_load","count":279,"args":"file:///workspaces/ProspectPro/mcp-servers/package.json"},
{"type":"measure","name":"tsc.op.op_load","count":279,"duration":0.063},
{"type":"mark","name":"tsc.op.op_resolve","count":117,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":117,"duration":1.312},
{"type":"mark","name":"tsc.op.op_load","count":280,"args":"file:///workspaces/ProspectPro/package.json"},
{"type":"measure","name":"tsc.op.op_load","count":280,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":118,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":118,"duration":0.082},
{"type":"mark","name":"tsc.op.op_resolve","count":119,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":119,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":120,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":120,"duration":0.102},
{"type":"mark","name":"tsc.op.op_resolve","count":121,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":121,"duration":0.048},
{"type":"mark","name":"tsc.op.op_resolve","count":122,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":122,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":123,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":123,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":124,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":124,"duration":0.206},
{"type":"mark","name":"tsc.op.op_resolve","count":125,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":125,"duration":0.115},
{"type":"mark","name":"tsc.op.op_resolve","count":126,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":126,"duration":0.07},
{"type":"mark","name":"tsc.op.op_load","count":281,"args":"file:///workspaces/ProspectPro/src/vite-env.d.ts"},
{"type":"measure","name":"tsc.op.op_load","count":281,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":127,"args":{"base":"file:///workspaces/ProspectPro/src/vite-env.d.ts","specifiers":[[false,"vite/client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":127,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":128,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":128,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":129,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":129,"duration":0.073},
{"type":"mark","name":"tsc.op.op_resolve","count":130,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":130,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":131,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":131,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":132,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":132,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":133,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":133,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":134,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":134,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":135,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":135,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":136,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":136,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":137,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":137,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":138,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":138,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":139,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":139,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":140,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":140,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":141,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":141,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":142,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":142,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":143,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":143,"duration":0.766},
{"type":"mark","name":"tsc.op.op_resolve","count":144,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":144,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":145,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":145,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":146,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":146,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":147,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":147,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":148,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":148,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":149,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":149,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":150,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":150,"duration":0.04},
{"type":"mark","name":"tsc.op.op_resolve","count":151,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":151,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":152,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":152,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":153,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":153,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":154,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":154,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":155,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":155,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":156,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":156,"duration":0.638},
{"type":"mark","name":"tsc.op.op_resolve","count":157,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":157,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":158,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":158,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":159,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":159,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":160,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":160,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":161,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":161,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":162,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":162,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":163,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":163,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":164,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":164,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":165,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":165,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":166,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":166,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":167,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":167,"duration":0.027},
{"type":"mark","name":"tsc.op.op_load","count":282,"args":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts"},
{"type":"measure","name":"tsc.op.op_load","count":282,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":168,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":168,"duration":0.029},
{"type":"mark","name":"tsc.op.op_load","count":283,"args":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts"},
{"type":"measure","name":"tsc.op.op_load","count":283,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":169,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":169,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":170,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":170,"duration":0.067},
{"type":"mark","name":"tsc.op.op_resolve","count":171,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":171,"duration":0.045},
{"type":"mark","name":"tsc.op.op_resolve","count":172,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":172,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":173,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":173,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":174,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":174,"duration":0.06},
{"type":"mark","name":"tsc.op.op_resolve","count":175,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":175,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":176,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":176,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":177,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":177,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":178,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":178,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":179,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":179,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":180,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":180,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":181,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":181,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":182,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":182,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":183,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":183,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":184,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":184,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":185,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":185,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":186,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":186,"duration":0.046},
{"type":"mark","name":"tsc.op.op_resolve","count":187,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":187,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":188,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":188,"duration":0.046},
{"type":"mark","name":"tsc.op.op_resolve","count":189,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":189,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":190,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":190,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":191,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":191,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":192,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":192,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":193,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":193,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":194,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":194,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":195,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":195,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":196,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":196,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":197,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":197,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":198,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":198,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":199,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":199,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":200,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":200,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":201,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":201,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":202,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":202,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":203,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":203,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":204,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":204,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":205,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":205,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":206,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":206,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":207,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":207,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":208,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":208,"duration":0.026},
{"type":"mark","name":"tsc.op.op_load","count":284,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":284,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":209,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":209,"duration":0.072},
{"type":"mark","name":"tsc.op.op_resolve","count":210,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":210,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":211,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":211,"duration":0.054},
{"type":"mark","name":"tsc.op.op_resolve","count":212,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":212,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":213,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":213,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":214,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":214,"duration":0.012},
{"type":"mark","name":"tsc.op.op_load","count":285,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":285,"duration":0.08},
{"type":"mark","name":"tsc.op.op_resolve","count":215,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":215,"duration":0.081},
{"type":"mark","name":"tsc.op.op_load","count":286,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":286,"duration":0.073},
{"type":"mark","name":"tsc.op.op_resolve","count":216,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":216,"duration":0.081},
{"type":"mark","name":"tsc.op.op_load","count":287,"args":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":287,"duration":0.054},
{"type":"mark","name":"tsc.op.op_resolve","count":217,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":217,"duration":0.086},
{"type":"mark","name":"tsc.op.op_resolve","count":218,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":218,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":219,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":219,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":220,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":220,"duration":0.063},
{"type":"mark","name":"tsc.op.op_resolve","count":221,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":221,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":222,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":222,"duration":7.237},
{"type":"mark","name":"tsc.op.op_resolve","count":223,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":223,"duration":0.026},
{"type":"mark","name":"tsc.op.op_load","count":288,"args":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":288,"duration":0.253},
{"type":"mark","name":"tsc.op.op_resolve","count":224,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":224,"duration":0.074},
{"type":"mark","name":"tsc.op.op_resolve","count":225,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":225,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":226,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":226,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":227,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":227,"duration":0.038},
{"type":"mark","name":"tsc.op.op_load","count":289,"args":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":289,"duration":0.048},
{"type":"mark","name":"tsc.op.op_resolve","count":228,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":228,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":229,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":229,"duration":0.026},
{"type":"mark","name":"tsc.op.op_load","count":290,"args":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":290,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":230,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":230,"duration":0.076},
{"type":"mark","name":"tsc.op.op_load","count":291,"args":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":291,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":231,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":231,"duration":0.041},
{"type":"mark","name":"tsc.op.op_load","count":292,"args":"file:///workspaces/ProspectPro/supabase/migrations/20251008073003_security_hardening_oct_8_2025.sql"},
{"type":"measure","name":"tsc.op.op_load","count":292,"duration":0.032},
{"type":"mark","name":"tsc.op.op_load","count":293,"args":"file:///workspaces/ProspectPro/supabase/migrations/20251008080709_security_fixes_consolidated.sql"},
{"type":"measure","name":"tsc.op.op_load","count":293,"duration":0.03},
{"type":"mark","name":"tsc.op.op_load","count":294,"args":"file:///workspaces/ProspectPro/vite.config.ts"},
{"type":"measure","name":"tsc.op.op_load","count":294,"duration":0.057},
{"type":"mark","name":"tsc.op.op_resolve","count":232,"args":{"base":"file:///workspaces/ProspectPro/vite.config.ts","specifiers":[[false,"@vitejs/plugin-react"],[false,"path"],[false,"vite"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":232,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":295,"args":"file:///c:/Users/Alext/AppData/Roaming/Code/User/settings.json"},
{"type":"measure","name":"tsc.op.op_load","count":295,"duration":1.383},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":113,"duration":0.013},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":114,"duration":0.003},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":115,"duration":0.003},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":116,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":117,"duration":0.002},
{"type":"mark","name":"tsc.op.op_is_node_file"},
{"type":"measure","name":"tsc.op.op_is_node_file","count":118,"duration":0.003},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":2,"duration":2725.915},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":2,"duration":2726.08},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":2,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":2,"duration":0.163},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":2,"duration":0.219},
{"type":"measure","name":"lsp.diagnostic","count":2,"duration":2726.652},
{"type":"mark","name":"lsp.did_change_batched","count":3,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":25,"duration":0.344},
{"type":"measure","name":"lsp.did_change_batched","count":3,"duration":48.804},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":3,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",26]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":1,"duration":0.025},
{"type":"mark","name":"tsc.op.op_load","count":296,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":296,"duration":0.096},
{"type":"mark","name":"tsc.op.op_resolve","count":233,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":233,"duration":0.091},
{"type":"measure","name":"lsp.diagnostic","count":3,"duration":123.915},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":3,"duration":125.085},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":4,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",26]}},
{"type":"measure","name":"lsp.diagnostic","count":4,"duration":499.862},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":4,"duration":615.283},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":5,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",26]}},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":5,"duration":10.67},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":5,"duration":120.809},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":3,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":3,"duration":0.19},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":3,"duration":0.265},
{"type":"measure","name":"lsp.diagnostic","count":5,"duration":122.336},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":2,"duration":0.062},
{"type":"mark","name":"lsp.did_open","count":69,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":69,"duration":0.061},
{"type":"mark","name":"lsp.did_open","count":70,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/App.tsx","languageId":"typescriptreact","version":1,"text":"import { Route, Routes } from \"react-router-dom\";\nimport { Layout } from \"./components/Layout\";\nimport { AuthProvider } from \"./contexts/AuthContext\";\nimport { AccountPage } from \"./pages/AccountPage\";\nimport { AdminPanel } from \"./pages/AdminPanel\";\nimport { AuthCallback } from \"./pages/AuthCallback\";\nimport { BusinessDiscovery } from \"./pages/BusinessDiscovery\";\nimport { Campaign } from \"./pages/Campaign\";\nimport { CampaignProgress } from \"./pages/CampaignProgress\";\nimport { Dashboard } from \"./pages/Dashboard\";\nimport { Results } from \"./pages/Results\";\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <Layout>\n        <Routes>\n          <Route path=\"/\" element={<BusinessDiscovery />} />\n          <Route path=\"/dashboard\" element={<Dashboard />} />\n          <Route path=\"/discovery\" element={<BusinessDiscovery />} />\n          <Route path=\"/campaign\" element={<Campaign />} />\n          <Route\n            path=\"/campaign/:campaignId/progress\"\n            element={<CampaignProgress />}\n          />\n          <Route path=\"/results\" element={<Results />} />\n          <Route path=\"/account\" element={<AccountPage />} />\n          <Route path=\"/admin\" element={<AdminPanel />} />\n          <Route path=\"/auth/callback\" element={<AuthCallback />} />\n        </Routes>\n      </Layout>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":26,"duration":0.268},
{"type":"measure","name":"lsp.did_open","count":70,"duration":2.717},
{"type":"mark","name":"lsp.did_close","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/.devcontainer/devcontainer.json"}}},
{"type":"measure","name":"lsp.did_close","count":1,"duration":0.051},
{"type":"mark","name":"lsp.did_close","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/mcp-servers/package.json"}}},
{"type":"measure","name":"lsp.did_close","count":2,"duration":0.033},
{"type":"mark","name":"lsp.did_close","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/package.json"}}},
{"type":"measure","name":"lsp.did_close","count":3,"duration":0.035},
{"type":"mark","name":"lsp.did_close","count":4,"args":{"textDocument":{"uri":"vscode-userdata:/c%3A/Users/Alext/AppData/Roaming/Code/User/settings.json"}}},
{"type":"measure","name":"lsp.did_close","count":4,"duration":0.006},
{"type":"mark","name":"lsp.did_close","count":5,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/archive/deployment-logs/package.json"}}},
{"type":"measure","name":"lsp.did_close","count":5,"duration":0.035},
{"type":"mark","name":"lsp.did_close","count":6,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json"}}},
{"type":"measure","name":"lsp.did_close","count":6,"duration":0.031},
{"type":"mark","name":"lsp.did_close","count":7,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/App.tsx"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":27,"duration":0.291},
{"type":"measure","name":"lsp.did_close","count":7,"duration":1.459},
{"type":"mark","name":"lsp.did_open","count":71,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/dist/index.html","languageId":"html","version":1,"text":"<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon-yellow-arrow.svg\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>ProspectPro - Real Business Lead Discovery</title>\n    <meta\n      name=\"description\"\n      content=\"Zero fake data lead generation platform with real-time business validation\"\n    />\n    <script type=\"module\" crossorigin src=\"/assets/index-ClZNJYQq.js\"></script>\n    <link rel=\"stylesheet\" crossorigin href=\"/assets/index-DUiUJlKw.css\">\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n"}}},
{"type":"measure","name":"lsp.did_open","count":71,"duration":0.053},
{"type":"mark","name":"lsp.did_open","count":72,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/CAMPAIGN_HISTORY_LINKING_COMPLETE.md","languageId":"markdown","version":1,"text":"# Campaign History Linking Implementation Complete\n\n## Overview\n\nSuccessfully implemented comprehensive campaign history linking functionality connecting the Dashboard to individual Campaign pages with CSV re-download capabilities.\n\n## Features Implemented\n\n### âœ… Dashboard Campaign Links\n\n- **Clickable Campaign Cards**: Each campaign in dashboard history is now clickable\n- **Enhanced Display**: Shows business type and location instead of generic campaign ID\n- **Visual Feedback**: Hover effects and \"View Details â†’\" button for clear navigation\n- **Responsive Design**: Works across all screen sizes\n\n### âœ… Campaign Page URL Support\n\n- **URL Parameters**: Supports `?id=campaign_id` for direct campaign access\n- **Campaign Loading**: Automatically loads specific campaigns from dashboard history\n- **Error Handling**: Redirects to discovery page if campaign not found\n- **Navigation Integration**: Seamless linking from dashboard to campaign details\n\n### âœ… Enhanced Data Model\n\n- **Campaign Context**: Added `business_type` and `location` to `CampaignResult` type\n- **Lead Association**: Added `campaign_id` to `BusinessLead` type for proper relationship\n- **Data Integrity**: Campaign creation includes business context information\n- **Type Safety**: Full TypeScript support for new fields\n\n### âœ… Campaign-Specific Data Display\n\n- **Filtered Results**: Results table shows only leads from selected campaign\n- **Targeted CSV Export**: CSV export filtered to campaign-specific data only\n- **Accurate Statistics**: Lead counts and metrics specific to each campaign\n- **Proper Data Isolation**: No cross-campaign data contamination\n\n## Technical Implementation\n\n### Updated Components\n\n- **Dashboard.tsx**: Added navigation hooks and clickable campaign cards\n- **Campaign.tsx**: Added URL parameter support and campaign-specific data filtering\n- **TierSelector.tsx**: Enhanced with actual API costs and single-column layout\n- **useBusinessDiscovery.ts**: Campaign creation includes business_type and location\n- **types/index.ts**: Extended interfaces for campaign-lead relationships\n\n### Data Flow\n\n```\nDashboard â†’ Click Campaign â†’ Navigate to /campaign?id=CAMPAIGN_ID â†’ Load Campaign â†’ Filter Leads â†’ Display Results + CSV Export\n```\n\n### URL Structure\n\n- **Dashboard**: `/dashboard` - Shows all campaign history\n- **Specific Campaign**: `/campaign?id=CAMPAIGN_ID` - Shows individual campaign details\n- **Discovery**: `/discovery` - Start new campaigns\n\n## User Workflow\n\n### From Dashboard\n\n1. View campaign history with business context (type + location)\n2. Click any campaign card or \"View Details â†’\" button\n3. Navigate to campaign-specific results page\n4. Review results and download CSV again with same tier-specific columns\n\n### Direct Access\n\n1. Use direct URL `/campaign?id=CAMPAIGN_ID` for bookmarking\n2. Share specific campaign results with team members\n3. Access historical campaigns via browser history\n\n### CSV Re-download\n\n1. Access any past campaign from dashboard\n2. View original results table with confidence scores\n3. Download CSV with same tier-specific columns as original export\n4. Includes ownership data columns for Compliance tier campaigns\n\n## Deployment Status\n\n### Production Environment\n\n- **URL**: https://prospectpro.appsmithery.co/\n- **Hosting**: Vercel with custom domain\n- **Build**: Successful TypeScript compilation\n- **Features**: All campaign linking functionality live and operational\n\n### Verification Completed\n\n- âœ… Dashboard campaign cards display business context\n- âœ… Click navigation works to campaign pages\n- âœ… URL parameters load correct campaigns\n- âœ… Lead filtering shows campaign-specific results\n- âœ… CSV export includes proper data columns\n- âœ… Error handling redirects appropriately\n\n## Technical Benefits\n\n### Data Architecture\n\n- **Proper Relationships**: Campaign-lead associations maintained\n- **Type Safety**: Full TypeScript coverage for new data structures\n- **Backward Compatibility**: Existing functionality preserved\n- **Performance**: Efficient filtering without database changes\n\n### User Experience\n\n- **Intuitive Navigation**: Clear pathways from dashboard to details\n- **Visual Clarity**: Business context instead of cryptic IDs\n- **Data Access**: Easy re-access to historical campaign results\n- **Workflow Continuity**: Seamless transition between pages\n\n### Maintenance\n\n- **Clean Code**: Well-structured component updates\n- **Consistent Patterns**: Follows existing architectural patterns\n- **Documentation**: Comprehensive TypeScript interfaces\n- **Testing Ready**: Clear data flow for future test implementation\n\n## Integration Points\n\n### Campaign Store\n\n- **State Management**: Zustand store handles campaign-lead relationships\n- **Data Persistence**: Campaign context preserved across navigation\n- **Memory Efficiency**: Smart filtering without data duplication\n\n### Routing\n\n- **React Router**: URL parameter handling for direct campaign access\n- **Navigation**: useNavigate hooks for programmatic routing\n- **Error Boundaries**: Graceful handling of invalid campaign IDs\n\n### CSV Export\n\n- **Tier-Specific**: Different column sets based on original campaign tier\n- **Data Integrity**: Only campaign-specific leads included\n- **Format Consistency**: Same CSV structure as original export\n\n## Next Steps\n\n### Potential Enhancements\n\n1. **Search/Filter**: Add search functionality to dashboard campaign history\n2. **Sorting**: Allow sorting campaigns by date, cost, or results count\n3. **Bulk Actions**: Select multiple campaigns for batch operations\n4. **Analytics**: Campaign performance comparison views\n\n### Integration Opportunities\n\n1. **Authentication**: Link campaigns to specific user accounts\n2. **Sharing**: Generate shareable links for campaign results\n3. **Notifications**: Alert when campaigns are accessed by others\n4. **API Access**: Programmatic access to campaign history\n\n## Files Modified\n\n### Core Components\n\n- `/src/pages/Dashboard.tsx` - Added navigation and enhanced display\n- `/src/pages/Campaign.tsx` - Added URL parameter support and filtering\n- `/src/types/index.ts` - Extended interfaces for campaign-lead relationships\n- `/src/hooks/useBusinessDiscovery.ts` - Enhanced campaign creation\n\n### Type Definitions\n\n- `CampaignResult` interface extended with `business_type` and `location`\n- `BusinessLead` interface extended with `campaign_id` association\n- URL parameter types for campaign navigation\n\n## Success Metrics\n\n### Functionality\n\n- **100% Campaign Linkage**: All dashboard campaigns link to detail pages\n- **Data Accuracy**: Campaign-specific filtering shows correct results\n- **CSV Integrity**: Re-downloaded CSVs match original tier specifications\n- **Navigation Reliability**: No broken links or missing campaigns\n\n### Performance\n\n- **Instant Navigation**: Dashboard to campaign transitions under 100ms\n- **Efficient Filtering**: Lead filtering doesn't impact page load times\n- **Memory Usage**: No memory leaks with campaign switching\n- **Build Size**: No significant bundle size increase\n\nThe campaign history linking feature is now complete and provides users with comprehensive access to their historical campaign data with professional CSV re-download capabilities.\n"}}},
{"type":"measure","name":"lsp.did_open","count":72,"duration":0.244},
{"type":"mark","name":"lsp.did_open","count":73,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx","languageId":"typescriptreact","version":1,"text":"import React, { useEffect, useState } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { EnrichmentButton } from \"../components/EnrichmentButton\";\nimport { ProgressDisplay } from \"../components/ProgressDisplay\";\nimport { useBusinessDiscovery } from \"../hooks/useBusinessDiscovery\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport type { BusinessLead } from \"../types\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nexport const Campaign: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const campaignId = searchParams.get(\"id\");\n  const { currentCampaign, campaigns, leads, setCurrentCampaign } =\n    useCampaignStore();\n  const { isDiscovering, progress, currentStage, cacheStats, error } =\n    useBusinessDiscovery();\n  const [showResults, setShowResults] = useState(false);\n\n  // Filter leads for current campaign\n  const campaignLeads = currentCampaign\n    ? leads.filter((lead) => lead.campaign_id === currentCampaign.campaign_id)\n    : [];\n\n  useEffect(() => {\n    if (!currentCampaign && campaignId) {\n      const matchedCampaign = campaigns.find(\n        (campaign) => campaign.campaign_id === campaignId\n      );\n      if (matchedCampaign) {\n        setCurrentCampaign(matchedCampaign);\n      }\n    }\n  }, [campaignId, campaigns, currentCampaign, setCurrentCampaign]);\n\n  useEffect(() => {\n    if (campaignLeads.length > 0) {\n      setShowResults(true);\n    }\n  }, [campaignLeads.length]);\n\n  const exportToCsv = () => {\n    if (!campaignLeads.length) return;\n\n    exportLeadsToCsv(campaignLeads, {\n      fileName: `campaign-${\n        currentCampaign?.campaign_id || Date.now()\n      }-results.csv`,\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Campaign Header */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">\n              Campaign Progress\n            </h1>\n            <p className=\"text-gray-600 mt-1\">\n              {currentCampaign\n                ? `Campaign ${currentCampaign.campaign_id}`\n                : \"Running campaign...\"}\n            </p>\n          </div>\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => navigate(\"/discovery\")}\n              className=\"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200\"\n            >\n              Back to Discovery\n            </button>\n            {showResults && (\n              <button\n                onClick={exportToCsv}\n                className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\"\n              >\n                Export CSV\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Progress Display */}\n      {isDiscovering && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <ProgressDisplay\n            isDiscovering={isDiscovering}\n            progress={progress}\n            currentStage={currentStage}\n            cacheStats={cacheStats}\n          />\n        </div>\n      )}\n\n      {/* Campaign Summary */}\n      {currentCampaign && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Campaign Summary\n          </h2>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-blue-600 font-medium\">Status</div>\n              <div className=\"text-lg font-bold text-blue-900 capitalize\">\n                {currentCampaign.status}\n              </div>\n            </div>\n            <div className=\"bg-green-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-green-600 font-medium\">\n                Leads Found\n              </div>\n              <div className=\"text-lg font-bold text-green-900\">\n                {currentCampaign.leads_found || 0}\n              </div>\n            </div>\n            <div className=\"bg-yellow-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-yellow-600 font-medium\">\n                Qualified\n              </div>\n              <div className=\"text-lg font-bold text-yellow-900\">\n                {currentCampaign.leads_qualified || 0}\n              </div>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-purple-600 font-medium\">\n                Total Cost\n              </div>\n              <div className=\"text-lg font-bold text-purple-900\">\n                ${(currentCampaign.total_cost || 0).toFixed(2)}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Enrichment Section */}\n      {currentCampaign && showResults && campaignLeads.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Progressive Enrichment\n          </h2>\n          <div className=\"flex items-start justify-between gap-6\">\n            <div className=\"flex-1\">\n              <p className=\"text-gray-600 mb-4\">\n                Enrich your leads with verified emails, business license\n                validation, and more. Only pay for successful enrichments.\n              </p>\n              <div className=\"grid grid-cols-3 gap-3 text-sm\">\n                <div className=\"bg-blue-50 p-3 rounded\">\n                  <div className=\"font-semibold text-blue-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.emails?.length\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-blue-600 text-xs\">With Emails</div>\n                </div>\n                <div className=\"bg-green-50 p-3 rounded\">\n                  <div className=\"font-semibold text-green-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.neverBounceVerified\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-green-600 text-xs\">Email Verified</div>\n                </div>\n                <div className=\"bg-purple-50 p-3 rounded\">\n                  <div className=\"font-semibold text-purple-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.licenseVerified\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-purple-600 text-xs\">\n                    License Verified\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"flex-shrink-0\">\n              <EnrichmentButton\n                campaignId={currentCampaign.campaign_id}\n                onComplete={() => {\n                  // Optionally refresh data or show success message\n                  console.log(\n                    \"Enrichment completed for campaign:\",\n                    currentCampaign.campaign_id\n                  );\n                }}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Results Table */}\n      {showResults && campaignLeads.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm overflow-hidden\">\n          <div className=\"px-6 py-4 border-b border-gray-200\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">\n                Campaign Results\n              </h2>\n              <div className=\"text-sm text-gray-500\">\n                {campaignLeads.length} leads found\n              </div>\n            </div>\n          </div>\n\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Business\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Contact Info\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Score\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cost\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {campaignLeads.map((lead: BusinessLead) => (\n                  <tr key={lead.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div>\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {lead.business_name}\n                        </div>\n                        <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                          {lead.address}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"space-y-1\">\n                        {lead.phone && (\n                          <div className=\"text-sm text-gray-900\">\n                            {lead.phone}\n                          </div>\n                        )}\n                        {lead.email && (\n                          <div className=\"text-sm text-blue-600\">\n                            {lead.email}\n                          </div>\n                        )}\n                        {lead.website && (\n                          <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                            <a\n                              href={lead.website}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"hover:text-blue-600\"\n                            >\n                              {lead.website}\n                            </a>\n                          </div>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {lead.confidence_score}%\n                        </div>\n                        <div\n                          className={`ml-2 w-16 bg-gray-200 rounded-full h-2`}\n                        >\n                          <div\n                            className={`h-2 rounded-full ${\n                              lead.confidence_score >= 80\n                                ? \"bg-green-500\"\n                                : lead.confidence_score >= 60\n                                ? \"bg-yellow-500\"\n                                : \"bg-red-500\"\n                            }`}\n                            style={{ width: `${lead.confidence_score}%` }}\n                          ></div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${(lead.cost_to_acquire || 0).toFixed(2)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                          lead.validation_status === \"validated\"\n                            ? \"bg-green-100 text-green-800\"\n                            : lead.validation_status === \"pending\"\n                            ? \"bg-yellow-100 text-yellow-800\"\n                            : \"bg-red-100 text-red-800\"\n                        }`}\n                      >\n                        {lead.validation_status || \"unknown\"}\n                      </span>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg\n                className=\"h-5 w-5 text-red-400\"\n                viewBox=\"0 0 20 20\"\n                fill=\"currentColor\"\n              >\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">\n                Campaign Failed\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700\">\n                <p>{error instanceof Error ? error.message : String(error)}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* No Results State */}\n      {showResults && campaignLeads.length === 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-12 text-center\">\n          <svg\n            className=\"mx-auto h-12 w-12 text-gray-400\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n            />\n          </svg>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n            No results found\n          </h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Try adjusting your search criteria or location.\n          </p>\n          <div className=\"mt-6\">\n            <button\n              onClick={() => navigate(\"/discovery\")}\n              className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\n            >\n              Start New Campaign\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":73,"duration":5.358},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":28,"duration":0.379},
{"type":"mark","name":"lsp.did_open","count":74,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Results.tsx","languageId":"typescriptreact","version":1,"text":"import React from \"react\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nexport const Results: React.FC = () => {\n  const { leads, currentCampaign } = useCampaignStore();\n\n  const handleExport = (format: \"csv\" | \"json\") => {\n    if (!leads.length) {\n      return;\n    }\n\n    if (format === \"csv\") {\n      exportLeadsToCsv(leads, {\n        fileName: `prospects-vault-secured-${\n          new Date().toISOString().split(\"T\")[0]\n        }.csv`,\n      });\n    } else {\n      const blob = new Blob([JSON.stringify(leads, null, 2)], {\n        type: \"application/json\",\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `prospects-vault-secured-${\n        new Date().toISOString().split(\"T\")[0]\n      }.json`;\n      a.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const getConfidenceColor = (score: number) => {\n    if (score >= 90) return \"bg-green-100 text-green-800\";\n    if (score >= 80) return \"bg-blue-100 text-blue-800\";\n    if (score >= 70) return \"bg-yellow-100 text-yellow-800\";\n    return \"bg-red-100 text-red-800\";\n  };\n\n  const getValidationStatusColor = (status: string) => {\n    switch (status) {\n      case \"validated\":\n        return \"bg-green-100 text-green-800\";\n      case \"validating\":\n        return \"bg-blue-100 text-blue-800\";\n      case \"pending\":\n        return \"bg-yellow-100 text-yellow-800\";\n      case \"failed\":\n        return \"bg-red-100 text-red-800\";\n      default:\n        return \"bg-gray-100 text-gray-800\";\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Results</h1>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            {leads.length} leads found â€¢{\" \"}\n            {leads.filter((l) => l.confidence_score >= 70).length} qualified\n          </p>\n        </div>\n\n        {leads.length > 0 && (\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => handleExport(\"csv\")}\n              className=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              ðŸ“Š Export CSV\n            </button>\n            <button\n              onClick={() => handleExport(\"json\")}\n              className=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              ðŸ“„ Export JSON\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Campaign Summary */}\n      {currentCampaign && (\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              Progressive Enrichment Results\n            </h3>\n            {currentCampaign.vault_secured && (\n              <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                ðŸ” Vault Secured\n              </span>\n            )}\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-5\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900\">\n                {currentCampaign.leads_found}\n              </div>\n              <div className=\"text-sm text-gray-500\">Total Found</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {currentCampaign.leads_qualified}\n              </div>\n              <div className=\"text-sm text-gray-500\">Qualified</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {currentCampaign.leads_validated}\n              </div>\n              <div className=\"text-sm text-gray-500\">Validated</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {currentCampaign.tier_used || \"Professional\"}\n              </div>\n              <div className=\"text-sm text-gray-500\">Tier Used</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900\">\n                ${currentCampaign.total_cost.toFixed(2)}\n              </div>\n              <div className=\"text-sm text-gray-500\">Total Cost</div>\n            </div>\n          </div>\n\n          {/* Cache Performance Display */}\n          {currentCampaign.cache_performance && (\n            <div className=\"mt-6 pt-6 border-t border-gray-200\">\n              <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n                ðŸš€ 90-Day Intelligent Cache Performance\n              </h4>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-green-600\">\n                    {currentCampaign.cache_performance.cache_hit_ratio.toFixed(\n                      1\n                    )}\n                    %\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Hit Ratio</div>\n                </div>\n                <div className=\"bg-blue-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-blue-600\">\n                    {currentCampaign.cache_performance.cache_hits}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Hits</div>\n                </div>\n                <div className=\"bg-yellow-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-yellow-600\">\n                    {currentCampaign.cache_performance.cache_misses}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Misses</div>\n                </div>\n                <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-green-600\">\n                    ${currentCampaign.cache_performance.cost_savings.toFixed(2)}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cost Savings</div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Results Table */}\n      <div className=\"bg-white shadow rounded-lg overflow-hidden\">\n        {leads.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <span className=\"text-4xl\">ðŸ”</span>\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n              No results yet\n            </h3>\n            <p className=\"mt-1 text-sm text-gray-500\">\n              Start a discovery campaign to find business leads.\n            </p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Business\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Contact\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Confidence\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Enrichment\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cost\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {leads.map((lead) => (\n                  <tr key={lead.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div>\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {lead.business_name}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">\n                            {lead.address}\n                          </div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"text-sm text-gray-900\">\n                        {lead.phone && <div>ðŸ“ž {lead.phone}</div>}\n                        {lead.website && (\n                          <div>\n                            ðŸŒ{\" \"}\n                            <a\n                              href={lead.website}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"text-blue-600 hover:underline\"\n                            >\n                              {lead.website.replace(/^https?:\\/\\//, \"\")}\n                            </a>\n                          </div>\n                        )}\n                        {lead.email && <div>ðŸ“§ {lead.email}</div>}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getConfidenceColor(\n                          lead.confidence_score\n                        )}`}\n                      >\n                        {lead.confidence_score}%\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex flex-col space-y-1\">\n                        <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800\">\n                          {lead.enrichment_tier || \"Professional\"}\n                        </span>\n                        {lead.vault_secured && (\n                          <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800\">\n                            ðŸ” Vault Secured\n                          </span>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getValidationStatusColor(\n                          lead.validation_status\n                        )}`}\n                      >\n                        {lead.validation_status}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${lead.cost_to_acquire.toFixed(3)}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":29,"duration":0.365},
{"type":"measure","name":"lsp.did_open","count":74,"duration":6.154},
{"type":"mark","name":"lsp.did_open","count":75,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","languageId":"typescript","version":1,"text":"import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport type { BusinessLead, CampaignResult, CampaignStore } from \"../types\";\n\ninterface CampaignActions {\n  addCampaign: (campaign: CampaignResult) => void;\n  updateCampaign: (\n    campaignId: string,\n    updates: Partial<CampaignResult>\n  ) => void;\n  setCurrentCampaign: (campaign: CampaignResult | null) => void;\n  addLeads: (leads: BusinessLead[]) => void;\n  updateLead: (leadId: string, updates: Partial<BusinessLead>) => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  clearLeads: () => void;\n  reset: () => void;\n}\n\nconst initialState: CampaignStore = {\n  campaigns: [],\n  currentCampaign: null,\n  leads: [],\n  isLoading: false,\n  error: null,\n};\n\nexport const useCampaignStore = create<CampaignStore & CampaignActions>()(\n  persist(\n    (set) => ({\n      ...initialState,\n\n      addCampaign: (campaign) =>\n        set((state) => ({\n          campaigns: [campaign, ...state.campaigns],\n        })),\n\n      updateCampaign: (campaignId, updates) =>\n        set((state) => ({\n          campaigns: state.campaigns.map((c) =>\n            c.campaign_id === campaignId ? { ...c, ...updates } : c\n          ),\n          currentCampaign:\n            state.currentCampaign?.campaign_id === campaignId\n              ? { ...state.currentCampaign, ...updates }\n              : state.currentCampaign,\n        })),\n\n      setCurrentCampaign: (campaign) => set({ currentCampaign: campaign }),\n\n      addLeads: (leads) =>\n        set((state) => ({\n          leads: [...state.leads, ...leads],\n        })),\n\n      updateLead: (leadId, updates) =>\n        set((state) => ({\n          leads: state.leads.map((l) =>\n            l.id === leadId ? { ...l, ...updates } : l\n          ),\n        })),\n\n      setLoading: (loading) => set({ isLoading: loading }),\n\n      setError: (error) => set({ error }),\n\n      clearLeads: () => set({ leads: [] }),\n\n      reset: () => set(initialState),\n    }),\n    {\n      name: \"campaign-store\",\n      partialize: (state) => ({\n        campaigns: state.campaigns,\n        leads: state.leads,\n      }),\n    }\n  )\n);\n"}}},
{"type":"measure","name":"lsp.did_open","count":75,"duration":1.585},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":30,"duration":0.307},
{"type":"mark","name":"lsp.did_open","count":76,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/components/AuthComponent.tsx","languageId":"typescriptreact","version":1,"text":"import { User } from \"@supabase/supabase-js\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { supabase } from \"../lib/supabase\";\n\ninterface AuthComponentProps {\n  onAuthChange?: (user: User | null) => void;\n}\n\n// HCaptcha component integration (if available)\ndeclare global {\n  interface Window {\n    hcaptcha?: {\n      render: (container: string, options: any) => string;\n      execute: (widgetId: string) => Promise<{ response: string }>;\n      reset: (widgetId: string) => void;\n    };\n  }\n}\n\nexport const AuthComponent: React.FC<AuthComponentProps> = ({\n  onAuthChange,\n}) => {\n  const {\n    user: authUser,\n    loading: authLoading,\n    signOut: contextSignOut,\n  } = useAuth();\n  const [localLoading, setLocalLoading] = useState(false);\n  const [isSignUp, setIsSignUp] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [fullName, setFullName] = useState(\"\");\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [showEmailForm, setShowEmailForm] = useState(false);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const menuContainerRef = useRef<HTMLDivElement | null>(null);\n  const hasEnsuredProfileRef = useRef(false);\n  const captchaWidgetIdRef = useRef<string | null>(null);\n\n  const combinedLoading = authLoading || localLoading;\n\n  const resetForm = useCallback(() => {\n    setIsSignUp(false);\n    setEmail(\"\");\n    setPassword(\"\");\n    setConfirmPassword(\"\");\n    setFullName(\"\");\n    setError(null);\n    setSuccess(null);\n\n    if (window.hcaptcha && captchaWidgetIdRef.current) {\n      window.hcaptcha.reset(captchaWidgetIdRef.current);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (onAuthChange) {\n      onAuthChange(authUser ?? null);\n    }\n  }, [authUser, onAuthChange]);\n\n  useEffect(() => {\n    if (authUser && !hasEnsuredProfileRef.current) {\n      hasEnsuredProfileRef.current = true;\n      void createUserProfile(authUser);\n    }\n\n    if (!authUser) {\n      hasEnsuredProfileRef.current = false;\n      setIsMenuOpen(false);\n      setShowEmailForm(false);\n      resetForm();\n    }\n  }, [authUser, resetForm]);\n\n  useEffect(() => {\n    if (!isMenuOpen) {\n      return;\n    }\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        menuContainerRef.current &&\n        !menuContainerRef.current.contains(event.target as Node)\n      ) {\n        setIsMenuOpen(false);\n        setShowEmailForm(false);\n        resetForm();\n      }\n    };\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") {\n        setIsMenuOpen(false);\n        setShowEmailForm(false);\n        resetForm();\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    document.addEventListener(\"keydown\", handleEscape);\n\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n      document.removeEventListener(\"keydown\", handleEscape);\n    };\n  }, [isMenuOpen, resetForm]);\n\n  const initializeCaptcha = useCallback(() => {\n    if (!showEmailForm || !isSignUp) {\n      return;\n    }\n\n    if (!window.hcaptcha || captchaWidgetIdRef.current) {\n      return;\n    }\n\n    try {\n      const widgetId = window.hcaptcha.render(\"auth-hcaptcha-container\", {\n        sitekey: import.meta.env.VITE_HCAPTCHA_SITE_KEY,\n        size: \"invisible\",\n        callback: () => undefined,\n      });\n      captchaWidgetIdRef.current = widgetId;\n    } catch (err) {\n      console.warn(\"Unable to initialize hCaptcha\", err);\n    }\n  }, [isSignUp, showEmailForm]);\n\n  const executeCaptcha = useCallback(async () => {\n    if (!window.hcaptcha || !captchaWidgetIdRef.current) {\n      return null;\n    }\n\n    try {\n      const result = await window.hcaptcha.execute(captchaWidgetIdRef.current);\n      return result.response;\n    } catch (err) {\n      console.warn(\"Unable to complete hCaptcha\", err);\n      return null;\n    }\n  }, []);\n\n  useEffect(() => {\n    if (showEmailForm && isSignUp) {\n      initializeCaptcha();\n    }\n  }, [showEmailForm, isSignUp, initializeCaptcha]);\n\n  const createUserProfile = async (user: User) => {\n    try {\n      const { error } = await supabase.from(\"user_profiles\").upsert([\n        {\n          id: user.id,\n          email: user.email,\n          full_name: user.user_metadata?.full_name || fullName || \"\",\n          avatar_url: user.user_metadata?.avatar_url || \"\",\n          subscription_tier: \"free\",\n          total_spent: 0,\n          monthly_budget: 100.0,\n        },\n      ]);\n\n      if (error && error.code !== \"23505\") {\n        console.error(\"Error creating user profile:\", error);\n      }\n    } catch (err) {\n      console.error(\"Error creating user profile:\", err);\n    }\n  };\n\n  const validatePassword = (password: string): string | null => {\n    if (password.length < 8) {\n      return \"Password must be at least 8 characters\";\n    }\n    if (!/(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/.test(password)) {\n      return \"Password must contain uppercase, lowercase, and number\";\n    }\n    return null;\n  };\n\n  const getRedirectTo = () => {\n    const defaultCallbackPath = \"/auth/callback\";\n\n    const ensureCallbackPath = (rawUrl: string | undefined | null) => {\n      if (!rawUrl) return null;\n\n      const trimmed = rawUrl.trim();\n      if (!trimmed) return null;\n\n      try {\n        const parsed = new URL(trimmed);\n\n        if (\n          parsed.pathname === \"/\" ||\n          parsed.pathname === \"\" ||\n          parsed.pathname === \"//\"\n        ) {\n          parsed.pathname = defaultCallbackPath;\n        }\n\n        return parsed.toString();\n      } catch {\n        const sanitized = trimmed.replace(/\\/+$/, \"\");\n        return `${sanitized}${defaultCallbackPath}`;\n      }\n    };\n\n    const configuredRedirect = ensureCallbackPath(\n      import.meta.env.VITE_AUTH_REDIRECT_URL\n    );\n\n    if (configuredRedirect) {\n      return configuredRedirect;\n    }\n\n    if (typeof window !== \"undefined\" && window.location?.origin) {\n      const origin = window.location.origin.replace(/\\/+$/, \"\");\n      return `${origin}${defaultCallbackPath}`;\n    }\n\n    return defaultCallbackPath;\n  };\n\n  const handleEmailAuth = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setError(null);\n    setSuccess(null);\n    setLocalLoading(true);\n\n    try {\n      if (isSignUp) {\n        if (password !== confirmPassword) {\n          setError(\"Passwords do not match\");\n          setLocalLoading(false);\n          return;\n        }\n\n        const passwordValidationError = validatePassword(password);\n        if (passwordValidationError) {\n          setError(passwordValidationError);\n          setLocalLoading(false);\n          return;\n        }\n\n        if (window.hcaptcha) {\n          const token = await executeCaptcha();\n          if (!token) {\n            setError(\"Captcha verification failed. Please try again.\");\n            setLocalLoading(false);\n            return;\n          }\n        }\n\n        const { error: signUpError } = await supabase.auth.signUp({\n          email,\n          password,\n          options: {\n            emailRedirectTo: getRedirectTo(),\n            data: {\n              full_name: fullName.trim(),\n            },\n          },\n        });\n\n        if (signUpError) {\n          throw signUpError;\n        }\n\n        setSuccess(\n          \"Check your email to confirm your account. Once confirmed, sign in to continue.\"\n        );\n        resetForm();\n        setShowEmailForm(false);\n        setIsMenuOpen(false);\n      } else {\n        const { error: signInError } = await supabase.auth.signInWithPassword({\n          email,\n          password,\n        });\n\n        if (signInError) {\n          throw signInError;\n        }\n\n        resetForm();\n        setShowEmailForm(false);\n        setIsMenuOpen(false);\n      }\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Authentication failed.\";\n      setError(message);\n    } finally {\n      setLocalLoading(false);\n    }\n  };\n\n  const handleGoogleAuth = async () => {\n    setError(null);\n    setSuccess(null);\n    setLocalLoading(true);\n\n    try {\n      const { error: oauthError } = await supabase.auth.signInWithOAuth({\n        provider: \"google\",\n        options: {\n          redirectTo: getRedirectTo(),\n          queryParams: {\n            access_type: \"offline\",\n            prompt: \"consent\",\n          },\n        },\n      });\n\n      if (oauthError) {\n        throw oauthError;\n      }\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Google sign-in failed.\";\n      setError(message);\n    } finally {\n      setLocalLoading(false);\n    }\n  };\n\n  const handleSignOut = async () => {\n    setLocalLoading(true);\n    setError(null);\n\n    try {\n      await contextSignOut();\n      resetForm();\n      setIsMenuOpen(false);\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Unable to sign out right now.\";\n      setError(message);\n    } finally {\n      setLocalLoading(false);\n    }\n  };\n\n  if (combinedLoading && !authUser) {\n    return (\n      <div className=\"flex items-center space-x-2\">\n        <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-gray-500 border-t-blue-600\"></div>\n        <span className=\"text-sm font-medium text-gray-800\">Loadingâ€¦</span>\n      </div>\n    );\n  }\n\n  if (authUser) {\n    const displayName = authUser.user_metadata?.full_name || \"ProspectPro user\";\n    const emailLabel = authUser.email || \"Authenticated\";\n    const initials = displayName\n      .split(\" \")\n      .map((segment: string) => segment.charAt(0))\n      .join(\"\")\n      .slice(0, 2)\n      .toUpperCase();\n\n    return (\n      <div className=\"relative\" ref={menuContainerRef}>\n        <button\n          type=\"button\"\n          onClick={() => setIsMenuOpen((prev) => !prev)}\n          className=\"inline-flex items-center gap-3 rounded-full border border-transparent bg-white/80 px-3 py-1.5 text-left text-sm font-medium text-gray-900 shadow-sm transition-colors hover:border-blue-600 hover:bg-white dark:bg-slate-900/70 dark:text-slate-100\"\n          aria-haspopup=\"menu\"\n          aria-expanded={isMenuOpen}\n        >\n          <span className=\"relative flex h-9 w-9 items-center justify-center overflow-hidden rounded-full border border-blue-200 bg-blue-100 text-base font-semibold text-blue-700 shadow-sm dark:border-sky-500/60 dark:bg-sky-500/10 dark:text-sky-200\">\n            {authUser.user_metadata?.avatar_url ? (\n              <img\n                src={authUser.user_metadata.avatar_url}\n                alt={displayName}\n                className=\"absolute inset-0 h-full w-full object-cover\"\n              />\n            ) : (\n              initials || \"PP\"\n            )}\n          </span>\n          <span className=\"flex flex-col items-start\">\n            <span className=\"text-sm font-semibold leading-tight\">\n              {displayName}\n            </span>\n            <span className=\"text-xs text-gray-600 leading-tight dark:text-slate-300\">\n              {emailLabel}\n            </span>\n          </span>\n          <svg\n            className={`h-4 w-4 text-gray-500 transition-transform dark:text-slate-300 ${\n              isMenuOpen ? \"rotate-180\" : \"\"\n            }`}\n            viewBox=\"0 0 20 20\"\n            fill=\"currentColor\"\n            aria-hidden=\"true\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 011.08 1.04l-4.25 4.25a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n        </button>\n\n        {isMenuOpen && (\n          <div\n            className=\"absolute right-0 z-50 mt-2 w-64 rounded-lg border border-gray-200 bg-white p-3 text-sm shadow-xl dark:border-slate-700 dark:bg-slate-900\"\n            role=\"menu\"\n            aria-label=\"Account menu\"\n          >\n            <div className=\"mb-3 rounded-md border border-gray-100 bg-gray-50 px-3 py-2 dark:border-slate-700 dark:bg-slate-800\">\n              <p className=\"text-xs uppercase tracking-wide text-gray-500 dark:text-slate-400\">\n                Signed in as\n              </p>\n              <p className=\"truncate text-sm font-semibold text-gray-900 dark:text-slate-100\">\n                {displayName}\n              </p>\n              <p className=\"truncate text-xs text-gray-600 dark:text-slate-300\">\n                {emailLabel}\n              </p>\n            </div>\n\n            <div className=\"flex flex-col gap-1\" role=\"none\">\n              <Link\n                to=\"/account\"\n                className=\"rounded-md px-3 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-blue-50 hover:text-blue-700 dark:text-slate-200 dark:hover:bg-slate-800\"\n                role=\"menuitem\"\n                onClick={() => setIsMenuOpen(false)}\n              >\n                Account settings\n              </Link>\n              <button\n                type=\"button\"\n                onClick={handleSignOut}\n                disabled={combinedLoading}\n                className=\"rounded-md px-3 py-2 text-sm font-semibold text-red-600 transition-colors hover:bg-red-50 disabled:opacity-60 dark:text-rose-400 dark:hover:bg-rose-500/10\"\n                role=\"menuitem\"\n              >\n                Sign out\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative\" ref={menuContainerRef}>\n      <button\n        type=\"button\"\n        onClick={() =>\n          setIsMenuOpen((prev) => {\n            const next = !prev;\n            if (!next) {\n              setShowEmailForm(false);\n              resetForm();\n            }\n            return next;\n          })\n        }\n        className=\"inline-flex items-center gap-2 rounded-full border border-blue-200 bg-white/80 px-4 py-1.5 text-sm font-semibold text-blue-700 shadow-sm transition-colors hover:border-blue-400 hover:bg-white dark:border-sky-500/40 dark:bg-slate-900/70 dark:text-sky-200\"\n        aria-haspopup=\"menu\"\n        aria-expanded={isMenuOpen}\n      >\n        <span>Sign in / Sign up</span>\n        <svg\n          className={`h-4 w-4 text-blue-500 transition-transform dark:text-sky-300 ${\n            isMenuOpen ? \"rotate-180\" : \"\"\n          }`}\n          viewBox=\"0 0 20 20\"\n          fill=\"currentColor\"\n          aria-hidden=\"true\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 011.08 1.04l-4.25 4.25a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n      </button>\n\n      {isMenuOpen && (\n        <div\n          className=\"absolute right-0 z-50 mt-2 w-80 rounded-lg border border-gray-200 bg-white p-4 text-sm shadow-xl dark:border-slate-700 dark:bg-slate-900\"\n          role=\"menu\"\n          aria-label=\"Authentication menu\"\n        >\n          <div className=\"space-y-4\" role=\"none\">\n            <button\n              type=\"button\"\n              onClick={handleGoogleAuth}\n              disabled={combinedLoading}\n              className=\"flex w-full items-center justify-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 font-medium text-gray-800 transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-60 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700\"\n              role=\"menuitem\"\n            >\n              <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\">\n                <path\n                  fill=\"#4285f4\"\n                  d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n                />\n                <path\n                  fill=\"#34a853\"\n                  d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n                />\n                <path\n                  fill=\"#fbbc05\"\n                  d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n                />\n                <path\n                  fill=\"#ea4335\"\n                  d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n                />\n              </svg>\n              <span>Continue with Google</span>\n            </button>\n\n            <div className=\"flex items-center gap-3 text-xs uppercase tracking-wide text-gray-400 dark:text-slate-500\">\n              <span className=\"h-px flex-1 bg-gray-200 dark:bg-slate-700\" />\n              <span>or</span>\n              <span className=\"h-px flex-1 bg-gray-200 dark:bg-slate-700\" />\n            </div>\n\n            <button\n              type=\"button\"\n              onClick={() => {\n                const next = !showEmailForm;\n                setShowEmailForm(next);\n                setError(null);\n                setSuccess(null);\n\n                if (!next) {\n                  resetForm();\n                }\n              }}\n              className=\"w-full rounded-md border border-transparent bg-blue-50 px-4 py-2 text-sm font-semibold text-blue-700 transition-colors hover:bg-blue-100 dark:bg-sky-500/10 dark:text-sky-200 dark:hover:bg-sky-500/20\"\n              role=\"menuitem\"\n            >\n              {showEmailForm ? \"Hide email options\" : \"Continue with email\"}\n            </button>\n\n            {showEmailForm && (\n              <div className=\"rounded-md border border-gray-200 bg-gray-50 p-4 dark:border-slate-700 dark:bg-slate-800\">\n                <div className=\"mb-3 flex items-center justify-between\">\n                  <p className=\"text-sm font-semibold text-gray-700 dark:text-slate-200\">\n                    {isSignUp ? \"Create an account\" : \"Sign in with email\"}\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setIsSignUp((prev) => !prev);\n                      setError(null);\n                      setSuccess(null);\n                    }}\n                    className=\"text-xs font-medium text-blue-600 transition-colors hover:text-blue-700 dark:text-sky-300 dark:hover:text-sky-200\"\n                  >\n                    {isSignUp\n                      ? \"Have an account? Sign in\"\n                      : \"New user? Create account\"}\n                  </button>\n                </div>\n\n                <form onSubmit={handleEmailAuth} className=\"space-y-3\">\n                  {isSignUp && (\n                    <input\n                      type=\"text\"\n                      placeholder=\"Full name\"\n                      value={fullName}\n                      onChange={(event) => setFullName(event.target.value)}\n                      className=\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\"\n                      required\n                    />\n                  )}\n\n                  <input\n                    type=\"email\"\n                    placeholder=\"Email\"\n                    value={email}\n                    onChange={(event) => setEmail(event.target.value)}\n                    className=\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\"\n                    required\n                  />\n\n                  <input\n                    type=\"password\"\n                    placeholder=\"Password\"\n                    value={password}\n                    onChange={(event) => setPassword(event.target.value)}\n                    className=\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\"\n                    required\n                  />\n\n                  {isSignUp && (\n                    <input\n                      type=\"password\"\n                      placeholder=\"Confirm password\"\n                      value={confirmPassword}\n                      onChange={(event) =>\n                        setConfirmPassword(event.target.value)\n                      }\n                      className=\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\"\n                      required\n                    />\n                  )}\n\n                  <button\n                    type=\"submit\"\n                    disabled={combinedLoading}\n                    className=\"w-full rounded bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60 dark:bg-sky-500 dark:hover:bg-sky-600\"\n                  >\n                    {combinedLoading ? (\n                      <span>Processingâ€¦</span>\n                    ) : isSignUp ? (\n                      \"Create account\"\n                    ) : (\n                      \"Sign in\"\n                    )}\n                  </button>\n                </form>\n\n                {error && (\n                  <div className=\"mt-3 rounded border border-red-200 bg-red-50 p-2 text-xs text-red-600 dark:border-rose-500/40 dark:bg-rose-500/10 dark:text-rose-200\">\n                    {error}\n                  </div>\n                )}\n\n                {success && (\n                  <div className=\"mt-3 rounded border border-green-200 bg-green-50 p-2 text-xs text-green-700 dark:border-emerald-500/40 dark:bg-emerald-500/10 dark:text-emerald-200\">\n                    {success}\n                  </div>\n                )}\n\n                <div id=\"auth-hcaptcha-container\" className=\"hidden\" />\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":31,"duration":0.34},
{"type":"measure","name":"lsp.did_open","count":76,"duration":7.22},
{"type":"mark","name":"lsp.did_open","count":77,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/dist/assets/index-ClZNJYQq.js","languageId":"javascript","version":1,"text":"var rc=t=>{throw TypeError(t)};var Ka=(t,e,r)=>e.has(t)||rc(\"Cannot \"+r);var _=(t,e,r)=>(Ka(t,e,\"read from private field\"),r?r.call(t):e.get(t)),H=(t,e,r)=>e.has(t)?rc(\"Cannot add the same private member more than once\"):e instanceof WeakSet?e.add(t):e.set(t,r),U=(t,e,r,n)=>(Ka(t,e,\"write to private field\"),n?n.call(t,r):e.set(t,r),r),ce=(t,e,r)=>(Ka(t,e,\"access private method\"),r);var hi=(t,e,r,n)=>({set _(s){U(t,e,s,r)},get _(){return _(t,e,n)}});function j0(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!=\"string\"&&!Array.isArray(n)){for(const s in n)if(s!==\"default\"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}))}(function(){const e=document.createElement(\"link\").relList;if(e&&e.supports&&e.supports(\"modulepreload\"))return;for(const s of document.querySelectorAll('link[rel=\"modulepreload\"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type===\"childList\")for(const a of i.addedNodes)a.tagName===\"LINK\"&&a.rel===\"modulepreload\"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin===\"use-credentials\"?i.credentials=\"include\":s.crossOrigin===\"anonymous\"?i.credentials=\"omit\":i.credentials=\"same-origin\",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var at=typeof globalThis<\"u\"?globalThis:typeof window<\"u\"?window:typeof global<\"u\"?global:typeof self<\"u\"?self:{};function ah(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,\"default\")?t.default:t}function N0(t){if(t.__esModule)return t;var e=t.default;if(typeof e==\"function\"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,\"__esModule\",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var oh={exports:{}},_a={},lh={exports:{}},q={};/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var ti=Symbol.for(\"react.element\"),C0=Symbol.for(\"react.portal\"),E0=Symbol.for(\"react.fragment\"),P0=Symbol.for(\"react.strict_mode\"),T0=Symbol.for(\"react.profiler\"),R0=Symbol.for(\"react.provider\"),O0=Symbol.for(\"react.context\"),A0=Symbol.for(\"react.forward_ref\"),L0=Symbol.for(\"react.suspense\"),I0=Symbol.for(\"react.memo\"),$0=Symbol.for(\"react.lazy\"),nc=Symbol.iterator;function D0(t){return t===null||typeof t!=\"object\"?null:(t=nc&&t[nc]||t[\"@@iterator\"],typeof t==\"function\"?t:null)}var uh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ch=Object.assign,dh={};function Jn(t,e,r){this.props=t,this.context=e,this.refs=dh,this.updater=r||uh}Jn.prototype.isReactComponent={};Jn.prototype.setState=function(t,e){if(typeof t!=\"object\"&&typeof t!=\"function\"&&t!=null)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,t,e,\"setState\")};Jn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,\"forceUpdate\")};function hh(){}hh.prototype=Jn.prototype;function ql(t,e,r){this.props=t,this.context=e,this.refs=dh,this.updater=r||uh}var Kl=ql.prototype=new hh;Kl.constructor=ql;ch(Kl,Jn.prototype);Kl.isPureReactComponent=!0;var sc=Array.isArray,fh=Object.prototype.hasOwnProperty,Gl={current:null},ph={key:!0,ref:!0,__self:!0,__source:!0};function mh(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=\"\"+e.key),e)fh.call(e,n)&&!ph.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:ti,type:t,key:i,ref:a,props:s,_owner:Gl.current}}function U0(t,e){return{$$typeof:ti,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ql(t){return typeof t==\"object\"&&t!==null&&t.$$typeof===ti}function M0(t){var e={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+t.replace(/[=:]/g,function(r){return e[r]})}var ic=/\\/+/g;function Ga(t,e){return typeof t==\"object\"&&t!==null&&t.key!=null?M0(\"\"+t.key):e.toString(36)}function $i(t,e,r,n,s){var i=typeof t;(i===\"undefined\"||i===\"boolean\")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case\"string\":case\"number\":a=!0;break;case\"object\":switch(t.$$typeof){case ti:case C0:a=!0}}if(a)return a=t,s=s(a),t=n===\"\"?\".\"+Ga(a,0):n,sc(s)?(r=\"\",t!=null&&(r=t.replace(ic,\"$&/\")+\"/\"),$i(s,e,r,\"\",function(c){return c})):s!=null&&(Ql(s)&&(s=U0(s,r+(!s.key||a&&a.key===s.key?\"\":(\"\"+s.key).replace(ic,\"$&/\")+\"/\")+t)),e.push(s)),1;if(a=0,n=n===\"\"?\".\":n+\":\",sc(t))for(var l=0;l<t.length;l++){i=t[l];var u=n+Ga(i,l);a+=$i(i,e,r,u,s)}else if(u=D0(t),typeof u==\"function\")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=n+Ga(i,l++),a+=$i(i,e,r,u,s);else if(i===\"object\")throw e=String(t),Error(\"Objects are not valid as a React child (found: \"+(e===\"[object Object]\"?\"object with keys {\"+Object.keys(t).join(\", \")+\"}\":e)+\"). If you meant to render a collection of children, use an array instead.\");return a}function fi(t,e,r){if(t==null)return t;var n=[],s=0;return $i(t,n,\"\",\"\",function(i){return e.call(r,i,s++)}),n}function F0(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ue={current:null},Di={transition:null},z0={ReactCurrentDispatcher:Ue,ReactCurrentBatchConfig:Di,ReactCurrentOwner:Gl};function gh(){throw Error(\"act(...) is not supported in production builds of React.\")}q.Children={map:fi,forEach:function(t,e,r){fi(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return fi(t,function(){e++}),e},toArray:function(t){return fi(t,function(e){return e})||[]},only:function(t){if(!Ql(t))throw Error(\"React.Children.only expected to receive a single React element child.\");return t}};q.Component=Jn;q.Fragment=E0;q.Profiler=T0;q.PureComponent=ql;q.StrictMode=P0;q.Suspense=L0;q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z0;q.act=gh;q.cloneElement=function(t,e,r){if(t==null)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+t+\".\");var n=ch({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Gl.current),e.key!==void 0&&(s=\"\"+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)fh.call(e,u)&&!ph.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:ti,type:t.type,key:s,ref:i,props:n,_owner:a}};q.createContext=function(t){return t={$$typeof:O0,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:R0,_context:t},t.Consumer=t};q.createElement=mh;q.createFactory=function(t){var e=mh.bind(null,t);return e.type=t,e};q.createRef=function(){return{current:null}};q.forwardRef=function(t){return{$$typeof:A0,render:t}};q.isValidElement=Ql;q.lazy=function(t){return{$$typeof:$0,_payload:{_status:-1,_result:t},_init:F0}};q.memo=function(t,e){return{$$typeof:I0,type:t,compare:e===void 0?null:e}};q.startTransition=function(t){var e=Di.transition;Di.transition={};try{t()}finally{Di.transition=e}};q.unstable_act=gh;q.useCallback=function(t,e){return Ue.current.useCallback(t,e)};q.useContext=function(t){return Ue.current.useContext(t)};q.useDebugValue=function(){};q.useDeferredValue=function(t){return Ue.current.useDeferredValue(t)};q.useEffect=function(t,e){return Ue.current.useEffect(t,e)};q.useId=function(){return Ue.current.useId()};q.useImperativeHandle=function(t,e,r){return Ue.current.useImperativeHandle(t,e,r)};q.useInsertionEffect=function(t,e){return Ue.current.useInsertionEffect(t,e)};q.useLayoutEffect=function(t,e){return Ue.current.useLayoutEffect(t,e)};q.useMemo=function(t,e){return Ue.current.useMemo(t,e)};q.useReducer=function(t,e,r){return Ue.current.useReducer(t,e,r)};q.useRef=function(t){return Ue.current.useRef(t)};q.useState=function(t){return Ue.current.useState(t)};q.useSyncExternalStore=function(t,e,r){return Ue.current.useSyncExternalStore(t,e,r)};q.useTransition=function(){return Ue.current.useTransition()};q.version=\"18.3.1\";lh.exports=q;var k=lh.exports;const Jl=ah(k),B0=j0({__proto__:null,default:Jl},[k]);/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var H0=k,W0=Symbol.for(\"react.element\"),V0=Symbol.for(\"react.fragment\"),q0=Object.prototype.hasOwnProperty,K0=H0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G0={key:!0,ref:!0,__self:!0,__source:!0};function vh(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=\"\"+r),e.key!==void 0&&(i=\"\"+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)q0.call(e,n)&&!G0.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:W0,type:t,key:i,ref:a,props:s,_owner:K0.current}}_a.Fragment=V0;_a.jsx=vh;_a.jsxs=vh;oh.exports=_a;var o=oh.exports,Ro={},yh={exports:{}},Xe={},xh={exports:{}},wh={};/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */(function(t){function e(C,A){var L=C.length;C.push(A);e:for(;0<L;){var W=L-1>>>1,J=C[W];if(0<s(J,A))C[W]=A,C[L]=J,L=W;else break e}}function r(C){return C.length===0?null:C[0]}function n(C){if(C.length===0)return null;var A=C[0],L=C.pop();if(L!==A){C[0]=L;e:for(var W=0,J=C.length,I=J>>>1;W<I;){var F=2*(W+1)-1,Z=C[F],ee=F+1,Pe=C[ee];if(0>s(Z,L))ee<J&&0>s(Pe,Z)?(C[W]=Pe,C[ee]=L,W=ee):(C[W]=Z,C[F]=L,W=F);else if(ee<J&&0>s(Pe,L))C[W]=Pe,C[ee]=L,W=ee;else break e}}return A}function s(C,A){var L=C.sortIndex-A.sortIndex;return L!==0?L:C.id-A.id}if(typeof performance==\"object\"&&typeof performance.now==\"function\"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],c=[],d=1,h=null,f=3,y=!1,x=!1,w=!1,v=typeof setTimeout==\"function\"?setTimeout:null,m=typeof clearTimeout==\"function\"?clearTimeout:null,p=typeof setImmediate<\"u\"?setImmediate:null;typeof navigator<\"u\"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(C){for(var A=r(c);A!==null;){if(A.callback===null)n(c);else if(A.startTime<=C)n(c),A.sortIndex=A.expirationTime,e(u,A);else break;A=r(c)}}function b(C){if(w=!1,g(C),!x)if(r(u)!==null)x=!0,M(S);else{var A=r(c);A!==null&&O(b,A.startTime-C)}}function S(C,A){x=!1,w&&(w=!1,m(P),P=-1),y=!0;var L=f;try{for(g(A),h=r(u);h!==null&&(!(h.expirationTime>A)||C&&!z());){var W=h.callback;if(typeof W==\"function\"){h.callback=null,f=h.priorityLevel;var J=W(h.expirationTime<=A);A=t.unstable_now(),typeof J==\"function\"?h.callback=J:h===r(u)&&n(u),g(A)}else n(u);h=r(u)}if(h!==null)var I=!0;else{var F=r(c);F!==null&&O(b,F.startTime-A),I=!1}return I}finally{h=null,f=L,y=!1}}var j=!1,N=null,P=-1,D=5,T=-1;function z(){return!(t.unstable_now()-T<D)}function G(){if(N!==null){var C=t.unstable_now();T=C;var A=!0;try{A=N(!0,C)}finally{A?ue():(j=!1,N=null)}}else j=!1}var ue;if(typeof p==\"function\")ue=function(){p(G)};else if(typeof MessageChannel<\"u\"){var Ce=new MessageChannel,Ee=Ce.port2;Ce.port1.onmessage=G,ue=function(){Ee.postMessage(null)}}else ue=function(){v(G,0)};function M(C){N=C,j||(j=!0,ue())}function O(C,A){P=v(function(){C(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(C){C.callback=null},t.unstable_continueExecution=function(){x||y||(x=!0,M(S))},t.unstable_forceFrameRate=function(C){0>C||125<C?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):D=0<C?Math.floor(1e3/C):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(C){switch(f){case 1:case 2:case 3:var A=3;break;default:A=f}var L=f;f=A;try{return C()}finally{f=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(C,A){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var L=f;f=C;try{return A()}finally{f=L}},t.unstable_scheduleCallback=function(C,A,L){var W=t.unstable_now();switch(typeof L==\"object\"&&L!==null?(L=L.delay,L=typeof L==\"number\"&&0<L?W+L:W):L=W,C){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=L+J,C={id:d++,callback:A,priorityLevel:C,startTime:L,expirationTime:J,sortIndex:-1},L>W?(C.sortIndex=L,e(c,C),r(u)===null&&C===r(c)&&(w?(m(P),P=-1):w=!0,O(b,L-W))):(C.sortIndex=J,e(u,C),x||y||(x=!0,M(S))),C},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(C){var A=f;return function(){var L=f;f=A;try{return C.apply(this,arguments)}finally{f=L}}}})(wh);xh.exports=wh;var Q0=xh.exports;/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var J0=k,Ye=Q0;function E(t){for(var e=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+t,r=1;r<arguments.length;r++)e+=\"&args[]=\"+encodeURIComponent(arguments[r]);return\"Minified React error #\"+t+\"; visit \"+e+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var bh=new Set,Ts={};function tn(t,e){zn(t,e),zn(t+\"Capture\",e)}function zn(t,e){for(Ts[t]=e,t=0;t<e.length;t++)bh.add(e[t])}var Ht=!(typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"),Oo=Object.prototype.hasOwnProperty,Y0=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,ac={},oc={};function X0(t){return Oo.call(oc,t)?!0:Oo.call(ac,t)?!1:Y0.test(t)?oc[t]=!0:(ac[t]=!0,!1)}function Z0(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case\"function\":case\"symbol\":return!0;case\"boolean\":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!==\"data-\"&&t!==\"aria-\");default:return!1}}function em(t,e,r,n){if(e===null||typeof e>\"u\"||Z0(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Me(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Ne={};\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(t){Ne[t]=new Me(t,0,!1,t,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(t){var e=t[0];Ne[e]=new Me(e,1,!1,t[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(t){Ne[t]=new Me(t,2,!1,t.toLowerCase(),null,!1,!1)});[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(t){Ne[t]=new Me(t,2,!1,t,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(t){Ne[t]=new Me(t,3,!1,t.toLowerCase(),null,!1,!1)});[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(t){Ne[t]=new Me(t,3,!0,t,null,!1,!1)});[\"capture\",\"download\"].forEach(function(t){Ne[t]=new Me(t,4,!1,t,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(t){Ne[t]=new Me(t,6,!1,t,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(t){Ne[t]=new Me(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yl=/[\\-:]([a-z])/g;function Xl(t){return t[1].toUpperCase()}\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(t){var e=t.replace(Yl,Xl);Ne[e]=new Me(e,1,!1,t,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(t){var e=t.replace(Yl,Xl);Ne[e]=new Me(e,1,!1,t,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(t){var e=t.replace(Yl,Xl);Ne[e]=new Me(e,1,!1,t,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(t){Ne[t]=new Me(t,1,!1,t.toLowerCase(),null,!1,!1)});Ne.xlinkHref=new Me(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(t){Ne[t]=new Me(t,1,!1,t.toLowerCase(),null,!0,!0)});function Zl(t,e,r,n){var s=Ne.hasOwnProperty(e)?Ne[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!==\"o\"&&e[0]!==\"O\"||e[1]!==\"n\"&&e[1]!==\"N\")&&(em(e,r,s,n)&&(r=null),n||s===null?X0(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,\"\"+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:\"\":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?\"\":\"\"+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Kt=J0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pi=Symbol.for(\"react.element\"),mn=Symbol.for(\"react.portal\"),gn=Symbol.for(\"react.fragment\"),eu=Symbol.for(\"react.strict_mode\"),Ao=Symbol.for(\"react.profiler\"),kh=Symbol.for(\"react.provider\"),_h=Symbol.for(\"react.context\"),tu=Symbol.for(\"react.forward_ref\"),Lo=Symbol.for(\"react.suspense\"),Io=Symbol.for(\"react.suspense_list\"),ru=Symbol.for(\"react.memo\"),Xt=Symbol.for(\"react.lazy\"),Sh=Symbol.for(\"react.offscreen\"),lc=Symbol.iterator;function ns(t){return t===null||typeof t!=\"object\"?null:(t=lc&&t[lc]||t[\"@@iterator\"],typeof t==\"function\"?t:null)}var ae=Object.assign,Qa;function hs(t){if(Qa===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\\n( *(at )?)/);Qa=e&&e[1]||\"\"}return`\n`+Qa+t}var Ja=!1;function Ya(t,e){if(!t||Ja)return\"\";Ja=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack==\"string\"){for(var s=c.stack.split(`\n`),i=n.stack.split(`\n`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`\n`+s[a].replace(\" at new \",\" at \");return t.displayName&&u.includes(\"<anonymous>\")&&(u=u.replace(\"<anonymous>\",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Ja=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:\"\")?hs(t):\"\"}function tm(t){switch(t.tag){case 5:return hs(t.type);case 16:return hs(\"Lazy\");case 13:return hs(\"Suspense\");case 19:return hs(\"SuspenseList\");case 0:case 2:case 15:return t=Ya(t.type,!1),t;case 11:return t=Ya(t.type.render,!1),t;case 1:return t=Ya(t.type,!0),t;default:return\"\"}}function $o(t){if(t==null)return null;if(typeof t==\"function\")return t.displayName||t.name||null;if(typeof t==\"string\")return t;switch(t){case gn:return\"Fragment\";case mn:return\"Portal\";case Ao:return\"Profiler\";case eu:return\"StrictMode\";case Lo:return\"Suspense\";case Io:return\"SuspenseList\"}if(typeof t==\"object\")switch(t.$$typeof){case _h:return(t.displayName||\"Context\")+\".Consumer\";case kh:return(t._context.displayName||\"Context\")+\".Provider\";case tu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||\"\",t=t!==\"\"?\"ForwardRef(\"+t+\")\":\"ForwardRef\"),t;case ru:return e=t.displayName||null,e!==null?e:$o(t.type)||\"Memo\";case Xt:e=t._payload,t=t._init;try{return $o(t(e))}catch{}}return null}function rm(t){var e=t.type;switch(t.tag){case 24:return\"Cache\";case 9:return(e.displayName||\"Context\")+\".Consumer\";case 10:return(e._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return t=e.render,t=t.displayName||t.name||\"\",e.displayName||(t!==\"\"?\"ForwardRef(\"+t+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return e;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return $o(e);case 8:return e===eu?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";case 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e}return null}function kr(t){switch(typeof t){case\"boolean\":case\"number\":case\"string\":case\"undefined\":return t;case\"object\":return t;default:return\"\"}}function jh(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()===\"input\"&&(e===\"checkbox\"||e===\"radio\")}function nm(t){var e=jh(t)?\"checked\":\"value\",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=\"\"+t[e];if(!t.hasOwnProperty(e)&&typeof r<\"u\"&&typeof r.get==\"function\"&&typeof r.set==\"function\"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=\"\"+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=\"\"+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mi(t){t._valueTracker||(t._valueTracker=nm(t))}function Nh(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n=\"\";return t&&(n=jh(t)?t.checked?\"true\":\"false\":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Qi(t){if(t=t||(typeof document<\"u\"?document:void 0),typeof t>\"u\")return null;try{return t.activeElement||t.body}catch{return t.body}}function Do(t,e){var r=e.checked;return ae({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function uc(t,e){var r=e.defaultValue==null?\"\":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=kr(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type===\"checkbox\"||e.type===\"radio\"?e.checked!=null:e.value!=null}}function Ch(t,e){e=e.checked,e!=null&&Zl(t,\"checked\",e,!1)}function Uo(t,e){Ch(t,e);var r=kr(e.value),n=e.type;if(r!=null)n===\"number\"?(r===0&&t.value===\"\"||t.value!=r)&&(t.value=\"\"+r):t.value!==\"\"+r&&(t.value=\"\"+r);else if(n===\"submit\"||n===\"reset\"){t.removeAttribute(\"value\");return}e.hasOwnProperty(\"value\")?Mo(t,e.type,r):e.hasOwnProperty(\"defaultValue\")&&Mo(t,e.type,kr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function cc(t,e,r){if(e.hasOwnProperty(\"value\")||e.hasOwnProperty(\"defaultValue\")){var n=e.type;if(!(n!==\"submit\"&&n!==\"reset\"||e.value!==void 0&&e.value!==null))return;e=\"\"+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==\"\"&&(t.name=\"\"),t.defaultChecked=!!t._wrapperState.initialChecked,r!==\"\"&&(t.name=r)}function Mo(t,e,r){(e!==\"number\"||Qi(t.ownerDocument)!==t)&&(r==null?t.defaultValue=\"\"+t._wrapperState.initialValue:t.defaultValue!==\"\"+r&&(t.defaultValue=\"\"+r))}var fs=Array.isArray;function Cn(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e[\"$\"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty(\"$\"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=\"\"+kr(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Fo(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(E(91));return ae({},e,{value:void 0,defaultValue:void 0,children:\"\"+t._wrapperState.initialValue})}function dc(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(E(92));if(fs(r)){if(1<r.length)throw Error(E(93));r=r[0]}e=r}e==null&&(e=\"\"),r=e}t._wrapperState={initialValue:kr(r)}}function Eh(t,e){var r=kr(e.value),n=kr(e.defaultValue);r!=null&&(r=\"\"+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=\"\"+n)}function hc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==\"\"&&e!==null&&(t.value=e)}function Ph(t){switch(t){case\"svg\":return\"http://www.w3.org/2000/svg\";case\"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function zo(t,e){return t==null||t===\"http://www.w3.org/1999/xhtml\"?Ph(e):t===\"http://www.w3.org/2000/svg\"&&e===\"foreignObject\"?\"http://www.w3.org/1999/xhtml\":t}var gi,Th=function(t){return typeof MSApp<\"u\"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!==\"http://www.w3.org/2000/svg\"||\"innerHTML\"in t)t.innerHTML=e;else{for(gi=gi||document.createElement(\"div\"),gi.innerHTML=\"<svg>\"+e.valueOf().toString()+\"</svg>\",e=gi.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Rs(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ys={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sm=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(ys).forEach(function(t){sm.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ys[e]=ys[t]})});function Rh(t,e,r){return e==null||typeof e==\"boolean\"||e===\"\"?\"\":r||typeof e!=\"number\"||e===0||ys.hasOwnProperty(t)&&ys[t]?(\"\"+e).trim():e+\"px\"}function Oh(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf(\"--\")===0,s=Rh(r,e[r],n);r===\"float\"&&(r=\"cssFloat\"),n?t.setProperty(r,s):t[r]=s}}var im=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bo(t,e){if(e){if(im[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(E(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(E(60));if(typeof e.dangerouslySetInnerHTML!=\"object\"||!(\"__html\"in e.dangerouslySetInnerHTML))throw Error(E(61))}if(e.style!=null&&typeof e.style!=\"object\")throw Error(E(62))}}function Ho(t,e){if(t.indexOf(\"-\")===-1)return typeof e.is==\"string\";switch(t){case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":return!1;default:return!0}}var Wo=null;function nu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vo=null,En=null,Pn=null;function fc(t){if(t=si(t)){if(typeof Vo!=\"function\")throw Error(E(280));var e=t.stateNode;e&&(e=Ea(e),Vo(t.stateNode,t.type,e))}}function Ah(t){En?Pn?Pn.push(t):Pn=[t]:En=t}function Lh(){if(En){var t=En,e=Pn;if(Pn=En=null,fc(t),e)for(t=0;t<e.length;t++)fc(e[t])}}function Ih(t,e){return t(e)}function $h(){}var Xa=!1;function Dh(t,e,r){if(Xa)return t(e,r);Xa=!0;try{return Ih(t,e,r)}finally{Xa=!1,(En!==null||Pn!==null)&&($h(),Lh())}}function Os(t,e){var r=t.stateNode;if(r===null)return null;var n=Ea(r);if(n===null)return null;r=n[e];e:switch(e){case\"onClick\":case\"onClickCapture\":case\"onDoubleClick\":case\"onDoubleClickCapture\":case\"onMouseDown\":case\"onMouseDownCapture\":case\"onMouseMove\":case\"onMouseMoveCapture\":case\"onMouseUp\":case\"onMouseUpCapture\":case\"onMouseEnter\":(n=!n.disabled)||(t=t.type,n=!(t===\"button\"||t===\"input\"||t===\"select\"||t===\"textarea\")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!=\"function\")throw Error(E(231,e,typeof r));return r}var qo=!1;if(Ht)try{var ss={};Object.defineProperty(ss,\"passive\",{get:function(){qo=!0}}),window.addEventListener(\"test\",ss,ss),window.removeEventListener(\"test\",ss,ss)}catch{qo=!1}function am(t,e,r,n,s,i,a,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var xs=!1,Ji=null,Yi=!1,Ko=null,om={onError:function(t){xs=!0,Ji=t}};function lm(t,e,r,n,s,i,a,l,u){xs=!1,Ji=null,am.apply(om,arguments)}function um(t,e,r,n,s,i,a,l,u){if(lm.apply(this,arguments),xs){if(xs){var c=Ji;xs=!1,Ji=null}else throw Error(E(198));Yi||(Yi=!0,Ko=c)}}function rn(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Uh(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pc(t){if(rn(t)!==t)throw Error(E(188))}function cm(t){var e=t.alternate;if(!e){if(e=rn(t),e===null)throw Error(E(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return pc(s),t;if(i===n)return pc(s),e;i=i.sibling}throw Error(E(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(E(189))}}if(r.alternate!==n)throw Error(E(190))}if(r.tag!==3)throw Error(E(188));return r.stateNode.current===r?t:e}function Mh(t){return t=cm(t),t!==null?Fh(t):null}function Fh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Fh(t);if(e!==null)return e;t=t.sibling}return null}var zh=Ye.unstable_scheduleCallback,mc=Ye.unstable_cancelCallback,dm=Ye.unstable_shouldYield,hm=Ye.unstable_requestPaint,de=Ye.unstable_now,fm=Ye.unstable_getCurrentPriorityLevel,su=Ye.unstable_ImmediatePriority,Bh=Ye.unstable_UserBlockingPriority,Xi=Ye.unstable_NormalPriority,pm=Ye.unstable_LowPriority,Hh=Ye.unstable_IdlePriority,Sa=null,Pt=null;function mm(t){if(Pt&&typeof Pt.onCommitFiberRoot==\"function\")try{Pt.onCommitFiberRoot(Sa,t,void 0,(t.current.flags&128)===128)}catch{}}var vt=Math.clz32?Math.clz32:ym,gm=Math.log,vm=Math.LN2;function ym(t){return t>>>=0,t===0?32:31-(gm(t)/vm|0)|0}var vi=64,yi=4194304;function ps(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zi(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=ps(l):(i&=a,i!==0&&(n=ps(i)))}else a=r&~s,a!==0?n=ps(a):i!==0&&(n=ps(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-vt(e),s=1<<r,n|=t[r],e&=~s;return n}function xm(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wm(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-vt(i),l=1<<a,u=s[a];u===-1?(!(l&r)||l&n)&&(s[a]=xm(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Go(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Wh(){var t=vi;return vi<<=1,!(vi&4194240)&&(vi=64),t}function Za(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ri(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-vt(e),t[e]=r}function bm(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-vt(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function iu(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-vt(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Q=0;function Vh(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qh,au,Kh,Gh,Qh,Qo=!1,xi=[],fr=null,pr=null,mr=null,As=new Map,Ls=new Map,er=[],km=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");function gc(t,e){switch(t){case\"focusin\":case\"focusout\":fr=null;break;case\"dragenter\":case\"dragleave\":pr=null;break;case\"mouseover\":case\"mouseout\":mr=null;break;case\"pointerover\":case\"pointerout\":As.delete(e.pointerId);break;case\"gotpointercapture\":case\"lostpointercapture\":Ls.delete(e.pointerId)}}function is(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=si(e),e!==null&&au(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function _m(t,e,r,n,s){switch(e){case\"focusin\":return fr=is(fr,t,e,r,n,s),!0;case\"dragenter\":return pr=is(pr,t,e,r,n,s),!0;case\"mouseover\":return mr=is(mr,t,e,r,n,s),!0;case\"pointerover\":var i=s.pointerId;return As.set(i,is(As.get(i)||null,t,e,r,n,s)),!0;case\"gotpointercapture\":return i=s.pointerId,Ls.set(i,is(Ls.get(i)||null,t,e,r,n,s)),!0}return!1}function Jh(t){var e=Ur(t.target);if(e!==null){var r=rn(e);if(r!==null){if(e=r.tag,e===13){if(e=Uh(r),e!==null){t.blockedOn=e,Qh(t.priority,function(){Kh(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ui(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Jo(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Wo=n,r.target.dispatchEvent(n),Wo=null}else return e=si(r),e!==null&&au(e),t.blockedOn=r,!1;e.shift()}return!0}function vc(t,e,r){Ui(t)&&r.delete(e)}function Sm(){Qo=!1,fr!==null&&Ui(fr)&&(fr=null),pr!==null&&Ui(pr)&&(pr=null),mr!==null&&Ui(mr)&&(mr=null),As.forEach(vc),Ls.forEach(vc)}function as(t,e){t.blockedOn===e&&(t.blockedOn=null,Qo||(Qo=!0,Ye.unstable_scheduleCallback(Ye.unstable_NormalPriority,Sm)))}function Is(t){function e(s){return as(s,t)}if(0<xi.length){as(xi[0],t);for(var r=1;r<xi.length;r++){var n=xi[r];n.blockedOn===t&&(n.blockedOn=null)}}for(fr!==null&&as(fr,t),pr!==null&&as(pr,t),mr!==null&&as(mr,t),As.forEach(e),Ls.forEach(e),r=0;r<er.length;r++)n=er[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<er.length&&(r=er[0],r.blockedOn===null);)Jh(r),r.blockedOn===null&&er.shift()}var Tn=Kt.ReactCurrentBatchConfig,ea=!0;function jm(t,e,r,n){var s=Q,i=Tn.transition;Tn.transition=null;try{Q=1,ou(t,e,r,n)}finally{Q=s,Tn.transition=i}}function Nm(t,e,r,n){var s=Q,i=Tn.transition;Tn.transition=null;try{Q=4,ou(t,e,r,n)}finally{Q=s,Tn.transition=i}}function ou(t,e,r,n){if(ea){var s=Jo(t,e,r,n);if(s===null)uo(t,e,n,ta,r),gc(t,n);else if(_m(s,t,e,r,n))n.stopPropagation();else if(gc(t,n),e&4&&-1<km.indexOf(t)){for(;s!==null;){var i=si(s);if(i!==null&&qh(i),i=Jo(t,e,r,n),i===null&&uo(t,e,n,ta,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else uo(t,e,n,null,r)}}var ta=null;function Jo(t,e,r,n){if(ta=null,t=nu(n),t=Ur(t),t!==null)if(e=rn(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Uh(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ta=t,null}function Yh(t){switch(t){case\"cancel\":case\"click\":case\"close\":case\"contextmenu\":case\"copy\":case\"cut\":case\"auxclick\":case\"dblclick\":case\"dragend\":case\"dragstart\":case\"drop\":case\"focusin\":case\"focusout\":case\"input\":case\"invalid\":case\"keydown\":case\"keypress\":case\"keyup\":case\"mousedown\":case\"mouseup\":case\"paste\":case\"pause\":case\"play\":case\"pointercancel\":case\"pointerdown\":case\"pointerup\":case\"ratechange\":case\"reset\":case\"resize\":case\"seeked\":case\"submit\":case\"touchcancel\":case\"touchend\":case\"touchstart\":case\"volumechange\":case\"change\":case\"selectionchange\":case\"textInput\":case\"compositionstart\":case\"compositionend\":case\"compositionupdate\":case\"beforeblur\":case\"afterblur\":case\"beforeinput\":case\"blur\":case\"fullscreenchange\":case\"focus\":case\"hashchange\":case\"popstate\":case\"select\":case\"selectstart\":return 1;case\"drag\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"mousemove\":case\"mouseout\":case\"mouseover\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"scroll\":case\"toggle\":case\"touchmove\":case\"wheel\":case\"mouseenter\":case\"mouseleave\":case\"pointerenter\":case\"pointerleave\":return 4;case\"message\":switch(fm()){case su:return 1;case Bh:return 4;case Xi:case pm:return 16;case Hh:return 536870912;default:return 16}default:return 16}}var cr=null,lu=null,Mi=null;function Xh(){if(Mi)return Mi;var t,e=lu,r=e.length,n,s=\"value\"in cr?cr.value:cr.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return Mi=s.slice(t,1<n?1-n:void 0)}function Fi(t){var e=t.keyCode;return\"charCode\"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function wi(){return!0}function yc(){return!1}function Ze(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wi:yc,this.isPropagationStopped=yc,this}return ae(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!=\"unknown\"&&(r.returnValue=!1),this.isDefaultPrevented=wi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!=\"unknown\"&&(r.cancelBubble=!0),this.isPropagationStopped=wi)},persist:function(){},isPersistent:wi}),e}var Yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uu=Ze(Yn),ni=ae({},Yn,{view:0,detail:0}),Cm=Ze(ni),eo,to,os,ja=ae({},ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return\"movementX\"in t?t.movementX:(t!==os&&(os&&t.type===\"mousemove\"?(eo=t.screenX-os.screenX,to=t.screenY-os.screenY):to=eo=0,os=t),eo)},movementY:function(t){return\"movementY\"in t?t.movementY:to}}),xc=Ze(ja),Em=ae({},ja,{dataTransfer:0}),Pm=Ze(Em),Tm=ae({},ni,{relatedTarget:0}),ro=Ze(Tm),Rm=ae({},Yn,{animationName:0,elapsedTime:0,pseudoElement:0}),Om=Ze(Rm),Am=ae({},Yn,{clipboardData:function(t){return\"clipboardData\"in t?t.clipboardData:window.clipboardData}}),Lm=Ze(Am),Im=ae({},Yn,{data:0}),wc=Ze(Im),$m={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Dm={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Um={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Mm(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Um[t])?!!e[t]:!1}function cu(){return Mm}var Fm=ae({},ni,{key:function(t){if(t.key){var e=$m[t.key]||t.key;if(e!==\"Unidentified\")return e}return t.type===\"keypress\"?(t=Fi(t),t===13?\"Enter\":String.fromCharCode(t)):t.type===\"keydown\"||t.type===\"keyup\"?Dm[t.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cu,charCode:function(t){return t.type===\"keypress\"?Fi(t):0},keyCode:function(t){return t.type===\"keydown\"||t.type===\"keyup\"?t.keyCode:0},which:function(t){return t.type===\"keypress\"?Fi(t):t.type===\"keydown\"||t.type===\"keyup\"?t.keyCode:0}}),zm=Ze(Fm),Bm=ae({},ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bc=Ze(Bm),Hm=ae({},ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cu}),Wm=Ze(Hm),Vm=ae({},Yn,{propertyName:0,elapsedTime:0,pseudoElement:0}),qm=Ze(Vm),Km=ae({},ja,{deltaX:function(t){return\"deltaX\"in t?t.deltaX:\"wheelDeltaX\"in t?-t.wheelDeltaX:0},deltaY:function(t){return\"deltaY\"in t?t.deltaY:\"wheelDeltaY\"in t?-t.wheelDeltaY:\"wheelDelta\"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Gm=Ze(Km),Qm=[9,13,27,32],du=Ht&&\"CompositionEvent\"in window,ws=null;Ht&&\"documentMode\"in document&&(ws=document.documentMode);var Jm=Ht&&\"TextEvent\"in window&&!ws,Zh=Ht&&(!du||ws&&8<ws&&11>=ws),kc=\" \",_c=!1;function ef(t,e){switch(t){case\"keyup\":return Qm.indexOf(e.keyCode)!==-1;case\"keydown\":return e.keyCode!==229;case\"keypress\":case\"mousedown\":case\"focusout\":return!0;default:return!1}}function tf(t){return t=t.detail,typeof t==\"object\"&&\"data\"in t?t.data:null}var vn=!1;function Ym(t,e){switch(t){case\"compositionend\":return tf(e);case\"keypress\":return e.which!==32?null:(_c=!0,kc);case\"textInput\":return t=e.data,t===kc&&_c?null:t;default:return null}}function Xm(t,e){if(vn)return t===\"compositionend\"||!du&&ef(t,e)?(t=Xh(),Mi=lu=cr=null,vn=!1,t):null;switch(t){case\"paste\":return null;case\"keypress\":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case\"compositionend\":return Zh&&e.locale!==\"ko\"?null:e.data;default:return null}}var Zm={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e===\"input\"?!!Zm[t.type]:e===\"textarea\"}function rf(t,e,r,n){Ah(n),e=ra(e,\"onChange\"),0<e.length&&(r=new uu(\"onChange\",\"change\",null,r,n),t.push({event:r,listeners:e}))}var bs=null,$s=null;function eg(t){pf(t,0)}function Na(t){var e=wn(t);if(Nh(e))return t}function tg(t,e){if(t===\"change\")return e}var nf=!1;if(Ht){var no;if(Ht){var so=\"oninput\"in document;if(!so){var jc=document.createElement(\"div\");jc.setAttribute(\"oninput\",\"return;\"),so=typeof jc.oninput==\"function\"}no=so}else no=!1;nf=no&&(!document.documentMode||9<document.documentMode)}function Nc(){bs&&(bs.detachEvent(\"onpropertychange\",sf),$s=bs=null)}function sf(t){if(t.propertyName===\"value\"&&Na($s)){var e=[];rf(e,$s,t,nu(t)),Dh(eg,e)}}function rg(t,e,r){t===\"focusin\"?(Nc(),bs=e,$s=r,bs.attachEvent(\"onpropertychange\",sf)):t===\"focusout\"&&Nc()}function ng(t){if(t===\"selectionchange\"||t===\"keyup\"||t===\"keydown\")return Na($s)}function sg(t,e){if(t===\"click\")return Na(e)}function ig(t,e){if(t===\"input\"||t===\"change\")return Na(e)}function ag(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xt=typeof Object.is==\"function\"?Object.is:ag;function Ds(t,e){if(xt(t,e))return!0;if(typeof t!=\"object\"||t===null||typeof e!=\"object\"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Oo.call(e,s)||!xt(t[s],e[s]))return!1}return!0}function Cc(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ec(t,e){var r=Cc(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Cc(r)}}function af(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?af(t,e.parentNode):\"contains\"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function of(){for(var t=window,e=Qi();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href==\"string\"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Qi(t.document)}return e}function hu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e===\"input\"&&(t.type===\"text\"||t.type===\"search\"||t.type===\"tel\"||t.type===\"url\"||t.type===\"password\")||e===\"textarea\"||t.contentEditable===\"true\")}function og(t){var e=of(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&af(r.ownerDocument.documentElement,r)){if(n!==null&&hu(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),\"selectionStart\"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Ec(r,i);var a=Ec(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus==\"function\"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lg=Ht&&\"documentMode\"in document&&11>=document.documentMode,yn=null,Yo=null,ks=null,Xo=!1;function Pc(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Xo||yn==null||yn!==Qi(n)||(n=yn,\"selectionStart\"in n&&hu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ks&&Ds(ks,n)||(ks=n,n=ra(Yo,\"onSelect\"),0<n.length&&(e=new uu(\"onSelect\",\"select\",null,e,r),t.push({event:e,listeners:n}),e.target=yn)))}function bi(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r[\"Webkit\"+t]=\"webkit\"+e,r[\"Moz\"+t]=\"moz\"+e,r}var xn={animationend:bi(\"Animation\",\"AnimationEnd\"),animationiteration:bi(\"Animation\",\"AnimationIteration\"),animationstart:bi(\"Animation\",\"AnimationStart\"),transitionend:bi(\"Transition\",\"TransitionEnd\")},io={},lf={};Ht&&(lf=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),\"TransitionEvent\"in window||delete xn.transitionend.transition);function Ca(t){if(io[t])return io[t];if(!xn[t])return t;var e=xn[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in lf)return io[t]=e[r];return t}var uf=Ca(\"animationend\"),cf=Ca(\"animationiteration\"),df=Ca(\"animationstart\"),hf=Ca(\"transitionend\"),ff=new Map,Tc=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");function Sr(t,e){ff.set(t,e),tn(e,[t])}for(var ao=0;ao<Tc.length;ao++){var oo=Tc[ao],ug=oo.toLowerCase(),cg=oo[0].toUpperCase()+oo.slice(1);Sr(ug,\"on\"+cg)}Sr(uf,\"onAnimationEnd\");Sr(cf,\"onAnimationIteration\");Sr(df,\"onAnimationStart\");Sr(\"dblclick\",\"onDoubleClick\");Sr(\"focusin\",\"onFocus\");Sr(\"focusout\",\"onBlur\");Sr(hf,\"onTransitionEnd\");zn(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);zn(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);zn(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);zn(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);tn(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));tn(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));tn(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);tn(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));tn(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));tn(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var ms=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),dg=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(ms));function Rc(t,e,r){var n=t.type||\"unknown-event\";t.currentTarget=r,um(n,e,void 0,t),t.currentTarget=null}function pf(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var l=n[a],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Rc(s,l,c),i=u}else for(a=0;a<n.length;a++){if(l=n[a],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Rc(s,l,c),i=u}}}if(Yi)throw t=Ko,Yi=!1,Ko=null,t}function te(t,e){var r=e[nl];r===void 0&&(r=e[nl]=new Set);var n=t+\"__bubble\";r.has(n)||(mf(e,t,2,!1),r.add(n))}function lo(t,e,r){var n=0;e&&(n|=4),mf(r,t,n,e)}var ki=\"_reactListening\"+Math.random().toString(36).slice(2);function Us(t){if(!t[ki]){t[ki]=!0,bh.forEach(function(r){r!==\"selectionchange\"&&(dg.has(r)||lo(r,!1,t),lo(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ki]||(e[ki]=!0,lo(\"selectionchange\",!1,e))}}function mf(t,e,r,n){switch(Yh(e)){case 1:var s=jm;break;case 4:s=Nm;break;default:s=ou}r=s.bind(null,e,r,t),s=void 0,!qo||e!==\"touchstart\"&&e!==\"touchmove\"&&e!==\"wheel\"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function uo(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Ur(l),a===null)return;if(u=a.tag,u===5||u===6){n=i=a;continue e}l=l.parentNode}}n=n.return}Dh(function(){var c=i,d=nu(r),h=[];e:{var f=ff.get(t);if(f!==void 0){var y=uu,x=t;switch(t){case\"keypress\":if(Fi(r)===0)break e;case\"keydown\":case\"keyup\":y=zm;break;case\"focusin\":x=\"focus\",y=ro;break;case\"focusout\":x=\"blur\",y=ro;break;case\"beforeblur\":case\"afterblur\":y=ro;break;case\"click\":if(r.button===2)break e;case\"auxclick\":case\"dblclick\":case\"mousedown\":case\"mousemove\":case\"mouseup\":case\"mouseout\":case\"mouseover\":case\"contextmenu\":y=xc;break;case\"drag\":case\"dragend\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"dragstart\":case\"drop\":y=Pm;break;case\"touchcancel\":case\"touchend\":case\"touchmove\":case\"touchstart\":y=Wm;break;case uf:case cf:case df:y=Om;break;case hf:y=qm;break;case\"scroll\":y=Cm;break;case\"wheel\":y=Gm;break;case\"copy\":case\"cut\":case\"paste\":y=Lm;break;case\"gotpointercapture\":case\"lostpointercapture\":case\"pointercancel\":case\"pointerdown\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"pointerup\":y=bc}var w=(e&4)!==0,v=!w&&t===\"scroll\",m=w?f!==null?f+\"Capture\":null:f;w=[];for(var p=c,g;p!==null;){g=p;var b=g.stateNode;if(g.tag===5&&b!==null&&(g=b,m!==null&&(b=Os(p,m),b!=null&&w.push(Ms(p,b,g)))),v)break;p=p.return}0<w.length&&(f=new y(f,x,null,r,d),h.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=t===\"mouseover\"||t===\"pointerover\",y=t===\"mouseout\"||t===\"pointerout\",f&&r!==Wo&&(x=r.relatedTarget||r.fromElement)&&(Ur(x)||x[Wt]))break e;if((y||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,y?(x=r.relatedTarget||r.toElement,y=c,x=x?Ur(x):null,x!==null&&(v=rn(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=c),y!==x)){if(w=xc,b=\"onMouseLeave\",m=\"onMouseEnter\",p=\"mouse\",(t===\"pointerout\"||t===\"pointerover\")&&(w=bc,b=\"onPointerLeave\",m=\"onPointerEnter\",p=\"pointer\"),v=y==null?f:wn(y),g=x==null?f:wn(x),f=new w(b,p+\"leave\",y,r,d),f.target=v,f.relatedTarget=g,b=null,Ur(d)===c&&(w=new w(m,p+\"enter\",x,r,d),w.target=g,w.relatedTarget=v,b=w),v=b,y&&x)t:{for(w=y,m=x,p=0,g=w;g;g=on(g))p++;for(g=0,b=m;b;b=on(b))g++;for(;0<p-g;)w=on(w),p--;for(;0<g-p;)m=on(m),g--;for(;p--;){if(w===m||m!==null&&w===m.alternate)break t;w=on(w),m=on(m)}w=null}else w=null;y!==null&&Oc(h,f,y,w,!1),x!==null&&v!==null&&Oc(h,v,x,w,!0)}}e:{if(f=c?wn(c):window,y=f.nodeName&&f.nodeName.toLowerCase(),y===\"select\"||y===\"input\"&&f.type===\"file\")var S=tg;else if(Sc(f))if(nf)S=ig;else{S=ng;var j=rg}else(y=f.nodeName)&&y.toLowerCase()===\"input\"&&(f.type===\"checkbox\"||f.type===\"radio\")&&(S=sg);if(S&&(S=S(t,c))){rf(h,S,r,d);break e}j&&j(t,f,c),t===\"focusout\"&&(j=f._wrapperState)&&j.controlled&&f.type===\"number\"&&Mo(f,\"number\",f.value)}switch(j=c?wn(c):window,t){case\"focusin\":(Sc(j)||j.contentEditable===\"true\")&&(yn=j,Yo=c,ks=null);break;case\"focusout\":ks=Yo=yn=null;break;case\"mousedown\":Xo=!0;break;case\"contextmenu\":case\"mouseup\":case\"dragend\":Xo=!1,Pc(h,r,d);break;case\"selectionchange\":if(lg)break;case\"keydown\":case\"keyup\":Pc(h,r,d)}var N;if(du)e:{switch(t){case\"compositionstart\":var P=\"onCompositionStart\";break e;case\"compositionend\":P=\"onCompositionEnd\";break e;case\"compositionupdate\":P=\"onCompositionUpdate\";break e}P=void 0}else vn?ef(t,r)&&(P=\"onCompositionEnd\"):t===\"keydown\"&&r.keyCode===229&&(P=\"onCompositionStart\");P&&(Zh&&r.locale!==\"ko\"&&(vn||P!==\"onCompositionStart\"?P===\"onCompositionEnd\"&&vn&&(N=Xh()):(cr=d,lu=\"value\"in cr?cr.value:cr.textContent,vn=!0)),j=ra(c,P),0<j.length&&(P=new wc(P,t,null,r,d),h.push({event:P,listeners:j}),N?P.data=N:(N=tf(r),N!==null&&(P.data=N)))),(N=Jm?Ym(t,r):Xm(t,r))&&(c=ra(c,\"onBeforeInput\"),0<c.length&&(d=new wc(\"onBeforeInput\",\"beforeinput\",null,r,d),h.push({event:d,listeners:c}),d.data=N))}pf(h,e)})}function Ms(t,e,r){return{instance:t,listener:e,currentTarget:r}}function ra(t,e){for(var r=e+\"Capture\",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Os(t,r),i!=null&&n.unshift(Ms(t,i,s)),i=Os(t,e),i!=null&&n.push(Ms(t,i,s))),t=t.return}return n}function on(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Oc(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var l=r,u=l.alternate,c=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&c!==null&&(l=c,s?(u=Os(r,i),u!=null&&a.unshift(Ms(r,u,l))):s||(u=Os(r,i),u!=null&&a.push(Ms(r,u,l)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var hg=/\\r\\n?/g,fg=/\\u0000|\\uFFFD/g;function Ac(t){return(typeof t==\"string\"?t:\"\"+t).replace(hg,`\n`).replace(fg,\"\")}function _i(t,e,r){if(e=Ac(e),Ac(t)!==e&&r)throw Error(E(425))}function na(){}var Zo=null,el=null;function tl(t,e){return t===\"textarea\"||t===\"noscript\"||typeof e.children==\"string\"||typeof e.children==\"number\"||typeof e.dangerouslySetInnerHTML==\"object\"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rl=typeof setTimeout==\"function\"?setTimeout:void 0,pg=typeof clearTimeout==\"function\"?clearTimeout:void 0,Lc=typeof Promise==\"function\"?Promise:void 0,mg=typeof queueMicrotask==\"function\"?queueMicrotask:typeof Lc<\"u\"?function(t){return Lc.resolve(null).then(t).catch(gg)}:rl;function gg(t){setTimeout(function(){throw t})}function co(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r===\"/$\"){if(n===0){t.removeChild(s),Is(e);return}n--}else r!==\"$\"&&r!==\"$?\"&&r!==\"$!\"||n++;r=s}while(r);Is(e)}function gr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e===\"$\"||e===\"$!\"||e===\"$?\")break;if(e===\"/$\")return null}}return t}function Ic(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r===\"$\"||r===\"$!\"||r===\"$?\"){if(e===0)return t;e--}else r===\"/$\"&&e++}t=t.previousSibling}return null}var Xn=Math.random().toString(36).slice(2),Et=\"__reactFiber$\"+Xn,Fs=\"__reactProps$\"+Xn,Wt=\"__reactContainer$\"+Xn,nl=\"__reactEvents$\"+Xn,vg=\"__reactListeners$\"+Xn,yg=\"__reactHandles$\"+Xn;function Ur(t){var e=t[Et];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Wt]||r[Et]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Ic(t);t!==null;){if(r=t[Et])return r;t=Ic(t)}return e}t=r,r=t.parentNode}return null}function si(t){return t=t[Et]||t[Wt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(E(33))}function Ea(t){return t[Fs]||null}var sl=[],bn=-1;function jr(t){return{current:t}}function re(t){0>bn||(t.current=sl[bn],sl[bn]=null,bn--)}function X(t,e){bn++,sl[bn]=t.current,t.current=e}var _r={},Ae=jr(_r),Ve=jr(!1),Qr=_r;function Bn(t,e){var r=t.type.contextTypes;if(!r)return _r;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function qe(t){return t=t.childContextTypes,t!=null}function sa(){re(Ve),re(Ae)}function $c(t,e,r){if(Ae.current!==_r)throw Error(E(168));X(Ae,e),X(Ve,r)}function gf(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!=\"function\")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(E(108,rm(t)||\"Unknown\",s));return ae({},r,n)}function ia(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_r,Qr=Ae.current,X(Ae,t),X(Ve,Ve.current),!0}function Dc(t,e,r){var n=t.stateNode;if(!n)throw Error(E(169));r?(t=gf(t,e,Qr),n.__reactInternalMemoizedMergedChildContext=t,re(Ve),re(Ae),X(Ae,t)):re(Ve),X(Ve,r)}var It=null,Pa=!1,ho=!1;function vf(t){It===null?It=[t]:It.push(t)}function xg(t){Pa=!0,vf(t)}function Nr(){if(!ho&&It!==null){ho=!0;var t=0,e=Q;try{var r=It;for(Q=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}It=null,Pa=!1}catch(s){throw It!==null&&(It=It.slice(t+1)),zh(su,Nr),s}finally{Q=e,ho=!1}}return null}var kn=[],_n=0,aa=null,oa=0,rt=[],nt=0,Jr=null,Mt=1,Ft=\"\";function Lr(t,e){kn[_n++]=oa,kn[_n++]=aa,aa=t,oa=e}function yf(t,e,r){rt[nt++]=Mt,rt[nt++]=Ft,rt[nt++]=Jr,Jr=t;var n=Mt;t=Ft;var s=32-vt(n)-1;n&=~(1<<s),r+=1;var i=32-vt(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Mt=1<<32-vt(e)+s|r<<s|n,Ft=i+t}else Mt=1<<i|r<<s|n,Ft=t}function fu(t){t.return!==null&&(Lr(t,1),yf(t,1,0))}function pu(t){for(;t===aa;)aa=kn[--_n],kn[_n]=null,oa=kn[--_n],kn[_n]=null;for(;t===Jr;)Jr=rt[--nt],rt[nt]=null,Ft=rt[--nt],rt[nt]=null,Mt=rt[--nt],rt[nt]=null}var Je=null,Qe=null,ne=!1,gt=null;function xf(t,e){var r=st(5,null,null,0);r.elementType=\"DELETED\",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Uc(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Je=t,Qe=gr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===\"\"||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Je=t,Qe=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Jr!==null?{id:Mt,overflow:Ft}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=st(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Je=t,Qe=null,!0):!1;default:return!1}}function il(t){return(t.mode&1)!==0&&(t.flags&128)===0}function al(t){if(ne){var e=Qe;if(e){var r=e;if(!Uc(t,e)){if(il(t))throw Error(E(418));e=gr(r.nextSibling);var n=Je;e&&Uc(t,e)?xf(n,r):(t.flags=t.flags&-4097|2,ne=!1,Je=t)}}else{if(il(t))throw Error(E(418));t.flags=t.flags&-4097|2,ne=!1,Je=t}}}function Mc(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Je=t}function Si(t){if(t!==Je)return!1;if(!ne)return Mc(t),ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!==\"head\"&&e!==\"body\"&&!tl(t.type,t.memoizedProps)),e&&(e=Qe)){if(il(t))throw wf(),Error(E(418));for(;e;)xf(t,e),e=gr(e.nextSibling)}if(Mc(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(E(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r===\"/$\"){if(e===0){Qe=gr(t.nextSibling);break e}e--}else r!==\"$\"&&r!==\"$!\"&&r!==\"$?\"||e++}t=t.nextSibling}Qe=null}}else Qe=Je?gr(t.stateNode.nextSibling):null;return!0}function wf(){for(var t=Qe;t;)t=gr(t.nextSibling)}function Hn(){Qe=Je=null,ne=!1}function mu(t){gt===null?gt=[t]:gt.push(t)}var wg=Kt.ReactCurrentBatchConfig;function ls(t,e,r){if(t=r.ref,t!==null&&typeof t!=\"function\"&&typeof t!=\"object\"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(E(309));var n=r.stateNode}if(!n)throw Error(E(147,t));var s=n,i=\"\"+t;return e!==null&&e.ref!==null&&typeof e.ref==\"function\"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!=\"string\")throw Error(E(284));if(!r._owner)throw Error(E(290,t))}return t}function ji(t,e){throw t=Object.prototype.toString.call(e),Error(E(31,t===\"[object Object]\"?\"object with keys {\"+Object.keys(e).join(\", \")+\"}\":t))}function Fc(t){var e=t._init;return e(t._payload)}function bf(t){function e(m,p){if(t){var g=m.deletions;g===null?(m.deletions=[p],m.flags|=16):g.push(p)}}function r(m,p){if(!t)return null;for(;p!==null;)e(m,p),p=p.sibling;return null}function n(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function s(m,p){return m=wr(m,p),m.index=0,m.sibling=null,m}function i(m,p,g){return m.index=g,t?(g=m.alternate,g!==null?(g=g.index,g<p?(m.flags|=2,p):g):(m.flags|=2,p)):(m.flags|=1048576,p)}function a(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,p,g,b){return p===null||p.tag!==6?(p=xo(g,m.mode,b),p.return=m,p):(p=s(p,g),p.return=m,p)}function u(m,p,g,b){var S=g.type;return S===gn?d(m,p,g.props.children,b,g.key):p!==null&&(p.elementType===S||typeof S==\"object\"&&S!==null&&S.$$typeof===Xt&&Fc(S)===p.type)?(b=s(p,g.props),b.ref=ls(m,p,g),b.return=m,b):(b=Ki(g.type,g.key,g.props,null,m.mode,b),b.ref=ls(m,p,g),b.return=m,b)}function c(m,p,g,b){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=wo(g,m.mode,b),p.return=m,p):(p=s(p,g.children||[]),p.return=m,p)}function d(m,p,g,b,S){return p===null||p.tag!==7?(p=Gr(g,m.mode,b,S),p.return=m,p):(p=s(p,g),p.return=m,p)}function h(m,p,g){if(typeof p==\"string\"&&p!==\"\"||typeof p==\"number\")return p=xo(\"\"+p,m.mode,g),p.return=m,p;if(typeof p==\"object\"&&p!==null){switch(p.$$typeof){case pi:return g=Ki(p.type,p.key,p.props,null,m.mode,g),g.ref=ls(m,null,p),g.return=m,g;case mn:return p=wo(p,m.mode,g),p.return=m,p;case Xt:var b=p._init;return h(m,b(p._payload),g)}if(fs(p)||ns(p))return p=Gr(p,m.mode,g,null),p.return=m,p;ji(m,p)}return null}function f(m,p,g,b){var S=p!==null?p.key:null;if(typeof g==\"string\"&&g!==\"\"||typeof g==\"number\")return S!==null?null:l(m,p,\"\"+g,b);if(typeof g==\"object\"&&g!==null){switch(g.$$typeof){case pi:return g.key===S?u(m,p,g,b):null;case mn:return g.key===S?c(m,p,g,b):null;case Xt:return S=g._init,f(m,p,S(g._payload),b)}if(fs(g)||ns(g))return S!==null?null:d(m,p,g,b,null);ji(m,g)}return null}function y(m,p,g,b,S){if(typeof b==\"string\"&&b!==\"\"||typeof b==\"number\")return m=m.get(g)||null,l(p,m,\"\"+b,S);if(typeof b==\"object\"&&b!==null){switch(b.$$typeof){case pi:return m=m.get(b.key===null?g:b.key)||null,u(p,m,b,S);case mn:return m=m.get(b.key===null?g:b.key)||null,c(p,m,b,S);case Xt:var j=b._init;return y(m,p,g,j(b._payload),S)}if(fs(b)||ns(b))return m=m.get(g)||null,d(p,m,b,S,null);ji(p,b)}return null}function x(m,p,g,b){for(var S=null,j=null,N=p,P=p=0,D=null;N!==null&&P<g.length;P++){N.index>P?(D=N,N=null):D=N.sibling;var T=f(m,N,g[P],b);if(T===null){N===null&&(N=D);break}t&&N&&T.alternate===null&&e(m,N),p=i(T,p,P),j===null?S=T:j.sibling=T,j=T,N=D}if(P===g.length)return r(m,N),ne&&Lr(m,P),S;if(N===null){for(;P<g.length;P++)N=h(m,g[P],b),N!==null&&(p=i(N,p,P),j===null?S=N:j.sibling=N,j=N);return ne&&Lr(m,P),S}for(N=n(m,N);P<g.length;P++)D=y(N,m,P,g[P],b),D!==null&&(t&&D.alternate!==null&&N.delete(D.key===null?P:D.key),p=i(D,p,P),j===null?S=D:j.sibling=D,j=D);return t&&N.forEach(function(z){return e(m,z)}),ne&&Lr(m,P),S}function w(m,p,g,b){var S=ns(g);if(typeof S!=\"function\")throw Error(E(150));if(g=S.call(g),g==null)throw Error(E(151));for(var j=S=null,N=p,P=p=0,D=null,T=g.next();N!==null&&!T.done;P++,T=g.next()){N.index>P?(D=N,N=null):D=N.sibling;var z=f(m,N,T.value,b);if(z===null){N===null&&(N=D);break}t&&N&&z.alternate===null&&e(m,N),p=i(z,p,P),j===null?S=z:j.sibling=z,j=z,N=D}if(T.done)return r(m,N),ne&&Lr(m,P),S;if(N===null){for(;!T.done;P++,T=g.next())T=h(m,T.value,b),T!==null&&(p=i(T,p,P),j===null?S=T:j.sibling=T,j=T);return ne&&Lr(m,P),S}for(N=n(m,N);!T.done;P++,T=g.next())T=y(N,m,P,T.value,b),T!==null&&(t&&T.alternate!==null&&N.delete(T.key===null?P:T.key),p=i(T,p,P),j===null?S=T:j.sibling=T,j=T);return t&&N.forEach(function(G){return e(m,G)}),ne&&Lr(m,P),S}function v(m,p,g,b){if(typeof g==\"object\"&&g!==null&&g.type===gn&&g.key===null&&(g=g.props.children),typeof g==\"object\"&&g!==null){switch(g.$$typeof){case pi:e:{for(var S=g.key,j=p;j!==null;){if(j.key===S){if(S=g.type,S===gn){if(j.tag===7){r(m,j.sibling),p=s(j,g.props.children),p.return=m,m=p;break e}}else if(j.elementType===S||typeof S==\"object\"&&S!==null&&S.$$typeof===Xt&&Fc(S)===j.type){r(m,j.sibling),p=s(j,g.props),p.ref=ls(m,j,g),p.return=m,m=p;break e}r(m,j);break}else e(m,j);j=j.sibling}g.type===gn?(p=Gr(g.props.children,m.mode,b,g.key),p.return=m,m=p):(b=Ki(g.type,g.key,g.props,null,m.mode,b),b.ref=ls(m,p,g),b.return=m,m=b)}return a(m);case mn:e:{for(j=g.key;p!==null;){if(p.key===j)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){r(m,p.sibling),p=s(p,g.children||[]),p.return=m,m=p;break e}else{r(m,p);break}else e(m,p);p=p.sibling}p=wo(g,m.mode,b),p.return=m,m=p}return a(m);case Xt:return j=g._init,v(m,p,j(g._payload),b)}if(fs(g))return x(m,p,g,b);if(ns(g))return w(m,p,g,b);ji(m,g)}return typeof g==\"string\"&&g!==\"\"||typeof g==\"number\"?(g=\"\"+g,p!==null&&p.tag===6?(r(m,p.sibling),p=s(p,g),p.return=m,m=p):(r(m,p),p=xo(g,m.mode,b),p.return=m,m=p),a(m)):r(m,p)}return v}var Wn=bf(!0),kf=bf(!1),la=jr(null),ua=null,Sn=null,gu=null;function vu(){gu=Sn=ua=null}function yu(t){var e=la.current;re(la),t._currentValue=e}function ol(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Rn(t,e){ua=t,gu=Sn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(We=!0),t.firstContext=null)}function ot(t){var e=t._currentValue;if(gu!==t)if(t={context:t,memoizedValue:e,next:null},Sn===null){if(ua===null)throw Error(E(308));Sn=t,ua.dependencies={lanes:0,firstContext:t}}else Sn=Sn.next=t;return e}var Mr=null;function xu(t){Mr===null?Mr=[t]:Mr.push(t)}function _f(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,xu(e)):(r.next=s.next,s.next=r),e.interleaved=r,Vt(t,n)}function Vt(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Zt=!1;function wu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sf(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vr(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,K&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Vt(t,r)}return s=n.interleaved,s===null?(e.next=e,xu(n)):(e.next=s.next,s.next=e),n.interleaved=e,Vt(t,r)}function zi(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,iu(t,r)}}function zc(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ca(t,e,r,n){var s=t.updateQueue;Zt=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,a===null?i=c:a.next=c,a=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;a=0,d=c=u=null,l=i;do{var f=l.lane,y=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,w=l;switch(f=e,y=r,w.tag){case 1:if(x=w.payload,typeof x==\"function\"){h=x.call(y,h,f);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,f=typeof x==\"function\"?x.call(y,h,f):x,f==null)break e;h=ae({},h,f);break e;case 2:Zt=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else y={eventTime:y,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=y,u=h):d=d.next=y,a|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Xr|=a,t.lanes=a,t.memoizedState=h}}function Bc(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!=\"function\")throw Error(E(191,s));s.call(n)}}}var ii={},Tt=jr(ii),zs=jr(ii),Bs=jr(ii);function Fr(t){if(t===ii)throw Error(E(174));return t}function bu(t,e){switch(X(Bs,e),X(zs,t),X(Tt,ii),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zo(null,\"\");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zo(e,t)}re(Tt),X(Tt,e)}function Vn(){re(Tt),re(zs),re(Bs)}function jf(t){Fr(Bs.current);var e=Fr(Tt.current),r=zo(e,t.type);e!==r&&(X(zs,t),X(Tt,r))}function ku(t){zs.current===t&&(re(Tt),re(zs))}var se=jr(0);function da(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data===\"$?\"||r.data===\"$!\"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fo=[];function _u(){for(var t=0;t<fo.length;t++)fo[t]._workInProgressVersionPrimary=null;fo.length=0}var Bi=Kt.ReactCurrentDispatcher,po=Kt.ReactCurrentBatchConfig,Yr=0,ie=null,ve=null,be=null,ha=!1,_s=!1,Hs=0,bg=0;function Te(){throw Error(E(321))}function Su(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!xt(t[r],e[r]))return!1;return!0}function ju(t,e,r,n,s,i){if(Yr=i,ie=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bi.current=t===null||t.memoizedState===null?jg:Ng,t=r(n,s),_s){i=0;do{if(_s=!1,Hs=0,25<=i)throw Error(E(301));i+=1,be=ve=null,e.updateQueue=null,Bi.current=Cg,t=r(n,s)}while(_s)}if(Bi.current=fa,e=ve!==null&&ve.next!==null,Yr=0,be=ve=ie=null,ha=!1,e)throw Error(E(300));return t}function Nu(){var t=Hs!==0;return Hs=0,t}function _t(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return be===null?ie.memoizedState=be=t:be=be.next=t,be}function lt(){if(ve===null){var t=ie.alternate;t=t!==null?t.memoizedState:null}else t=ve.next;var e=be===null?ie.memoizedState:be.next;if(e!==null)be=e,ve=t;else{if(t===null)throw Error(E(310));ve=t,t={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},be===null?ie.memoizedState=be=t:be=be.next=t}return be}function Ws(t,e){return typeof e==\"function\"?e(t):e}function mo(t){var e=lt(),r=e.queue;if(r===null)throw Error(E(311));r.lastRenderedReducer=t;var n=ve,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,u=null,c=i;do{var d=c.lane;if((Yr&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,a=n):u=u.next=h,ie.lanes|=d,Xr|=d}c=c.next}while(c!==null&&c!==i);u===null?a=n:u.next=l,xt(n,e.memoizedState)||(We=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,ie.lanes|=i,Xr|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function go(t){var e=lt(),r=e.queue;if(r===null)throw Error(E(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);xt(i,e.memoizedState)||(We=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function Nf(){}function Cf(t,e){var r=ie,n=lt(),s=e(),i=!xt(n.memoizedState,s);if(i&&(n.memoizedState=s,We=!0),n=n.queue,Cu(Tf.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||be!==null&&be.memoizedState.tag&1){if(r.flags|=2048,Vs(9,Pf.bind(null,r,n,s,e),void 0,null),ke===null)throw Error(E(349));Yr&30||Ef(r,e,s)}return s}function Ef(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ie.updateQueue,e===null?(e={lastEffect:null,stores:null},ie.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Pf(t,e,r,n){e.value=r,e.getSnapshot=n,Rf(e)&&Of(t)}function Tf(t,e,r){return r(function(){Rf(e)&&Of(t)})}function Rf(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!xt(t,r)}catch{return!0}}function Of(t){var e=Vt(t,1);e!==null&&yt(e,t,1,-1)}function Hc(t){var e=_t();return typeof t==\"function\"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:t},e.queue=t,t=t.dispatch=Sg.bind(null,ie,t),[e.memoizedState,t]}function Vs(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ie.updateQueue,e===null?(e={lastEffect:null,stores:null},ie.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Af(){return lt().memoizedState}function Hi(t,e,r,n){var s=_t();ie.flags|=t,s.memoizedState=Vs(1|e,r,void 0,n===void 0?null:n)}function Ta(t,e,r,n){var s=lt();n=n===void 0?null:n;var i=void 0;if(ve!==null){var a=ve.memoizedState;if(i=a.destroy,n!==null&&Su(n,a.deps)){s.memoizedState=Vs(e,r,i,n);return}}ie.flags|=t,s.memoizedState=Vs(1|e,r,i,n)}function Wc(t,e){return Hi(8390656,8,t,e)}function Cu(t,e){return Ta(2048,8,t,e)}function Lf(t,e){return Ta(4,2,t,e)}function If(t,e){return Ta(4,4,t,e)}function $f(t,e){if(typeof e==\"function\")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Df(t,e,r){return r=r!=null?r.concat([t]):null,Ta(4,4,$f.bind(null,e,t),r)}function Eu(){}function Uf(t,e){var r=lt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Su(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Mf(t,e){var r=lt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Su(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Ff(t,e,r){return Yr&21?(xt(r,e)||(r=Wh(),ie.lanes|=r,Xr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,We=!0),t.memoizedState=r)}function kg(t,e){var r=Q;Q=r!==0&&4>r?r:4,t(!0);var n=po.transition;po.transition={};try{t(!1),e()}finally{Q=r,po.transition=n}}function zf(){return lt().memoizedState}function _g(t,e,r){var n=xr(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Bf(t))Hf(e,r);else if(r=_f(t,e,r,n),r!==null){var s=De();yt(r,t,n,s),Wf(r,e,n)}}function Sg(t,e,r){var n=xr(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Bf(t))Hf(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,xt(l,a)){var u=e.interleaved;u===null?(s.next=s,xu(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}r=_f(t,e,s,n),r!==null&&(s=De(),yt(r,t,n,s),Wf(r,e,n))}}function Bf(t){var e=t.alternate;return t===ie||e!==null&&e===ie}function Hf(t,e){_s=ha=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Wf(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,iu(t,r)}}var fa={readContext:ot,useCallback:Te,useContext:Te,useEffect:Te,useImperativeHandle:Te,useInsertionEffect:Te,useLayoutEffect:Te,useMemo:Te,useReducer:Te,useRef:Te,useState:Te,useDebugValue:Te,useDeferredValue:Te,useTransition:Te,useMutableSource:Te,useSyncExternalStore:Te,useId:Te,unstable_isNewReconciler:!1},jg={readContext:ot,useCallback:function(t,e){return _t().memoizedState=[t,e===void 0?null:e],t},useContext:ot,useEffect:Wc,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Hi(4194308,4,$f.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Hi(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hi(4,2,t,e)},useMemo:function(t,e){var r=_t();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=_t();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=_g.bind(null,ie,t),[n.memoizedState,t]},useRef:function(t){var e=_t();return t={current:t},e.memoizedState=t},useState:Hc,useDebugValue:Eu,useDeferredValue:function(t){return _t().memoizedState=t},useTransition:function(){var t=Hc(!1),e=t[0];return t=kg.bind(null,t[1]),_t().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ie,s=_t();if(ne){if(r===void 0)throw Error(E(407));r=r()}else{if(r=e(),ke===null)throw Error(E(349));Yr&30||Ef(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Wc(Tf.bind(null,n,i,t),[t]),n.flags|=2048,Vs(9,Pf.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=_t(),e=ke.identifierPrefix;if(ne){var r=Ft,n=Mt;r=(n&~(1<<32-vt(n)-1)).toString(32)+r,e=\":\"+e+\"R\"+r,r=Hs++,0<r&&(e+=\"H\"+r.toString(32)),e+=\":\"}else r=bg++,e=\":\"+e+\"r\"+r.toString(32)+\":\";return t.memoizedState=e},unstable_isNewReconciler:!1},Ng={readContext:ot,useCallback:Uf,useContext:ot,useEffect:Cu,useImperativeHandle:Df,useInsertionEffect:Lf,useLayoutEffect:If,useMemo:Mf,useReducer:mo,useRef:Af,useState:function(){return mo(Ws)},useDebugValue:Eu,useDeferredValue:function(t){var e=lt();return Ff(e,ve.memoizedState,t)},useTransition:function(){var t=mo(Ws)[0],e=lt().memoizedState;return[t,e]},useMutableSource:Nf,useSyncExternalStore:Cf,useId:zf,unstable_isNewReconciler:!1},Cg={readContext:ot,useCallback:Uf,useContext:ot,useEffect:Cu,useImperativeHandle:Df,useInsertionEffect:Lf,useLayoutEffect:If,useMemo:Mf,useReducer:go,useRef:Af,useState:function(){return go(Ws)},useDebugValue:Eu,useDeferredValue:function(t){var e=lt();return ve===null?e.memoizedState=t:Ff(e,ve.memoizedState,t)},useTransition:function(){var t=go(Ws)[0],e=lt().memoizedState;return[t,e]},useMutableSource:Nf,useSyncExternalStore:Cf,useId:zf,unstable_isNewReconciler:!1};function dt(t,e){if(t&&t.defaultProps){e=ae({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ll(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ae({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Ra={isMounted:function(t){return(t=t._reactInternals)?rn(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=De(),s=xr(t),i=zt(n,s);i.payload=e,r!=null&&(i.callback=r),e=vr(t,i,s),e!==null&&(yt(e,t,s,n),zi(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=De(),s=xr(t),i=zt(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=vr(t,i,s),e!==null&&(yt(e,t,s,n),zi(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=De(),n=xr(t),s=zt(r,n);s.tag=2,e!=null&&(s.callback=e),e=vr(t,s,n),e!==null&&(yt(e,t,n,r),zi(e,t,n))}};function Vc(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate==\"function\"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!Ds(r,n)||!Ds(s,i):!0}function Vf(t,e,r){var n=!1,s=_r,i=e.contextType;return typeof i==\"object\"&&i!==null?i=ot(i):(s=qe(e)?Qr:Ae.current,n=e.contextTypes,i=(n=n!=null)?Bn(t,s):_r),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ra,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function qc(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps==\"function\"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps==\"function\"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Ra.enqueueReplaceState(e,e.state,null)}function ul(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},wu(t);var i=e.contextType;typeof i==\"object\"&&i!==null?s.context=ot(i):(i=qe(e)?Qr:Ae.current,s.context=Bn(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i==\"function\"&&(ll(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps==\"function\"||typeof s.getSnapshotBeforeUpdate==\"function\"||typeof s.UNSAFE_componentWillMount!=\"function\"&&typeof s.componentWillMount!=\"function\"||(e=s.state,typeof s.componentWillMount==\"function\"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount==\"function\"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ra.enqueueReplaceState(s,s.state,null),ca(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount==\"function\"&&(t.flags|=4194308)}function qn(t,e){try{var r=\"\",n=e;do r+=tm(n),n=n.return;while(n);var s=r}catch(i){s=`\nError generating stack: `+i.message+`\n`+i.stack}return{value:t,source:e,stack:s,digest:null}}function vo(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function cl(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Eg=typeof WeakMap==\"function\"?WeakMap:Map;function qf(t,e,r){r=zt(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ma||(ma=!0,wl=n),cl(t,e)},r}function Kf(t,e,r){r=zt(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n==\"function\"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){cl(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch==\"function\"&&(r.callback=function(){cl(t,e),typeof n!=\"function\"&&(yr===null?yr=new Set([this]):yr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:\"\"})}),r}function Kc(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Eg;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Bg.bind(null,t,e,r),e.then(t,t))}function Gc(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qc(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=zt(-1,1),e.tag=2,vr(r,e,1))),r.lanes|=1),t)}var Pg=Kt.ReactCurrentOwner,We=!1;function $e(t,e,r,n){e.child=t===null?kf(e,null,r,n):Wn(e,t.child,r,n)}function Jc(t,e,r,n,s){r=r.render;var i=e.ref;return Rn(e,s),n=ju(t,e,r,n,i,s),r=Nu(),t!==null&&!We?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qt(t,e,s)):(ne&&r&&fu(e),e.flags|=1,$e(t,e,n,s),e.child)}function Yc(t,e,r,n,s){if(t===null){var i=r.type;return typeof i==\"function\"&&!$u(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,Gf(t,e,i,n,s)):(t=Ki(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ds,r(a,n)&&t.ref===e.ref)return qt(t,e,s)}return e.flags|=1,t=wr(i,n),t.ref=e.ref,t.return=e,e.child=t}function Gf(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Ds(i,n)&&t.ref===e.ref)if(We=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(We=!0);else return e.lanes=t.lanes,qt(t,e,s)}return dl(t,e,r,n,s)}function Qf(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode===\"hidden\")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},X(Nn,Ge),Ge|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,X(Nn,Ge),Ge|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,X(Nn,Ge),Ge|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,X(Nn,Ge),Ge|=n;return $e(t,e,s,r),e.child}function Jf(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function dl(t,e,r,n,s){var i=qe(r)?Qr:Ae.current;return i=Bn(e,i),Rn(e,s),r=ju(t,e,r,n,i,s),n=Nu(),t!==null&&!We?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qt(t,e,s)):(ne&&n&&fu(e),e.flags|=1,$e(t,e,r,s),e.child)}function Xc(t,e,r,n,s){if(qe(r)){var i=!0;ia(e)}else i=!1;if(Rn(e,s),e.stateNode===null)Wi(t,e),Vf(e,r,n),ul(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,c=r.contextType;typeof c==\"object\"&&c!==null?c=ot(c):(c=qe(r)?Qr:Ae.current,c=Bn(e,c));var d=r.getDerivedStateFromProps,h=typeof d==\"function\"||typeof a.getSnapshotBeforeUpdate==\"function\";h||typeof a.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof a.componentWillReceiveProps!=\"function\"||(l!==n||u!==c)&&qc(e,a,n,c),Zt=!1;var f=e.memoizedState;a.state=f,ca(e,n,a,s),u=e.memoizedState,l!==n||f!==u||Ve.current||Zt?(typeof d==\"function\"&&(ll(e,r,d,n),u=e.memoizedState),(l=Zt||Vc(e,r,l,n,f,u,c))?(h||typeof a.UNSAFE_componentWillMount!=\"function\"&&typeof a.componentWillMount!=\"function\"||(typeof a.componentWillMount==\"function\"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount==\"function\"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount==\"function\"&&(e.flags|=4194308)):(typeof a.componentDidMount==\"function\"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),a.props=n,a.state=u,a.context=c,n=l):(typeof a.componentDidMount==\"function\"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Sf(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:dt(e.type,l),a.props=c,h=e.pendingProps,f=a.context,u=r.contextType,typeof u==\"object\"&&u!==null?u=ot(u):(u=qe(r)?Qr:Ae.current,u=Bn(e,u));var y=r.getDerivedStateFromProps;(d=typeof y==\"function\"||typeof a.getSnapshotBeforeUpdate==\"function\")||typeof a.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof a.componentWillReceiveProps!=\"function\"||(l!==h||f!==u)&&qc(e,a,n,u),Zt=!1,f=e.memoizedState,a.state=f,ca(e,n,a,s);var x=e.memoizedState;l!==h||f!==x||Ve.current||Zt?(typeof y==\"function\"&&(ll(e,r,y,n),x=e.memoizedState),(c=Zt||Vc(e,r,c,n,f,x,u)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!=\"function\"&&typeof a.componentWillUpdate!=\"function\"||(typeof a.componentWillUpdate==\"function\"&&a.componentWillUpdate(n,x,u),typeof a.UNSAFE_componentWillUpdate==\"function\"&&a.UNSAFE_componentWillUpdate(n,x,u)),typeof a.componentDidUpdate==\"function\"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate==\"function\"&&(e.flags|=1024)):(typeof a.componentDidUpdate!=\"function\"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!=\"function\"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),a.props=n,a.state=x,a.context=u,n=c):(typeof a.componentDidUpdate!=\"function\"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!=\"function\"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return hl(t,e,r,n,i,s)}function hl(t,e,r,n,s,i){Jf(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&Dc(e,r,!1),qt(t,e,i);n=e.stateNode,Pg.current=e;var l=a&&typeof r.getDerivedStateFromError!=\"function\"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Wn(e,t.child,null,i),e.child=Wn(e,null,l,i)):$e(t,e,l,i),e.memoizedState=n.state,s&&Dc(e,r,!0),e.child}function Yf(t){var e=t.stateNode;e.pendingContext?$c(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$c(t,e.context,!1),bu(t,e.containerInfo)}function Zc(t,e,r,n,s){return Hn(),mu(s),e.flags|=256,$e(t,e,r,n),e.child}var fl={dehydrated:null,treeContext:null,retryLane:0};function pl(t){return{baseLanes:t,cachePool:null,transitions:null}}function Xf(t,e,r){var n=e.pendingProps,s=se.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),X(se,s&1),t===null)return al(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data===\"$!\"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:\"hidden\",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=La(a,n,0,null),t=Gr(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=pl(r),e.memoizedState=fl,t):Pu(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Tg(t,e,a,n,l,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:\"hidden\",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=wr(s,u),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=wr(l,i):(i=Gr(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?pl(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=fl,n}return i=t.child,t=i.sibling,n=wr(i,{mode:\"visible\",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Pu(t,e){return e=La({mode:\"visible\",children:e},t.mode,0,null),e.return=t,t.child=e}function Ni(t,e,r,n){return n!==null&&mu(n),Wn(e,t.child,null,r),t=Pu(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Tg(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=vo(Error(E(422))),Ni(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=La({mode:\"visible\",children:n.children},s,0,null),i=Gr(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Wn(e,t.child,null,a),e.child.memoizedState=pl(a),e.memoizedState=fl,i);if(!(e.mode&1))return Ni(t,e,a,null);if(s.data===\"$!\"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(E(419)),n=vo(i,n,void 0),Ni(t,e,a,n)}if(l=(a&t.childLanes)!==0,We||l){if(n=ke,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Vt(t,s),yt(n,t,s,-1))}return Iu(),n=vo(Error(E(421))),Ni(t,e,a,n)}return s.data===\"$?\"?(e.flags|=128,e.child=t.child,e=Hg.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Qe=gr(s.nextSibling),Je=e,ne=!0,gt=null,t!==null&&(rt[nt++]=Mt,rt[nt++]=Ft,rt[nt++]=Jr,Mt=t.id,Ft=t.overflow,Jr=e),e=Pu(e,n.children),e.flags|=4096,e)}function ed(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),ol(t.return,e,r)}function yo(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Zf(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if($e(t,e,n.children,r),n=se.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ed(t,r,e);else if(t.tag===19)ed(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(X(se,n),!(e.mode&1))e.memoizedState=null;else switch(s){case\"forwards\":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&da(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),yo(e,!1,s,r,i);break;case\"backwards\":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&da(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}yo(e,!0,r,null,i);break;case\"together\":yo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wi(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qt(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Xr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(E(153));if(e.child!==null){for(t=e.child,r=wr(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=wr(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Rg(t,e,r){switch(e.tag){case 3:Yf(e),Hn();break;case 5:jf(e);break;case 1:qe(e.type)&&ia(e);break;case 4:bu(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;X(la,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(X(se,se.current&1),e.flags|=128,null):r&e.child.childLanes?Xf(t,e,r):(X(se,se.current&1),t=qt(t,e,r),t!==null?t.sibling:null);X(se,se.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Zf(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),X(se,se.current),n)break;return null;case 22:case 23:return e.lanes=0,Qf(t,e,r)}return qt(t,e,r)}var ep,ml,tp,rp;ep=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ml=function(){};tp=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Fr(Tt.current);var i=null;switch(r){case\"input\":s=Do(t,s),n=Do(t,n),i=[];break;case\"select\":s=ae({},s,{value:void 0}),n=ae({},n,{value:void 0}),i=[];break;case\"textarea\":s=Fo(t,s),n=Fo(t,n),i=[];break;default:typeof s.onClick!=\"function\"&&typeof n.onClick==\"function\"&&(t.onclick=na)}Bo(r,n);var a;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c===\"style\"){var l=s[c];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]=\"\")}else c!==\"dangerouslySetInnerHTML\"&&c!==\"children\"&&c!==\"suppressContentEditableWarning\"&&c!==\"suppressHydrationWarning\"&&c!==\"autoFocus\"&&(Ts.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(l=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c===\"style\")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(r||(r={}),r[a]=\"\");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(r||(r={}),r[a]=u[a])}else r||(i||(i=[]),i.push(c,r)),r=u;else c===\"dangerouslySetInnerHTML\"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c===\"children\"?typeof u!=\"string\"&&typeof u!=\"number\"||(i=i||[]).push(c,\"\"+u):c!==\"suppressContentEditableWarning\"&&c!==\"suppressHydrationWarning\"&&(Ts.hasOwnProperty(c)?(u!=null&&c===\"onScroll\"&&te(\"scroll\",t),i||l===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push(\"style\",r);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};rp=function(t,e,r,n){r!==n&&(e.flags|=4)};function us(t,e){if(!ne)switch(t.tailMode){case\"hidden\":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case\"collapsed\":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Re(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Og(t,e,r){var n=e.pendingProps;switch(pu(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Re(e),null;case 1:return qe(e.type)&&sa(),Re(e),null;case 3:return n=e.stateNode,Vn(),re(Ve),re(Ae),_u(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Si(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gt!==null&&(_l(gt),gt=null))),ml(t,e),Re(e),null;case 5:ku(e);var s=Fr(Bs.current);if(r=e.type,t!==null&&e.stateNode!=null)tp(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(E(166));return Re(e),null}if(t=Fr(Tt.current),Si(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Et]=e,n[Fs]=i,t=(e.mode&1)!==0,r){case\"dialog\":te(\"cancel\",n),te(\"close\",n);break;case\"iframe\":case\"object\":case\"embed\":te(\"load\",n);break;case\"video\":case\"audio\":for(s=0;s<ms.length;s++)te(ms[s],n);break;case\"source\":te(\"error\",n);break;case\"img\":case\"image\":case\"link\":te(\"error\",n),te(\"load\",n);break;case\"details\":te(\"toggle\",n);break;case\"input\":uc(n,i),te(\"invalid\",n);break;case\"select\":n._wrapperState={wasMultiple:!!i.multiple},te(\"invalid\",n);break;case\"textarea\":dc(n,i),te(\"invalid\",n)}Bo(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a===\"children\"?typeof l==\"string\"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&_i(n.textContent,l,t),s=[\"children\",l]):typeof l==\"number\"&&n.textContent!==\"\"+l&&(i.suppressHydrationWarning!==!0&&_i(n.textContent,l,t),s=[\"children\",\"\"+l]):Ts.hasOwnProperty(a)&&l!=null&&a===\"onScroll\"&&te(\"scroll\",n)}switch(r){case\"input\":mi(n),cc(n,i,!0);break;case\"textarea\":mi(n),hc(n);break;case\"select\":case\"option\":break;default:typeof i.onClick==\"function\"&&(n.onclick=na)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t===\"http://www.w3.org/1999/xhtml\"&&(t=Ph(r)),t===\"http://www.w3.org/1999/xhtml\"?r===\"script\"?(t=a.createElement(\"div\"),t.innerHTML=\"<script><\\/script>\",t=t.removeChild(t.firstChild)):typeof n.is==\"string\"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r===\"select\"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Et]=e,t[Fs]=n,ep(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ho(r,n),r){case\"dialog\":te(\"cancel\",t),te(\"close\",t),s=n;break;case\"iframe\":case\"object\":case\"embed\":te(\"load\",t),s=n;break;case\"video\":case\"audio\":for(s=0;s<ms.length;s++)te(ms[s],t);s=n;break;case\"source\":te(\"error\",t),s=n;break;case\"img\":case\"image\":case\"link\":te(\"error\",t),te(\"load\",t),s=n;break;case\"details\":te(\"toggle\",t),s=n;break;case\"input\":uc(t,n),s=Do(t,n),te(\"invalid\",t);break;case\"option\":s=n;break;case\"select\":t._wrapperState={wasMultiple:!!n.multiple},s=ae({},n,{value:void 0}),te(\"invalid\",t);break;case\"textarea\":dc(t,n),s=Fo(t,n),te(\"invalid\",t);break;default:s=n}Bo(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i===\"style\"?Oh(t,u):i===\"dangerouslySetInnerHTML\"?(u=u?u.__html:void 0,u!=null&&Th(t,u)):i===\"children\"?typeof u==\"string\"?(r!==\"textarea\"||u!==\"\")&&Rs(t,u):typeof u==\"number\"&&Rs(t,\"\"+u):i!==\"suppressContentEditableWarning\"&&i!==\"suppressHydrationWarning\"&&i!==\"autoFocus\"&&(Ts.hasOwnProperty(i)?u!=null&&i===\"onScroll\"&&te(\"scroll\",t):u!=null&&Zl(t,i,u,a))}switch(r){case\"input\":mi(t),cc(t,n,!1);break;case\"textarea\":mi(t),hc(t);break;case\"option\":n.value!=null&&t.setAttribute(\"value\",\"\"+kr(n.value));break;case\"select\":t.multiple=!!n.multiple,i=n.value,i!=null?Cn(t,!!n.multiple,i,!1):n.defaultValue!=null&&Cn(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick==\"function\"&&(t.onclick=na)}switch(r){case\"button\":case\"input\":case\"select\":case\"textarea\":n=!!n.autoFocus;break e;case\"img\":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Re(e),null;case 6:if(t&&e.stateNode!=null)rp(t,e,t.memoizedProps,n);else{if(typeof n!=\"string\"&&e.stateNode===null)throw Error(E(166));if(r=Fr(Bs.current),Fr(Tt.current),Si(e)){if(n=e.stateNode,r=e.memoizedProps,n[Et]=e,(i=n.nodeValue!==r)&&(t=Je,t!==null))switch(t.tag){case 3:_i(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_i(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Et]=e,e.stateNode=n}return Re(e),null;case 13:if(re(se),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ne&&Qe!==null&&e.mode&1&&!(e.flags&128))wf(),Hn(),e.flags|=98560,i=!1;else if(i=Si(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(E(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(E(317));i[Et]=e}else Hn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Re(e),i=!1}else gt!==null&&(_l(gt),gt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||se.current&1?ye===0&&(ye=3):Iu())),e.updateQueue!==null&&(e.flags|=4),Re(e),null);case 4:return Vn(),ml(t,e),t===null&&Us(e.stateNode.containerInfo),Re(e),null;case 10:return yu(e.type._context),Re(e),null;case 17:return qe(e.type)&&sa(),Re(e),null;case 19:if(re(se),i=e.memoizedState,i===null)return Re(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)us(i,!1);else{if(ye!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=da(t),a!==null){for(e.flags|=128,us(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return X(se,se.current&1|2),e.child}t=t.sibling}i.tail!==null&&de()>Kn&&(e.flags|=128,n=!0,us(i,!1),e.lanes=4194304)}else{if(!n)if(t=da(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),us(i,!0),i.tail===null&&i.tailMode===\"hidden\"&&!a.alternate&&!ne)return Re(e),null}else 2*de()-i.renderingStartTime>Kn&&r!==1073741824&&(e.flags|=128,n=!0,us(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=de(),e.sibling=null,r=se.current,X(se,n?r&1|2:r&1),e):(Re(e),null);case 22:case 23:return Lu(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ge&1073741824&&(Re(e),e.subtreeFlags&6&&(e.flags|=8192)):Re(e),null;case 24:return null;case 25:return null}throw Error(E(156,e.tag))}function Ag(t,e){switch(pu(e),e.tag){case 1:return qe(e.type)&&sa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vn(),re(Ve),re(Ae),_u(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ku(e),null;case 13:if(re(se),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(E(340));Hn()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return re(se),null;case 4:return Vn(),null;case 10:return yu(e.type._context),null;case 22:case 23:return Lu(),null;case 24:return null;default:return null}}var Ci=!1,Oe=!1,Lg=typeof WeakSet==\"function\"?WeakSet:Set,R=null;function jn(t,e){var r=t.ref;if(r!==null)if(typeof r==\"function\")try{r(null)}catch(n){le(t,e,n)}else r.current=null}function gl(t,e,r){try{r()}catch(n){le(t,e,n)}}var td=!1;function Ig(t,e){if(Zo=ea,t=of(),hu(t)){if(\"selectionStart\"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,u=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var y;h!==r||s!==0&&h.nodeType!==3||(l=a+s),h!==i||n!==0&&h.nodeType!==3||(u=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(y=h.firstChild)!==null;)f=h,h=y;for(;;){if(h===t)break t;if(f===r&&++c===s&&(l=a),f===i&&++d===n&&(u=a),(y=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=y}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(el={focusedElem:t,selectionRange:r},ea=!1,R=e;R!==null;)if(e=R,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,R=t;else for(;R!==null;){e=R;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,v=x.memoizedState,m=e.stateNode,p=m.getSnapshotBeforeUpdate(e.elementType===e.type?w:dt(e.type,w),v);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent=\"\":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(E(163))}}catch(b){le(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,R=t;break}R=e.return}return x=td,td=!1,x}function Ss(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&gl(e,r,i)}s=s.next}while(s!==n)}}function Oa(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function vl(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e==\"function\"?e(t):e.current=t}}function np(t){var e=t.alternate;e!==null&&(t.alternate=null,np(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Et],delete e[Fs],delete e[nl],delete e[vg],delete e[yg])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sp(t){return t.tag===5||t.tag===3||t.tag===4}function rd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=na));else if(n!==4&&(t=t.child,t!==null))for(yl(t,e,r),t=t.sibling;t!==null;)yl(t,e,r),t=t.sibling}function xl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(xl(t,e,r),t=t.sibling;t!==null;)xl(t,e,r),t=t.sibling}var _e=null,pt=!1;function Gt(t,e,r){for(r=r.child;r!==null;)ip(t,e,r),r=r.sibling}function ip(t,e,r){if(Pt&&typeof Pt.onCommitFiberUnmount==\"function\")try{Pt.onCommitFiberUnmount(Sa,r)}catch{}switch(r.tag){case 5:Oe||jn(r,e);case 6:var n=_e,s=pt;_e=null,Gt(t,e,r),_e=n,pt=s,_e!==null&&(pt?(t=_e,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):_e.removeChild(r.stateNode));break;case 18:_e!==null&&(pt?(t=_e,r=r.stateNode,t.nodeType===8?co(t.parentNode,r):t.nodeType===1&&co(t,r),Is(t)):co(_e,r.stateNode));break;case 4:n=_e,s=pt,_e=r.stateNode.containerInfo,pt=!0,Gt(t,e,r),_e=n,pt=s;break;case 0:case 11:case 14:case 15:if(!Oe&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&gl(r,e,a),s=s.next}while(s!==n)}Gt(t,e,r);break;case 1:if(!Oe&&(jn(r,e),n=r.stateNode,typeof n.componentWillUnmount==\"function\"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){le(r,e,l)}Gt(t,e,r);break;case 21:Gt(t,e,r);break;case 22:r.mode&1?(Oe=(n=Oe)||r.memoizedState!==null,Gt(t,e,r),Oe=n):Gt(t,e,r);break;default:Gt(t,e,r)}}function nd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Lg),e.forEach(function(n){var s=Wg.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ut(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:_e=l.stateNode,pt=!1;break e;case 3:_e=l.stateNode.containerInfo,pt=!0;break e;case 4:_e=l.stateNode.containerInfo,pt=!0;break e}l=l.return}if(_e===null)throw Error(E(160));ip(i,a,s),_e=null,pt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){le(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ap(e,t),e=e.sibling}function ap(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ut(e,t),bt(t),n&4){try{Ss(3,t,t.return),Oa(3,t)}catch(w){le(t,t.return,w)}try{Ss(5,t,t.return)}catch(w){le(t,t.return,w)}}break;case 1:ut(e,t),bt(t),n&512&&r!==null&&jn(r,r.return);break;case 5:if(ut(e,t),bt(t),n&512&&r!==null&&jn(r,r.return),t.flags&32){var s=t.stateNode;try{Rs(s,\"\")}catch(w){le(t,t.return,w)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l===\"input\"&&i.type===\"radio\"&&i.name!=null&&Ch(s,i),Ho(l,a);var c=Ho(l,i);for(a=0;a<u.length;a+=2){var d=u[a],h=u[a+1];d===\"style\"?Oh(s,h):d===\"dangerouslySetInnerHTML\"?Th(s,h):d===\"children\"?Rs(s,h):Zl(s,d,h,c)}switch(l){case\"input\":Uo(s,i);break;case\"textarea\":Eh(s,i);break;case\"select\":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?Cn(s,!!i.multiple,y,!1):f!==!!i.multiple&&(i.defaultValue!=null?Cn(s,!!i.multiple,i.defaultValue,!0):Cn(s,!!i.multiple,i.multiple?[]:\"\",!1))}s[Fs]=i}catch(w){le(t,t.return,w)}}break;case 6:if(ut(e,t),bt(t),n&4){if(t.stateNode===null)throw Error(E(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){le(t,t.return,w)}}break;case 3:if(ut(e,t),bt(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Is(e.containerInfo)}catch(w){le(t,t.return,w)}break;case 4:ut(e,t),bt(t);break;case 13:ut(e,t),bt(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ou=de())),n&4&&nd(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Oe=(c=Oe)||d,ut(e,t),Oe=c):ut(e,t),bt(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(R=t,d=t.child;d!==null;){for(h=R=d;R!==null;){switch(f=R,y=f.child,f.tag){case 0:case 11:case 14:case 15:Ss(4,f,f.return);break;case 1:jn(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount==\"function\"){n=f,r=f.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){le(n,r,w)}}break;case 5:jn(f,f.return);break;case 22:if(f.memoizedState!==null){id(h);continue}}y!==null?(y.return=f,R=y):id(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty==\"function\"?i.setProperty(\"display\",\"none\",\"important\"):i.display=\"none\"):(l=h.stateNode,u=h.memoizedProps.style,a=u!=null&&u.hasOwnProperty(\"display\")?u.display:null,l.style.display=Rh(\"display\",a))}catch(w){le(t,t.return,w)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?\"\":h.memoizedProps}catch(w){le(t,t.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ut(e,t),bt(t),n&4&&nd(t);break;case 21:break;default:ut(e,t),bt(t)}}function bt(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(sp(r)){var n=r;break e}r=r.return}throw Error(E(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Rs(s,\"\"),n.flags&=-33);var i=rd(t);xl(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=rd(t);yl(t,l,a);break;default:throw Error(E(161))}}catch(u){le(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function $g(t,e,r){R=t,op(t)}function op(t,e,r){for(var n=(t.mode&1)!==0;R!==null;){var s=R,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Ci;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Oe;l=Ci;var c=Oe;if(Ci=a,(Oe=u)&&!c)for(R=s;R!==null;)a=R,u=a.child,a.tag===22&&a.memoizedState!==null?ad(s):u!==null?(u.return=a,R=u):ad(s);for(;i!==null;)R=i,op(i),i=i.sibling;R=s,Ci=l,Oe=c}sd(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,R=i):sd(t)}}function sd(t){for(;R!==null;){var e=R;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Oe||Oa(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Oe)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:dt(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Bc(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Bc(e,a,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var u=e.memoizedProps;switch(e.type){case\"button\":case\"input\":case\"select\":case\"textarea\":u.autoFocus&&r.focus();break;case\"img\":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Is(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(E(163))}Oe||e.flags&512&&vl(e)}catch(f){le(e,e.return,f)}}if(e===t){R=null;break}if(r=e.sibling,r!==null){r.return=e.return,R=r;break}R=e.return}}function id(t){for(;R!==null;){var e=R;if(e===t){R=null;break}var r=e.sibling;if(r!==null){r.return=e.return,R=r;break}R=e.return}}function ad(t){for(;R!==null;){var e=R;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Oa(4,e)}catch(u){le(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount==\"function\"){var s=e.return;try{n.componentDidMount()}catch(u){le(e,s,u)}}var i=e.return;try{vl(e)}catch(u){le(e,i,u)}break;case 5:var a=e.return;try{vl(e)}catch(u){le(e,a,u)}}}catch(u){le(e,e.return,u)}if(e===t){R=null;break}var l=e.sibling;if(l!==null){l.return=e.return,R=l;break}R=e.return}}var Dg=Math.ceil,pa=Kt.ReactCurrentDispatcher,Tu=Kt.ReactCurrentOwner,it=Kt.ReactCurrentBatchConfig,K=0,ke=null,he=null,je=0,Ge=0,Nn=jr(0),ye=0,qs=null,Xr=0,Aa=0,Ru=0,js=null,Be=null,Ou=0,Kn=1/0,At=null,ma=!1,wl=null,yr=null,Ei=!1,dr=null,ga=0,Ns=0,bl=null,Vi=-1,qi=0;function De(){return K&6?de():Vi!==-1?Vi:Vi=de()}function xr(t){return t.mode&1?K&2&&je!==0?je&-je:wg.transition!==null?(qi===0&&(qi=Wh()),qi):(t=Q,t!==0||(t=window.event,t=t===void 0?16:Yh(t.type)),t):1}function yt(t,e,r,n){if(50<Ns)throw Ns=0,bl=null,Error(E(185));ri(t,r,n),(!(K&2)||t!==ke)&&(t===ke&&(!(K&2)&&(Aa|=r),ye===4&&tr(t,je)),Ke(t,n),r===1&&K===0&&!(e.mode&1)&&(Kn=de()+500,Pa&&Nr()))}function Ke(t,e){var r=t.callbackNode;wm(t,e);var n=Zi(t,t===ke?je:0);if(n===0)r!==null&&mc(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&mc(r),e===1)t.tag===0?xg(od.bind(null,t)):vf(od.bind(null,t)),mg(function(){!(K&6)&&Nr()}),r=null;else{switch(Vh(n)){case 1:r=su;break;case 4:r=Bh;break;case 16:r=Xi;break;case 536870912:r=Hh;break;default:r=Xi}r=mp(r,lp.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function lp(t,e){if(Vi=-1,qi=0,K&6)throw Error(E(327));var r=t.callbackNode;if(On()&&t.callbackNode!==r)return null;var n=Zi(t,t===ke?je:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=va(t,n);else{e=n;var s=K;K|=2;var i=cp();(ke!==t||je!==e)&&(At=null,Kn=de()+500,Kr(t,e));do try{Fg();break}catch(l){up(t,l)}while(!0);vu(),pa.current=i,K=s,he!==null?e=0:(ke=null,je=0,e=ye)}if(e!==0){if(e===2&&(s=Go(t),s!==0&&(n=s,e=kl(t,s))),e===1)throw r=qs,Kr(t,0),tr(t,n),Ke(t,de()),r;if(e===6)tr(t,n);else{if(s=t.current.alternate,!(n&30)&&!Ug(s)&&(e=va(t,n),e===2&&(i=Go(t),i!==0&&(n=i,e=kl(t,i))),e===1))throw r=qs,Kr(t,0),tr(t,n),Ke(t,de()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(E(345));case 2:Ir(t,Be,At);break;case 3:if(tr(t,n),(n&130023424)===n&&(e=Ou+500-de(),10<e)){if(Zi(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){De(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=rl(Ir.bind(null,t,Be,At),e);break}Ir(t,Be,At);break;case 4:if(tr(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-vt(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=de()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Dg(n/1960))-n,10<n){t.timeoutHandle=rl(Ir.bind(null,t,Be,At),n);break}Ir(t,Be,At);break;case 5:Ir(t,Be,At);break;default:throw Error(E(329))}}}return Ke(t,de()),t.callbackNode===r?lp.bind(null,t):null}function kl(t,e){var r=js;return t.current.memoizedState.isDehydrated&&(Kr(t,e).flags|=256),t=va(t,e),t!==2&&(e=Be,Be=r,e!==null&&_l(e)),t}function _l(t){Be===null?Be=t:Be.push.apply(Be,t)}function Ug(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!xt(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tr(t,e){for(e&=~Ru,e&=~Aa,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-vt(e),n=1<<r;t[r]=-1,e&=~n}}function od(t){if(K&6)throw Error(E(327));On();var e=Zi(t,0);if(!(e&1))return Ke(t,de()),null;var r=va(t,e);if(t.tag!==0&&r===2){var n=Go(t);n!==0&&(e=n,r=kl(t,n))}if(r===1)throw r=qs,Kr(t,0),tr(t,e),Ke(t,de()),r;if(r===6)throw Error(E(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ir(t,Be,At),Ke(t,de()),null}function Au(t,e){var r=K;K|=1;try{return t(e)}finally{K=r,K===0&&(Kn=de()+500,Pa&&Nr())}}function Zr(t){dr!==null&&dr.tag===0&&!(K&6)&&On();var e=K;K|=1;var r=it.transition,n=Q;try{if(it.transition=null,Q=1,t)return t()}finally{Q=n,it.transition=r,K=e,!(K&6)&&Nr()}}function Lu(){Ge=Nn.current,re(Nn)}function Kr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,pg(r)),he!==null)for(r=he.return;r!==null;){var n=r;switch(pu(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&sa();break;case 3:Vn(),re(Ve),re(Ae),_u();break;case 5:ku(n);break;case 4:Vn();break;case 13:re(se);break;case 19:re(se);break;case 10:yu(n.type._context);break;case 22:case 23:Lu()}r=r.return}if(ke=t,he=t=wr(t.current,null),je=Ge=e,ye=0,qs=null,Ru=Aa=Xr=0,Be=js=null,Mr!==null){for(e=0;e<Mr.length;e++)if(r=Mr[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}Mr=null}return t}function up(t,e){do{var r=he;try{if(vu(),Bi.current=fa,ha){for(var n=ie.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ha=!1}if(Yr=0,be=ve=ie=null,_s=!1,Hs=0,Tu.current=null,r===null||r.return===null){ye=1,qs=e,he=null;break}e:{var i=t,a=r.return,l=r,u=e;if(e=je,l.flags|=32768,u!==null&&typeof u==\"object\"&&typeof u.then==\"function\"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=Gc(a);if(y!==null){y.flags&=-257,Qc(y,a,l,i,e),y.mode&1&&Kc(i,c,e),e=y,u=c;var x=e.updateQueue;if(x===null){var w=new Set;w.add(u),e.updateQueue=w}else x.add(u);break e}else{if(!(e&1)){Kc(i,c,e),Iu();break e}u=Error(E(426))}}else if(ne&&l.mode&1){var v=Gc(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Qc(v,a,l,i,e),mu(qn(u,l));break e}}i=u=qn(u,l),ye!==4&&(ye=2),js===null?js=[i]:js.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=qf(i,u,e);zc(i,m);break e;case 1:l=u;var p=i.type,g=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError==\"function\"||g!==null&&typeof g.componentDidCatch==\"function\"&&(yr===null||!yr.has(g)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=Kf(i,l,e);zc(i,b);break e}}i=i.return}while(i!==null)}hp(r)}catch(S){e=S,he===r&&r!==null&&(he=r=r.return);continue}break}while(!0)}function cp(){var t=pa.current;return pa.current=fa,t===null?fa:t}function Iu(){(ye===0||ye===3||ye===2)&&(ye=4),ke===null||!(Xr&268435455)&&!(Aa&268435455)||tr(ke,je)}function va(t,e){var r=K;K|=2;var n=cp();(ke!==t||je!==e)&&(At=null,Kr(t,e));do try{Mg();break}catch(s){up(t,s)}while(!0);if(vu(),K=r,pa.current=n,he!==null)throw Error(E(261));return ke=null,je=0,ye}function Mg(){for(;he!==null;)dp(he)}function Fg(){for(;he!==null&&!dm();)dp(he)}function dp(t){var e=pp(t.alternate,t,Ge);t.memoizedProps=t.pendingProps,e===null?hp(t):he=e,Tu.current=null}function hp(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Ag(r,e),r!==null){r.flags&=32767,he=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ye=6,he=null;return}}else if(r=Og(r,e,Ge),r!==null){he=r;return}if(e=e.sibling,e!==null){he=e;return}he=e=t}while(e!==null);ye===0&&(ye=5)}function Ir(t,e,r){var n=Q,s=it.transition;try{it.transition=null,Q=1,zg(t,e,r,n)}finally{it.transition=s,Q=n}return null}function zg(t,e,r,n){do On();while(dr!==null);if(K&6)throw Error(E(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(E(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(bm(t,i),t===ke&&(he=ke=null,je=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ei||(Ei=!0,mp(Xi,function(){return On(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=it.transition,it.transition=null;var a=Q;Q=1;var l=K;K|=4,Tu.current=null,Ig(t,r),ap(r,t),og(el),ea=!!Zo,el=Zo=null,t.current=r,$g(r),hm(),K=l,Q=a,it.transition=i}else t.current=r;if(Ei&&(Ei=!1,dr=t,ga=s),i=t.pendingLanes,i===0&&(yr=null),mm(r.stateNode),Ke(t,de()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ma)throw ma=!1,t=wl,wl=null,t;return ga&1&&t.tag!==0&&On(),i=t.pendingLanes,i&1?t===bl?Ns++:(Ns=0,bl=t):Ns=0,Nr(),null}function On(){if(dr!==null){var t=Vh(ga),e=it.transition,r=Q;try{if(it.transition=null,Q=16>t?16:t,dr===null)var n=!1;else{if(t=dr,dr=null,ga=0,K&6)throw Error(E(331));var s=K;for(K|=4,R=t.current;R!==null;){var i=R,a=i.child;if(R.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(R=c;R!==null;){var d=R;switch(d.tag){case 0:case 11:case 15:Ss(8,d,i)}var h=d.child;if(h!==null)h.return=d,R=h;else for(;R!==null;){d=R;var f=d.sibling,y=d.return;if(np(d),d===c){R=null;break}if(f!==null){f.return=y,R=f;break}R=y}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var v=w.sibling;w.sibling=null,w=v}while(w!==null)}}R=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,R=a;else e:for(;R!==null;){if(i=R,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ss(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,R=m;break e}R=i.return}}var p=t.current;for(R=p;R!==null;){a=R;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,R=g;else e:for(a=p;R!==null;){if(l=R,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Oa(9,l)}}catch(S){le(l,l.return,S)}if(l===a){R=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,R=b;break e}R=l.return}}if(K=s,Nr(),Pt&&typeof Pt.onPostCommitFiberRoot==\"function\")try{Pt.onPostCommitFiberRoot(Sa,t)}catch{}n=!0}return n}finally{Q=r,it.transition=e}}return!1}function ld(t,e,r){e=qn(r,e),e=qf(t,e,1),t=vr(t,e,1),e=De(),t!==null&&(ri(t,1,e),Ke(t,e))}function le(t,e,r){if(t.tag===3)ld(t,t,r);else for(;e!==null;){if(e.tag===3){ld(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError==\"function\"||typeof n.componentDidCatch==\"function\"&&(yr===null||!yr.has(n))){t=qn(r,t),t=Kf(e,t,1),e=vr(e,t,1),t=De(),e!==null&&(ri(e,1,t),Ke(e,t));break}}e=e.return}}function Bg(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=De(),t.pingedLanes|=t.suspendedLanes&r,ke===t&&(je&r)===r&&(ye===4||ye===3&&(je&130023424)===je&&500>de()-Ou?Kr(t,0):Ru|=r),Ke(t,e)}function fp(t,e){e===0&&(t.mode&1?(e=yi,yi<<=1,!(yi&130023424)&&(yi=4194304)):e=1);var r=De();t=Vt(t,e),t!==null&&(ri(t,e,r),Ke(t,r))}function Hg(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),fp(t,r)}function Wg(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(E(314))}n!==null&&n.delete(e),fp(t,r)}var pp;pp=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ve.current)We=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return We=!1,Rg(t,e,r);We=!!(t.flags&131072)}else We=!1,ne&&e.flags&1048576&&yf(e,oa,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Wi(t,e),t=e.pendingProps;var s=Bn(e,Ae.current);Rn(e,r),s=ju(null,e,n,t,s,r);var i=Nu();return e.flags|=1,typeof s==\"object\"&&s!==null&&typeof s.render==\"function\"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qe(n)?(i=!0,ia(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,wu(e),s.updater=Ra,e.stateNode=s,s._reactInternals=e,ul(e,n,t,r),e=hl(null,e,n,!0,i,r)):(e.tag=0,ne&&i&&fu(e),$e(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Wi(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=qg(n),t=dt(n,t),s){case 0:e=dl(null,e,n,t,r);break e;case 1:e=Xc(null,e,n,t,r);break e;case 11:e=Jc(null,e,n,t,r);break e;case 14:e=Yc(null,e,n,dt(n.type,t),r);break e}throw Error(E(306,n,\"\"))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:dt(n,s),dl(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:dt(n,s),Xc(t,e,n,s,r);case 3:e:{if(Yf(e),t===null)throw Error(E(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Sf(t,e),ca(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=qn(Error(E(423)),e),e=Zc(t,e,n,r,s);break e}else if(n!==s){s=qn(Error(E(424)),e),e=Zc(t,e,n,r,s);break e}else for(Qe=gr(e.stateNode.containerInfo.firstChild),Je=e,ne=!0,gt=null,r=kf(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Hn(),n===s){e=qt(t,e,r);break e}$e(t,e,n,r)}e=e.child}return e;case 5:return jf(e),t===null&&al(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,tl(n,s)?a=null:i!==null&&tl(n,i)&&(e.flags|=32),Jf(t,e),$e(t,e,a,r),e.child;case 6:return t===null&&al(e),null;case 13:return Xf(t,e,r);case 4:return bu(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Wn(e,null,n,r):$e(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:dt(n,s),Jc(t,e,n,s,r);case 7:return $e(t,e,e.pendingProps,r),e.child;case 8:return $e(t,e,e.pendingProps.children,r),e.child;case 12:return $e(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,X(la,n._currentValue),n._currentValue=a,i!==null)if(xt(i.value,a)){if(i.children===s.children&&!Ve.current){e=qt(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=zt(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),ol(i.return,r,e),l.lanes|=r;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(E(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),ol(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}$e(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Rn(e,r),s=ot(s),n=n(s),e.flags|=1,$e(t,e,n,r),e.child;case 14:return n=e.type,s=dt(n,e.pendingProps),s=dt(n.type,s),Yc(t,e,n,s,r);case 15:return Gf(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:dt(n,s),Wi(t,e),e.tag=1,qe(n)?(t=!0,ia(e)):t=!1,Rn(e,r),Vf(e,n,s),ul(e,n,s,r),hl(null,e,n,!0,t,r);case 19:return Zf(t,e,r);case 22:return Qf(t,e,r)}throw Error(E(156,e.tag))};function mp(t,e){return zh(t,e)}function Vg(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function st(t,e,r,n){return new Vg(t,e,r,n)}function $u(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qg(t){if(typeof t==\"function\")return $u(t)?1:0;if(t!=null){if(t=t.$$typeof,t===tu)return 11;if(t===ru)return 14}return 2}function wr(t,e){var r=t.alternate;return r===null?(r=st(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ki(t,e,r,n,s,i){var a=2;if(n=t,typeof t==\"function\")$u(t)&&(a=1);else if(typeof t==\"string\")a=5;else e:switch(t){case gn:return Gr(r.children,s,i,e);case eu:a=8,s|=8;break;case Ao:return t=st(12,r,e,s|2),t.elementType=Ao,t.lanes=i,t;case Lo:return t=st(13,r,e,s),t.elementType=Lo,t.lanes=i,t;case Io:return t=st(19,r,e,s),t.elementType=Io,t.lanes=i,t;case Sh:return La(r,s,i,e);default:if(typeof t==\"object\"&&t!==null)switch(t.$$typeof){case kh:a=10;break e;case _h:a=9;break e;case tu:a=11;break e;case ru:a=14;break e;case Xt:a=16,n=null;break e}throw Error(E(130,t==null?t:typeof t,\"\"))}return e=st(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function Gr(t,e,r,n){return t=st(7,t,n,e),t.lanes=r,t}function La(t,e,r,n){return t=st(22,t,n,e),t.elementType=Sh,t.lanes=r,t.stateNode={isHidden:!1},t}function xo(t,e,r){return t=st(6,t,null,e),t.lanes=r,t}function wo(t,e,r){return e=st(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Kg(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Za(0),this.expirationTimes=Za(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Za(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Du(t,e,r,n,s,i,a,l,u){return t=new Kg(t,e,r,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=st(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},wu(i),t}function Gg(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mn,key:n==null?null:\"\"+n,children:t,containerInfo:e,implementation:r}}function gp(t){if(!t)return _r;t=t._reactInternals;e:{if(rn(t)!==t||t.tag!==1)throw Error(E(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qe(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(E(171))}if(t.tag===1){var r=t.type;if(qe(r))return gf(t,r,e)}return e}function vp(t,e,r,n,s,i,a,l,u){return t=Du(r,n,!0,t,s,i,a,l,u),t.context=gp(null),r=t.current,n=De(),s=xr(r),i=zt(n,s),i.callback=e??null,vr(r,i,s),t.current.lanes=s,ri(t,s,n),Ke(t,n),t}function Ia(t,e,r,n){var s=e.current,i=De(),a=xr(s);return r=gp(r),e.context===null?e.context=r:e.pendingContext=r,e=zt(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=vr(s,e,a),t!==null&&(yt(t,s,a,i),zi(t,s,a)),a}function ya(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ud(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Uu(t,e){ud(t,e),(t=t.alternate)&&ud(t,e)}function Qg(){return null}var yp=typeof reportError==\"function\"?reportError:function(t){console.error(t)};function Mu(t){this._internalRoot=t}$a.prototype.render=Mu.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(E(409));Ia(t,e,null,null)};$a.prototype.unmount=Mu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zr(function(){Ia(null,t,null,null)}),e[Wt]=null}};function $a(t){this._internalRoot=t}$a.prototype.unstable_scheduleHydration=function(t){if(t){var e=Gh();t={blockedOn:null,target:t,priority:e};for(var r=0;r<er.length&&e!==0&&e<er[r].priority;r++);er.splice(r,0,t),r===0&&Jh(t)}};function Fu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Da(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==\" react-mount-point-unstable \"))}function cd(){}function Jg(t,e,r,n,s){if(s){if(typeof n==\"function\"){var i=n;n=function(){var c=ya(a);i.call(c)}}var a=vp(e,n,t,0,null,!1,!1,\"\",cd);return t._reactRootContainer=a,t[Wt]=a.current,Us(t.nodeType===8?t.parentNode:t),Zr(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n==\"function\"){var l=n;n=function(){var c=ya(u);l.call(c)}}var u=Du(t,0,!1,null,null,!1,!1,\"\",cd);return t._reactRootContainer=u,t[Wt]=u.current,Us(t.nodeType===8?t.parentNode:t),Zr(function(){Ia(e,u,r,n)}),u}function Ua(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s==\"function\"){var l=s;s=function(){var u=ya(a);l.call(u)}}Ia(e,a,t,s)}else a=Jg(r,e,t,s,n);return ya(a)}qh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ps(e.pendingLanes);r!==0&&(iu(e,r|1),Ke(e,de()),!(K&6)&&(Kn=de()+500,Nr()))}break;case 13:Zr(function(){var n=Vt(t,1);if(n!==null){var s=De();yt(n,t,1,s)}}),Uu(t,1)}};au=function(t){if(t.tag===13){var e=Vt(t,134217728);if(e!==null){var r=De();yt(e,t,134217728,r)}Uu(t,134217728)}};Kh=function(t){if(t.tag===13){var e=xr(t),r=Vt(t,e);if(r!==null){var n=De();yt(r,t,e,n)}Uu(t,e)}};Gh=function(){return Q};Qh=function(t,e){var r=Q;try{return Q=t,e()}finally{Q=r}};Vo=function(t,e,r){switch(e){case\"input\":if(Uo(t,r),e=r.name,r.type===\"radio\"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+e)+'][type=\"radio\"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Ea(n);if(!s)throw Error(E(90));Nh(n),Uo(n,s)}}}break;case\"textarea\":Eh(t,r);break;case\"select\":e=r.value,e!=null&&Cn(t,!!r.multiple,e,!1)}};Ih=Au;$h=Zr;var Yg={usingClientEntryPoint:!1,Events:[si,wn,Ea,Ah,Lh,Au]},cs={findFiberByHostInstance:Ur,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"},Xg={bundleType:cs.bundleType,version:cs.version,rendererPackageName:cs.rendererPackageName,rendererConfig:cs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kt.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Mh(t),t===null?null:t.stateNode},findFiberByHostInstance:cs.findFiberByHostInstance||Qg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<\"u\"){var Pi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pi.isDisabled&&Pi.supportsFiber)try{Sa=Pi.inject(Xg),Pt=Pi}catch{}}Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yg;Xe.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fu(e))throw Error(E(200));return Gg(t,e,null,r)};Xe.createRoot=function(t,e){if(!Fu(t))throw Error(E(299));var r=!1,n=\"\",s=yp;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Du(t,1,!1,null,null,r,!1,n,s),t[Wt]=e.current,Us(t.nodeType===8?t.parentNode:t),new Mu(e)};Xe.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render==\"function\"?Error(E(188)):(t=Object.keys(t).join(\",\"),Error(E(268,t)));return t=Mh(e),t=t===null?null:t.stateNode,t};Xe.flushSync=function(t){return Zr(t)};Xe.hydrate=function(t,e,r){if(!Da(e))throw Error(E(200));return Ua(null,t,e,!0,r)};Xe.hydrateRoot=function(t,e,r){if(!Fu(t))throw Error(E(405));var n=r!=null&&r.hydratedSources||null,s=!1,i=\"\",a=yp;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=vp(e,null,t,1,r??null,s,!1,i,a),t[Wt]=e.current,Us(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new $a(e)};Xe.render=function(t,e,r){if(!Da(e))throw Error(E(200));return Ua(null,t,e,!1,r)};Xe.unmountComponentAtNode=function(t){if(!Da(t))throw Error(E(40));return t._reactRootContainer?(Zr(function(){Ua(null,null,t,!1,function(){t._reactRootContainer=null,t[Wt]=null})}),!0):!1};Xe.unstable_batchedUpdates=Au;Xe.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Da(r))throw Error(E(200));if(t==null||t._reactInternals===void 0)throw Error(E(38));return Ua(t,e,r,!1,n)};Xe.version=\"18.3.1-next-f1338f8080-20240426\";function xp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>\"u\"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=\"function\"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xp)}catch(t){console.error(t)}}xp(),yh.exports=Xe;var Zg=yh.exports,dd=Zg;Ro.createRoot=dd.createRoot,Ro.hydrateRoot=dd.hydrateRoot;/**\n * @remix-run/router v1.23.0\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */function Ks(){return Ks=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ks.apply(this,arguments)}var hr;(function(t){t.Pop=\"POP\",t.Push=\"PUSH\",t.Replace=\"REPLACE\"})(hr||(hr={}));const hd=\"popstate\";function ev(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:a,hash:l}=n.location;return Sl(\"\",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||\"default\")}function r(n,s){return typeof s==\"string\"?s:xa(s)}return rv(e,r,null,t)}function pe(t,e){if(t===!1||t===null||typeof t>\"u\")throw new Error(e)}function wp(t,e){if(!t){typeof console<\"u\"&&console.warn(e);try{throw new Error(e)}catch{}}}function tv(){return Math.random().toString(36).substr(2,8)}function fd(t,e){return{usr:t.state,key:t.key,idx:e}}function Sl(t,e,r,n){return r===void 0&&(r=null),Ks({pathname:typeof t==\"string\"?t:t.pathname,search:\"\",hash:\"\"},typeof e==\"string\"?Zn(e):e,{state:r,key:e&&e.key||n||tv()})}function xa(t){let{pathname:e=\"/\",search:r=\"\",hash:n=\"\"}=t;return r&&r!==\"?\"&&(e+=r.charAt(0)===\"?\"?r:\"?\"+r),n&&n!==\"#\"&&(e+=n.charAt(0)===\"#\"?n:\"#\"+n),e}function Zn(t){let e={};if(t){let r=t.indexOf(\"#\");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf(\"?\");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function rv(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,l=hr.Pop,u=null,c=d();c==null&&(c=0,a.replaceState(Ks({},a.state,{idx:c}),\"\"));function d(){return(a.state||{idx:null}).idx}function h(){l=hr.Pop;let v=d(),m=v==null?null:v-c;c=v,u&&u({action:l,location:w.location,delta:m})}function f(v,m){l=hr.Push;let p=Sl(w.location,v,m);c=d()+1;let g=fd(p,c),b=w.createHref(p);try{a.pushState(g,\"\",b)}catch(S){if(S instanceof DOMException&&S.name===\"DataCloneError\")throw S;s.location.assign(b)}i&&u&&u({action:l,location:w.location,delta:1})}function y(v,m){l=hr.Replace;let p=Sl(w.location,v,m);c=d();let g=fd(p,c),b=w.createHref(p);a.replaceState(g,\"\",b),i&&u&&u({action:l,location:w.location,delta:0})}function x(v){let m=s.location.origin!==\"null\"?s.location.origin:s.location.href,p=typeof v==\"string\"?v:xa(v);return p=p.replace(/ $/,\"%20\"),pe(m,\"No window.location.(origin|href) available to create URL for href: \"+p),new URL(p,m)}let w={get action(){return l},get location(){return t(s,a)},listen(v){if(u)throw new Error(\"A history only accepts one active listener\");return s.addEventListener(hd,h),u=v,()=>{s.removeEventListener(hd,h),u=null}},createHref(v){return e(s,v)},createURL:x,encodeLocation(v){let m=x(v);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:y,go(v){return a.go(v)}};return w}var pd;(function(t){t.data=\"data\",t.deferred=\"deferred\",t.redirect=\"redirect\",t.error=\"error\"})(pd||(pd={}));function nv(t,e,r){return r===void 0&&(r=\"/\"),sv(t,e,r)}function sv(t,e,r,n){let s=typeof e==\"string\"?Zn(e):e,i=zu(s.pathname||\"/\",r);if(i==null)return null;let a=bp(t);iv(a);let l=null;for(let u=0;l==null&&u<a.length;++u){let c=vv(i);l=pv(a[u],c)}return l}function bp(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n=\"\");let s=(i,a,l)=>{let u={relativePath:l===void 0?i.path||\"\":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith(\"/\")&&(pe(u.relativePath.startsWith(n),'Absolute route path \"'+u.relativePath+'\" nested under path '+('\"'+n+'\" is not valid. An absolute child route path ')+\"must start with the combined path of all its parent routes.\"),u.relativePath=u.relativePath.slice(n.length));let c=br([n,u.relativePath]),d=r.concat(u);i.children&&i.children.length>0&&(pe(i.index!==!0,\"Index routes must not have child routes. Please remove \"+('all child routes from route path \"'+c+'\".')),bp(i.children,e,d,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:hv(c,i.index),routesMeta:d})};return t.forEach((i,a)=>{var l;if(i.path===\"\"||!((l=i.path)!=null&&l.includes(\"?\")))s(i,a);else for(let u of kp(i.path))s(i,a,u)}),e}function kp(t){let e=t.split(\"/\");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith(\"?\"),i=r.replace(/\\?$/,\"\");if(n.length===0)return s?[i,\"\"]:[i];let a=kp(n.join(\"/\")),l=[];return l.push(...a.map(u=>u===\"\"?i:[i,u].join(\"/\"))),s&&l.push(...a),l.map(u=>t.startsWith(\"/\")&&u===\"\"?\"/\":u)}function iv(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:fv(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const av=/^:[\\w-]+$/,ov=3,lv=2,uv=1,cv=10,dv=-2,md=t=>t===\"*\";function hv(t,e){let r=t.split(\"/\"),n=r.length;return r.some(md)&&(n+=dv),e&&(n+=lv),r.filter(s=>!md(s)).reduce((s,i)=>s+(av.test(i)?ov:i===\"\"?uv:cv),n)}function fv(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function pv(t,e,r){let{routesMeta:n}=t,s={},i=\"/\",a=[];for(let l=0;l<n.length;++l){let u=n[l],c=l===n.length-1,d=i===\"/\"?e:e.slice(i.length)||\"/\",h=mv({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),f=u.route;if(!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:br([i,h.pathname]),pathnameBase:bv(br([i,h.pathnameBase])),route:f}),h.pathnameBase!==\"/\"&&(i=br([i,h.pathnameBase]))}return a}function mv(t,e){typeof t==\"string\"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=gv(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\\/+$/,\"$1\"),l=s.slice(1);return{params:n.reduce((c,d,h)=>{let{paramName:f,isOptional:y}=d;if(f===\"*\"){let w=l[h]||\"\";a=i.slice(0,i.length-w.length).replace(/(.)\\/+$/,\"$1\")}const x=l[h];return y&&!x?c[f]=void 0:c[f]=(x||\"\").replace(/%2F/g,\"/\"),c},{}),pathname:i,pathnameBase:a,pattern:t}}function gv(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),wp(t===\"*\"||!t.endsWith(\"*\")||t.endsWith(\"/*\"),'Route path \"'+t+'\" will be treated as if it were '+('\"'+t.replace(/\\*$/,\"/*\")+'\" because the `*` character must ')+\"always follow a `/` in the pattern. To get rid of this warning, \"+('please change the route path to \"'+t.replace(/\\*$/,\"/*\")+'\".'));let n=[],s=\"^\"+t.replace(/\\/*\\*?$/,\"\").replace(/^\\/*/,\"/\").replace(/[\\\\.*+^${}|()[\\]]/g,\"\\\\$&\").replace(/\\/:([\\w-]+)(\\?)?/g,(a,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?\"/?([^\\\\/]+)?\":\"/([^\\\\/]+)\"));return t.endsWith(\"*\")?(n.push({paramName:\"*\"}),s+=t===\"*\"||t===\"/*\"?\"(.*)$\":\"(?:\\\\/(.+)|\\\\/*)$\"):r?s+=\"\\\\/*$\":t!==\"\"&&t!==\"/\"&&(s+=\"(?:(?=\\\\/|$))\"),[new RegExp(s,e?void 0:\"i\"),n]}function vv(t){try{return t.split(\"/\").map(e=>decodeURIComponent(e).replace(/\\//g,\"%2F\")).join(\"/\")}catch(e){return wp(!1,'The URL path \"'+t+'\" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+(\"encoding (\"+e+\").\")),t}}function zu(t,e){if(e===\"/\")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith(\"/\")?e.length-1:e.length,n=t.charAt(r);return n&&n!==\"/\"?null:t.slice(r)||\"/\"}function yv(t,e){e===void 0&&(e=\"/\");let{pathname:r,search:n=\"\",hash:s=\"\"}=typeof t==\"string\"?Zn(t):t;return{pathname:r?r.startsWith(\"/\")?r:xv(r,e):e,search:kv(n),hash:_v(s)}}function xv(t,e){let r=e.replace(/\\/+$/,\"\").split(\"/\");return t.split(\"/\").forEach(s=>{s===\"..\"?r.length>1&&r.pop():s!==\".\"&&r.push(s)}),r.length>1?r.join(\"/\"):\"/\"}function bo(t,e,r,n){return\"Cannot include a '\"+t+\"' character in a manually specified \"+(\"`to.\"+e+\"` field [\"+JSON.stringify(n)+\"].  Please separate it out to the \")+(\"`to.\"+r+\"` field. Alternatively you may provide the full path as \")+'a string in <Link to=\"...\"> and the router will parse it for you.'}function wv(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function _p(t,e){let r=wv(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Sp(t,e,r,n){n===void 0&&(n=!1);let s;typeof t==\"string\"?s=Zn(t):(s=Ks({},t),pe(!s.pathname||!s.pathname.includes(\"?\"),bo(\"?\",\"pathname\",\"search\",s)),pe(!s.pathname||!s.pathname.includes(\"#\"),bo(\"#\",\"pathname\",\"hash\",s)),pe(!s.search||!s.search.includes(\"#\"),bo(\"#\",\"search\",\"hash\",s)));let i=t===\"\"||s.pathname===\"\",a=i?\"/\":s.pathname,l;if(a==null)l=r;else{let h=e.length-1;if(!n&&a.startsWith(\"..\")){let f=a.split(\"/\");for(;f[0]===\"..\";)f.shift(),h-=1;s.pathname=f.join(\"/\")}l=h>=0?e[h]:\"/\"}let u=yv(s,l),c=a&&a!==\"/\"&&a.endsWith(\"/\"),d=(i||a===\".\")&&r.endsWith(\"/\");return!u.pathname.endsWith(\"/\")&&(c||d)&&(u.pathname+=\"/\"),u}const br=t=>t.join(\"/\").replace(/\\/\\/+/g,\"/\"),bv=t=>t.replace(/\\/+$/,\"\").replace(/^\\/*/,\"/\"),kv=t=>!t||t===\"?\"?\"\":t.startsWith(\"?\")?t:\"?\"+t,_v=t=>!t||t===\"#\"?\"\":t.startsWith(\"#\")?t:\"#\"+t;function Sv(t){return t!=null&&typeof t.status==\"number\"&&typeof t.statusText==\"string\"&&typeof t.internal==\"boolean\"&&\"data\"in t}const jp=[\"post\",\"put\",\"patch\",\"delete\"];new Set(jp);const jv=[\"get\",...jp];new Set(jv);/**\n * React Router v6.30.1\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */function Gs(){return Gs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gs.apply(this,arguments)}const Bu=k.createContext(null),Nv=k.createContext(null),nn=k.createContext(null),Ma=k.createContext(null),Cr=k.createContext({outlet:null,matches:[],isDataRoute:!1}),Np=k.createContext(null);function Cv(t,e){let{relative:r}=e===void 0?{}:e;ai()||pe(!1);let{basename:n,navigator:s}=k.useContext(nn),{hash:i,pathname:a,search:l}=Ep(t,{relative:r}),u=a;return n!==\"/\"&&(u=a===\"/\"?n:br([n,a])),s.createHref({pathname:u,search:l,hash:i})}function ai(){return k.useContext(Ma)!=null}function es(){return ai()||pe(!1),k.useContext(Ma).location}function Cp(t){k.useContext(nn).static||k.useLayoutEffect(t)}function sn(){let{isDataRoute:t}=k.useContext(Cr);return t?zv():Ev()}function Ev(){ai()||pe(!1);let t=k.useContext(Bu),{basename:e,future:r,navigator:n}=k.useContext(nn),{matches:s}=k.useContext(Cr),{pathname:i}=es(),a=JSON.stringify(_p(s,r.v7_relativeSplatPath)),l=k.useRef(!1);return Cp(()=>{l.current=!0}),k.useCallback(function(c,d){if(d===void 0&&(d={}),!l.current)return;if(typeof c==\"number\"){n.go(c);return}let h=Sp(c,JSON.parse(a),i,d.relative===\"path\");t==null&&e!==\"/\"&&(h.pathname=h.pathname===\"/\"?e:br([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,a,i,t])}function Pv(){let{matches:t}=k.useContext(Cr),e=t[t.length-1];return e?e.params:{}}function Ep(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=k.useContext(nn),{matches:s}=k.useContext(Cr),{pathname:i}=es(),a=JSON.stringify(_p(s,n.v7_relativeSplatPath));return k.useMemo(()=>Sp(t,JSON.parse(a),i,r===\"path\"),[t,a,i,r])}function Tv(t,e){return Rv(t,e)}function Rv(t,e,r,n){ai()||pe(!1);let{navigator:s}=k.useContext(nn),{matches:i}=k.useContext(Cr),a=i[i.length-1],l=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:\"/\";a&&a.route;let c=es(),d;if(e){var h;let v=typeof e==\"string\"?Zn(e):e;u===\"/\"||(h=v.pathname)!=null&&h.startsWith(u)||pe(!1),d=v}else d=c;let f=d.pathname||\"/\",y=f;if(u!==\"/\"){let v=u.replace(/^\\//,\"\").split(\"/\");y=\"/\"+f.replace(/^\\//,\"\").split(\"/\").slice(v.length).join(\"/\")}let x=nv(t,{pathname:y}),w=$v(x&&x.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:br([u,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase===\"/\"?u:br([u,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return e&&w?k.createElement(Ma.Provider,{value:{location:Gs({pathname:\"/\",search:\"\",hash:\"\",state:null,key:\"default\"},d),navigationType:hr.Pop}},w):w}function Ov(){let t=Fv(),e=Sv(t)?t.status+\" \"+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:\"0.5rem\",backgroundColor:\"rgba(200,200,200, 0.5)\"};return k.createElement(k.Fragment,null,k.createElement(\"h2\",null,\"Unexpected Application Error!\"),k.createElement(\"h3\",{style:{fontStyle:\"italic\"}},e),r?k.createElement(\"pre\",{style:s},r):null,null)}const Av=k.createElement(Ov,null);class Lv extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!==\"idle\"&&e.revalidation===\"idle\"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error(\"React Router caught the following error during render\",e,r)}render(){return this.state.error!==void 0?k.createElement(Cr.Provider,{value:this.props.routeContext},k.createElement(Np.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Iv(t){let{routeContext:e,match:r,children:n}=t,s=k.useContext(Bu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),k.createElement(Cr.Provider,{value:e},n)}function $v(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let d=a.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||pe(!1),a=a.slice(0,Math.min(a.length,d+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<a.length;d++){let h=a[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=d),h.route.id){let{loaderData:f,errors:y}=r,x=h.route.loader&&f[h.route.id]===void 0&&(!y||y[h.route.id]===void 0);if(h.route.lazy||x){u=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((d,h,f)=>{let y,x=!1,w=null,v=null;r&&(y=l&&h.route.id?l[h.route.id]:void 0,w=h.route.errorElement||Av,u&&(c<0&&f===0?(Bv(\"route-fallback\"),x=!0,v=null):c===f&&(x=!0,v=h.route.hydrateFallbackElement||null)));let m=e.concat(a.slice(0,f+1)),p=()=>{let g;return y?g=w:x?g=v:h.route.Component?g=k.createElement(h.route.Component,null):h.route.element?g=h.route.element:g=d,k.createElement(Iv,{match:h,routeContext:{outlet:d,matches:m,isDataRoute:r!=null},children:g})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?k.createElement(Lv,{location:r.location,revalidation:r.revalidation,component:w,error:y,children:p(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):p()},null)}var Pp=function(t){return t.UseBlocker=\"useBlocker\",t.UseRevalidator=\"useRevalidator\",t.UseNavigateStable=\"useNavigate\",t}(Pp||{}),Tp=function(t){return t.UseBlocker=\"useBlocker\",t.UseLoaderData=\"useLoaderData\",t.UseActionData=\"useActionData\",t.UseRouteError=\"useRouteError\",t.UseNavigation=\"useNavigation\",t.UseRouteLoaderData=\"useRouteLoaderData\",t.UseMatches=\"useMatches\",t.UseRevalidator=\"useRevalidator\",t.UseNavigateStable=\"useNavigate\",t.UseRouteId=\"useRouteId\",t}(Tp||{});function Dv(t){let e=k.useContext(Bu);return e||pe(!1),e}function Uv(t){let e=k.useContext(Nv);return e||pe(!1),e}function Mv(t){let e=k.useContext(Cr);return e||pe(!1),e}function Rp(t){let e=Mv(),r=e.matches[e.matches.length-1];return r.route.id||pe(!1),r.route.id}function Fv(){var t;let e=k.useContext(Np),r=Uv(),n=Rp();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function zv(){let{router:t}=Dv(Pp.UseNavigateStable),e=Rp(Tp.UseNavigateStable),r=k.useRef(!1);return Cp(()=>{r.current=!0}),k.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s==\"number\"?t.navigate(s):t.navigate(s,Gs({fromRouteId:e},i)))},[t,e])}const gd={};function Bv(t,e,r){gd[t]||(gd[t]=!0)}function Hv(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function kt(t){pe(!1)}function Wv(t){let{basename:e=\"/\",children:r=null,location:n,navigationType:s=hr.Pop,navigator:i,static:a=!1,future:l}=t;ai()&&pe(!1);let u=e.replace(/^\\/*/,\"/\"),c=k.useMemo(()=>({basename:u,navigator:i,static:a,future:Gs({v7_relativeSplatPath:!1},l)}),[u,l,i,a]);typeof n==\"string\"&&(n=Zn(n));let{pathname:d=\"/\",search:h=\"\",hash:f=\"\",state:y=null,key:x=\"default\"}=n,w=k.useMemo(()=>{let v=zu(d,u);return v==null?null:{location:{pathname:v,search:h,hash:f,state:y,key:x},navigationType:s}},[u,d,h,f,y,x,s]);return w==null?null:k.createElement(nn.Provider,{value:c},k.createElement(Ma.Provider,{children:r,value:w}))}function Vv(t){let{children:e,location:r}=t;return Tv(jl(e),r)}new Promise(()=>{});function jl(t,e){e===void 0&&(e=[]);let r=[];return k.Children.forEach(t,(n,s)=>{if(!k.isValidElement(n))return;let i=[...e,s];if(n.type===k.Fragment){r.push.apply(r,jl(n.props.children,i));return}n.type!==kt&&pe(!1),!n.props.index||!n.props.children||pe(!1);let a={id:n.props.id||i.join(\"-\"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=jl(n.props.children,i)),r.push(a)}),r}/**\n * React Router DOM v6.30.1\n *\n * Copyright (c) Remix Software Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */function Nl(){return Nl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nl.apply(this,arguments)}function qv(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function Kv(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Gv(t,e){return t.button===0&&(!e||e===\"_self\")&&!Kv(t)}function Cl(t){return t===void 0&&(t=\"\"),new URLSearchParams(typeof t==\"string\"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function Qv(t,e){let r=Cl(t);return e&&e.forEach((n,s)=>{r.has(s)||e.getAll(s).forEach(i=>{r.append(s,i)})}),r}const Jv=[\"onClick\",\"relative\",\"reloadDocument\",\"replace\",\"state\",\"target\",\"to\",\"preventScrollReset\",\"viewTransition\"],Yv=\"6\";try{window.__reactRouterVersion=Yv}catch{}const Xv=\"startTransition\",vd=B0[Xv];function Zv(t){let{basename:e,children:r,future:n,window:s}=t,i=k.useRef();i.current==null&&(i.current=ev({window:s,v5Compat:!0}));let a=i.current,[l,u]=k.useState({action:a.action,location:a.location}),{v7_startTransition:c}=n||{},d=k.useCallback(h=>{c&&vd?vd(()=>u(h)):u(h)},[u,c]);return k.useLayoutEffect(()=>a.listen(d),[a,d]),k.useEffect(()=>Hv(n),[n]),k.createElement(Wv,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:a,future:n})}const ey=typeof window<\"u\"&&typeof window.document<\"u\"&&typeof window.document.createElement<\"u\",ty=/^(?:[a-z][a-z0-9+.-]*:|\\/\\/)/i,El=k.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:l,target:u,to:c,preventScrollReset:d,viewTransition:h}=e,f=qv(e,Jv),{basename:y}=k.useContext(nn),x,w=!1;if(typeof c==\"string\"&&ty.test(c)&&(x=c,ey))try{let g=new URL(window.location.href),b=c.startsWith(\"//\")?new URL(g.protocol+c):new URL(c),S=zu(b.pathname,y);b.origin===g.origin&&S!=null?c=S+b.search+b.hash:w=!0}catch{}let v=Cv(c,{relative:s}),m=ry(c,{replace:a,state:l,target:u,preventScrollReset:d,relative:s,viewTransition:h});function p(g){n&&n(g),g.defaultPrevented||m(g)}return k.createElement(\"a\",Nl({},f,{href:x||v,onClick:w||i?n:p,ref:r,target:u}))});var yd;(function(t){t.UseScrollRestoration=\"useScrollRestoration\",t.UseSubmit=\"useSubmit\",t.UseSubmitFetcher=\"useSubmitFetcher\",t.UseFetcher=\"useFetcher\",t.useViewTransitionState=\"useViewTransitionState\"})(yd||(yd={}));var xd;(function(t){t.UseFetcher=\"useFetcher\",t.UseFetchers=\"useFetchers\",t.UseScrollRestoration=\"useScrollRestoration\"})(xd||(xd={}));function ry(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:l}=e===void 0?{}:e,u=sn(),c=es(),d=Ep(t,{relative:a});return k.useCallback(h=>{if(Gv(h,r)){h.preventDefault();let f=n!==void 0?n:xa(c)===xa(d);u(t,{replace:f,state:s,preventScrollReset:i,relative:a,viewTransition:l})}},[c,u,d,n,s,r,t,i,a,l])}function Hu(t){let e=k.useRef(Cl(t)),r=k.useRef(!1),n=es(),s=k.useMemo(()=>Qv(n.search,r.current?null:e.current),[n.search]),i=sn(),a=k.useCallback((l,u)=>{const c=Cl(typeof l==\"function\"?l(s):l);r.current=!0,i(\"?\"+c,u)},[i,s]);return[s,a]}var oi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ny={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},nr,Vl,Jd,sy=(Jd=class{constructor(){H(this,nr,ny);H(this,Vl,!1)}setTimeoutProvider(t){U(this,nr,t)}setTimeout(t,e){return _(this,nr).setTimeout(t,e)}clearTimeout(t){_(this,nr).clearTimeout(t)}setInterval(t,e){return _(this,nr).setInterval(t,e)}clearInterval(t){_(this,nr).clearInterval(t)}},nr=new WeakMap,Vl=new WeakMap,Jd),Pl=new sy;function iy(t){setTimeout(t,0)}var Fa=typeof window>\"u\"||\"Deno\"in globalThis;function tt(){}function ay(t,e){return typeof t==\"function\"?t(e):t}function oy(t){return typeof t==\"number\"&&t>=0&&t!==1/0}function ly(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Tl(t,e){return typeof t==\"function\"?t(e):t}function uy(t,e){return typeof t==\"function\"?t(e):t}function wd(t,e){const{type:r=\"all\",exact:n,fetchStatus:s,predicate:i,queryKey:a,stale:l}=t;if(a){if(n){if(e.queryHash!==Wu(a,e.options))return!1}else if(!Qs(e.queryKey,a))return!1}if(r!==\"all\"){const u=e.isActive();if(r===\"active\"&&!u||r===\"inactive\"&&u)return!1}return!(typeof l==\"boolean\"&&e.isStale()!==l||s&&s!==e.state.fetchStatus||i&&!i(e))}function bd(t,e){const{exact:r,status:n,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(r){if(en(e.options.mutationKey)!==en(i))return!1}else if(!Qs(e.options.mutationKey,i))return!1}return!(n&&e.state.status!==n||s&&!s(e))}function Wu(t,e){return((e==null?void 0:e.queryKeyHashFn)||en)(t)}function en(t){return JSON.stringify(t,(e,r)=>Rl(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Qs(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t==\"object\"&&typeof e==\"object\"?Object.keys(e).every(r=>Qs(t[r],e[r])):!1}var cy=Object.prototype.hasOwnProperty;function Op(t,e){if(t===e)return t;const r=kd(t)&&kd(e);if(!r&&!(Rl(t)&&Rl(e)))return e;const s=(r?t:Object.keys(t)).length,i=r?e:Object.keys(e),a=i.length,l=r?new Array(a):{};let u=0;for(let c=0;c<a;c++){const d=r?c:i[c],h=t[d],f=e[d];if(h===f){l[d]=h,(r?c<s:cy.call(t,d))&&u++;continue}if(h===null||f===null||typeof h!=\"object\"||typeof f!=\"object\"){l[d]=f;continue}const y=Op(h,f);l[d]=y,y===h&&u++}return s===a&&u===s?t:l}function dy(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function kd(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Rl(t){if(!_d(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!_d(r)||!r.hasOwnProperty(\"isPrototypeOf\")||Object.getPrototypeOf(t)!==Object.prototype)}function _d(t){return Object.prototype.toString.call(t)===\"[object Object]\"}function hy(t){return new Promise(e=>{Pl.setTimeout(e,t)})}function fy(t,e,r){return typeof r.structuralSharing==\"function\"?r.structuralSharing(t,e):r.structuralSharing!==!1?Op(t,e):e}function py(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function my(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var Vu=Symbol();function Ap(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Vu?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function gy(t,e){return typeof t==\"function\"?t(...e):!!t}var zr,sr,An,Yd,vy=(Yd=class extends oi{constructor(){super();H(this,zr);H(this,sr);H(this,An);U(this,An,e=>{if(!Fa&&window.addEventListener){const r=()=>e();return window.addEventListener(\"visibilitychange\",r,!1),()=>{window.removeEventListener(\"visibilitychange\",r)}}})}onSubscribe(){_(this,sr)||this.setEventListener(_(this,An))}onUnsubscribe(){var e;this.hasListeners()||((e=_(this,sr))==null||e.call(this),U(this,sr,void 0))}setEventListener(e){var r;U(this,An,e),(r=_(this,sr))==null||r.call(this),U(this,sr,e(n=>{typeof n==\"boolean\"?this.setFocused(n):this.onFocus()}))}setFocused(e){_(this,zr)!==e&&(U(this,zr,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof _(this,zr)==\"boolean\"?_(this,zr):((e=globalThis.document)==null?void 0:e.visibilityState)!==\"hidden\"}},zr=new WeakMap,sr=new WeakMap,An=new WeakMap,Yd),Lp=new vy;function yy(){let t,e;const r=new Promise((s,i)=>{t=s,e=i});r.status=\"pending\",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:\"fulfilled\",value:s}),t(s)},r.reject=s=>{n({status:\"rejected\",reason:s}),e(s)},r}var xy=iy;function wy(){let t=[],e=0,r=l=>{l()},n=l=>{l()},s=xy;const i=l=>{e?t.push(l):s(()=>{r(l)})},a=()=>{const l=t;t=[],l.length&&s(()=>{n(()=>{l.forEach(u=>{r(u)})})})};return{batch:l=>{let u;e++;try{u=l()}finally{e--,e||a()}return u},batchCalls:l=>(...u)=>{i(()=>{l(...u)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var Se=wy(),Ln,ir,In,Xd,by=(Xd=class extends oi{constructor(){super();H(this,Ln,!0);H(this,ir);H(this,In);U(this,In,e=>{if(!Fa&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener(\"online\",r,!1),window.addEventListener(\"offline\",n,!1),()=>{window.removeEventListener(\"online\",r),window.removeEventListener(\"offline\",n)}}})}onSubscribe(){_(this,ir)||this.setEventListener(_(this,In))}onUnsubscribe(){var e;this.hasListeners()||((e=_(this,ir))==null||e.call(this),U(this,ir,void 0))}setEventListener(e){var r;U(this,In,e),(r=_(this,ir))==null||r.call(this),U(this,ir,e(this.setOnline.bind(this)))}setOnline(e){_(this,Ln)!==e&&(U(this,Ln,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return _(this,Ln)}},Ln=new WeakMap,ir=new WeakMap,In=new WeakMap,Xd),wa=new by;function ky(t){return Math.min(1e3*2**t,3e4)}function Ip(t){return(t??\"online\")===\"online\"?wa.isOnline():!0}var Ol=class extends Error{constructor(t){super(\"CancelledError\"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function $p(t){let e=!1,r=0,n;const s=yy(),i=()=>s.status!==\"pending\",a=w=>{var v;if(!i()){const m=new Ol(w);f(m),(v=t.onCancel)==null||v.call(t,m)}},l=()=>{e=!0},u=()=>{e=!1},c=()=>Lp.isFocused()&&(t.networkMode===\"always\"||wa.isOnline())&&t.canRun(),d=()=>Ip(t.networkMode)&&t.canRun(),h=w=>{i()||(n==null||n(),s.resolve(w))},f=w=>{i()||(n==null||n(),s.reject(w))},y=()=>new Promise(w=>{var v;n=m=>{(i()||c())&&w(m)},(v=t.onPause)==null||v.call(t)}).then(()=>{var w;n=void 0,i()||(w=t.onContinue)==null||w.call(t)}),x=()=>{if(i())return;let w;const v=r===0?t.initialPromise:void 0;try{w=v??t.fn()}catch(m){w=Promise.reject(m)}Promise.resolve(w).then(h).catch(m=>{var j;if(i())return;const p=t.retry??(Fa?0:3),g=t.retryDelay??ky,b=typeof g==\"function\"?g(r,m):g,S=p===!0||typeof p==\"number\"&&r<p||typeof p==\"function\"&&p(r,m);if(e||!S){f(m);return}r++,(j=t.onFail)==null||j.call(t,r,m),hy(b).then(()=>c()?void 0:y()).then(()=>{e?f(m):x()})})};return{promise:s,status:()=>s.status,cancel:a,continue:()=>(n==null||n(),s),cancelRetry:l,continueRetry:u,canStart:d,start:()=>(d()?x():y().then(x),s)}}var Br,Zd,Dp=(Zd=class{constructor(){H(this,Br)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),oy(this.gcTime)&&U(this,Br,Pl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Fa?1/0:5*60*1e3))}clearGcTimeout(){_(this,Br)&&(Pl.clearTimeout(_(this,Br)),U(this,Br,void 0))}},Br=new WeakMap,Zd),Hr,$n,et,Wr,we,Xs,Vr,ht,Rt,eh,_y=(eh=class extends Dp{constructor(e){super();H(this,ht);H(this,Hr);H(this,$n);H(this,et);H(this,Wr);H(this,we);H(this,Xs);H(this,Vr);U(this,Vr,!1),U(this,Xs,e.defaultOptions),this.setOptions(e.options),this.observers=[],U(this,Wr,e.client),U(this,et,_(this,Wr).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,U(this,Hr,Sd(this.options)),this.state=e.state??_(this,Hr),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=_(this,we))==null?void 0:e.promise}setOptions(e){if(this.options={..._(this,Xs),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Sd(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),U(this,Hr,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus===\"idle\"&&_(this,et).remove(this)}setData(e,r){const n=fy(this.state.data,e,this.options);return ce(this,ht,Rt).call(this,{data:n,type:\"success\",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){ce(this,ht,Rt).call(this,{type:\"setState\",state:e,setStateOptions:r})}cancel(e){var n,s;const r=(n=_(this,we))==null?void 0:n.promise;return(s=_(this,we))==null||s.cancel(e),r?r.then(tt).catch(tt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(_(this,Hr))}isActive(){return this.observers.some(e=>uy(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Vu||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Tl(e.options.staleTime,this)===\"static\"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e===\"static\"?!1:this.state.isInvalidated?!0:!ly(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=_(this,we))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=_(this,we))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),_(this,et).notify({type:\"observerAdded\",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(_(this,we)&&(_(this,Vr)?_(this,we).cancel({revert:!0}):_(this,we).cancelRetry()),this.scheduleGc()),_(this,et).notify({type:\"observerRemoved\",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ce(this,ht,Rt).call(this,{type:\"invalidate\"})}async fetch(e,r){var u,c,d,h,f,y,x,w,v,m,p,g;if(this.state.fetchStatus!==\"idle\"&&((u=_(this,we))==null?void 0:u.status())!==\"rejected\"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(_(this,we))return _(this,we).continueRetry(),_(this,we).promise}if(e&&this.setOptions(e),!this.options.queryFn){const b=this.observers.find(S=>S.options.queryFn);b&&this.setOptions(b.options)}const n=new AbortController,s=b=>{Object.defineProperty(b,\"signal\",{enumerable:!0,get:()=>(U(this,Vr,!0),n.signal)})},i=()=>{const b=Ap(this.options,r),j=(()=>{const N={client:_(this,Wr),queryKey:this.queryKey,meta:this.meta};return s(N),N})();return U(this,Vr,!1),this.options.persister?this.options.persister(b,j,this):b(j)},l=(()=>{const b={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:_(this,Wr),state:this.state,fetchFn:i};return s(b),b})();(c=this.options.behavior)==null||c.onFetch(l,this),U(this,$n,this.state),(this.state.fetchStatus===\"idle\"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&ce(this,ht,Rt).call(this,{type:\"fetch\",meta:(h=l.fetchOptions)==null?void 0:h.meta}),U(this,we,$p({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:b=>{b instanceof Ol&&b.revert&&this.setState({..._(this,$n),fetchStatus:\"idle\"}),n.abort()},onFail:(b,S)=>{ce(this,ht,Rt).call(this,{type:\"failed\",failureCount:b,error:S})},onPause:()=>{ce(this,ht,Rt).call(this,{type:\"pause\"})},onContinue:()=>{ce(this,ht,Rt).call(this,{type:\"continue\"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const b=await _(this,we).start();if(b===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(b),(y=(f=_(this,et).config).onSuccess)==null||y.call(f,b,this),(w=(x=_(this,et).config).onSettled)==null||w.call(x,b,this.state.error,this),b}catch(b){if(b instanceof Ol){if(b.silent)return _(this,we).promise;if(b.revert){if(this.state.data===void 0)throw b;return this.state.data}}throw ce(this,ht,Rt).call(this,{type:\"error\",error:b}),(m=(v=_(this,et).config).onError)==null||m.call(v,b,this),(g=(p=_(this,et).config).onSettled)==null||g.call(p,this.state.data,b,this),b}finally{this.scheduleGc()}}},Hr=new WeakMap,$n=new WeakMap,et=new WeakMap,Wr=new WeakMap,we=new WeakMap,Xs=new WeakMap,Vr=new WeakMap,ht=new WeakSet,Rt=function(e){const r=n=>{switch(e.type){case\"failed\":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case\"pause\":return{...n,fetchStatus:\"paused\"};case\"continue\":return{...n,fetchStatus:\"fetching\"};case\"fetch\":return{...n,...Sy(n.data,this.options),fetchMeta:e.meta??null};case\"success\":const s={...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:\"success\",...!e.manual&&{fetchStatus:\"idle\",fetchFailureCount:0,fetchFailureReason:null}};return U(this,$n,e.manual?s:void 0),s;case\"error\":const i=e.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:\"idle\",status:\"error\"};case\"invalidate\":return{...n,isInvalidated:!0};case\"setState\":return{...n,...e.state}}};this.state=r(this.state),Se.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),_(this,et).notify({query:this,type:\"updated\",action:e})})},eh);function Sy(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ip(e.networkMode)?\"fetching\":\"paused\",...t===void 0&&{error:null,status:\"pending\"}}}function Sd(t){const e=typeof t.initialData==\"function\"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt==\"function\"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?\"success\":\"pending\",fetchStatus:\"idle\"}}function jd(t){return{onFetch:(e,r)=>{var d,h,f,y,x;const n=e.options,s=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((y=e.state.data)==null?void 0:y.pages)||[],a=((x=e.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},u=0;const c=async()=>{let w=!1;const v=g=>{Object.defineProperty(g,\"signal\",{enumerable:!0,get:()=>(e.signal.aborted?w=!0:e.signal.addEventListener(\"abort\",()=>{w=!0}),e.signal)})},m=Ap(e.options,e.fetchOptions),p=async(g,b,S)=>{if(w)return Promise.reject();if(b==null&&g.pages.length)return Promise.resolve(g);const N=(()=>{const z={client:e.client,queryKey:e.queryKey,pageParam:b,direction:S?\"backward\":\"forward\",meta:e.options.meta};return v(z),z})(),P=await m(N),{maxPages:D}=e.options,T=S?my:py;return{pages:T(g.pages,P,D),pageParams:T(g.pageParams,b,D)}};if(s&&i.length){const g=s===\"backward\",b=g?jy:Nd,S={pages:i,pageParams:a},j=b(n,S);l=await p(S,j,g)}else{const g=t??i.length;do{const b=u===0?a[0]??n.initialPageParam:Nd(n,l);if(u>0&&b==null)break;l=await p(l,b),u++}while(u<g)}return l};e.options.persister?e.fetchFn=()=>{var w,v;return(v=(w=e.options).persister)==null?void 0:v.call(w,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=c}}}function Nd(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function jy(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var Zs,jt,Ie,qr,Nt,Jt,th,Ny=(th=class extends Dp{constructor(e){super();H(this,Nt);H(this,Zs);H(this,jt);H(this,Ie);H(this,qr);U(this,Zs,e.client),this.mutationId=e.mutationId,U(this,Ie,e.mutationCache),U(this,jt,[]),this.state=e.state||Up(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){_(this,jt).includes(e)||(_(this,jt).push(e),this.clearGcTimeout(),_(this,Ie).notify({type:\"observerAdded\",mutation:this,observer:e}))}removeObserver(e){U(this,jt,_(this,jt).filter(r=>r!==e)),this.scheduleGc(),_(this,Ie).notify({type:\"observerRemoved\",mutation:this,observer:e})}optionalRemove(){_(this,jt).length||(this.state.status===\"pending\"?this.scheduleGc():_(this,Ie).remove(this))}continue(){var e;return((e=_(this,qr))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,l,u,c,d,h,f,y,x,w,v,m,p,g,b,S,j,N,P,D;const r=()=>{ce(this,Nt,Jt).call(this,{type:\"continue\"})},n={client:_(this,Zs),meta:this.options.meta,mutationKey:this.options.mutationKey};U(this,qr,$p({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error(\"No mutationFn found\")),onFail:(T,z)=>{ce(this,Nt,Jt).call(this,{type:\"failed\",failureCount:T,error:z})},onPause:()=>{ce(this,Nt,Jt).call(this,{type:\"pause\"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>_(this,Ie).canRun(this)}));const s=this.state.status===\"pending\",i=!_(this,qr).canStart();try{if(s)r();else{ce(this,Nt,Jt).call(this,{type:\"pending\",variables:e,isPaused:i}),await((l=(a=_(this,Ie).config).onMutate)==null?void 0:l.call(a,e,this,n));const z=await((c=(u=this.options).onMutate)==null?void 0:c.call(u,e,n));z!==this.state.context&&ce(this,Nt,Jt).call(this,{type:\"pending\",context:z,variables:e,isPaused:i})}const T=await _(this,qr).start();return await((h=(d=_(this,Ie).config).onSuccess)==null?void 0:h.call(d,T,e,this.state.context,this,n)),await((y=(f=this.options).onSuccess)==null?void 0:y.call(f,T,e,this.state.context,n)),await((w=(x=_(this,Ie).config).onSettled)==null?void 0:w.call(x,T,null,this.state.variables,this.state.context,this,n)),await((m=(v=this.options).onSettled)==null?void 0:m.call(v,T,null,e,this.state.context,n)),ce(this,Nt,Jt).call(this,{type:\"success\",data:T}),T}catch(T){try{throw await((g=(p=_(this,Ie).config).onError)==null?void 0:g.call(p,T,e,this.state.context,this,n)),await((S=(b=this.options).onError)==null?void 0:S.call(b,T,e,this.state.context,n)),await((N=(j=_(this,Ie).config).onSettled)==null?void 0:N.call(j,void 0,T,this.state.variables,this.state.context,this,n)),await((D=(P=this.options).onSettled)==null?void 0:D.call(P,void 0,T,e,this.state.context,n)),T}finally{ce(this,Nt,Jt).call(this,{type:\"error\",error:T})}}finally{_(this,Ie).runNext(this)}}},Zs=new WeakMap,jt=new WeakMap,Ie=new WeakMap,qr=new WeakMap,Nt=new WeakSet,Jt=function(e){const r=n=>{switch(e.type){case\"failed\":return{...n,failureCount:e.failureCount,failureReason:e.error};case\"pause\":return{...n,isPaused:!0};case\"continue\":return{...n,isPaused:!1};case\"pending\":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:\"pending\",variables:e.variables,submittedAt:Date.now()};case\"success\":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:\"success\",isPaused:!1};case\"error\":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:\"error\"}}};this.state=r(this.state),Se.batch(()=>{_(this,jt).forEach(n=>{n.onMutationUpdate(e)}),_(this,Ie).notify({mutation:this,type:\"updated\",action:e})})},th);function Up(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:\"idle\",variables:void 0,submittedAt:0}}var $t,ft,ei,rh,Cy=(rh=class extends oi{constructor(e={}){super();H(this,$t);H(this,ft);H(this,ei);this.config=e,U(this,$t,new Set),U(this,ft,new Map),U(this,ei,0)}build(e,r,n){const s=new Ny({client:e,mutationCache:this,mutationId:++hi(this,ei)._,options:e.defaultMutationOptions(r),state:n});return this.add(s),s}add(e){_(this,$t).add(e);const r=Ti(e);if(typeof r==\"string\"){const n=_(this,ft).get(r);n?n.push(e):_(this,ft).set(r,[e])}this.notify({type:\"added\",mutation:e})}remove(e){if(_(this,$t).delete(e)){const r=Ti(e);if(typeof r==\"string\"){const n=_(this,ft).get(r);if(n)if(n.length>1){const s=n.indexOf(e);s!==-1&&n.splice(s,1)}else n[0]===e&&_(this,ft).delete(r)}}this.notify({type:\"removed\",mutation:e})}canRun(e){const r=Ti(e);if(typeof r==\"string\"){const n=_(this,ft).get(r),s=n==null?void 0:n.find(i=>i.state.status===\"pending\");return!s||s===e}else return!0}runNext(e){var n;const r=Ti(e);if(typeof r==\"string\"){const s=(n=_(this,ft).get(r))==null?void 0:n.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Se.batch(()=>{_(this,$t).forEach(e=>{this.notify({type:\"removed\",mutation:e})}),_(this,$t).clear(),_(this,ft).clear()})}getAll(){return Array.from(_(this,$t))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>bd(r,n))}findAll(e={}){return this.getAll().filter(r=>bd(e,r))}notify(e){Se.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return Se.batch(()=>Promise.all(e.map(r=>r.continue().catch(tt))))}},$t=new WeakMap,ft=new WeakMap,ei=new WeakMap,rh);function Ti(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Dt,ar,Fe,Ut,Bt,Gi,Al,nh,Ey=(nh=class extends oi{constructor(r,n){super();H(this,Bt);H(this,Dt);H(this,ar);H(this,Fe);H(this,Ut);U(this,Dt,r),this.setOptions(n),this.bindMethods(),ce(this,Bt,Gi).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=_(this,Dt).defaultMutationOptions(r),dy(this.options,n)||_(this,Dt).getMutationCache().notify({type:\"observerOptionsUpdated\",mutation:_(this,Fe),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&en(n.mutationKey)!==en(this.options.mutationKey)?this.reset():((s=_(this,Fe))==null?void 0:s.state.status)===\"pending\"&&_(this,Fe).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=_(this,Fe))==null||r.removeObserver(this)}onMutationUpdate(r){ce(this,Bt,Gi).call(this),ce(this,Bt,Al).call(this,r)}getCurrentResult(){return _(this,ar)}reset(){var r;(r=_(this,Fe))==null||r.removeObserver(this),U(this,Fe,void 0),ce(this,Bt,Gi).call(this),ce(this,Bt,Al).call(this)}mutate(r,n){var s;return U(this,Ut,n),(s=_(this,Fe))==null||s.removeObserver(this),U(this,Fe,_(this,Dt).getMutationCache().build(_(this,Dt),this.options)),_(this,Fe).addObserver(this),_(this,Fe).execute(r)}},Dt=new WeakMap,ar=new WeakMap,Fe=new WeakMap,Ut=new WeakMap,Bt=new WeakSet,Gi=function(){var n;const r=((n=_(this,Fe))==null?void 0:n.state)??Up();U(this,ar,{...r,isPending:r.status===\"pending\",isSuccess:r.status===\"success\",isError:r.status===\"error\",isIdle:r.status===\"idle\",mutate:this.mutate,reset:this.reset})},Al=function(r){Se.batch(()=>{var n,s,i,a,l,u,c,d;if(_(this,Ut)&&this.hasListeners()){const h=_(this,ar).variables,f=_(this,ar).context,y={client:_(this,Dt),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)===\"success\"?((s=(n=_(this,Ut)).onSuccess)==null||s.call(n,r.data,h,f,y),(a=(i=_(this,Ut)).onSettled)==null||a.call(i,r.data,null,h,f,y)):(r==null?void 0:r.type)===\"error\"&&((u=(l=_(this,Ut)).onError)==null||u.call(l,r.error,h,f,y),(d=(c=_(this,Ut)).onSettled)==null||d.call(c,void 0,r.error,h,f,y))}this.listeners.forEach(h=>{h(_(this,ar))})})},nh),Ct,sh,Py=(sh=class extends oi{constructor(e={}){super();H(this,Ct);this.config=e,U(this,Ct,new Map)}build(e,r,n){const s=r.queryKey,i=r.queryHash??Wu(s,r);let a=this.get(i);return a||(a=new _y({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(a)),a}add(e){_(this,Ct).has(e.queryHash)||(_(this,Ct).set(e.queryHash,e),this.notify({type:\"added\",query:e}))}remove(e){const r=_(this,Ct).get(e.queryHash);r&&(e.destroy(),r===e&&_(this,Ct).delete(e.queryHash),this.notify({type:\"removed\",query:e}))}clear(){Se.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return _(this,Ct).get(e)}getAll(){return[..._(this,Ct).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>wd(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>wd(e,n)):r}notify(e){Se.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){Se.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Se.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ct=new WeakMap,sh),oe,or,lr,Dn,Un,ur,Mn,Fn,ih,Ty=(ih=class{constructor(t={}){H(this,oe);H(this,or);H(this,lr);H(this,Dn);H(this,Un);H(this,ur);H(this,Mn);H(this,Fn);U(this,oe,t.queryCache||new Py),U(this,or,t.mutationCache||new Cy),U(this,lr,t.defaultOptions||{}),U(this,Dn,new Map),U(this,Un,new Map),U(this,ur,0)}mount(){hi(this,ur)._++,_(this,ur)===1&&(U(this,Mn,Lp.subscribe(async t=>{t&&(await this.resumePausedMutations(),_(this,oe).onFocus())})),U(this,Fn,wa.subscribe(async t=>{t&&(await this.resumePausedMutations(),_(this,oe).onOnline())})))}unmount(){var t,e;hi(this,ur)._--,_(this,ur)===0&&((t=_(this,Mn))==null||t.call(this),U(this,Mn,void 0),(e=_(this,Fn))==null||e.call(this),U(this,Fn,void 0))}isFetching(t){return _(this,oe).findAll({...t,fetchStatus:\"fetching\"}).length}isMutating(t){return _(this,or).findAll({...t,status:\"pending\"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=_(this,oe).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=_(this,oe).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Tl(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return _(this,oe).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),s=_(this,oe).get(n.queryHash),i=s==null?void 0:s.state.data,a=ay(e,i);if(a!==void 0)return _(this,oe).build(this,n).setData(a,{...r,manual:!0})}setQueriesData(t,e,r){return Se.batch(()=>_(this,oe).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=_(this,oe).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=_(this,oe);Se.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=_(this,oe);return Se.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:\"active\",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=Se.batch(()=>_(this,oe).findAll(t).map(s=>s.cancel(r)));return Promise.all(n).then(tt).catch(tt)}invalidateQueries(t,e={}){return Se.batch(()=>(_(this,oe).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)===\"none\"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??\"active\"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=Se.batch(()=>_(this,oe).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(tt)),s.state.fetchStatus===\"paused\"?Promise.resolve():i}));return Promise.all(n).then(tt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=_(this,oe).build(this,e);return r.isStaleByTime(Tl(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(tt).catch(tt)}fetchInfiniteQuery(t){return t.behavior=jd(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(tt).catch(tt)}ensureInfiniteQueryData(t){return t.behavior=jd(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return wa.isOnline()?_(this,or).resumePausedMutations():Promise.resolve()}getQueryCache(){return _(this,oe)}getMutationCache(){return _(this,or)}getDefaultOptions(){return _(this,lr)}setDefaultOptions(t){U(this,lr,t)}setQueryDefaults(t,e){_(this,Dn).set(en(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[..._(this,Dn).values()],r={};return e.forEach(n=>{Qs(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){_(this,Un).set(en(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[..._(this,Un).values()],r={};return e.forEach(n=>{Qs(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={..._(this,lr).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Wu(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!==\"always\"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode=\"offlineFirst\"),e.queryFn===Vu&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{..._(this,lr).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){_(this,oe).clear(),_(this,or).clear()}},oe=new WeakMap,or=new WeakMap,lr=new WeakMap,Dn=new WeakMap,Un=new WeakMap,ur=new WeakMap,Mn=new WeakMap,Fn=new WeakMap,ih),Mp=k.createContext(void 0),Ry=t=>{const e=k.useContext(Mp);if(!e)throw new Error(\"No QueryClient set, use QueryClientProvider to set one\");return e},Oy=({client:t,children:e})=>(k.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),o.jsx(Mp.Provider,{value:t,children:e}));function Fp(t,e){const r=Ry(),[n]=k.useState(()=>new Ey(r,t));k.useEffect(()=>{n.setOptions(t)},[n,t]);const s=k.useSyncExternalStore(k.useCallback(a=>n.subscribe(Se.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=k.useCallback((a,l)=>{n.mutate(a,l).catch(tt)},[n]);if(s.error&&gy(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const Ay=\"modulepreload\",Ly=function(t){return\"/\"+t},Cd={},li=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName(\"link\");const a=document.querySelector(\"meta[property=csp-nonce]\"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute(\"nonce\"));s=Promise.allSettled(r.map(u=>{if(u=Ly(u),u in Cd)return;Cd[u]=!0;const c=u.endsWith(\".css\"),d=c?'[rel=\"stylesheet\"]':\"\";if(document.querySelector(`link[href=\"${u}\"]${d}`))return;const h=document.createElement(\"link\");if(h.rel=c?\"stylesheet\":Ay,c||(h.as=\"script\"),h.crossOrigin=\"\",h.href=u,l&&h.setAttribute(\"nonce\",l),document.head.appendChild(h),c)return new Promise((f,y)=>{h.addEventListener(\"load\",f),h.addEventListener(\"error\",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const l=new Event(\"vite:preloadError\",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status===\"rejected\"&&i(l.reason);return e().catch(i)})},Iy=t=>{let e;return t?e=t:typeof fetch>\"u\"?e=(...r)=>li(async()=>{const{default:n}=await Promise.resolve().then(()=>ts);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class qu extends Error{constructor(e,r=\"FunctionsError\",n){super(e),this.name=r,this.context=n}}class $y extends qu{constructor(e){super(\"Failed to send a request to the Edge Function\",\"FunctionsFetchError\",e)}}class Ed extends qu{constructor(e){super(\"Relay Error invoking the Edge Function\",\"FunctionsRelayError\",e)}}class Pd extends qu{constructor(e){super(\"Edge Function returned a non-2xx status code\",\"FunctionsHttpError\",e)}}var Ll;(function(t){t.Any=\"any\",t.ApNortheast1=\"ap-northeast-1\",t.ApNortheast2=\"ap-northeast-2\",t.ApSouth1=\"ap-south-1\",t.ApSoutheast1=\"ap-southeast-1\",t.ApSoutheast2=\"ap-southeast-2\",t.CaCentral1=\"ca-central-1\",t.EuCentral1=\"eu-central-1\",t.EuWest1=\"eu-west-1\",t.EuWest2=\"eu-west-2\",t.EuWest3=\"eu-west-3\",t.SaEast1=\"sa-east-1\",t.UsEast1=\"us-east-1\",t.UsWest1=\"us-west-1\",t.UsWest2=\"us-west-2\"})(Ll||(Ll={}));var Dy=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};class Uy{constructor(e,{headers:r={},customFetch:n,region:s=Ll.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=Iy(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return Dy(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let l={},{region:u}=r;u||(u=this.region);const c=new URL(`${this.url}/${e}`);u&&u!==\"any\"&&(l[\"x-region\"]=u,c.searchParams.set(\"forceFunctionRegion\",u));let d;a&&(s&&!Object.prototype.hasOwnProperty.call(s,\"Content-Type\")||!s)&&(typeof Blob<\"u\"&&a instanceof Blob||a instanceof ArrayBuffer?(l[\"Content-Type\"]=\"application/octet-stream\",d=a):typeof a==\"string\"?(l[\"Content-Type\"]=\"text/plain\",d=a):typeof FormData<\"u\"&&a instanceof FormData?d=a:(l[\"Content-Type\"]=\"application/json\",d=JSON.stringify(a)));const h=yield this.fetch(c.toString(),{method:i||\"POST\",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(w=>{throw new $y(w)}),f=h.headers.get(\"x-relay-error\");if(f&&f===\"true\")throw new Ed(h);if(!h.ok)throw new Pd(h);let y=((n=h.headers.get(\"Content-Type\"))!==null&&n!==void 0?n:\"text/plain\").split(\";\")[0].trim(),x;return y===\"application/json\"?x=yield h.json():y===\"application/octet-stream\"?x=yield h.blob():y===\"text/event-stream\"?x=h:y===\"multipart/form-data\"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof Pd||s instanceof Ed?s.context:void 0}}})}}var He={},Ku={},za={},ui={},Ba={},Ha={},My=function(){if(typeof self<\"u\")return self;if(typeof window<\"u\")return window;if(typeof global<\"u\")return global;throw new Error(\"unable to locate global object\")},Gn=My();const Fy=Gn.fetch,zp=Gn.fetch.bind(Gn),Bp=Gn.Headers,zy=Gn.Request,By=Gn.Response,ts=Object.freeze(Object.defineProperty({__proto__:null,Headers:Bp,Request:zy,Response:By,default:zp,fetch:Fy},Symbol.toStringTag,{value:\"Module\"})),Hy=N0(ts);var Wa={};Object.defineProperty(Wa,\"__esModule\",{value:!0});let Wy=class extends Error{constructor(e){super(e.message),this.name=\"PostgrestError\",this.details=e.details,this.hint=e.hint,this.code=e.code}};Wa.default=Wy;var Hp=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ha,\"__esModule\",{value:!0});const Vy=Hp(Hy),qy=Hp(Wa);let Ky=class{constructor(e){var r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>\"u\"?this.fetch=Vy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){this.schema===void 0||([\"GET\",\"HEAD\"].includes(this.method)?this.headers.set(\"Accept-Profile\",this.schema):this.headers.set(\"Content-Profile\",this.schema)),this.method!==\"GET\"&&this.method!==\"HEAD\"&&this.headers.set(\"Content-Type\",\"application/json\");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,l,u,c;let d=null,h=null,f=null,y=i.status,x=i.statusText;if(i.ok){if(this.method!==\"HEAD\"){const p=await i.text();p===\"\"||(this.headers.get(\"Accept\")===\"text/csv\"||this.headers.get(\"Accept\")&&(!((a=this.headers.get(\"Accept\"))===null||a===void 0)&&a.includes(\"application/vnd.pgrst.plan+text\"))?h=p:h=JSON.parse(p))}const v=(l=this.headers.get(\"Prefer\"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),m=(u=i.headers.get(\"content-range\"))===null||u===void 0?void 0:u.split(\"/\");v&&m&&m.length>1&&(f=parseInt(m[1])),this.isMaybeSingle&&this.method===\"GET\"&&Array.isArray(h)&&(h.length>1?(d={code:\"PGRST116\",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:\"JSON object requested, multiple (or no) rows returned\"},h=null,f=null,y=406,x=\"Not Acceptable\"):h.length===1?h=h[0]:h=null)}else{const v=await i.text();try{d=JSON.parse(v),Array.isArray(d)&&i.status===404&&(h=[],d=null,y=200,x=\"OK\")}catch{i.status===404&&v===\"\"?(y=204,x=\"No Content\"):d={message:v}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes(\"0 rows\"))&&(d=null,y=200,x=\"OK\"),d&&this.shouldThrowOnError)throw new qy.default(d)}return{error:d,data:h,count:f,status:y,statusText:x}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,l,u;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:\"FetchError\"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:\"\"}`,hint:\"\",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:\"\"}`},data:null,count:null,status:0,statusText:\"\"}})),s.then(e,r)}returns(){return this}overrideTypes(){return this}};Ha.default=Ky;var Gy=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ba,\"__esModule\",{value:!0});const Qy=Gy(Ha);let Jy=class extends Qy.default{select(e){let r=!1;const n=(e??\"*\").split(\"\").map(s=>/\\s/.test(s)&&!r?\"\":(s==='\"'&&(r=!r),s)).join(\"\");return this.url.searchParams.set(\"select\",n),this.headers.append(\"Prefer\",\"return=representation\"),this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:\"order\",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:\"\"}${e}.${r?\"asc\":\"desc\"}${n===void 0?\"\":n?\".nullsfirst\":\".nullslast\"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>\"u\"?\"limit\":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>\"u\"?\"offset\":`${s}.offset`,a=typeof s>\"u\"?\"limit\":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set(\"Accept\",\"application/vnd.pgrst.object+json\"),this}maybeSingle(){return this.method===\"GET\"?this.headers.set(\"Accept\",\"application/json\"):this.headers.set(\"Accept\",\"application/vnd.pgrst.object+json\"),this.isMaybeSingle=!0,this}csv(){return this.headers.set(\"Accept\",\"text/csv\"),this}geojson(){return this.headers.set(\"Accept\",\"application/geo+json\"),this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a=\"text\"}={}){var l;const u=[e?\"analyze\":null,r?\"verbose\":null,n?\"settings\":null,s?\"buffers\":null,i?\"wal\":null].filter(Boolean).join(\"|\"),c=(l=this.headers.get(\"Accept\"))!==null&&l!==void 0?l:\"application/json\";return this.headers.set(\"Accept\",`application/vnd.pgrst.plan+${a}; for=\"${c}\"; options=${u};`),a===\"json\"?this:this}rollback(){return this.headers.append(\"Prefer\",\"tx=rollback\"),this}returns(){return this}maxAffected(e){return this.headers.append(\"Prefer\",\"handling=strict\"),this.headers.append(\"Prefer\",`max-affected=${e}`),this}};Ba.default=Jy;var Yy=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ui,\"__esModule\",{value:!0});const Xy=Yy(Ba);let Zy=class extends Xy.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(\",\")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(\",\")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(\",\")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(\",\")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(s=>typeof s==\"string\"&&new RegExp(\"[,()]\").test(s)?`\"${s}\"`:`${s}`).join(\",\");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r==\"string\"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(\",\")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r==\"string\"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(\",\")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r==\"string\"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(\",\")}}`),this}textSearch(e,r,{config:n,type:s}={}){let i=\"\";s===\"plain\"?i=\"pl\":s===\"phrase\"?i=\"ph\":s===\"websearch\"&&(i=\"w\");const a=n===void 0?\"\":`(${n})`;return this.url.searchParams.append(e,`${i}fts${a}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:\"or\";return this.url.searchParams.append(s,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};ui.default=Zy;var ex=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(za,\"__esModule\",{value:!0});const ds=ex(ui);let tx=class{constructor(e,{headers:r={},schema:n,fetch:s}){this.url=e,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(e,{head:r=!1,count:n}={}){const s=r?\"HEAD\":\"GET\";let i=!1;const a=(e??\"*\").split(\"\").map(l=>/\\s/.test(l)&&!i?\"\":(l==='\"'&&(i=!i),l)).join(\"\");return this.url.searchParams.set(\"select\",a),n&&this.headers.append(\"Prefer\",`count=${n}`),new ds.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:n=!0}={}){var s;const i=\"POST\";if(r&&this.headers.append(\"Prefer\",`count=${r}`),n||this.headers.append(\"Prefer\",\"missing=default\"),Array.isArray(e)){const a=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`\"${u}\"`);this.url.searchParams.set(\"columns\",l.join(\",\"))}}return new ds.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){var a;const l=\"POST\";if(this.headers.append(\"Prefer\",`resolution=${n?\"ignore\":\"merge\"}-duplicates`),r!==void 0&&this.url.searchParams.set(\"on_conflict\",r),s&&this.headers.append(\"Prefer\",`count=${s}`),i||this.headers.append(\"Prefer\",\"missing=default\"),Array.isArray(e)){const u=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`\"${d}\"`);this.url.searchParams.set(\"columns\",c.join(\",\"))}}return new ds.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:r}={}){var n;const s=\"PATCH\";return r&&this.headers.append(\"Prefer\",`count=${r}`),new ds.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var r;const n=\"DELETE\";return e&&this.headers.append(\"Prefer\",`count=${e}`),new ds.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};za.default=tx;var Wp=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ku,\"__esModule\",{value:!0});const rx=Wp(za),nx=Wp(ui);let sx=class Vp{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new rx.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Vp(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:s=!1,count:i}={}){var a;let l;const u=new URL(`${this.url}/rpc/${e}`);let c;n||s?(l=n?\"HEAD\":\"GET\",Object.entries(r).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(\",\")}}`:`${f}`]).forEach(([h,f])=>{u.searchParams.append(h,f)})):(l=\"POST\",c=r);const d=new Headers(this.headers);return i&&d.set(\"Prefer\",`count=${i}`),new nx.default({method:l,url:u,headers:d,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};Ku.default=sx;var rs=at&&at.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(He,\"__esModule\",{value:!0});He.PostgrestError=He.PostgrestBuilder=He.PostgrestTransformBuilder=He.PostgrestFilterBuilder=He.PostgrestQueryBuilder=He.PostgrestClient=void 0;const qp=rs(Ku);He.PostgrestClient=qp.default;const Kp=rs(za);He.PostgrestQueryBuilder=Kp.default;const Gp=rs(ui);He.PostgrestFilterBuilder=Gp.default;const Qp=rs(Ba);He.PostgrestTransformBuilder=Qp.default;const Jp=rs(Ha);He.PostgrestBuilder=Jp.default;const Yp=rs(Wa);He.PostgrestError=Yp.default;var ix=He.default={PostgrestClient:qp.default,PostgrestQueryBuilder:Kp.default,PostgrestFilterBuilder:Gp.default,PostgrestTransformBuilder:Qp.default,PostgrestBuilder:Jp.default,PostgrestError:Yp.default};const{PostgrestClient:ax,PostgrestQueryBuilder:xk,PostgrestFilterBuilder:wk,PostgrestTransformBuilder:bk,PostgrestBuilder:kk,PostgrestError:_k}=ix;class ox{static detectEnvironment(){var e;if(typeof WebSocket<\"u\")return{type:\"native\",constructor:WebSocket};if(typeof globalThis<\"u\"&&typeof globalThis.WebSocket<\"u\")return{type:\"native\",constructor:globalThis.WebSocket};if(typeof global<\"u\"&&typeof global.WebSocket<\"u\")return{type:\"native\",constructor:global.WebSocket};if(typeof globalThis<\"u\"&&typeof globalThis.WebSocketPair<\"u\"&&typeof globalThis.WebSocket>\"u\")return{type:\"cloudflare\",error:\"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.\",workaround:\"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.\"};if(typeof globalThis<\"u\"&&globalThis.EdgeRuntime||typeof navigator<\"u\"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes(\"Vercel-Edge\")))return{type:\"unsupported\",error:\"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.\",workaround:\"Use serverless functions or a different deployment target for WebSocket functionality.\"};if(typeof process<\"u\"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,\"\").split(\".\")[0]);return s>=22?typeof globalThis.WebSocket<\"u\"?{type:\"native\",constructor:globalThis.WebSocket}:{type:\"unsupported\",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:\"Provide a WebSocket implementation via the transport option.\"}:{type:\"unsupported\",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install \"ws\" package and provide it via the transport option:\nimport ws from \"ws\"\nnew RealtimeClient(url, { transport: ws })`}}}return{type:\"unsupported\",error:\"Unknown JavaScript runtime without WebSocket support.\",workaround:\"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\"}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||\"WebSocket not supported in this environment.\";throw e.workaround&&(r+=`\n\nSuggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type===\"native\"||e.type===\"ws\"}catch{return!1}}}const lx=\"2.15.5\",ux=`realtime-js/${lx}`,cx=\"1.0.0\",Il=1e4,dx=1e3,hx=100;var Cs;(function(t){t[t.connecting=0]=\"connecting\",t[t.open=1]=\"open\",t[t.closing=2]=\"closing\",t[t.closed=3]=\"closed\"})(Cs||(Cs={}));var me;(function(t){t.closed=\"closed\",t.errored=\"errored\",t.joined=\"joined\",t.joining=\"joining\",t.leaving=\"leaving\"})(me||(me={}));var mt;(function(t){t.close=\"phx_close\",t.error=\"phx_error\",t.join=\"phx_join\",t.reply=\"phx_reply\",t.leave=\"phx_leave\",t.access_token=\"access_token\"})(mt||(mt={}));var $l;(function(t){t.websocket=\"websocket\"})($l||($l={}));var Dr;(function(t){t.Connecting=\"connecting\",t.Open=\"open\",t.Closing=\"closing\",t.Closed=\"closed\"})(Dr||(Dr={}));class fx{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e==\"string\"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(e.slice(a,a+s));a=a+s;const u=n.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class Xp{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Y;(function(t){t.abstime=\"abstime\",t.bool=\"bool\",t.date=\"date\",t.daterange=\"daterange\",t.float4=\"float4\",t.float8=\"float8\",t.int2=\"int2\",t.int4=\"int4\",t.int4range=\"int4range\",t.int8=\"int8\",t.int8range=\"int8range\",t.json=\"json\",t.jsonb=\"jsonb\",t.money=\"money\",t.numeric=\"numeric\",t.oid=\"oid\",t.reltime=\"reltime\",t.text=\"text\",t.time=\"time\",t.timestamp=\"timestamp\",t.timestamptz=\"timestamptz\",t.timetz=\"timetz\",t.tsrange=\"tsrange\",t.tstzrange=\"tstzrange\"})(Y||(Y={}));const Td=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,a)=>(i[a]=px(a,t,e,s),i),{})},px=(t,e,r,n)=>{const s=e.find(l=>l.name===t),i=s==null?void 0:s.type,a=r[t];return i&&!n.includes(i)?Zp(i,a):Dl(a)},Zp=(t,e)=>{if(t.charAt(0)===\"_\"){const r=t.slice(1,t.length);return yx(e,r)}switch(t){case Y.bool:return mx(e);case Y.float4:case Y.float8:case Y.int2:case Y.int4:case Y.int8:case Y.numeric:case Y.oid:return gx(e);case Y.json:case Y.jsonb:return vx(e);case Y.timestamp:return xx(e);case Y.abstime:case Y.date:case Y.daterange:case Y.int4range:case Y.int8range:case Y.money:case Y.reltime:case Y.text:case Y.time:case Y.timestamptz:case Y.timetz:case Y.tsrange:case Y.tstzrange:return Dl(e);default:return Dl(e)}},Dl=t=>t,mx=t=>{switch(t){case\"t\":return!0;case\"f\":return!1;default:return t}},gx=t=>{if(typeof t==\"string\"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},vx=t=>{if(typeof t==\"string\")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},yx=(t,e)=>{if(typeof t!=\"string\")return t;const r=t.length-1,n=t[r];if(t[0]===\"{\"&&n===\"}\"){let i;const a=t.slice(1,r);try{i=JSON.parse(\"[\"+a+\"]\")}catch{i=a?a.split(\",\"):[]}return i.map(l=>Zp(e,l))}return t},xx=t=>typeof t==\"string\"?t.replace(\" \",\"T\"):t,e0=t=>{let e=t;return e=e.replace(/^ws/i,\"http\"),e=e.replace(/(\\/socket\\/websocket|\\/socket|\\/websocket)\\/?$/i,\"\"),e.replace(/\\/+$/,\"\")+\"/api/broadcast\"};class ko{constructor(e,r,n={},s=Il){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref=\"\",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref=\"\",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived(\"timeout\")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger(\"timeout\",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Rd;(function(t){t.SYNC=\"sync\",t.JOIN=\"join\",t.LEAVE=\"leave\"})(Rd||(Rd={}));class Es{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:\"presence_state\",diff:\"presence_diff\"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Es.syncState(this.state,s,i,a),this.pendingDiffs.forEach(u=>{this.state=Es.syncDiff(this.state,u,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Es.syncDiff(this.state,s,i,a),l())}),this.onJoin((s,i,a)=>{this.channel._trigger(\"presence\",{event:\"join\",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger(\"presence\",{event:\"leave\",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger(\"presence\",{event:\"sync\"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),a=this.transformState(r),l={},u={};return this.map(i,(c,d)=>{a[c]||(u[c]=d)}),this.map(a,(c,d)=>{const h=i[c];if(h){const f=d.map(v=>v.presence_ref),y=h.map(v=>v.presence_ref),x=d.filter(v=>y.indexOf(v.presence_ref)<0),w=h.filter(v=>f.indexOf(v.presence_ref)<0);x.length>0&&(l[c]=x),w.length>0&&(u[c]=w)}else l[c]=d}),this.syncDiff(i,{joins:l,leaves:u},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,u)=>{var c;const d=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(u),d.length>0){const h=e[l].map(y=>y.presence_ref),f=d.filter(y=>h.indexOf(y.presence_ref)<0);e[l].unshift(...f)}n(l,d,u)}),this.map(a,(l,u)=>{let c=e[l];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=c,s(l,c,u),c.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return\"metas\"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Od;(function(t){t.ALL=\"*\",t.INSERT=\"INSERT\",t.UPDATE=\"UPDATE\",t.DELETE=\"DELETE\"})(Od||(Od={}));var Ps;(function(t){t.BROADCAST=\"broadcast\",t.PRESENCE=\"presence\",t.POSTGRES_CHANGES=\"postgres_changes\",t.SYSTEM=\"system\"})(Ps||(Ps={}));var Lt;(function(t){t.SUBSCRIBED=\"SUBSCRIBED\",t.TIMED_OUT=\"TIMED_OUT\",t.CLOSED=\"CLOSED\",t.CHANNEL_ERROR=\"CHANNEL_ERROR\"})(Lt||(Lt={}));class Gu{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,\"\"),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:\"\",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ko(this,mt.join,this.params,this.timeout),this.rejoinTimer=new Xp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive(\"ok\",()=>{this.state=me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log(\"channel\",`close ${this.topic} ${this._joinRef()}`),this.state=me.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log(\"channel\",`error ${this.topic}`,s),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive(\"timeout\",()=>{this._isJoining()&&(this.socket.log(\"channel\",`timeout ${this.topic}`,this.joinPush.timeout),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive(\"error\",s=>{this._isLeaving()||this._isClosed()||(this.socket.log(\"channel\",`error ${this.topic}`,s),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this._on(mt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Es(this),this.broadcastEndpointURL=e0(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==me.closed){const{config:{broadcast:a,presence:l,private:u}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[Ps.PRESENCE]&&this.bindings[Ps.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(y=>e==null?void 0:e(Lt.CHANNEL_ERROR,y)),this._onClose(()=>e==null?void 0:e(Lt.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive(\"ok\",async({postgres_changes:y})=>{var x;if(this.socket.setAuth(),y===void 0){e==null||e(Lt.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,v=(x=w==null?void 0:w.length)!==null&&x!==void 0?x:0,m=[];for(let p=0;p<v;p++){const g=w[p],{filter:{event:b,schema:S,table:j,filter:N}}=g,P=y&&y[p];if(P&&P.event===b&&P.schema===S&&P.table===j&&P.filter===N)m.push(Object.assign(Object.assign({},g),{id:P.id}));else{this.unsubscribe(),this.state=me.errored,e==null||e(Lt.CHANNEL_ERROR,new Error(\"mismatch between server and client bindings for postgres changes\"));return}}this.bindings.postgres_changes=m,e&&e(Lt.SUBSCRIBED);return}}).receive(\"error\",y=>{this.state=me.errored,e==null||e(Lt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(\", \")||\"error\")))}).receive(\"timeout\",()=>{e==null||e(Lt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:\"presence\",event:\"track\",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:\"presence\",event:\"untrack\"},e)}on(e,r,n){return this.state===me.joined&&e===Ps.PRESENCE&&(this.socket.log(\"channel\",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type===\"broadcast\"){const{event:i,payload:a}=e,u={method:\"POST\",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:\"\",apikey:this.socket.apiKey?this.socket.apiKey:\"\",\"Content-Type\":\"application/json\"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?\"ok\":\"error\"}catch(c){return c.name===\"AbortError\"?\"timed out\":\"error\"}}else return new Promise(i=>{var a,l,u;const c=this._push(e.type,e,r.timeout||this.timeout);e.type===\"broadcast\"&&!(!((u=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&i(\"ok\"),c.receive(\"ok\",()=>i(\"ok\")),c.receive(\"error\",()=>i(\"error\")),c.receive(\"timeout\",()=>i(\"timed out\"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=me.leaving;const r=()=>{this.socket.log(\"channel\",`leave ${this.topic}`),this._trigger(mt.close,\"leave\",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new ko(this,mt.leave,{},e),n.receive(\"ok\",()=>{r(),s(\"ok\")}).receive(\"timeout\",()=>{r(),s(\"timed out\")}).receive(\"error\",()=>{s(\"error\")}),n.send(),this._canPush()||n.trigger(\"ok\",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=me.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ko(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>hx){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log(\"channel\",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const a=e.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=mt;if(n&&[l,u,c,d].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw\"channel onMessage callbacks must return the payload, modified or unmodified\";[\"insert\",\"update\",\"delete\"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var x,w,v;return((x=y.filter)===null||x===void 0?void 0:x.event)===\"*\"||((v=(w=y.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===a}).map(y=>y.callback(f,n)):(i=this.bindings[a])===null||i===void 0||i.filter(y=>{var x,w,v,m,p,g;if([\"broadcast\",\"presence\",\"postgres_changes\"].includes(a))if(\"id\"in y){const b=y.id,S=(x=y.filter)===null||x===void 0?void 0:x.event;return b&&((w=r.ids)===null||w===void 0?void 0:w.includes(b))&&(S===\"*\"||(S==null?void 0:S.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const b=(p=(m=y==null?void 0:y.filter)===null||m===void 0?void 0:m.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return b===\"*\"||b===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===a}).map(y=>{if(typeof f==\"object\"&&\"ids\"in f){const x=f.data,{schema:w,table:v,commit_timestamp:m,type:p,errors:g}=x;f=Object.assign(Object.assign({},{schema:w,table:v,commit_timestamp:m,eventType:p,new:{},old:{},errors:g}),this._getPayloadRecords(x))}y.callback(f,n)})}_isClosed(){return this.state===me.closed}_isJoined(){return this.state===me.joined}_isJoining(){return this.state===me.joining}_isLeaving(){return this.state===me.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Gu.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(mt.close,{},e)}_onError(e){this._on(mt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=me.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type===\"INSERT\"||e.type===\"UPDATE\")&&(r.new=Td(e.columns,e.record)),(e.type===\"UPDATE\"||e.type===\"DELETE\")&&(r.old=Td(e.columns,e.old_record)),r}}const _o=()=>{},Ri={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},wx=[1e3,2e3,5e3,1e4],bx=1e4,kx=`\n  addEventListener(\"message\", (e) => {\n    if (e.data.event === \"start\") {\n      setInterval(() => postMessage({ event: \"keepAlive\" }), e.data.interval);\n    }\n  });`;class _x{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint=\"\",this.httpEndpoint=\"\",this.headers={},this.params={},this.timeout=Il,this.transport=null,this.heartbeatIntervalMs=Ri.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=_o,this.ref=0,this.reconnectTimer=null,this.logger=_o,this.conn=null,this.sendBuffer=[],this.serializer=new fx,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState=\"disconnected\",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>\"u\"?i=(...a)=>li(async()=>{const{default:l}=await Promise.resolve().then(()=>ts);return{default:l}},void 0).then(({default:l})=>l(...a)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error(\"API key is required to connect to Realtime\");this.apiKey=r.params.apikey,this.endPoint=`${e}/${$l.websocket}`,this.httpEndpoint=e0(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState(\"connecting\"),this._setAuthSafely(\"connect\"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ox.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState(\"disconnected\");const r=e.message;throw r.includes(\"Node.js\")?new Error(`${r}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the \"ws\" package:\n\n  npm install ws\n\n  import ws from \"ws\"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cx}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState(\"disconnecting\",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState(\"disconnected\")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState(\"disconnected\")},e?this.conn.close(e,r??\"\"):this.conn.close(),this._teardownConnection()}else this._setConnectionState(\"disconnected\")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Cs.connecting:return Dr.Connecting;case Cs.open:return Dr.Open;case Cs.closing:return Dr.Closing;default:return Dr.Closed}}isConnected(){return this.connectionState()===Dr.Open}isConnecting(){return this._connectionState===\"connecting\"}isDisconnecting(){return this._connectionState===\"disconnecting\"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Gu(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,a=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log(\"push\",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback(\"disconnected\")}catch(r){this.log(\"error\",\"error in heartbeat callback\",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log(\"transport\",\"heartbeat timeout. Attempting to re-establish connection\");try{this.heartbeatCallback(\"timeout\")}catch(r){this.log(\"error\",\"error in heartbeat callback\",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(dx,\"heartbeat timeout\"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ri.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:\"phoenix\",event:\"heartbeat\",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback(\"sent\")}catch(r){this.log(\"error\",\"error in heartbeat callback\",r)}this._setAuthSafely(\"heartbeat\")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log(\"transport\",`leaving duplicate topic \"${e}\"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic===\"phoenix\"&&r.event===\"phx_reply\")try{this.heartbeatCallback(r.payload.status===\"ok\"?\"ok\":\"error\")}catch(c){this.log(\"error\",\"error in heartbeat callback\",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:a}=r,l=a?`(${a})`:\"\",u=i.status||\"\";this.log(\"receive\",`${u} ${n} ${s} ${l}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,i,a)),this._triggerStateCallbacks(\"message\",r)})}_clearTimer(e){var r;e===\"heartbeat\"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e===\"reconnect\"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer(\"heartbeat\"),this._clearTimer(\"reconnect\")}_setupConnectionHandlers(){this.conn&&(\"binaryType\"in this.conn&&(this.conn.binaryType=\"arraybuffer\"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState(\"connected\"),this.log(\"transport\",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer(\"reconnect\"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks(\"open\")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log(\"worker\",`starting worker for from ${this.workerUrl}`):this.log(\"worker\",\"starting default worker\");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log(\"worker\",\"worker error\",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event===\"keepAlive\"&&this.sendHeartbeat()},this.workerRef.postMessage({event:\"start\",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState(\"disconnected\"),this.log(\"transport\",\"close\",e),this._triggerChanError(),this._clearTimer(\"heartbeat\"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks(\"close\",e)}_onConnError(e){this._setConnectionState(\"disconnected\"),this.log(\"transport\",`${e}`),this._triggerChanError(),this._triggerStateCallbacks(\"error\",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(mt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\\?/)?\"&\":\"?\",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([kx],{type:\"application/javascript\"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e===\"connecting\"?this._wasManualDisconnect=!1:e===\"disconnecting\"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:ux};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(mt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e=\"general\"){this.setAuth().catch(r=>{this.log(\"error\",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log(\"error\",`error in ${e} callback`,s)}})}catch(n){this.log(\"error\",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Xp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ri.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,i,a,l,u,c,d;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Il,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Ri.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:_o,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:h=>wx[h-1]||bx,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,f)=>f(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<\"u\"&&!window.Worker)throw new Error(\"Web Worker is not supported\");this.workerUrl=e==null?void 0:e.workerUrl}}}class Qu extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name=\"StorageError\"}}function ge(t){return typeof t==\"object\"&&t!==null&&\"__isStorageError\"in t}class Sx extends Qu{constructor(e,r,n){super(e),this.name=\"StorageApiError\",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ul extends Qu{constructor(e,r){super(e),this.name=\"StorageUnknownError\",this.originalError=r}}var jx=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};const t0=t=>{let e;return t?e=t:typeof fetch>\"u\"?e=(...r)=>li(async()=>{const{default:n}=await Promise.resolve().then(()=>ts);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Nx=()=>jx(void 0,void 0,void 0,function*(){return typeof Response>\"u\"?(yield li(()=>Promise.resolve().then(()=>ts),void 0)).Response:Response}),Ml=t=>{if(Array.isArray(t))return t.map(r=>Ml(r));if(typeof t==\"function\"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,\"\"));e[s]=Ml(n)}),e},Cx=t=>{if(typeof t!=\"object\"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var an=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};const So=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ex=(t,e,r)=>an(void 0,void 0,void 0,function*(){const n=yield Nx();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const i=t.status||500,a=(s==null?void 0:s.statusCode)||i+\"\";e(new Sx(So(s),i,a))}).catch(s=>{e(new Ul(So(s),s))}):e(new Ul(So(t),t))}),Px=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t===\"GET\"||!n?s:(Cx(n)?(s.headers=Object.assign({\"Content-Type\":\"application/json\"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),r))};function ci(t,e,r,n,s,i){return an(this,void 0,void 0,function*(){return new Promise((a,l)=>{t(r,Px(e,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>Ex(u,l,n))})})}function ba(t,e,r,n){return an(this,void 0,void 0,function*(){return ci(t,\"GET\",e,r,n)})}function St(t,e,r,n,s){return an(this,void 0,void 0,function*(){return ci(t,\"POST\",e,n,s,r)})}function Fl(t,e,r,n,s){return an(this,void 0,void 0,function*(){return ci(t,\"PUT\",e,n,s,r)})}function Tx(t,e,r,n){return an(this,void 0,void 0,function*(){return ci(t,\"HEAD\",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function r0(t,e,r,n,s){return an(this,void 0,void 0,function*(){return ci(t,\"DELETE\",e,n,s,r)})}var Le=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};const Rx={limit:100,offset:0,sortBy:{column:\"name\",order:\"asc\"}},Ad={cacheControl:\"3600\",contentType:\"text/plain;charset=UTF-8\",upsert:!1};class Ox{constructor(e,r={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=t0(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,s){return Le(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Ad),s);let l=Object.assign(Object.assign({},this.headers),e===\"POST\"&&{\"x-upsert\":String(a.upsert)});const u=a.metadata;typeof Blob<\"u\"&&n instanceof Blob?(i=new FormData,i.append(\"cacheControl\",a.cacheControl),u&&i.append(\"metadata\",this.encodeMetadata(u)),i.append(\"\",n)):typeof FormData<\"u\"&&n instanceof FormData?(i=n,i.append(\"cacheControl\",a.cacheControl),u&&i.append(\"metadata\",this.encodeMetadata(u))):(i=n,l[\"cache-control\"]=`max-age=${a.cacheControl}`,l[\"content-type\"]=a.contentType,u&&(l[\"x-metadata\"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield(e==\"PUT\"?Fl:St)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ge(i))return{data:null,error:i};throw i}})}upload(e,r,n){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate(\"POST\",e,r,n)})}uploadToSignedUrl(e,r,n,s){return Le(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set(\"token\",r);try{let u;const c=Object.assign({upsert:Ad.upsert},s),d=Object.assign(Object.assign({},this.headers),{\"x-upsert\":String(c.upsert)});typeof Blob<\"u\"&&n instanceof Blob?(u=new FormData,u.append(\"cacheControl\",c.cacheControl),u.append(\"\",n)):typeof FormData<\"u\"&&n instanceof FormData?(u=n,u.append(\"cacheControl\",c.cacheControl)):(u=n,d[\"cache-control\"]=`max-age=${c.cacheControl}`,d[\"content-type\"]=c.contentType);const h=yield Fl(this.fetch,l.toString(),u,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ge(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,r){return Le(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s[\"x-upsert\"]=\"true\");const i=yield St(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),l=a.searchParams.get(\"token\");if(!l)throw new Qu(\"No token returned by API\");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}update(e,r,n){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate(\"PUT\",e,r,n)})}move(e,r,n){return Le(this,void 0,void 0,function*(){try{return{data:yield St(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ge(s))return{data:null,error:s};throw s}})}copy(e,r,n){return Le(this,void 0,void 0,function*(){try{return{data:{path:(yield St(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ge(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return Le(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield St(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?\"\":n.download}`:\"\";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ge(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return Le(this,void 0,void 0,function*(){try{const s=yield St(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?\"\":n.download}`:\"\";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ge(s))return{data:null,error:s};throw s}})}download(e,r){return Le(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<\"u\"?\"render/image/authenticated\":\"object\",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:\"\";try{const l=this._getFinalPath(e);return{data:yield(yield ba(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ge(l))return{data:null,error:l};throw l}})}info(e){return Le(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield ba(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ml(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}exists(e){return Le(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Tx(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n)&&n instanceof Ul){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r!=null&&r.download?`download=${r.download===!0?\"\":r.download}`:\"\";i!==\"\"&&s.push(i);const l=typeof(r==null?void 0:r.transform)<\"u\"?\"render/image\":\"object\",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==\"\"&&s.push(u);let c=s.join(\"&\");return c!==\"\"&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${c}`)}}}remove(e){return Le(this,void 0,void 0,function*(){try{return{data:yield r0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ge(r))return{data:null,error:r};throw r}})}list(e,r,n){return Le(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Rx),r),{prefix:e||\"\"});return{data:yield St(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ge(s))return{data:null,error:s};throw s}})}listV2(e,r){return Le(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield St(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<\"u\"?Buffer.from(e).toString(\"base64\"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\\/+/,\"\")}`}_removeEmptyFolders(e){return e.replace(/^\\/|\\/$/g,\"\").replace(/\\/+/g,\"/\")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join(\"&\")}}const Ax=\"2.12.1\",Lx={\"X-Client-Info\":`storage-js/${Ax}`};var ln=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};class Ix{constructor(e,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes(\"storage.supabase.\")&&(i.hostname=i.hostname.replace(\"supabase.\",\"storage.supabase.\")),this.url=i.href,this.headers=Object.assign(Object.assign({},Lx),r),this.fetch=t0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ln(this,void 0,void 0,function*(){try{return{data:yield ba(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ge(e))return{data:null,error:e};throw e}})}getBucket(e){return ln(this,void 0,void 0,function*(){try{return{data:yield ba(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ge(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return ln(this,void 0,void 0,function*(){try{return{data:yield St(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return ln(this,void 0,void 0,function*(){try{return{data:yield Fl(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ln(this,void 0,void 0,function*(){try{return{data:yield St(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ge(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ln(this,void 0,void 0,function*(){try{return{data:yield r0(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ge(r))return{data:null,error:r};throw r}})}}class $x extends Ix{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new Ox(this.url,this.headers,e,this.fetch)}}const Dx=\"2.57.4\";let gs=\"\";typeof Deno<\"u\"?gs=\"deno\":typeof document<\"u\"?gs=\"web\":typeof navigator<\"u\"&&navigator.product===\"ReactNative\"?gs=\"react-native\":gs=\"node\";const Ux={\"X-Client-Info\":`supabase-js-${gs}/${Dx}`},Mx={headers:Ux},Fx={schema:\"public\"},zx={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:\"implicit\"},Bx={};var Hx=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};const Wx=t=>{let e;return t?e=t:typeof fetch>\"u\"?e=zp:e=fetch,(...r)=>e(...r)},Vx=()=>typeof Headers>\"u\"?Bp:Headers,qx=(t,e,r)=>{const n=Wx(r),s=Vx();return(i,a)=>Hx(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let c=new s(a==null?void 0:a.headers);return c.has(\"apikey\")||c.set(\"apikey\",t),c.has(\"Authorization\")||c.set(\"Authorization\",`Bearer ${u}`),n(i,Object.assign(Object.assign({},a),{headers:c}))})};var Kx=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};function Gx(t){return t.endsWith(\"/\")?t:t+\"/\"}function Qx(t,e){var r,n;const{db:s,auth:i,realtime:a,global:l}=t,{db:u,auth:c,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},u),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Kx(this,void 0,void 0,function*(){return\"\"})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function Jx(t){const e=t==null?void 0:t.trim();if(!e)throw new Error(\"supabaseUrl is required.\");if(!e.match(/^https?:\\/\\//i))throw new Error(\"Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.\");try{return new URL(Gx(e))}catch{throw Error(\"Invalid supabaseUrl: Provided URL is malformed.\")}}const n0=\"2.71.1\",fn=30*1e3,zl=3,jo=zl*fn,Yx=\"http://localhost:9999\",Xx=\"supabase.auth.token\",Zx={\"X-Client-Info\":`gotrue-js/${n0}`},Bl=\"X-Supabase-Api-Version\",s0={\"2024-01-01\":{timestamp:Date.parse(\"2024-01-01T00:00:00.0Z\"),name:\"2024-01-01\"}},ew=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,tw=10*60*1e3;class Ju extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name=\"AuthError\",this.status=r,this.code=n}}function B(t){return typeof t==\"object\"&&t!==null&&\"__isAuthError\"in t}class rw extends Ju{constructor(e,r,n){super(e,r,n),this.name=\"AuthApiError\",this.status=r,this.code=n}}function nw(t){return B(t)&&t.name===\"AuthApiError\"}class i0 extends Ju{constructor(e,r){super(e),this.name=\"AuthUnknownError\",this.originalError=r}}class Er extends Ju{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class Yt extends Er{constructor(){super(\"Auth session missing!\",\"AuthSessionMissingError\",400,void 0)}}function sw(t){return B(t)&&t.name===\"AuthSessionMissingError\"}class Oi extends Er{constructor(){super(\"Auth session or user missing\",\"AuthInvalidTokenResponseError\",500,void 0)}}class Ai extends Er{constructor(e){super(e,\"AuthInvalidCredentialsError\",400,void 0)}}class Li extends Er{constructor(e,r=null){super(e,\"AuthImplicitGrantRedirectError\",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function iw(t){return B(t)&&t.name===\"AuthImplicitGrantRedirectError\"}class Ld extends Er{constructor(e,r=null){super(e,\"AuthPKCEGrantCodeExchangeError\",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hl extends Er{constructor(e,r){super(e,\"AuthRetryableFetchError\",r,void 0)}}function No(t){return B(t)&&t.name===\"AuthRetryableFetchError\"}class Id extends Er{constructor(e,r,n){super(e,\"AuthWeakPasswordError\",r,\"weak_password\"),this.reasons=n}}class Wl extends Er{constructor(e){super(e,\"AuthInvalidJwtError\",400,\"invalid_jwt\")}}const ka=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\".split(\"\"),$d=` \t\n\\r=`.split(\"\"),aw=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<$d.length;e+=1)t[$d[e].charCodeAt(0)]=-2;for(let e=0;e<ka.length;e+=1)t[ka[e].charCodeAt(0)]=e;return t})();function Dd(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(ka[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(ka[n]),e.queuedBits-=6}}function a0(t,e,r){const n=aw[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character \"${String.fromCharCode(t)}\"`)}}function Ud(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{uw(a,n,r)};for(let a=0;a<t.length;a+=1)a0(t.charCodeAt(a),s,i);return e.join(\"\")}function ow(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function lw(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}ow(n,e)}}function uw(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error(\"Invalid UTF-8 sequence\");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error(\"Invalid UTF-8 sequence\");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function cw(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)a0(t.charCodeAt(s),r,n);return new Uint8Array(e)}function dw(t){const e=[];return lw(t,r=>e.push(r)),new Uint8Array(e)}function hw(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>Dd(s,r,n)),Dd(null,r,n),e.join(\"\")}function fw(t){return Math.round(Date.now()/1e3)+t}function pw(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t==\"x\"?e:e&3|8).toString(16)})}const ct=()=>typeof window<\"u\"&&typeof document<\"u\",Or={tested:!1,writable:!1},o0=()=>{if(!ct())return!1;try{if(typeof globalThis.localStorage!=\"object\")return!1}catch{return!1}if(Or.tested)return Or.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Or.tested=!0,Or.writable=!0}catch{Or.tested=!0,Or.writable=!1}return Or.writable};function mw(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]===\"#\")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const l0=t=>{let e;return t?e=t:typeof fetch>\"u\"?e=(...r)=>li(async()=>{const{default:n}=await Promise.resolve().then(()=>ts);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},gw=t=>typeof t==\"object\"&&t!==null&&\"status\"in t&&\"ok\"in t&&\"json\"in t&&typeof t.json==\"function\",pn=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Ar=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Qt=async(t,e)=>{await t.removeItem(e)};class Va{constructor(){this.promise=new Va.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Va.promiseConstructor=Promise;function Co(t){const e=t.split(\".\");if(e.length!==3)throw new Wl(\"Invalid JWT structure\");for(let n=0;n<e.length;n++)if(!ew.test(e[n]))throw new Wl(\"JWT not in base64url format\");return{header:JSON.parse(Ud(e[0])),payload:JSON.parse(Ud(e[1])),signature:cw(e[2]),raw:{header:e[0],payload:e[1]}}}async function vw(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function yw(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){n(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function xw(t){return(\"0\"+t.toString(16)).substr(-2)}function ww(){const e=new Uint32Array(56);if(typeof crypto>\"u\"){const r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~\",n=r.length;let s=\"\";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,xw).join(\"\")}async function bw(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest(\"SHA-256\",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join(\"\")}async function kw(t){if(!(typeof crypto<\"u\"&&typeof crypto.subtle<\"u\"&&typeof TextEncoder<\"u\"))return console.warn(\"WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256.\"),t;const r=await bw(t);return btoa(r).replace(/\\+/g,\"-\").replace(/\\//g,\"_\").replace(/=+$/,\"\")}async function un(t,e,r=!1){const n=ww();let s=n;r&&(s+=\"/PASSWORD_RECOVERY\"),await pn(t,`${e}-code-verifier`,s);const i=await kw(n);return[i,n===i?\"plain\":\"s256\"]}const _w=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Sw(t){const e=t.headers.get(Bl);if(!e||!e.match(_w))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function jw(t){if(!t)throw new Error(\"Missing exp claim\");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error(\"JWT has expired\")}function Nw(t){switch(t){case\"RS256\":return{name:\"RSASSA-PKCS1-v1_5\",hash:{name:\"SHA-256\"}};case\"ES256\":return{name:\"ECDSA\",namedCurve:\"P-256\",hash:{name:\"SHA-256\"}};default:throw new Error(\"Invalid alg claim\")}}const Cw=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function cn(t){if(!Cw.test(t))throw new Error(\"@supabase/auth-js: Expected parameter to be UUID but is not\")}function Eo(){const t={};return new Proxy(t,{get:(e,r)=>{if(r===\"__isUserNotAvailableProxy\")return!0;if(typeof r==\"symbol\"){const n=r.toString();if(n===\"Symbol(Symbol.toPrimitive)\"||n===\"Symbol(Symbol.toStringTag)\"||n===\"Symbol(util.inspect.custom)\")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the \"${r}\" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the \"${r}\" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the \"${r}\" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Md(t){return JSON.parse(JSON.stringify(t))}var Ew=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols==\"function\")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const $r=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Pw=[502,503,504];async function Fd(t){var e;if(!gw(t))throw new Hl($r(t),0);if(Pw.includes(t.status))throw new Hl($r(t),t.status);let r;try{r=await t.json()}catch(i){throw new i0($r(i),i)}let n;const s=Sw(t);if(s&&s.getTime()>=s0[\"2024-01-01\"].timestamp&&typeof r==\"object\"&&r&&typeof r.code==\"string\"?n=r.code:typeof r==\"object\"&&r&&typeof r.error_code==\"string\"&&(n=r.error_code),n){if(n===\"weak_password\")throw new Id($r(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n===\"session_not_found\")throw new Yt}else if(typeof r==\"object\"&&r&&typeof r.weak_password==\"object\"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a==\"string\",!0))throw new Id($r(r),t.status,r.weak_password.reasons);throw new rw($r(r),t.status||500,n)}const Tw=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t===\"GET\"?s:(s.headers=Object.assign({\"Content-Type\":\"application/json;charset=UTF-8\"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function V(t,e,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Bl]||(i[Bl]=s0[\"2024-01-01\"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?\"?\"+new URLSearchParams(a).toString():\"\",u=await Rw(t,e,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function Rw(t,e,r,n,s,i){const a=Tw(e,n,s,i);let l;try{l=await t(r,Object.assign({},a))}catch(u){throw console.error(u),new Hl($r(u),0)}if(l.ok||await Fd(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(u){await Fd(u)}}function Ot(t){var e;let r=null;Iw(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=fw(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function zd(t){const e=Ot(t);return!e.error&&t.weak_password&&typeof t.weak_password==\"object\"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message==\"string\"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n==\"string\",!0)&&(e.data.weak_password=t.weak_password),e}function rr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Ow(t){return{data:t,error:null}}function Aw(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,a=Ew(t,[\"action_link\",\"email_otp\",\"hashed_token\",\"redirect_to\",\"verification_type\"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},a);return{data:{properties:l,user:u},error:null}}function Lw(t){return t}function Iw(t){return t.access_token&&t.refresh_token&&t.expires_in}const Po=[\"global\",\"local\",\"others\"];var $w=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols==\"function\")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class Dw{constructor({url:e=\"\",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=l0(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Po[0]){if(Po.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Po.join(\", \")}`);try{return await V(this.fetch,\"POST\",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(B(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await V(this.fetch,\"POST\",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:rr})}catch(n){if(B(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=$w(e,[\"options\"]),s=Object.assign(Object.assign({},n),r);return\"newEmail\"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await V(this.fetch,\"POST\",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Aw,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(B(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await V(this.fetch,\"POST\",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:rr})}catch(r){if(B(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,a,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await V(this.fetch,\"GET\",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:\"\",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:\"\"},xform:Lw});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get(\"x-total-count\"))!==null&&a!==void 0?a:0,y=(u=(l=d.headers.get(\"link\"))===null||l===void 0?void 0:l.split(\",\"))!==null&&u!==void 0?u:[];return y.length>0&&(y.forEach(x=>{const w=parseInt(x.split(\";\")[0].split(\"=\")[1].substring(0,1)),v=JSON.parse(x.split(\";\")[1].split(\"=\")[1]);c[`${v}Page`]=w}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(B(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){cn(e);try{return await V(this.fetch,\"GET\",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:rr})}catch(r){if(B(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){cn(e);try{return await V(this.fetch,\"PUT\",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:rr})}catch(n){if(B(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){cn(e);try{return await V(this.fetch,\"DELETE\",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:rr})}catch(n){if(B(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){cn(e.userId);try{const{data:r,error:n}=await V(this.fetch,\"GET\",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(B(r))return{data:null,error:r};throw r}}async _deleteFactor(e){cn(e.userId),cn(e.id);try{return{data:await V(this.fetch,\"DELETE\",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(B(r))return{data:null,error:r};throw r}}}function Bd(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Uw(){if(typeof globalThis!=\"object\")try{Object.defineProperty(Object.prototype,\"__magic__\",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<\"u\"&&(self.globalThis=self)}}const dn={debug:!!(globalThis&&o0()&&globalThis.localStorage&&globalThis.localStorage.getItem(\"supabase.gotrue-js.locks.debug\")===\"true\")};class u0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Mw extends u0{}async function Fw(t,e,r){dn.debug&&console.log(\"@supabase/gotrue-js: navigatorLock: acquire lock\",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),dn.debug&&console.log(\"@supabase/gotrue-js: navigatorLock acquire timed out\",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:\"exclusive\",ifAvailable:!0}:{mode:\"exclusive\",signal:n.signal},async s=>{if(s){dn.debug&&console.log(\"@supabase/gotrue-js: navigatorLock: acquired\",t,s.name);try{return await r()}finally{dn.debug&&console.log(\"@supabase/gotrue-js: navigatorLock: released\",t,s.name)}}else{if(e===0)throw dn.debug&&console.log(\"@supabase/gotrue-js: navigatorLock: not immediately available\",t),new Mw(`Acquiring an exclusive Navigator LockManager lock \"${t}\" immediately failed`);if(dn.debug)try{const i=await globalThis.navigator.locks.query();console.log(\"@supabase/gotrue-js: Navigator LockManager state\",JSON.stringify(i,null,\"  \"))}catch(i){console.warn(\"@supabase/gotrue-js: Error when querying Navigator LockManager state\",i)}return console.warn(\"@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request\"),await r()}}))}Uw();const zw={url:Yx,storageKey:Xx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Zx,flowType:\"implicit\",debug:!1,hasCustomAuthorizationHeader:!1};async function Hd(t,e,r){return await r()}const hn={};class Js{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Js.nextInstanceID,Js.nextInstanceID+=1,this.instanceID>0&&ct()&&console.warn(\"Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.\");const s=Object.assign(Object.assign({},zw),e);if(this.logDebugMessages=!!s.debug,typeof s.debug==\"function\"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Dw({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=l0(s.fetch),this.lock=s.lock||Hd,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:ct()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Fw:this.lock=Hd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:o0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Bd(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Bd(this.memoryStorage)),ct()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error(\"Failed to create a new BroadcastChannel, multi-tab state changes will not be available\",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener(\"message\",async i=>{this._debug(\"received broadcast notification from other tab or client\",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=hn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){hn[this.storageKey]=Object.assign(Object.assign({},hn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=hn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){hn[this.storageKey]=Object.assign(Object.assign({},hn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${n0}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=mw(window.location.href);let n=\"none\";if(this._isImplicitGrantCallback(r)?n=\"implicit\":await this._isPKCECallback(r)&&(n=\"pkce\"),ct()&&this.detectSessionInUrl&&n!==\"none\"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug(\"#_initialize()\",\"error detecting session from URL\",i),iw(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u===\"identity_already_exists\"||u===\"identity_not_found\"||u===\"single_identity_not_deletable\")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=s;return this._debug(\"#_initialize()\",\"detected session in URL\",a,\"redirect type\",l),await this._saveSession(a),setTimeout(async()=>{l===\"recovery\"?await this._notifyAllSubscribers(\"PASSWORD_RECOVERY\",a):await this._notifyAllSubscribers(\"SIGNED_IN\",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return B(r)?{error:r}:{error:new i0(\"Unexpected error during initialization\",r)}}finally{await this._handleVisibilityChange(),this._debug(\"#_initialize()\",\"end\")}}async signInAnonymously(e){var r,n,s;try{const i=await V(this.fetch,\"POST\",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ot}),{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const u=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers(\"SIGNED_IN\",u)),{data:{user:c,session:u},error:null}}catch(i){if(B(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,s;try{let i;if(\"email\"in e){const{email:d,password:h,options:f}=e;let y=null,x=null;this.flowType===\"pkce\"&&([y,x]=await un(this.storage,this.storageKey)),i=await V(this.fetch,\"POST\",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:y,code_challenge_method:x},xform:Ot})}else if(\"phone\"in e){const{phone:d,password:h,options:f}=e;i=await V(this.fetch,\"POST\",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:\"sms\",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ot})}else throw new Ai(\"You must provide either an email or phone number and a password\");const{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const u=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers(\"SIGNED_IN\",u)),{data:{user:c,session:u},error:null}}catch(i){if(B(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if(\"email\"in e){const{email:i,password:a,options:l}=e;r=await V(this.fetch,\"POST\",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zd})}else if(\"phone\"in e){const{phone:i,password:a,options:l}=e;r=await V(this.fetch,\"POST\",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zd})}else throw new Ai(\"You must provide either an email or phone number and a password\");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Oi}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers(\"SIGNED_IN\",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(B(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r===\"solana\")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain \"${r}\"`)}async signInWithSolana(e){var r,n,s,i,a,l,u,c,d,h,f,y;let x,w;if(\"message\"in e)x=e.message,w=e.signature;else{const{chain:v,wallet:m,statement:p,options:g}=e;let b;if(ct())if(typeof m==\"object\")b=m;else{const j=window;if(\"solana\"in j&&typeof j.solana==\"object\"&&(\"signIn\"in j.solana&&typeof j.solana.signIn==\"function\"||\"signMessage\"in j.solana&&typeof j.solana.signMessage==\"function\"))b=j.solana;else throw new Error(\"@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.\")}else{if(typeof m!=\"object\"||!(g!=null&&g.url))throw new Error(\"@supabase/auth-js: Both wallet and url must be specified in non-browser environments.\");b=m}const S=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if(\"signIn\"in b&&b.signIn){const j=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:\"1\",domain:S.host,uri:S.href}),p?{statement:p}:null));let N;if(Array.isArray(j)&&j[0]&&typeof j[0]==\"object\")N=j[0];else if(j&&typeof j==\"object\"&&\"signedMessage\"in j&&\"signature\"in j)N=j;else throw new Error(\"@supabase/auth-js: Wallet method signIn() returned unrecognized value\");if(\"signedMessage\"in N&&\"signature\"in N&&(typeof N.signedMessage==\"string\"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)x=typeof N.signedMessage==\"string\"?N.signedMessage:new TextDecoder().decode(N.signedMessage),w=N.signature;else throw new Error(\"@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields\")}else{if(!(\"signMessage\"in b)||typeof b.signMessage!=\"function\"||!(\"publicKey\"in b)||typeof b!=\"object\"||!b.publicKey||!(\"toBase58\"in b.publicKey)||typeof b.publicKey.toBase58!=\"function\")throw new Error(\"@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API\");x=[`${S.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...p?[\"\",p,\"\"]:[\"\"],\"Version: 1\",`URI: ${S.href}`,`Issued At: ${(s=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?[\"Resources\",...g.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`\n`);const j=await b.signMessage(new TextEncoder().encode(x),\"utf8\");if(!j||!(j instanceof Uint8Array))throw new Error(\"@supabase/auth-js: Wallet signMessage() API returned an recognized value\");w=j}}try{const{data:v,error:m}=await V(this.fetch,\"POST\",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:\"solana\",message:x,signature:hw(w)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Ot});if(m)throw m;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Oi}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers(\"SIGNED_IN\",v.session)),{data:Object.assign({},v),error:m})}catch(v){if(B(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const r=await Ar(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??\"\").split(\"/\");try{const{data:i,error:a}=await V(this.fetch,\"POST\",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ot});if(await Qt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Oi}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers(\"SIGNED_IN\",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(B(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=e,l=await V(this.fetch,\"POST\",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ot}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Oi}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers(\"SIGNED_IN\",u.session)),{data:u,error:c})}catch(r){if(B(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,i,a;try{if(\"email\"in e){const{email:l,options:u}=e;let c=null,d=null;this.flowType===\"pkce\"&&([c,d]=await un(this.storage,this.storageKey));const{error:h}=await V(this.fetch,\"POST\",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if(\"phone\"in e){const{phone:l,options:u}=e,{data:c,error:d}=await V(this.fetch,\"POST\",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:\"sms\"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Ai(\"You must provide either an email or phone number.\")}catch(l){if(B(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,n;try{let s,i;\"options\"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await V(this.fetch,\"POST\",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Ot});if(l)throw l;if(!a)throw new Error(\"An error occurred on token verification.\");const u=a.session,c=a.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type==\"recovery\"?\"PASSWORD_RECOVERY\":\"SIGNED_IN\",u)),{data:{user:c,session:u},error:null}}catch(s){if(B(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let i=null,a=null;return this.flowType===\"pkce\"&&([i,a]=await un(this.storage,this.storageKey)),await V(this.fetch,\"POST\",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},\"providerId\"in e?{provider_id:e.providerId}:null),\"domain\"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Ow})}catch(i){if(B(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Yt;const{error:s}=await V(this.fetch,\"GET\",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(B(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if(\"email\"in e){const{email:n,type:s,options:i}=e,{error:a}=await V(this.fetch,\"POST\",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if(\"phone\"in e){const{phone:n,type:s,options:i}=e,{data:a,error:l}=await V(this.fetch,\"POST\",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new Ai(\"You must provide either an email or phone number and a type\")}catch(r){if(B(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug(\"#_acquireLock\",\"begin\",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug(\"#_acquireLock\",\"lock acquired for storage key\",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug(\"#_acquireLock\",\"lock released for storage key\",this.storageKey),this.lockAcquired=!1}})}finally{this._debug(\"#_acquireLock\",\"end\")}}async _useSession(e){this._debug(\"#_useSession\",\"begin\");try{const r=await this.__loadSession();return await e(r)}finally{this._debug(\"#_useSession\",\"end\")}}async __loadSession(){this._debug(\"#__loadSession()\",\"begin\"),this.lockAcquired||this._debug(\"#__loadSession()\",\"used outside of an acquired lock!\",new Error().stack);try{let e=null;const r=await Ar(this.storage,this.storageKey);if(this._debug(\"#getSession()\",\"session from storage\",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug(\"#getSession()\",\"session from storage is not valid\"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<jo:!1;if(this._debug(\"#__loadSession()\",`session has${n?\"\":\" not\"} expired`,\"expires_at\",e.expires_at),!n){if(this.userStorage){const a=await Ar(this.userStorage,this.storageKey+\"-user\");a!=null&&a.user?e.user=a.user:e.user=Eo()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,c,d)=>(!a&&c===\"user\"&&(console.warn(\"Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.\"),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug(\"#__loadSession()\",\"end\")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await V(this.fetch,\"GET\",`${this.url}/user`,{headers:this.headers,jwt:e,xform:rr}):await this._useSession(async r=>{var n,s,i;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Yt}:await V(this.fetch,\"GET\",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:rr})})}catch(r){if(B(r))return sw(r)&&(await this._removeSession(),await Qt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Yt;const a=s.session;let l=null,u=null;this.flowType===\"pkce\"&&e.email!=null&&([l,u]=await un(this.storage,this.storageKey));const{data:c,error:d}=await V(this.fetch,\"PUT\",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:a.access_token,xform:rr});if(d)throw d;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers(\"USER_UPDATED\",a),{data:{user:a.user},error:null}})}catch(n){if(B(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Yt;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=Co(e.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:\"bearer\",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers(\"SIGNED_IN\",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(B(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:l}=r;if(l)throw l;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Yt;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(B(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!ct())throw new Li(\"No browser detected.\");if(e.error||e.error_description||e.error_code)throw new Li(e.error_description||\"Error in URL with unspecified error_description\",{error:e.error||\"unspecified_error\",code:e.error_code||\"unspecified_code\"});switch(r){case\"implicit\":if(this.flowType===\"pkce\")throw new Ld(\"Not a valid PKCE flow url.\");break;case\"pkce\":if(this.flowType===\"implicit\")throw new Li(\"Not a valid implicit grant flow url.\");break;default:}if(r===\"pkce\"){if(this._debug(\"#_initialize()\",\"begin\",\"is PKCE flow\",!0),!e.code)throw new Ld(\"No code detected.\");const{data:p,error:g}=await this._exchangeCodeForSession(e.code);if(g)throw g;const b=new URL(window.location.href);return b.searchParams.delete(\"code\"),window.history.replaceState(window.history.state,\"\",b.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:l,expires_at:u,token_type:c}=e;if(!i||!l||!a||!c)throw new Li(\"No session defined in URL\");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;u&&(f=parseInt(u));const y=f-d;y*1e3<=fn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${h}s`);const x=f-h;d-x>=120?console.warn(\"@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale\",x,f,d):d-x<0&&console.warn(\"@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew\",x,f,d);const{data:w,error:v}=await this._getUser(i);if(v)throw v;const m={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:c,user:w.user};return window.location.hash=\"\",this._debug(\"#_getSessionFromURL()\",\"clearing window.location.hash\"),{data:{session:m,redirectType:e.type},error:null}}catch(n){if(B(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Ar(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:\"global\"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:\"global\"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(nw(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!==\"others\"&&(await this._removeSession(),await Qt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=pw(),n={id:r,callback:e,unsubscribe:()=>{this._debug(\"#unsubscribe()\",\"state change callback with id removed\",r),this.stateChangeEmitters.delete(r)}};return this._debug(\"#onAuthStateChange()\",\"registered callback with id\",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback(\"INITIAL_SESSION\",i)),this._debug(\"INITIAL_SESSION\",\"callback id\",e,\"session\",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback(\"INITIAL_SESSION\",null)),this._debug(\"INITIAL_SESSION\",\"callback id\",e,\"error\",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType===\"pkce\"&&([n,s]=await un(this.storage,this.storageKey,!0));try{return await V(this.fetch,\"POST\",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(B(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(B(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,l,u,c,d;const{data:h,error:f}=i;if(f)throw f;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await V(this.fetch,\"GET\",y,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return ct()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(B(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await V(this.fetch,\"DELETE\",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(B(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,\"begin\");try{const n=Date.now();return await yw(async s=>(s>0&&await vw(200*Math.pow(2,s-1)),this._debug(r,\"refreshing attempt\",s),await V(this.fetch,\"POST\",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ot})),(s,i)=>{const a=200*Math.pow(2,s);return i&&No(i)&&Date.now()+a-n<fn})}catch(n){if(this._debug(r,\"error\",n),B(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,\"end\")}}_isValidSession(e){return typeof e==\"object\"&&e!==null&&\"access_token\"in e&&\"refresh_token\"in e&&\"expires_at\"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug(\"#_handleProviderSignIn()\",\"provider\",e,\"options\",r,\"url\",n),ct()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n=\"#_recoverAndRefresh()\";this._debug(n,\"begin\");try{const s=await Ar(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Ar(this.userStorage,this.storageKey+\"-user\");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await pn(this.userStorage,this.storageKey+\"-user\",a)),s.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Eo()}else if(s&&!s.user&&!s.user){const a=await Ar(this.storage,this.storageKey+\"-user\");a&&(a!=null&&a.user)?(s.user=a.user,await Qt(this.storage,this.storageKey+\"-user\"),await pn(this.storage,this.storageKey,s)):s.user=Eo()}if(this._debug(n,\"session from storage\",s),!this._isValidSession(s)){this._debug(n,\"session is not valid\"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<jo;if(this._debug(n,`session has${i?\"\":\" not\"} expired with margin of ${jo}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),No(a)||(this._debug(n,\"refresh failed with a non-retryable error, removing the session\",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(s.access_token);!l&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers(\"SIGNED_IN\",s)):this._debug(n,\"could not get user data, skipping SIGNED_IN notification\")}catch(a){console.error(\"Error getting user data:\",a),this._debug(n,\"error getting user data, skipping SIGNED_IN notification\",a)}else await this._notifyAllSubscribers(\"SIGNED_IN\",s)}catch(s){this._debug(n,\"error\",s),console.error(s);return}finally{this._debug(n,\"end\")}}async _callRefreshToken(e){var r,n;if(!e)throw new Yt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,\"begin\");try{this.refreshingDeferred=new Va;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Yt;await this._saveSession(i.session),await this._notifyAllSubscribers(\"TOKEN_REFRESHED\",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,\"error\",i),B(i)){const a={session:null,error:i};return No(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,\"end\")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,\"begin\",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(u){i.push(u)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,\"end\")}}async _saveSession(e){this._debug(\"#_saveSession()\",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await pn(this.userStorage,this.storageKey+\"-user\",{user:r.user});const s=Object.assign({},r);delete s.user;const i=Md(s);await pn(this.storage,this.storageKey,i)}else{const s=Md(r);await pn(this.storage,this.storageKey,s)}}async _removeSession(){this._debug(\"#_removeSession()\"),await Qt(this.storage,this.storageKey),await Qt(this.storage,this.storageKey+\"-code-verifier\"),await Qt(this.storage,this.storageKey+\"-user\"),this.userStorage&&await Qt(this.userStorage,this.storageKey+\"-user\"),await this._notifyAllSubscribers(\"SIGNED_OUT\",null)}_removeVisibilityChangedCallback(){this._debug(\"#_removeVisibilityChangedCallback()\");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ct()&&(window!=null&&window.removeEventListener)&&window.removeEventListener(\"visibilitychange\",e)}catch(r){console.error(\"removing visibilitychange callback failed\",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug(\"#_startAutoRefresh()\");const e=setInterval(()=>this._autoRefreshTokenTick(),fn);this.autoRefreshTicker=e,e&&typeof e==\"object\"&&typeof e.unref==\"function\"?e.unref():typeof Deno<\"u\"&&typeof Deno.unrefTimer==\"function\"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug(\"#_stopAutoRefresh()\");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug(\"#_autoRefreshTokenTick()\",\"begin\");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug(\"#_autoRefreshTokenTick()\",\"no session\");return}const s=Math.floor((n.expires_at*1e3-e)/fn);this._debug(\"#_autoRefreshTokenTick()\",`access token expires in ${s} ticks, a tick lasts ${fn}ms, refresh threshold is ${zl} ticks`),s<=zl&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error(\"Auto refresh tick failed with error. This is likely a transient error.\",r)}}finally{this._debug(\"#_autoRefreshTokenTick()\",\"end\")}})}catch(e){if(e.isAcquireTimeout||e instanceof u0)this._debug(\"auto refresh token tick lock not available\");else throw e}}async _handleVisibilityChange(){if(this._debug(\"#_handleVisibilityChange()\"),!ct()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener(\"visibilitychange\",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error(\"_handleVisibilityChange\",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,\"visibilityState\",document.visibilityState),document.visibilityState===\"visible\"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!==\"visible\"){this._debug(r,\"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting\");return}await this._recoverAndRefresh()}))):document.visibilityState===\"hidden\"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType===\"pkce\"){const[i,a]=await un(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join(\"&\")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await V(this.fetch,\"DELETE\",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(B(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType===\"phone\"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:c}=await V(this.fetch,\"POST\",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType===\"totp\"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(B(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:l}=await V(this.fetch,\"POST\",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers(\"MFA_CHALLENGE_VERIFIED\",a),{data:a,error:l})})}catch(r){if(B(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await V(this.fetch,\"POST\",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(B(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],s=n.filter(a=>a.factor_type===\"totp\"&&a.status===\"verified\"),i=n.filter(a=>a.factor_type===\"phone\"&&a.status===\"verified\");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Co(s.access_token);let l=null;a.aal&&(l=a.aal);let u=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status===\"verified\"))!==null&&n!==void 0?n:[]).length>0&&(u=\"aal2\");const d=a.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+tw>s)return n;const{data:i,error:a}=await V(this.fetch,\"GET\",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:y,error:x}=await this.getSession();if(x||!y.session)return{data:null,error:x};n=y.session.access_token}const{header:s,payload:i,signature:a,raw:{header:l,payload:u}}=Co(n);r!=null&&r.allowExpired||jw(i.exp);const c=!s.alg||s.alg.startsWith(\"HS\")||!s.kid||!(\"crypto\"in globalThis&&\"subtle\"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:i,header:s,signature:a},error:null}}const d=Nw(s.alg),h=await crypto.subtle.importKey(\"jwk\",c,d,!0,[\"verify\"]);if(!await crypto.subtle.verify(d,h,a,dw(`${l}.${u}`)))throw new Wl(\"Invalid JWT signature\");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(B(n))return{data:null,error:n};throw n}}}Js.nextInstanceID=0;const Bw=Js;class Hw extends Bw{constructor(e){super(e)}}var Ww=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{c(n.next(d))}catch(h){a(h)}}function u(d){try{c(n.throw(d))}catch(h){a(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(t,e||[])).next())})};class Vw{constructor(e,r,n){var s,i,a;this.supabaseUrl=e,this.supabaseKey=r;const l=Jx(e);if(!r)throw new Error(\"supabaseKey is required.\");this.realtimeUrl=new URL(\"realtime/v1\",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace(\"http\",\"ws\"),this.authUrl=new URL(\"auth/v1\",l),this.storageUrl=new URL(\"storage/v1\",l),this.functionsUrl=new URL(\"functions/v1\",l);const u=`sb-${l.hostname.split(\".\")[0]}-auth-token`,c={db:Fx,realtime:Bx,auth:Object.assign(Object.assign({},zx),{storageKey:u}),global:Mx},d=Qx(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:\"\",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=qx(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new ax(new URL(\"rest/v1\",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new $x(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Uy(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return Ww(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:a,flowType:l,lock:u,debug:c},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Hw({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:a,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:l,lock:u,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()===\"authorization\")})}_initRealtimeClient(e){return new _x(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,\"CLIENT\",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e===\"TOKEN_REFRESHED\"||e===\"SIGNED_IN\")&&this.changedAccessToken!==n?this.changedAccessToken=n:e===\"SIGNED_OUT\"&&(this.realtime.setAuth(),r==\"STORAGE\"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const qw=(t,e,r)=>new Vw(t,e,r);function Kw(){if(typeof window<\"u\"||typeof process>\"u\")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\\d+)\\./);return e?parseInt(e[1],10)<=18:!1}Kw()&&console.warn(\"âš ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217\");const Gw=\"https://sriycekxdqnesdsgwiuc.supabase.co\",Qw=\"sb_publishable_your_key_here\",fe=qw(Gw,Qw,{auth:{persistSession:!0,autoRefreshToken:!0}}),Jw=async()=>{const{data:{session:t},error:e}=await fe.auth.getSession();return e?(console.error(\"Error getting session:\",e),null):(t==null?void 0:t.access_token)??null},c0=async()=>{const{data:{session:t},error:e}=await fe.auth.getSession();return e?(console.error(\"Failed to read session:\",e),!1):!!(t!=null&&t.access_token)},Yu={BASE:{name:\"Base\",price:.15,stages:[\"business-verification\",\"company-data\"],description:\"Essential Business Data - Perfect for targeted outreach campaigns\",features:[\"Business verification\",\"Company data (name, industry, size)\",\"Phone & address validation\",\"Generic company email\"],badge:\"Most Popular\",hasOwnershipData:!1},PROFESSIONAL:{name:\"Professional\",price:.45,stages:[\"business-verification\",\"company-data\",\"email-discovery\",\"email-verification\"],description:\"Enhanced Sales Intelligence - Verified contacts for higher conversion rates\",features:[\"Everything in Base\",\"Professional email discovery & verification\",\"Email deliverability verification\",\"Enhanced company enrichment\"],badge:\"\",hasOwnershipData:!1},ENTERPRISE:{name:\"Enterprise\",price:2.5,stages:[\"business-verification\",\"company-data\",\"email-discovery\",\"email-verification\",\"executive-enrichment\",\"compliance-verification\"],description:\"Premium Executive Access - Compliance-grade data with C-suite contacts\",features:[\"Everything in Professional\",\"Executive contact enrichment\",\"Full compliance verification\",\"Advanced data validation\"],badge:\"Premium\",hasOwnershipData:!0}},d0=k.createContext(void 0),Yw=({children:t})=>{const[e,r]=k.useState(null),[n,s]=k.useState(null),[i,a]=k.useState(null),[l,u]=k.useState(!0);k.useEffect(()=>{(async()=>{try{const{data:{session:w},error:v}=await fe.auth.getSession();v&&console.error(\"Session error:\",v),w!=null&&w.user?(s(w),r(w.user),a(w.user.id)):(s(null),r(null),a(null)),u(!1)}catch(w){console.error(\"Auth initialization error:\",w),s(null),r(null),a(null),u(!1)}})();const{data:{subscription:x}}=fe.auth.onAuthStateChange(async(w,v)=>{var m;console.log(\"Auth state changed:\",w,(m=v==null?void 0:v.user)==null?void 0:m.id),v!=null&&v.user?(s(v),r(v.user),a(v.user.id)):(s(null),r(null),a(null))});return()=>x.unsubscribe()},[]);const f={user:e,session:n,sessionUserId:i,loading:l,signIn:async(y,x)=>{const{error:w}=await fe.auth.signInWithPassword({email:y,password:x});if(w)throw w},signUp:async(y,x)=>{const{error:w}=await fe.auth.signUp({email:y,password:x});if(w)throw w},signOut:async()=>{const{error:y}=await fe.auth.signOut();if(y)throw y;s(null),r(null),a(null)}};return o.jsx(d0.Provider,{value:f,children:t})},Pr=()=>{const t=k.useContext(d0);if(t===void 0)throw new Error(\"useAuth must be used within an AuthProvider\");return t},Xw=({onAuthChange:t})=>{var W,J;const{user:e,loading:r,signOut:n}=Pr(),[s,i]=k.useState(!1),[a,l]=k.useState(!1),[u,c]=k.useState(\"\"),[d,h]=k.useState(\"\"),[f,y]=k.useState(\"\"),[x,w]=k.useState(\"\"),[v,m]=k.useState(null),[p,g]=k.useState(null),[b,S]=k.useState(!1),[j,N]=k.useState(!1),P=k.useRef(null),D=k.useRef(!1),T=k.useRef(null),z=r||s,G=k.useCallback(()=>{l(!1),c(\"\"),h(\"\"),y(\"\"),w(\"\"),m(null),g(null),window.hcaptcha&&T.current&&window.hcaptcha.reset(T.current)},[]);k.useEffect(()=>{t&&t(e??null)},[e,t]),k.useEffect(()=>{e&&!D.current&&(D.current=!0,Ee(e)),e||(D.current=!1,N(!1),S(!1),G())},[e,G]),k.useEffect(()=>{if(!j)return;const I=Z=>{P.current&&!P.current.contains(Z.target)&&(N(!1),S(!1),G())},F=Z=>{Z.key===\"Escape\"&&(N(!1),S(!1),G())};return document.addEventListener(\"mousedown\",I),document.addEventListener(\"keydown\",F),()=>{document.removeEventListener(\"mousedown\",I),document.removeEventListener(\"keydown\",F)}},[j,G]);const ue=k.useCallback(()=>{if(!(!b||!a)&&!(!window.hcaptcha||T.current))try{const I=window.hcaptcha.render(\"auth-hcaptcha-container\",{sitekey:void 0,size:\"invisible\",callback:()=>{}});T.current=I}catch(I){console.warn(\"Unable to initialize hCaptcha\",I)}},[a,b]),Ce=k.useCallback(async()=>{if(!window.hcaptcha||!T.current)return null;try{return(await window.hcaptcha.execute(T.current)).response}catch(I){return console.warn(\"Unable to complete hCaptcha\",I),null}},[]);k.useEffect(()=>{b&&a&&ue()},[b,a,ue]);const Ee=async I=>{var F,Z;try{const{error:ee}=await fe.from(\"user_profiles\").upsert([{id:I.id,email:I.email,full_name:((F=I.user_metadata)==null?void 0:F.full_name)||x||\"\",avatar_url:((Z=I.user_metadata)==null?void 0:Z.avatar_url)||\"\",subscription_tier:\"free\",total_spent:0,monthly_budget:100}]);ee&&ee.code!==\"23505\"&&console.error(\"Error creating user profile:\",ee)}catch(ee){console.error(\"Error creating user profile:\",ee)}},M=I=>I.length<8?\"Password must be at least 8 characters\":/(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/.test(I)?null:\"Password must contain uppercase, lowercase, and number\",O=()=>{var ee;const I=\"/auth/callback\",Z=(Pe=>{const Tr=Pe.trim();if(!Tr)return null;try{const wt=new URL(Tr);return(wt.pathname===\"/\"||wt.pathname===\"\"||wt.pathname===\"//\")&&(wt.pathname=I),wt.toString()}catch{return`${Tr.replace(/\\/+$/,\"\")}${I}`}})(\"https://prospectpro.appsmithery.co/auth/callback\");return Z||(typeof window<\"u\"&&((ee=window.location)!=null&&ee.origin)?`${window.location.origin.replace(/\\/+$/,\"\")}${I}`:I)},C=async I=>{I.preventDefault(),m(null),g(null),i(!0);try{if(a){if(d!==f){m(\"Passwords do not match\"),i(!1);return}const F=M(d);if(F){m(F),i(!1);return}if(window.hcaptcha&&!await Ce()){m(\"Captcha verification failed. Please try again.\"),i(!1);return}const{error:Z}=await fe.auth.signUp({email:u,password:d,options:{emailRedirectTo:O(),data:{full_name:x.trim()}}});if(Z)throw Z;g(\"Check your email to confirm your account. Once confirmed, sign in to continue.\"),G(),S(!1),N(!1)}else{const{error:F}=await fe.auth.signInWithPassword({email:u,password:d});if(F)throw F;G(),S(!1),N(!1)}}catch(F){const Z=F instanceof Error?F.message:\"Authentication failed.\";m(Z)}finally{i(!1)}},A=async()=>{m(null),g(null),i(!0);try{const{error:I}=await fe.auth.signInWithOAuth({provider:\"google\",options:{redirectTo:O(),queryParams:{access_type:\"offline\",prompt:\"consent\"}}});if(I)throw I}catch(I){const F=I instanceof Error?I.message:\"Google sign-in failed.\";m(F)}finally{i(!1)}},L=async()=>{i(!0),m(null);try{await n(),G(),N(!1)}catch(I){const F=I instanceof Error?I.message:\"Unable to sign out right now.\";m(F)}finally{i(!1)}};if(z&&!e)return o.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[o.jsx(\"div\",{className:\"h-4 w-4 animate-spin rounded-full border-2 border-gray-500 border-t-blue-600\"}),o.jsx(\"span\",{className:\"text-sm font-medium text-gray-800\",children:\"Loadingâ€¦\"})]});if(e){const I=((W=e.user_metadata)==null?void 0:W.full_name)||\"ProspectPro user\",F=e.email||\"Authenticated\",Z=I.split(\" \").map(ee=>ee.charAt(0)).join(\"\").slice(0,2).toUpperCase();return o.jsxs(\"div\",{className:\"relative\",ref:P,children:[o.jsxs(\"button\",{type:\"button\",onClick:()=>N(ee=>!ee),className:\"inline-flex items-center gap-3 rounded-full border border-transparent bg-white/80 px-3 py-1.5 text-left text-sm font-medium text-gray-900 shadow-sm transition-colors hover:border-blue-600 hover:bg-white dark:bg-slate-900/70 dark:text-slate-100\",\"aria-haspopup\":\"menu\",\"aria-expanded\":j,children:[o.jsx(\"span\",{className:\"relative flex h-9 w-9 items-center justify-center overflow-hidden rounded-full border border-blue-200 bg-blue-100 text-base font-semibold text-blue-700 shadow-sm dark:border-sky-500/60 dark:bg-sky-500/10 dark:text-sky-200\",children:(J=e.user_metadata)!=null&&J.avatar_url?o.jsx(\"img\",{src:e.user_metadata.avatar_url,alt:I,className:\"absolute inset-0 h-full w-full object-cover\"}):Z||\"PP\"}),o.jsxs(\"span\",{className:\"flex flex-col items-start\",children:[o.jsx(\"span\",{className:\"text-sm font-semibold leading-tight\",children:I}),o.jsx(\"span\",{className:\"text-xs text-gray-600 leading-tight dark:text-slate-300\",children:F})]}),o.jsx(\"svg\",{className:`h-4 w-4 text-gray-500 transition-transform dark:text-slate-300 ${j?\"rotate-180\":\"\"}`,viewBox:\"0 0 20 20\",fill:\"currentColor\",\"aria-hidden\":\"true\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 011.08 1.04l-4.25 4.25a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z\",clipRule:\"evenodd\"})})]}),j&&o.jsxs(\"div\",{className:\"absolute right-0 z-50 mt-2 w-64 rounded-lg border border-gray-200 bg-white p-3 text-sm shadow-xl dark:border-slate-700 dark:bg-slate-900\",role:\"menu\",\"aria-label\":\"Account menu\",children:[o.jsxs(\"div\",{className:\"mb-3 rounded-md border border-gray-100 bg-gray-50 px-3 py-2 dark:border-slate-700 dark:bg-slate-800\",children:[o.jsx(\"p\",{className:\"text-xs uppercase tracking-wide text-gray-500 dark:text-slate-400\",children:\"Signed in as\"}),o.jsx(\"p\",{className:\"truncate text-sm font-semibold text-gray-900 dark:text-slate-100\",children:I}),o.jsx(\"p\",{className:\"truncate text-xs text-gray-600 dark:text-slate-300\",children:F})]}),o.jsxs(\"div\",{className:\"flex flex-col gap-1\",role:\"none\",children:[o.jsx(El,{to:\"/account\",className:\"rounded-md px-3 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-blue-50 hover:text-blue-700 dark:text-slate-200 dark:hover:bg-slate-800\",role:\"menuitem\",onClick:()=>N(!1),children:\"Account settings\"}),o.jsx(\"button\",{type:\"button\",onClick:L,disabled:z,className:\"rounded-md px-3 py-2 text-sm font-semibold text-red-600 transition-colors hover:bg-red-50 disabled:opacity-60 dark:text-rose-400 dark:hover:bg-rose-500/10\",role:\"menuitem\",children:\"Sign out\"})]})]})]})}return o.jsxs(\"div\",{className:\"relative\",ref:P,children:[o.jsxs(\"button\",{type:\"button\",onClick:()=>N(I=>{const F=!I;return F||(S(!1),G()),F}),className:\"inline-flex items-center gap-2 rounded-full border border-blue-200 bg-white/80 px-4 py-1.5 text-sm font-semibold text-blue-700 shadow-sm transition-colors hover:border-blue-400 hover:bg-white dark:border-sky-500/40 dark:bg-slate-900/70 dark:text-sky-200\",\"aria-haspopup\":\"menu\",\"aria-expanded\":j,children:[o.jsx(\"span\",{children:\"Sign in / Sign up\"}),o.jsx(\"svg\",{className:`h-4 w-4 text-blue-500 transition-transform dark:text-sky-300 ${j?\"rotate-180\":\"\"}`,viewBox:\"0 0 20 20\",fill:\"currentColor\",\"aria-hidden\":\"true\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 011.08 1.04l-4.25 4.25a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z\",clipRule:\"evenodd\"})})]}),j&&o.jsx(\"div\",{className:\"absolute right-0 z-50 mt-2 w-80 rounded-lg border border-gray-200 bg-white p-4 text-sm shadow-xl dark:border-slate-700 dark:bg-slate-900\",role:\"menu\",\"aria-label\":\"Authentication menu\",children:o.jsxs(\"div\",{className:\"space-y-4\",role:\"none\",children:[o.jsxs(\"button\",{type:\"button\",onClick:A,disabled:z,className:\"flex w-full items-center justify-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 font-medium text-gray-800 transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-60 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700\",role:\"menuitem\",children:[o.jsxs(\"svg\",{className:\"h-4 w-4\",viewBox:\"0 0 24 24\",children:[o.jsx(\"path\",{fill:\"#4285f4\",d:\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"}),o.jsx(\"path\",{fill:\"#34a853\",d:\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"}),o.jsx(\"path\",{fill:\"#fbbc05\",d:\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"}),o.jsx(\"path\",{fill:\"#ea4335\",d:\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"})]}),o.jsx(\"span\",{children:\"Continue with Google\"})]}),o.jsxs(\"div\",{className:\"flex items-center gap-3 text-xs uppercase tracking-wide text-gray-400 dark:text-slate-500\",children:[o.jsx(\"span\",{className:\"h-px flex-1 bg-gray-200 dark:bg-slate-700\"}),o.jsx(\"span\",{children:\"or\"}),o.jsx(\"span\",{className:\"h-px flex-1 bg-gray-200 dark:bg-slate-700\"})]}),o.jsx(\"button\",{type:\"button\",onClick:()=>{const I=!b;S(I),m(null),g(null),I||G()},className:\"w-full rounded-md border border-transparent bg-blue-50 px-4 py-2 text-sm font-semibold text-blue-700 transition-colors hover:bg-blue-100 dark:bg-sky-500/10 dark:text-sky-200 dark:hover:bg-sky-500/20\",role:\"menuitem\",children:b?\"Hide email options\":\"Continue with email\"}),b&&o.jsxs(\"div\",{className:\"rounded-md border border-gray-200 bg-gray-50 p-4 dark:border-slate-700 dark:bg-slate-800\",children:[o.jsxs(\"div\",{className:\"mb-3 flex items-center justify-between\",children:[o.jsx(\"p\",{className:\"text-sm font-semibold text-gray-700 dark:text-slate-200\",children:a?\"Create an account\":\"Sign in with email\"}),o.jsx(\"button\",{type:\"button\",onClick:()=>{l(I=>!I),m(null),g(null)},className:\"text-xs font-medium text-blue-600 transition-colors hover:text-blue-700 dark:text-sky-300 dark:hover:text-sky-200\",children:a?\"Have an account? Sign in\":\"New user? Create account\"})]}),o.jsxs(\"form\",{onSubmit:C,className:\"space-y-3\",children:[a&&o.jsx(\"input\",{type:\"text\",placeholder:\"Full name\",value:x,onChange:I=>w(I.target.value),className:\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\",required:!0}),o.jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:u,onChange:I=>c(I.target.value),className:\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\",required:!0}),o.jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:d,onChange:I=>h(I.target.value),className:\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\",required:!0}),a&&o.jsx(\"input\",{type:\"password\",placeholder:\"Confirm password\",value:f,onChange:I=>y(I.target.value),className:\"w-full rounded border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100\",required:!0}),o.jsx(\"button\",{type:\"submit\",disabled:z,className:\"w-full rounded bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60 dark:bg-sky-500 dark:hover:bg-sky-600\",children:z?o.jsx(\"span\",{children:\"Processingâ€¦\"}):a?\"Create account\":\"Sign in\"})]}),v&&o.jsx(\"div\",{className:\"mt-3 rounded border border-red-200 bg-red-50 p-2 text-xs text-red-600 dark:border-rose-500/40 dark:bg-rose-500/10 dark:text-rose-200\",children:v}),p&&o.jsx(\"div\",{className:\"mt-3 rounded border border-green-200 bg-green-50 p-2 text-xs text-green-700 dark:border-emerald-500/40 dark:bg-emerald-500/10 dark:text-emerald-200\",children:p}),o.jsx(\"div\",{id:\"auth-hcaptcha-container\",className:\"hidden\"})]})]})})]})},Zw=()=>{const[t,e]=k.useState(!1);k.useEffect(()=>{const n=localStorage.getItem(\"theme\"),s=window.matchMedia(\"(prefers-color-scheme: dark)\").matches;n===\"dark\"||!n&&s?(e(!0),document.documentElement.classList.add(\"dark\")):(e(!1),document.documentElement.classList.remove(\"dark\"))},[]);const r=()=>{const n=!t;e(n),n?(document.documentElement.classList.add(\"dark\"),localStorage.setItem(\"theme\",\"dark\")):(document.documentElement.classList.remove(\"dark\"),localStorage.setItem(\"theme\",\"light\"))};return o.jsx(\"button\",{onClick:r,className:\"p-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\",\"aria-label\":\"Toggle dark mode\",children:t?o.jsx(\"svg\",{className:\"w-5 h-5 text-yellow-500\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z\",clipRule:\"evenodd\"})}):o.jsx(\"svg\",{className:\"w-5 h-5 text-gray-700\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:o.jsx(\"path\",{d:\"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z\"})})})},eb=({children:t})=>{const e=es(),{user:r}=Pr(),n=k.useMemo(()=>[{name:\"New Campaign\",href:\"/\",disabled:!1},{name:\"My Campaigns\",href:\"/dashboard\",disabled:!r}],[r]);return o.jsxs(\"div\",{className:\"min-h-screen bg-gray-100 text-gray-900 transition-colors dark:bg-slate-900 dark:text-slate-100\",children:[o.jsx(\"header\",{className:\"border-b border-yellow-400 bg-[#f9ed69] text-gray-900 dark:border-yellow-500 dark:bg-[#f9ed69] dark:text-gray-900\",children:o.jsxs(\"div\",{className:\"mx-auto flex h-16 max-w-5xl items-center justify-between px-6\",children:[o.jsx(El,{to:\"/\",className:\"flex h-full items-center\",\"aria-label\":\"ProspectPro home\",children:o.jsx(\"img\",{src:\"/logo-full.svg\",alt:\"ProspectPro\",className:\"h-16 w-auto\"})}),o.jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[o.jsx(Xw,{}),o.jsx(\"div\",{className:\"h-10 w-px bg-gray-300\",\"aria-hidden\":\"true\"}),o.jsx(Zw,{})]})]})}),o.jsx(\"nav\",{className:\"border-b border-gray-200 bg-white text-sm font-medium transition-colors dark:border-slate-700 dark:bg-slate-900\",children:o.jsx(\"div\",{className:\"mx-auto flex max-w-5xl items-center px-6\",children:n.map(s=>{const i=!s.disabled&&e.pathname===s.href;return s.disabled?o.jsx(\"span\",{className:\"flex items-center border-b-2 border-transparent px-4 py-3 text-gray-400\",\"aria-disabled\":\"true\",children:s.name},s.name):o.jsx(El,{to:s.href,className:`flex items-center border-b-2 px-4 py-3 transition-colors ${i?\"border-blue-600 text-blue-700 dark:border-sky-400 dark:text-sky-300\":\"border-transparent text-gray-600 hover:text-gray-900 dark:text-slate-400 dark:hover:text-slate-50\"}`,children:s.name},s.name)})})}),o.jsx(\"main\",{className:\"mx-auto max-w-5xl px-6 pb-12 pt-8 sm:pb-16 sm:pt-10\",children:t})]})},tb={},Wd=t=>{let e;const r=new Set,n=(d,h)=>{const f=typeof d==\"function\"?d(e):d;if(!Object.is(f,e)){const y=e;e=h??(typeof f!=\"object\"||f===null)?f:Object.assign({},e,f),r.forEach(x=>x(e,y))}},s=()=>e,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(tb?\"production\":void 0)!==\"production\"&&console.warn(\"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"),r.clear()}},c=e=t(n,s,u);return u},rb=t=>t?Wd(t):Wd;var h0={exports:{}},f0={},p0={exports:{}},m0={};/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var Qn=k;function nb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sb=typeof Object.is==\"function\"?Object.is:nb,ib=Qn.useState,ab=Qn.useEffect,ob=Qn.useLayoutEffect,lb=Qn.useDebugValue;function ub(t,e){var r=e(),n=ib({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return ob(function(){s.value=r,s.getSnapshot=e,To(s)&&i({inst:s})},[t,r,e]),ab(function(){return To(s)&&i({inst:s}),t(function(){To(s)&&i({inst:s})})},[t]),lb(r),r}function To(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!sb(t,r)}catch{return!0}}function cb(t,e){return e()}var db=typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"?cb:ub;m0.useSyncExternalStore=Qn.useSyncExternalStore!==void 0?Qn.useSyncExternalStore:db;p0.exports=m0;var hb=p0.exports;/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var qa=k,fb=hb;function pb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mb=typeof Object.is==\"function\"?Object.is:pb,gb=fb.useSyncExternalStore,vb=qa.useRef,yb=qa.useEffect,xb=qa.useMemo,wb=qa.useDebugValue;f0.useSyncExternalStoreWithSelector=function(t,e,r,n,s){var i=vb(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=xb(function(){function u(y){if(!c){if(c=!0,d=y,y=n(y),s!==void 0&&a.hasValue){var x=a.value;if(s(x,y))return h=x}return h=y}if(x=h,mb(d,y))return x;var w=n(y);return s!==void 0&&s(x,w)?(d=y,x):(d=y,h=w)}var c=!1,d,h,f=r===void 0?null:r;return[function(){return u(e())},f===null?void 0:function(){return u(f())}]},[e,r,n,s]);var l=gb(t,i[0],i[1]);return yb(function(){a.hasValue=!0,a.value=l},[l]),wb(l),l};h0.exports=f0;var bb=h0.exports;const kb=ah(bb),g0={},{useDebugValue:_b}=Jl,{useSyncExternalStoreWithSelector:Sb}=kb;let Vd=!1;const jb=t=>t;function Nb(t,e=jb,r){(g0?\"production\":void 0)!==\"production\"&&r&&!Vd&&(console.warn(\"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"),Vd=!0);const n=Sb(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return _b(n),n}const Cb=t=>{(g0?\"production\":void 0)!==\"production\"&&typeof t!=\"function\"&&console.warn(\"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\");const e=typeof t==\"function\"?rb(t):t,r=(n,s)=>Nb(e,n,s);return Object.assign(r,e),r},v0=t=>Cb,Eb={};function Pb(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var i;const a=u=>u===null?null:JSON.parse(u,void 0),l=(i=r.getItem(s))!=null?i:null;return l instanceof Promise?l.then(a):a(l)},setItem:(s,i)=>r.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>r.removeItem(s)}}const Ys=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Ys(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Ys(n)(r)}}}},Tb=(t,e)=>(r,n,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,m)=>({...m,...v}),...e},a=!1;const l=new Set,u=new Set;let c;try{c=i.getStorage()}catch{}if(!c)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...v)},n,s);const d=Ys(i.serialize),h=()=>{const v=i.partialize({...n()});let m;const p=d({state:v,version:i.version}).then(g=>c.setItem(i.name,g)).catch(g=>{m=g});if(m)throw m;return p},f=s.setState;s.setState=(v,m)=>{f(v,m),h()};const y=t((...v)=>{r(...v),h()},n,s);let x;const w=()=>{var v;if(!c)return;a=!1,l.forEach(p=>p(n()));const m=((v=i.onRehydrateStorage)==null?void 0:v.call(i,n()))||void 0;return Ys(c.getItem.bind(c))(i.name).then(p=>{if(p)return i.deserialize(p)}).then(p=>{if(p)if(typeof p.version==\"number\"&&p.version!==i.version){if(i.migrate)return i.migrate(p.state,p.version);console.error(\"State loaded from storage couldn't be migrated since no migrate function was provided\")}else return p.state}).then(p=>{var g;return x=i.merge(p,(g=n())!=null?g:y),r(x,!0),h()}).then(()=>{m==null||m(x,void 0),a=!0,u.forEach(p=>p(x))}).catch(p=>{m==null||m(void 0,p)})};return s.persist={setOptions:v=>{i={...i,...v},v.getStorage&&(c=v.getStorage())},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>a,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},w(),x||y},Rb=(t,e)=>(r,n,s)=>{let i={storage:Pb(()=>localStorage),partialize:w=>w,version:0,merge:(w,v)=>({...v,...w}),...e},a=!1;const l=new Set,u=new Set;let c=i.storage;if(!c)return t((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...w)},n,s);const d=()=>{const w=i.partialize({...n()});return c.setItem(i.name,{state:w,version:i.version})},h=s.setState;s.setState=(w,v)=>{h(w,v),d()};const f=t((...w)=>{r(...w),d()},n,s);s.getInitialState=()=>f;let y;const x=()=>{var w,v;if(!c)return;a=!1,l.forEach(p=>{var g;return p((g=n())!=null?g:f)});const m=((v=i.onRehydrateStorage)==null?void 0:v.call(i,(w=n())!=null?w:f))||void 0;return Ys(c.getItem.bind(c))(i.name).then(p=>{if(p)if(typeof p.version==\"number\"&&p.version!==i.version){if(i.migrate)return[!0,i.migrate(p.state,p.version)];console.error(\"State loaded from storage couldn't be migrated since no migrate function was provided\")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var g;const[b,S]=p;if(y=i.merge(S,(g=n())!=null?g:f),r(y,!0),b)return d()}).then(()=>{m==null||m(y,void 0),y=n(),a=!0,u.forEach(p=>p(y))}).catch(p=>{m==null||m(void 0,p)})};return s.persist={setOptions:w=>{i={...i,...w},w.storage&&(c=w.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},i.skipHydration||x(),y||f},Ob=(t,e)=>\"getStorage\"in e||\"serialize\"in e||\"deserialize\"in e?((Eb?\"production\":void 0)!==\"production\"&&console.warn(\"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"),Tb(t,e)):Rb(t,e),y0=Ob,qd={campaigns:[],currentCampaign:null,leads:[],isLoading:!1,error:null,jobProgress:{},apiUsageMetrics:[],lastMetricsCleanup:new Date},Ab=v0()(y0((t,e)=>({...qd,addCampaign:r=>t(n=>({campaigns:[r,...n.campaigns]})),updateCampaign:(r,n)=>t(s=>{var i;return{campaigns:s.campaigns.map(a=>a.campaign_id===r?{...a,...n}:a),currentCampaign:((i=s.currentCampaign)==null?void 0:i.campaign_id)===r?{...s.currentCampaign,...n}:s.currentCampaign}}),setCurrentCampaign:r=>t({currentCampaign:r}),addLeads:r=>t(n=>({leads:[...n.leads,...r]})),updateLead:(r,n)=>t(s=>({leads:s.leads.map(i=>i.id===r?{...i,...n}:i)})),setLoading:r=>t({isLoading:r}),setError:r=>t({error:r}),clearLeads:()=>t({leads:[]}),reset:()=>t(qd),addJobProgress:(r,n)=>t(s=>({jobProgress:{...s.jobProgress,[r]:n}})),updateJobProgress:(r,n)=>t(s=>({jobProgress:{...s.jobProgress,[r]:s.jobProgress[r]?{...s.jobProgress[r],...n}:{id:r,campaignId:\"\",status:\"pending\",progress:0,currentStage:\"\",startedAt:new Date,...n}}})),getJobProgress:r=>e().jobProgress[r],addApiUsageMetric:r=>t(n=>({apiUsageMetrics:[r,...n.apiUsageMetrics]})),getApiUsageStats:()=>{const r=e().apiUsageMetrics,n=r.reduce((h,f)=>h+f.cost,0),s=r.reduce((h,f)=>h+f.requestCount,0),i=r.reduce((h,f)=>h+f.responseTimeMs,0),a=r.filter(h=>h.success).length,l={},u={},c={},d={};return r.forEach(h=>{l[h.service]=(l[h.service]||0)+h.cost,u[h.service]=(u[h.service]||0)+h.requestCount;const f=h.timestamp.toISOString().split(\"T\")[0],y=f.substring(0,7);c[f]=(c[f]||0)+h.cost,d[y]=(d[y]||0)+h.cost}),{totalCost:n,totalRequests:s,averageResponseTime:s>0?i/s:0,successRate:s>0?a/s:1,costByService:l,requestsByService:u,dailySpend:c,monthlySpend:d}},clearOldMetrics:(r=30)=>t(n=>{const s=new Date;return s.setDate(s.getDate()-r),{apiUsageMetrics:n.apiUsageMetrics.filter(i=>i.timestamp>s),lastMetricsCleanup:new Date}})}),{name:\"campaign-store\",partialize:t=>({campaigns:t.campaigns,leads:t.leads,jobProgress:t.jobProgress,apiUsageMetrics:t.apiUsageMetrics.slice(0,1e3),lastMetricsCleanup:t.lastMetricsCleanup})})),Lb=({className:t=\"\"})=>{const{getApiUsageStats:e,clearOldMetrics:r,apiUsageMetrics:n}=Ab(),s=e();k.useEffect(()=>{r(30)},[r]);const i=h=>new Intl.NumberFormat(\"en-US\",{style:\"currency\",currency:\"USD\",minimumFractionDigits:4}).format(h),a=h=>new Intl.NumberFormat(\"en-US\",{style:\"percent\",minimumFractionDigits:1,maximumFractionDigits:1}).format(h),l=h=>new Intl.NumberFormat(\"en-US\").format(h),u=Object.entries(s.costByService).map(([h,f])=>({service:h,cost:f,requests:s.requestsByService[h]||0,avgCostPerRequest:f/(s.requestsByService[h]||1)})),c=Object.entries(s.monthlySpend).sort(([h],[f])=>f.localeCompare(h)).slice(0,6),d=Object.entries(s.dailySpend).sort(([h],[f])=>f.localeCompare(h)).slice(0,7);return o.jsxs(\"div\",{className:`space-y-6 ${t}`,children:[o.jsxs(\"div\",{className:\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4\",children:[o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-blue-600 dark:text-sky-400\",children:i(s.totalCost)}),o.jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"Total Spend\"})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-green-600 dark:text-emerald-400\",children:l(s.totalRequests)}),o.jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"API Requests\"})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsxs(\"div\",{className:\"text-2xl font-bold text-purple-600 dark:text-violet-400\",children:[s.averageResponseTime.toFixed(0),\"ms\"]}),o.jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"Avg Response Time\"})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-orange-600 dark:text-amber-400\",children:a(s.successRate)}),o.jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"Success Rate\"})]})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsxs(\"div\",{className:\"border-b border-gray-200 px-6 py-4 dark:border-slate-700\",children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100\",children:\"Cost by Service\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"API usage and costs broken down by service provider\"})]}),o.jsx(\"div\",{className:\"overflow-x-auto\",children:o.jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-slate-700\",children:[o.jsx(\"thead\",{className:\"bg-gray-50 dark:bg-slate-800\",children:o.jsxs(\"tr\",{children:[o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Service\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Total Cost\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Requests\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Avg Cost/Request\"})]})}),o.jsx(\"tbody\",{className:\"divide-y divide-gray-200 bg-white dark:divide-slate-700 dark:bg-slate-900\",children:u.length===0?o.jsx(\"tr\",{children:o.jsx(\"td\",{colSpan:4,className:\"px-6 py-4 text-center text-sm text-gray-500 dark:text-slate-400\",children:\"No API usage data available\"})}):u.map(({service:h,cost:f,requests:y,avgCostPerRequest:x})=>o.jsxs(\"tr\",{className:\"hover:bg-gray-50 dark:hover:bg-slate-800\",children:[o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-slate-100\",children:h.replace(/_/g,\" \").replace(/\\b\\w/g,w=>w.toUpperCase())}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-slate-100\",children:i(f)}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-slate-100\",children:l(y)}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-slate-100\",children:i(x)})]},h))})]})})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsxs(\"div\",{className:\"border-b border-gray-200 px-6 py-4 dark:border-slate-700\",children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100\",children:\"Monthly Spend Trend\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"API costs over the last 6 months\"})]}),o.jsx(\"div\",{className:\"overflow-x-auto\",children:o.jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-slate-700\",children:[o.jsx(\"thead\",{className:\"bg-gray-50 dark:bg-slate-800\",children:o.jsxs(\"tr\",{children:[o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Month\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Total Spend\"})]})}),o.jsx(\"tbody\",{className:\"divide-y divide-gray-200 bg-white dark:divide-slate-700 dark:bg-slate-900\",children:c.length===0?o.jsx(\"tr\",{children:o.jsx(\"td\",{colSpan:2,className:\"px-6 py-4 text-center text-sm text-gray-500 dark:text-slate-400\",children:\"No monthly data available\"})}):c.map(([h,f])=>o.jsxs(\"tr\",{className:\"hover:bg-gray-50 dark:hover:bg-slate-800\",children:[o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-slate-100\",children:new Date(h+\"-01\").toLocaleDateString(\"en-US\",{year:\"numeric\",month:\"long\"})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-slate-100\",children:i(f)})]},h))})]})})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsxs(\"div\",{className:\"border-b border-gray-200 px-6 py-4 dark:border-slate-700\",children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100\",children:\"Daily Spend (Last 7 Days)\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"Recent daily API costs for monitoring usage patterns\"})]}),o.jsx(\"div\",{className:\"overflow-x-auto\",children:o.jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-slate-700\",children:[o.jsx(\"thead\",{className:\"bg-gray-50 dark:bg-slate-800\",children:o.jsxs(\"tr\",{children:[o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Date\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-slate-400\",children:\"Daily Spend\"})]})}),o.jsx(\"tbody\",{className:\"divide-y divide-gray-200 bg-white dark:divide-slate-700 dark:bg-slate-900\",children:d.length===0?o.jsx(\"tr\",{children:o.jsx(\"td\",{colSpan:2,className:\"px-6 py-4 text-center text-sm text-gray-500 dark:text-slate-400\",children:\"No daily data available\"})}):d.map(([h,f])=>o.jsxs(\"tr\",{className:\"hover:bg-gray-50 dark:hover:bg-slate-800\",children:[o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-slate-100\",children:new Date(h).toLocaleDateString(\"en-US\",{weekday:\"short\",month:\"short\",day:\"numeric\",year:\"numeric\"})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-slate-100\",children:i(f)})]},h))})]})})]}),o.jsx(\"div\",{className:\"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-sky-800 dark:bg-sky-900/20\",children:o.jsxs(\"div\",{className:\"flex\",children:[o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsx(\"svg\",{className:\"h-5 w-5 text-blue-400\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\",clipRule:\"evenodd\"})})}),o.jsx(\"div\",{className:\"ml-3\",children:o.jsxs(\"p\",{className:\"text-sm text-blue-800 dark:text-sky-200\",children:[o.jsx(\"strong\",{children:\"Data Source:\"}),\" API usage metrics are collected from real campaign runs and stored locally. Historical data shows the last \",n.length,\" recorded API calls across all services.\"]})})]})})]})},Ib=()=>{var u,c;const{user:t,loading:e}=Pr();if(e)return o.jsx(\"div\",{className:\"flex items-center justify-center min-h-64\",children:o.jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[o.jsx(\"div\",{className:\"h-6 w-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\"}),o.jsx(\"span\",{className:\"text-gray-600 dark:text-slate-400\",children:\"Loading account...\"})]})});if(!t)return o.jsx(\"div\",{className:\"flex items-center justify-center min-h-64\",children:o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"h1\",{className:\"text-xl font-semibold text-gray-900 dark:text-slate-100\",children:\"Sign in to manage your account\"}),o.jsx(\"p\",{className:\"mt-2 text-sm text-gray-600 dark:text-slate-400\",children:\"Access your billing, usage analytics, and profile settings after signing in.\"})]})});const r=((u=t==null?void 0:t.user_metadata)==null?void 0:u.full_name)||\"ProspectPro User\",n=(t==null?void 0:t.email)||\"Not provided\",s=(c=t==null?void 0:t.user_metadata)==null?void 0:c.avatar_url,i=t!=null&&t.created_at?new Date(t.created_at):null,a=t!=null&&t.last_sign_in_at?new Date(t.last_sign_in_at):null,l=r.split(\" \").map(d=>d.charAt(0)).join(\"\").slice(0,2).toUpperCase();return o.jsxs(\"div\",{className:\"max-w-6xl mx-auto space-y-8\",children:[o.jsxs(\"div\",{className:\"border-b border-gray-200 pb-6 dark:border-slate-700\",children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 dark:text-slate-100\",children:\"Account Settings\"}),o.jsx(\"p\",{className:\"mt-2 text-gray-600 dark:text-slate-400\",children:\"Manage your account, view usage analytics, and configure preferences.\"})]}),o.jsxs(\"div\",{className:\"grid grid-cols-1 gap-8 lg:grid-cols-3\",children:[o.jsxs(\"div\",{className:\"lg:col-span-1\",children:[o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4\",children:\"Profile Information\"}),o.jsxs(\"div\",{className:\"flex items-center space-x-4 mb-6\",children:[o.jsx(\"div\",{className:\"relative flex h-16 w-16 items-center justify-center overflow-hidden rounded-full border-2 border-blue-200 bg-blue-100 text-xl font-bold text-blue-700 shadow-sm dark:border-sky-500/60 dark:bg-sky-500/10 dark:text-sky-200\",children:s?o.jsx(\"img\",{src:s,alt:r,className:\"absolute inset-0 h-full w-full object-cover\"}):l||\"PP\"}),o.jsxs(\"div\",{children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100\",children:r}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:n})]})]}),o.jsxs(\"div\",{className:\"space-y-4\",children:[o.jsxs(\"div\",{children:[o.jsx(\"dt\",{className:\"text-sm font-medium text-gray-500 dark:text-slate-400\",children:\"Account Created\"}),o.jsx(\"dd\",{className:\"text-sm text-gray-900 dark:text-slate-100\",children:i?i.toLocaleDateString(\"en-US\",{year:\"numeric\",month:\"long\",day:\"numeric\"}):\"Unknown\"})]}),o.jsxs(\"div\",{children:[o.jsx(\"dt\",{className:\"text-sm font-medium text-gray-500 dark:text-slate-400\",children:\"Last Sign In\"}),o.jsx(\"dd\",{className:\"text-sm text-gray-900 dark:text-slate-100\",children:a?a.toLocaleDateString(\"en-US\",{year:\"numeric\",month:\"short\",day:\"numeric\",hour:\"2-digit\",minute:\"2-digit\"}):\"Unknown\"})]}),o.jsxs(\"div\",{children:[o.jsx(\"dt\",{className:\"text-sm font-medium text-gray-500 dark:text-slate-400\",children:\"User ID\"}),o.jsx(\"dd\",{className:\"text-xs font-mono text-gray-700 dark:text-slate-300 break-all\",children:(t==null?void 0:t.id)||\"Not available\"})]})]})]}),o.jsxs(\"div\",{className:\"mt-6 rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4\",children:\"Quick Actions\"}),o.jsxs(\"div\",{className:\"space-y-3\",children:[o.jsx(\"button\",{type:\"button\",className:\"w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700\",onClick:()=>{alert(\"Profile editing will be available in a future update.\")},children:\"Edit Profile\"}),o.jsx(\"button\",{type:\"button\",className:\"w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700\",onClick:()=>{alert(\"Password management will be available in a future update.\")},children:\"Change Password\"}),o.jsx(\"button\",{type:\"button\",className:\"w-full rounded-md border border-red-300 bg-white px-4 py-2 text-sm font-medium text-red-600 transition-colors hover:bg-red-50 dark:border-red-600 dark:bg-slate-800 dark:text-red-400 dark:hover:bg-red-900/20\",onClick:()=>{confirm(\"Are you sure you want to delete your account? This action cannot be undone.\")&&alert(\"Account deletion will be available in a future update.\")},children:\"Delete Account\"})]})]})]}),o.jsx(\"div\",{className:\"lg:col-span-2\",children:o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsxs(\"div\",{className:\"mb-6\",children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100\",children:\"API Usage & Cost Analytics\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:\"Monitor your API usage patterns and costs across all services.\"})]}),o.jsx(Lb,{})]})})]}),o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4\",children:\"Subscription & Billing\"}),o.jsx(\"div\",{className:\"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-sky-800 dark:bg-sky-900/20\",children:o.jsxs(\"div\",{className:\"flex\",children:[o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsx(\"svg\",{className:\"h-5 w-5 text-blue-400\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\",clipRule:\"evenodd\"})})}),o.jsxs(\"div\",{className:\"ml-3\",children:[o.jsx(\"h3\",{className:\"text-sm font-medium text-blue-800 dark:text-sky-200\",children:\"Current Plan: Pay-per-Use\"}),o.jsx(\"p\",{className:\"mt-1 text-sm text-blue-700 dark:text-sky-300\",children:\"You're currently on a pay-per-use billing model with no monthly subscription. API costs are charged based on actual usage. Subscription plans with fixed pricing and enhanced features coming soon.\"})]})]})})]})]})},$b=()=>o.jsxs(\"div\",{className:\"space-y-6\",children:[o.jsxs(\"div\",{children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Admin Panel\"}),o.jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:\"System monitoring and API usage analytics\"})]}),o.jsxs(\"div\",{className:\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3\",children:[o.jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[o.jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"API Status\"}),o.jsxs(\"div\",{className:\"space-y-3\",children:[o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Google Places API\"}),o.jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:\"Active\"})]}),o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"ZeroBounce API\"}),o.jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:\"Active\"})]}),o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"State Registry APIs\"}),o.jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:\"Active\"})]})]})]}),o.jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[o.jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Usage Quotas\"}),o.jsxs(\"div\",{className:\"space-y-3\",children:[o.jsxs(\"div\",{children:[o.jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[o.jsx(\"span\",{className:\"text-gray-600\",children:\"Google Places\"}),o.jsx(\"span\",{className:\"text-gray-900\",children:\"1,247 / 10,000\"})]}),o.jsx(\"div\",{className:\"mt-1 w-full bg-gray-200 rounded-full h-2\",children:o.jsx(\"div\",{className:\"bg-blue-600 h-2 rounded-full\",style:{width:\"12.5%\"}})})]}),o.jsxs(\"div\",{children:[o.jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[o.jsx(\"span\",{className:\"text-gray-600\",children:\"Email Validation\"}),o.jsx(\"span\",{className:\"text-gray-900\",children:\"342 / 1,000\"})]}),o.jsx(\"div\",{className:\"mt-1 w-full bg-gray-200 rounded-full h-2\",children:o.jsx(\"div\",{className:\"bg-green-600 h-2 rounded-full\",style:{width:\"34.2%\"}})})]})]})]}),o.jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[o.jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"System Health\"}),o.jsxs(\"div\",{className:\"space-y-3\",children:[o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Database\"}),o.jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:\"Healthy\"})]}),o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Edge Functions\"}),o.jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:\"4/4 Active\"})]}),o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Response Time\"}),o.jsx(\"span\",{className:\"text-sm text-gray-900\",children:\"~2.3s avg\"})]})]})]})]}),o.jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[o.jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Recent Activity\"}),o.jsxs(\"div\",{className:\"space-y-4\",children:[o.jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[o.jsx(\"div\",{className:\"flex-shrink-0 w-2 h-2 mt-2 bg-green-400 rounded-full\"}),o.jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[o.jsx(\"p\",{className:\"text-sm text-gray-900\",children:\"Campaign completed successfully\"}),o.jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"47 leads discovered, $12.34 total cost â€¢ 2 minutes ago\"})]})]}),o.jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[o.jsx(\"div\",{className:\"flex-shrink-0 w-2 h-2 mt-2 bg-blue-400 rounded-full\"}),o.jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[o.jsx(\"p\",{className:\"text-sm text-gray-900\",children:\"New campaign started\"}),o.jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Searching for restaurants in San Francisco â€¢ 5 minutes ago\"})]})]}),o.jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[o.jsx(\"div\",{className:\"flex-shrink-0 w-2 h-2 mt-2 bg-yellow-400 rounded-full\"}),o.jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[o.jsx(\"p\",{className:\"text-sm text-gray-900\",children:\"API rate limit warning\"}),o.jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Google Places API approaching daily limit â€¢ 1 hour ago\"})]})]})]})]})]}),Db=()=>{const t=sn(),[e]=Hu(),[r,n]=k.useState(!0),[s,i]=k.useState(null);return k.useEffect(()=>{(async()=>{try{const{data:l,error:u}=await fe.auth.getSession();if(u)throw u;if(l!=null&&l.session)t(\"/dashboard\",{replace:!0});else{const c=e.get(\"error_description\"),d=e.get(\"error\");if(d)throw new Error(c||`Authentication error: ${d}`);t(\"/\",{replace:!0})}}catch(l){console.error(\"Auth callback error:\",l),i(l.message)}finally{n(!1)}})()},[t,e]),r?o.jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\",children:o.jsx(\"div\",{className:\"max-w-md w-full space-y-8 p-8\",children:o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto\"}),o.jsx(\"h2\",{className:\"mt-6 text-xl font-semibold text-gray-900 dark:text-gray-100\",children:\"Completing Sign In...\"}),o.jsx(\"p\",{className:\"mt-2 text-sm text-gray-600 dark:text-gray-400\",children:\"Please wait while we authenticate your account.\"})]})})}):s?o.jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\",children:o.jsx(\"div\",{className:\"max-w-md w-full space-y-8 p-8\",children:o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"w-16 h-16 bg-red-100 dark:bg-red-900/50 rounded-full flex items-center justify-center mx-auto\",children:o.jsx(\"svg\",{className:\"w-8 h-8 text-red-600 dark:text-red-400\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:o.jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.866-.833-2.536 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"})})}),o.jsx(\"h2\",{className:\"mt-6 text-xl font-semibold text-gray-900 dark:text-gray-100\",children:\"Authentication Failed\"}),o.jsx(\"p\",{className:\"mt-2 text-sm text-red-600 dark:text-red-400\",children:s}),o.jsx(\"div\",{className:\"mt-6\",children:o.jsx(\"button\",{onClick:()=>t(\"/\",{replace:!0}),className:\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",children:\"Return to Home\"})})]})})}):null},Ub=({onLocationChange:t,initialLocation:e={lat:40.7128,lng:-74.006,address:\"New York, NY\"},initialRadius:r=10})=>{var Ee;const[s,i]=k.useState(e),[a,l]=k.useState(r),[u,c]=k.useState(e.address),[d,h]=k.useState(!1),[f,y]=k.useState(\"idle\"),x=k.useRef(null),w=k.useRef(null),v=k.useRef(null),m=k.useRef(null),p=k.useRef(((Ee=window.google)==null?void 0:Ee.maps)??null),g=k.useRef(null),b=k.useRef(null),S=M=>{c(M),i(O=>{const C={...O,address:M};return t(C,a),C})},j=async M=>{const O=g.current;return O!=null&&O.Geocoder?new Promise(C=>{new O.Geocoder().geocode({address:M},(L,W)=>{if(W===\"OK\"&&(L!=null&&L[0])){const J=L[0].geometry.location;C({lat:J.lat(),lng:J.lng(),address:L[0].formatted_address})}else C(null)})}):null},N=async M=>{try{h(!0);const O=await j(M);if(O)return O;const A=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(M)}&limit=1`)).json();if(A&&A.length>0){const L=A[0];return{lat:parseFloat(L.lat),lng:parseFloat(L.lon),address:L.display_name}}return null}catch(O){return console.error(\"Geocoding error:\",O),null}finally{h(!1)}},P=async()=>{if(!u.trim())return;const M=await N(u);M?(c(M.address),i(M),t(M,a)):alert(\"Address not found. Please try a different address.\")},D=M=>{l(M),t(s,M)},T=[{value:1,label:\"1 mile\"},{value:5,label:\"5 miles\"},{value:10,label:\"10 miles\"},{value:25,label:\"25 miles\"},{value:50,label:\"50 miles\"},{value:100,label:\"100 miles\"}],z=()=>{const M=O=>Math.min(O*3.6,160);return o.jsxs(\"div\",{className:\"relative h-full w-full overflow-hidden bg-gradient-to-br from-green-100 via-blue-50 to-blue-100\",children:[o.jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-green-50 via-white to-blue-100 opacity-60\"}),o.jsxs(\"div\",{className:\"absolute inset-0 opacity-20\",children:[[...Array(6)].map((O,C)=>o.jsx(\"div\",{className:\"absolute border-t border-gray-400/70\",style:{top:`${C*20}%`,width:\"100%\"}},`h-${C}`)),[...Array(8)].map((O,C)=>o.jsx(\"div\",{className:\"absolute border-l border-gray-400/70\",style:{left:`${C*12.5}%`,height:\"100%\"}},`v-${C}`))]}),o.jsxs(\"div\",{className:\"absolute left-1/2 top-1/2 z-10 -translate-x-1/2 -translate-y-1/2\",children:[o.jsx(\"div\",{className:\"absolute -translate-x-1/2 -translate-y-1/2 rounded-full border-2 border-blue-500 border-dashed bg-blue-200/40\",style:{width:`${M(a)}px`,height:`${M(a)}px`}}),o.jsx(\"div\",{className:\"relative h-4 w-4 rounded-full border-2 border-white bg-red-500 shadow-lg\",children:o.jsx(\"div\",{className:\"absolute left-1/2 top-full -ml-[2px] border-l-[2px] border-r-[2px] border-t-[6px] border-l-transparent border-r-transparent border-t-red-500\"})})]}),o.jsx(\"div\",{className:\"absolute bottom-3 left-3 right-3 rounded-md bg-white/90 px-3 py-2 text-xs font-medium text-gray-800 shadow-sm\",children:s.address})]})},ue={idle:{label:\"Static preview\",className:\"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300\"},loading:{label:\"Loading maps\",className:\"bg-amber-100 text-amber-700 dark:bg-amber-500/10 dark:text-amber-200\"},ready:{label:\"Live map\",className:\"bg-emerald-100 text-emerald-700 dark:bg-emerald-500/10 dark:text-emerald-200\"},error:{label:\"Fallback preview\",className:\"bg-rose-100 text-rose-700 dark:bg-rose-500/10 dark:text-rose-200\"}}[f];k.useEffect(()=>{{p.current=null,g.current=null,b.current=null,y(\"idle\");return}},[void 0]);const Ce=M=>M<=1?14:M<=5?12:M<=10?11:M<=25?10:M<=50?8:7;return k.useEffect(()=>{var A,L,W;if(f!==\"ready\"||!x.current)return;const M=p.current,O=g.current;if(!M||!O){y(\"error\");return}const C={lat:s.lat,lng:s.lng};w.current?(w.current.setCenter(C),w.current.setZoom(Ce(a)),(A=v.current)==null||A.setPosition(C),(L=m.current)==null||L.setCenter(C),(W=m.current)==null||W.setRadius(a*1609.34)):(w.current=new O.Map(x.current,{center:C,zoom:Ce(a),disableDefaultUI:!0,zoomControl:!0}),v.current=new O.Marker({position:C,map:w.current,animation:M.Animation.DROP}),m.current=new O.Circle({map:w.current,center:C,radius:a*1609.34,strokeColor:\"#2563EB\",strokeOpacity:.8,strokeWeight:2,fillColor:\"#60A5FA\",fillOpacity:.2}))},[f,s,a]),o.jsxs(\"div\",{className:\"grid gap-6 lg:grid-cols-[minmax(0,380px),1fr]\",children:[o.jsxs(\"div\",{className:\"flex flex-col gap-4\",children:[o.jsx(\"section\",{className:\"rounded-2xl border border-slate-200 bg-white/90 p-5 shadow-sm backdrop-blur dark:border-slate-700 dark:bg-slate-900/60\",children:o.jsxs(\"div\",{className:\"space-y-5\",children:[o.jsxs(\"div\",{children:[o.jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400\",children:\"Primary Location\"}),o.jsx(\"label\",{className:\"mt-1 block text-base font-semibold text-slate-900 dark:text-slate-100\",children:\"Where should we focus discovery?\"}),o.jsxs(\"div\",{className:\"mt-3 flex flex-col gap-3 sm:flex-row\",children:[o.jsxs(\"div\",{className:\"flex flex-1 items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm transition focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500 dark:border-slate-600 dark:bg-slate-900\",children:[o.jsx(\"svg\",{className:\"h-5 w-5 text-blue-500 dark:text-sky-300\",viewBox:\"0 0 20 20\",fill:\"currentColor\",\"aria-hidden\":\"true\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 2a6 6 0 00-6 6c0 4.08 4.2 9.07 5.36 10.47a.84.84 0 001.28 0C11.8 17.07 16 12.08 16 8a6 6 0 00-6-6zm0 8.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z\",clipRule:\"evenodd\"})}),o.jsx(\"input\",{type:\"text\",value:u,onChange:M=>S(M.target.value),placeholder:\"Enter city, state, or address\",className:\"flex-1 border-none bg-transparent text-sm text-slate-900 outline-none placeholder:text-slate-400 focus:ring-0 dark:text-slate-100 dark:placeholder:text-slate-500\",onKeyPress:M=>M.key===\"Enter\"&&P(),onBlur:P,\"aria-label\":\"Location search input\"})]}),o.jsx(\"button\",{type:\"button\",onClick:P,disabled:d,className:\"inline-flex items-center justify-center rounded-xl bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60 dark:bg-sky-500 dark:hover:bg-sky-600\",children:d?\"Searchingâ€¦\":\"Search\"})]}),o.jsx(\"p\",{className:\"mt-2 text-xs text-slate-500 dark:text-slate-400\",children:\"Use a city, full address, or landmark. Weâ€™ll automatically match nearby businesses.\"})]}),o.jsxs(\"div\",{children:[o.jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400\",children:\"Search Radius\"}),o.jsx(\"label\",{className:\"mt-1 block text-base font-semibold text-slate-900 dark:text-slate-100\",children:\"How wide should we scan?\"}),o.jsx(\"div\",{className:\"mt-3 grid grid-cols-2 gap-2 sm:grid-cols-3\",role:\"radiogroup\",\"aria-label\":\"Search radius in miles\",children:T.map(M=>{const O=a===M.value;return o.jsx(\"button\",{type:\"button\",role:\"radio\",\"aria-checked\":O,onClick:()=>D(M.value),className:`flex items-center justify-center rounded-lg border px-3 py-2 text-sm font-medium transition-all focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-slate-900 ${O?\"border-blue-600 bg-blue-600 text-white shadow-sm dark:border-sky-400 dark:bg-sky-500\":\"border-slate-200 bg-white text-slate-600 hover:border-blue-400 hover:text-blue-600 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-200 dark:hover:border-sky-400\"}`,children:M.label},M.value)})}),o.jsx(\"p\",{className:\"mt-2 text-xs text-slate-500 dark:text-slate-400\",children:\"Tip: 10â€“25 miles captures metro areas, 50+ miles is ideal for statewide searches.\"})]})]})}),o.jsxs(\"section\",{className:\"relative overflow-hidden rounded-2xl border border-blue-100 bg-gradient-to-br from-blue-50 via-white to-blue-100 p-5 shadow-sm dark:border-sky-500/30 dark:from-slate-900 dark:via-slate-900/70 dark:to-slate-900\",children:[o.jsxs(\"div\",{className:\"relative z-10 flex flex-col gap-2\",children:[o.jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-blue-600 dark:text-sky-300\",children:\"Approximate Coverage\"}),o.jsxs(\"p\",{className:\"text-2xl font-semibold text-blue-900 dark:text-slate-100\",children:[\"~\",Math.round(Math.PI*a*a),\" square miles\"]}),o.jsxs(\"p\",{className:\"text-sm text-blue-700 dark:text-sky-200\",children:[\"Radius: \",a,\" miles Â· \",s.address]})]}),o.jsx(\"div\",{className:\"pointer-events-none absolute -right-16 -top-16 h-32 w-32 rounded-full border border-blue-200/70 bg-blue-200/40 dark:border-sky-500/40 dark:bg-sky-500/10\"}),o.jsx(\"div\",{className:\"pointer-events-none absolute -bottom-20 -left-10 h-28 w-28 rounded-full border border-blue-100/60 bg-blue-100/30 dark:border-sky-500/20 dark:bg-sky-500/10\"})]})]}),o.jsxs(\"section\",{className:\"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm dark:border-slate-700 dark:bg-slate-900/60\",children:[o.jsxs(\"div\",{className:\"mb-4 flex flex-wrap items-center justify-between gap-3\",children:[o.jsxs(\"div\",{children:[o.jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400\",children:\"Geographic Coverage\"}),o.jsx(\"h3\",{className:\"text-lg font-semibold text-slate-900 dark:text-slate-100\",children:\"Visualize your target radius\"}),o.jsx(\"p\",{className:\"mt-1 text-xs text-slate-500 dark:text-slate-400\",children:\"The preview updates instantly as you adjust the radius or address.\"})]}),o.jsx(\"span\",{className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold ${ue.className}`,children:ue.label})]}),o.jsx(\"div\",{className:\"relative overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900/80\",children:o.jsxs(\"div\",{className:\"relative aspect-[4/3] w-full max-h-[360px]\",children:[o.jsx(\"div\",{ref:x,className:`absolute inset-0 h-full w-full transition-opacity duration-300 ${f===\"ready\"?\"opacity-100\":\"pointer-events-none opacity-0\"}`}),f!==\"ready\"&&o.jsxs(\"div\",{className:\"absolute inset-0\",children:[o.jsx(z,{}),void 0,void 0]}),o.jsx(\"div\",{className:\"absolute left-3 top-3 rounded-full bg-gray-900/70 px-3 py-1 text-xs font-semibold text-white shadow\",children:\"Add a Google Maps API key for live coverage\"})]})})]})]})},Mb=[\"Automotive Services\",\"Education & Training\",\"Entertainment & Recreation\",\"Financial Services\",\"Food & Dining\",\"Government & Public Services\",\"Healthcare & Medical\",\"Home & Property Services\",\"Hospitality & Lodging\",\"Personal Care & Beauty\",\"Professional Services\",\"Religious & Community\",\"Retail & Shopping\",\"Technology & IT Services\",\"Transportation & Transit\"],vs={\"Automotive Services\":[\"Auto Body Shop\",\"Auto Detailing\",\"Auto Parts Store\",\"Automotive Glass Service\",\"Car Dealer\",\"Car Rental\",\"Car Repair\",\"Car Wash\",\"Electric Vehicle Charging Station\",\"Gas Station\",\"Motorcycle Dealer\",\"Oil Change Service\",\"Rv Dealer\",\"Smog Check Station\",\"Tire Shop\",\"Towing Service\",\"Transmission Shop\",\"Truck Dealer\"],\"Education & Training\":[\"Art School\",\"Charter School\",\"College\",\"Community College\",\"Cooking School\",\"Dance Studio\",\"Daycare\",\"Driving School\",\"Kindergarten\",\"Language School\",\"Library\",\"Music School\",\"Preschool\",\"Primary School\",\"Private School\",\"Public School\",\"School\",\"Secondary School\",\"Summer Camp Organizer\",\"Technical School\",\"Training Center\",\"Tutoring Center\",\"University\",\"Vocational School\"],\"Entertainment & Recreation\":[\"Amusement Park\",\"Aquarium\",\"Arcade\",\"Arena\",\"Art Gallery\",\"Banquet Hall\",\"Beach\",\"Botanical Garden\",\"Bowling Alley\",\"Casino\",\"Comedy Club\",\"Concert Hall\",\"Convention Center\",\"Escape Room\",\"Event Venue\",\"Fitness Center\",\"Golf Course\",\"Gym\",\"Karaoke Venue\",\"Marina\",\"Mini Golf\",\"Movie Theater\",\"Museum\",\"Night Club\",\"Paintball\",\"Park\",\"Rock Climbing Gym\",\"Ski Resort\",\"Sports Complex\",\"Stadium\",\"Swimming Pool\",\"Tennis Court\",\"Theater\",\"Tourist Attraction\",\"Trampoline Park\",\"Wedding Venue\",\"Yoga Studio\",\"Zoo\"],\"Financial Services\":[\"Atm\",\"Bank\",\"Check Cashing Service\",\"Credit Union\",\"Cryptocurrency Exchange\",\"Financial Planner\",\"Investment Firm\",\"Money Transfer Service\",\"Mortgage Broker\",\"Payday Lender\",\"Stock Broker\"],\"Food & Dining\":[\"Bakery\",\"Bar\",\"Barbecue Restaurant\",\"Brewery\",\"Brunch Restaurant\",\"Buffet\",\"Burger Joint\",\"Cafe\",\"Catering Service\",\"Chinese Restaurant\",\"Cocktail Bar\",\"Coffee Shop\",\"Deli\",\"Dessert Shop\",\"Distillery\",\"Donut Shop\",\"Fast Food Restaurant\",\"Food Court\",\"Food Stand\",\"Food Truck\",\"Ice Cream Shop\",\"Indian Restaurant\",\"Italian Restaurant\",\"Japanese Restaurant\",\"Juice Bar\",\"Meal Delivery\",\"Meal Takeaway\",\"Mexican Restaurant\",\"Pizza Restaurant\",\"Pub\",\"Restaurant\",\"Sandwich Shop\",\"Seafood Restaurant\",\"Smoothie Shop\",\"Steakhouse\",\"Sushi Restaurant\",\"Taco Place\",\"Tea House\",\"Wine Bar\",\"Winery\"],\"Government & Public Services\":[\"City Hall\",\"Consulate\",\"Courthouse\",\"County Office\",\"Dmv\",\"Embassy\",\"Fire Station\",\"Government Office\",\"Municipal Building\",\"Passport Office\",\"Police Station\",\"Post Office\",\"Public Library\",\"Public School\",\"Public Works\",\"Social Services Office\",\"Tax Office\",\"Voter Registration Office\"],\"Healthcare & Medical\":[\"Acupuncture Clinic\",\"Chiropractor\",\"Dental Clinic\",\"Dentist\",\"Doctor\",\"Drugstore\",\"Health Insurance Office\",\"Hospital\",\"Medical Center\",\"Medical Equipment Supplier\",\"Medical Lab\",\"Mental Health Clinic\",\"Occupational Therapist\",\"Optical Clinic\",\"Optometrist\",\"Orthodontist\",\"Pharmacy\",\"Physical Therapy\",\"Physiotherapist\",\"Psychiatrist\",\"Psychologist\",\"Skin Care Clinic\",\"Speech Therapist\",\"Urgent Care\",\"Veterinary Care\",\"Wellness Center\"],\"Home & Property Services\":[\"Appliance Repair\",\"Carpet Cleaning\",\"Cleaning Service\",\"Dry Cleaning\",\"Electrician\",\"Fence Contractor\",\"Flooring Contractor\",\"Gardener\",\"General Contractor\",\"Gutter Service\",\"Handyman\",\"Home Inspector\",\"Hvac Contractor\",\"Landscaping\",\"Laundry\",\"Locksmith\",\"Moving Company\",\"Painter\",\"Pest Control\",\"Plumber\",\"Pool Service\",\"Property Management\",\"Roofing Contractor\",\"Storage\",\"Window Cleaning\"],\"Hospitality & Lodging\":[\"Bed And Breakfast\",\"Boutique Hotel\",\"Campground\",\"Extended Stay Hotel\",\"Guest House\",\"Hostel\",\"Hotel\",\"Inn\",\"Lodge\",\"Motel\",\"Resort\",\"Rv Park\",\"Vacation Rental\"],\"Personal Care & Beauty\":[\"Barber Shop\",\"Beauty Salon\",\"Beautician\",\"Body Art Service\",\"Cosmetics Store\",\"Day Spa\",\"Eyebrow Threading\",\"Facial Spa\",\"Hair Care\",\"Hair Salon\",\"Makeup Artist\",\"Massage\",\"Nail Salon\",\"Piercing Shop\",\"Sauna\",\"Spa\",\"Tanning Studio\",\"Tattoo Parlor\",\"Waxing Salon\"],\"Professional Services\":[\"Accounting\",\"Advertising Agency\",\"Architecture Firm\",\"Attorney\",\"Business Center\",\"Consultant\",\"Corporate Office\",\"Employment Agency\",\"Engineering Office\",\"Financial Advisor\",\"Insurance Agency\",\"Lawyer\",\"Marketing Agency\",\"Notary\",\"Real Estate Agency\",\"Recruiter\",\"Tax Preparation\"],\"Religious & Community\":[\"Cemetery\",\"Church\",\"Civic Organization\",\"Community Center\",\"Crematorium\",\"Funeral Home\",\"Meditation Center\",\"Mosque\",\"Non-Profit Organization\",\"Place Of Worship\",\"Religious Center\",\"Social Club\",\"Spiritual Center\",\"Synagogue\",\"Temple\"],\"Retail & Shopping\":[\"Antique Shop\",\"Art Supply Store\",\"Bicycle Store\",\"Book Store\",\"Boutique\",\"Clothing Store\",\"Convenience Store\",\"Craft Store\",\"Department Store\",\"Discount Store\",\"Dollar Store\",\"Electronics Store\",\"Florist\",\"Furniture Store\",\"Garden Center\",\"Gift Shop\",\"Grocery Store\",\"Hardware Store\",\"Hobby Shop\",\"Home Goods Store\",\"Jewelry Store\",\"Liquor Store\",\"Music Store\",\"Office Supply Store\",\"Optical Store\",\"Outlet Store\",\"Party Supply Store\",\"Pet Store\",\"Second Hand Store\",\"Shoe Store\",\"Shopping Mall\",\"Sporting Goods Store\",\"Supermarket\",\"Thrift Store\",\"Tobacco Shop\",\"Toy Store\",\"Vape Shop\"],\"Technology & IT Services\":[\"App Development\",\"Cell Phone Store\",\"Co-Working Space\",\"Computer Repair\",\"Cybersecurity Firm\",\"Data Center\",\"Internet Cafe\",\"It Services\",\"Managed Services Provider\",\"Software Company\",\"Tech Support\",\"Telecommunications Service Provider\",\"Web Design\"],\"Transportation & Transit\":[\"Airport\",\"Bike Rental\",\"Bus Station\",\"Bus Tour Agency\",\"Car Sharing\",\"Cruise Agency\",\"Ferry Terminal\",\"Limousine Service\",\"Parking Garage\",\"Parking Lot\",\"Rest Area\",\"Ride Share Location\",\"Scooter Rental\",\"Shuttle Service\",\"Subway Station\",\"Taxi Stand\",\"Train Station\",\"Travel Agency\",\"Truck Stop\"]},Fb=({selectedCategories:t,selectedBusinessTypes:e,onCategoriesChange:r,onBusinessTypesChange:n})=>{const[s,i]=k.useState(!1),[a,l]=k.useState(\"\"),c=t.reduce((x,w)=>{const v=vs[w]||[];return[...x,...v]},[]).filter(x=>x.toLowerCase().includes(a.toLowerCase())),d=x=>{const w=t.includes(x)?t.filter(v=>v!==x):[...t,x];if(r(w),t.includes(x)){const v=vs[x]||[],m=e.filter(p=>!v.includes(p));n(m)}},h=x=>{const w=e.includes(x)?e.filter(v=>v!==x):[...e,x];n(w)},f=x=>{const w=vs[x]||[],v=[...new Set([...e,...w])];n(v)},y=x=>{const w=vs[x]||[],v=e.filter(m=>!w.includes(m));n(v)};return o.jsxs(\"div\",{className:\"space-y-4\",children:[o.jsxs(\"div\",{children:[o.jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\",children:[\"Business Categories (\",t.length,\" selected)\"]}),o.jsx(\"div\",{className:\"max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-800\",children:o.jsx(\"div\",{className:\"grid grid-cols-2 gap-2\",children:Mb.map(x=>{const w=t.includes(x);return o.jsxs(\"label\",{className:\"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-1 rounded\",children:[o.jsx(\"input\",{type:\"checkbox\",checked:w,onChange:()=>d(x),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"}),o.jsx(\"span\",{className:\"text-sm text-gray-900 dark:text-gray-100\",children:x})]},x)})})})]}),t.length>0&&o.jsxs(\"div\",{children:[o.jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[o.jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:[\"Business Types (\",e.length,\" selected)\"]}),o.jsx(\"button\",{onClick:()=>i(!s),className:\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400\",children:s?\"Hide Types\":\"Show Types\"})]}),s&&o.jsxs(\"div\",{className:\"space-y-3\",children:[o.jsx(\"input\",{type:\"text\",placeholder:\"Search business types...\",value:a,onChange:x=>l(x.target.value),className:\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm\"}),o.jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:t.map(x=>o.jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[o.jsxs(\"button\",{onClick:()=>f(x),className:\"text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200\",children:[\"All \",x]}),o.jsxs(\"button\",{onClick:()=>y(x),className:\"text-xs px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200\",children:[\"Clear \",x]})]},x))}),o.jsxs(\"div\",{className:\"max-h-60 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-3 bg-white dark:bg-gray-800\",children:[o.jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-2\",children:c.map(x=>{const w=e.includes(x);return o.jsxs(\"label\",{className:\"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-1 rounded\",children:[o.jsx(\"input\",{type:\"checkbox\",checked:w,onChange:()=>h(x),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"}),o.jsx(\"span\",{className:\"text-sm text-gray-900 dark:text-gray-100\",children:x})]},x)})}),c.length===0&&o.jsxs(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400 text-center py-4\",children:['No business types found for \"',a,'\"']})]})]})]}),e.length>0&&o.jsx(\"div\",{className:\"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md\",children:o.jsxs(\"div\",{className:\"text-sm text-blue-800 dark:text-blue-200\",children:[o.jsx(\"strong\",{children:\"Selected:\"}),\" \",e.slice(0,5).join(\", \"),e.length>5&&` +${e.length-5} more`]})})]})},Xu=({isDiscovering:t,progress:e,currentStage:r,cacheStats:n})=>!t&&!n?null:o.jsxs(\"div\",{className:\"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\",children:[t&&o.jsxs(o.Fragment,{children:[o.jsxs(\"div\",{className:\"flex items-center mb-4\",children:[o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsxs(\"svg\",{className:\"animate-spin h-5 w-5 text-blue-600 dark:text-blue-400\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[o.jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),o.jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]})}),o.jsxs(\"div\",{className:\"ml-3\",children:[o.jsx(\"h3\",{className:\"text-sm font-medium text-blue-800 dark:text-blue-200\",children:\"Progressive Enrichment in Progress\"}),o.jsx(\"p\",{className:\"text-sm text-blue-600 dark:text-blue-300\",children:r||`${e}% complete`})]})]}),o.jsx(\"div\",{className:\"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2\",children:o.jsx(\"div\",{className:\"bg-blue-600 dark:bg-blue-400 h-2 rounded-full transition-all duration-300\",style:{width:`${e}%`}})})]}),n&&o.jsxs(\"div\",{className:\"mt-4\",children:[o.jsx(\"h4\",{className:\"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2\",children:\"ðŸš€ Cache Performance (90-Day Intelligent Caching)\"}),o.jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:[o.jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600\",children:[o.jsxs(\"div\",{className:\"text-lg font-bold text-green-600 dark:text-green-400\",children:[n.cache_hit_ratio.toFixed(1),\"%\"]}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-gray-400\",children:\"Hit Ratio\"})]}),o.jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-blue-600 dark:text-blue-400\",children:n.cache_hits}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-gray-400\",children:\"Cache Hits\"})]}),o.jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-yellow-600 dark:text-yellow-400\",children:n.cache_misses}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-gray-400\",children:\"Cache Misses\"})]}),o.jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600\",children:[o.jsxs(\"div\",{className:\"text-lg font-bold text-green-600 dark:text-green-400\",children:[\"$\",n.cost_savings.toFixed(2)]}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-gray-400\",children:\"Saved\"})]})]})]})]}),zb={BASE:[\"Business verification\",\"Company data (name, industry, size)\",\"Phone & address validation\",\"Generic company email\"],PROFESSIONAL:[\"Everything in Base\",\"Professional email discovery & verification\",\"Email deliverability verification\",\"Enhanced company enrichment\"],ENTERPRISE:[\"Everything in Professional\",\"Executive contact enrichment\",\"Full compliance verification\",\"Advanced data validation\"]},Bb=({selectedTier:t,onTierChange:e,numberOfLeads:r})=>{const n=s=>s>=1?`$${s.toFixed(2)}`:s>=.01?`$${s.toFixed(3)}`:`$${s.toFixed(4)}`;return o.jsxs(\"div\",{children:[o.jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\",children:\"Data Enhancement Tiers\"}),o.jsx(\"div\",{className:\"space-y-2\",children:Object.entries(Yu).map(([s,i])=>{const a=s,l=r*i.price,u=zb[a];return o.jsxs(\"div\",{className:`rounded-lg p-4 cursor-pointer transition-all border-l-4 ${t===s?\"bg-blue-50 dark:bg-blue-950/30 border-l-blue-500 shadow-md dark:shadow-gray-900/20\":\"bg-gray-100 dark:bg-gray-700 border-l-gray-200 dark:border-l-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600 hover:border-l-gray-300 dark:hover:border-l-gray-500\"}`,onClick:()=>e(a),children:[o.jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[o.jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 dark:text-gray-100\",children:i.name}),i.badge&&o.jsx(\"span\",{className:`px-2 py-1 text-xs font-medium rounded-full ${i.badge===\"Most Popular\"?\"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200\":i.badge===\"Premium\"?\"bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-200\":\"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200\"}`,children:i.badge}),o.jsxs(\"div\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:[n(i.price),\" per lead\"]}),t===s&&o.jsxs(\"div\",{className:\"flex items-center text-sm text-blue-600 dark:text-blue-400\",children:[o.jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",clipRule:\"evenodd\"})}),\"Selected\"]})]}),o.jsxs(\"div\",{className:\"text-right\",children:[o.jsxs(\"div\",{className:\"text-2xl font-bold text-blue-600 dark:text-blue-400\",children:[\"$\",l.toFixed(2)]}),o.jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:\"Total cost\"})]})]}),o.jsx(\"div\",{className:\"flex items-start justify-between\",children:o.jsxs(\"div\",{className:\"flex-1\",children:[o.jsx(\"div\",{className:\"text-sm text-gray-600 dark:text-gray-300 mb-2\",children:i.description}),o.jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:u.map((c,d)=>o.jsxs(\"div\",{className:\"flex items-center text-xs bg-white dark:bg-gray-800 rounded-full px-2 py-1 border border-gray-200 dark:border-gray-600\",children:[o.jsx(\"svg\",{className:\"w-3 h-3 text-green-500 dark:text-green-400 mr-1 flex-shrink-0\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\",clipRule:\"evenodd\"})}),o.jsx(\"span\",{className:\"text-gray-700 dark:text-gray-200\",children:c})]},d))})]})})]},s)})})]})},Kd={campaigns:[],currentCampaign:null,leads:[],isLoading:!1,error:null},ze=v0()(y0(t=>({...Kd,addCampaign:e=>t(r=>({campaigns:[e,...r.campaigns]})),updateCampaign:(e,r)=>t(n=>{var s;return{campaigns:n.campaigns.map(i=>i.campaign_id===e?{...i,...r}:i),currentCampaign:((s=n.currentCampaign)==null?void 0:s.campaign_id)===e?{...n.currentCampaign,...r}:n.currentCampaign}}),setCurrentCampaign:e=>t({currentCampaign:e}),addLeads:e=>t(r=>({leads:[...r.leads,...e]})),updateLead:(e,r)=>t(n=>({leads:n.leads.map(s=>s.id===e?{...s,...r}:s)})),setLoading:e=>t({isLoading:e}),setError:e=>t({error:e}),clearLeads:()=>t({leads:[]}),reset:()=>t(Kd)}),{name:\"campaign-store\",partialize:t=>({campaigns:t.campaigns,leads:t.leads})})),Hb=t=>{var s;if(!t||typeof t!=\"object\")return\"Discovery failed due to an unknown error.\";const e=t,r=e.message||\"Edge function returned an error response.\",n=(s=e.context)==null?void 0:s.response;if(!n)return r;try{if(typeof n==\"string\"){const i=JSON.parse(n);return i!=null&&i.error?String(i.error):i!=null&&i.message?String(i.message):n}if(typeof n==\"object\"&&n!==null&&\"error\"in n){const{error:i}=n;if(i)return String(i)}}catch(i){return console.warn(\"Unable to parse edge function error response:\",i),r}return r},x0=t=>{const{user:e}=Pr(),{setLoading:r,setError:n,clearLeads:s,setCurrentCampaign:i}=ze(),[a,l]=k.useState(0),[u,c]=k.useState(\"\"),[d]=k.useState(null),h=Fp({mutationFn:async f=>{r(!0),n(null),l(10),c(\"Initializing user-aware discovery...\"),s(),i(null);try{if(console.log(\"ðŸš€ Starting user-aware business discovery:\",f),!await c0()||!(e!=null&&e.id))throw new Error(\"Please sign in to run a discovery campaign.\");const x=f.selectedTier||\"PROFESSIONAL\",w=Yu[x],v=f.keywords?f.keywords.split(\",\").map(N=>N.trim()).filter(Boolean):void 0,m={tradeAssociation:f.trade_association??!1,professionalLicense:f.professional_license??!1,chamberVerification:f.chamber_verification??!1,apolloDiscovery:x===\"ENTERPRISE\"};c(`Using ${w.name} tier ($${w.price}/lead)`),l(20);const p=await Jw(),g={tier:x,tierName:w.name,unitPrice:w.price,estimatedBudget:f.max_results*w.price,currency:\"USD\"},{data:b,error:S}=await fe.functions.invoke(\"business-discovery-background\",{body:{businessType:f.business_type||f.search_terms,location:f.location,keywords:v,searchRadius:f.search_radius,expandGeography:f.expand_geography,maxResults:f.max_results,budgetLimit:f.max_results*w.price,minConfidenceScore:f.min_confidence_score||50,tierKey:x,tierName:w.name,tierPrice:w.price,options:m,sessionUserId:e.id,userId:e.id,billingContext:g},headers:p?{Authorization:`Bearer ${p}`}:void 0});if(S)throw console.error(\"âŒ Background discovery error:\",S),new Error(Hb(S));if(!b||!b.success){const N=typeof(b==null?void 0:b.error)==\"string\"?b.error:\"No data returned from background discovery\";throw new Error(N)}console.log(\"âœ… Background discovery response:\",b);const j={campaign_id:b.campaignId,job_id:b.jobId,status:b.status,estimated_time:b.estimatedTime,realtime_channel:b.realtimeChannel,total_found:0,qualified_count:0,total_cost:0,processing_time:\"< 100ms\",tier_used:w.name,cache_performance:void 0,vault_status:\"secured\",census_intelligence:void 0,businesses:[]};return l(100),c(\"Complete! ðŸŽ‰\"),j}catch(y){throw console.error(\"âŒ User-aware discovery error:\",y),c(\"Failed âŒ\"),y}finally{r(!1)}},onSuccess:f=>{if(console.log(\"âœ… Background job created:\",f),l(100),c(\"Background processing started! ðŸš€\"),f.job_id&&f.campaign_id){const y={jobId:f.job_id,campaignId:f.campaign_id,status:f.status||\"pending\",estimatedTime:f.estimated_time};console.log(\"Job started:\",y),t&&t(y)}},onError:f=>{n(f instanceof Error?f.message:\"User-aware discovery failed\"),l(0),c(\"Failed âŒ\")}});return{startDiscovery:h.mutate,isDiscovering:h.isPending,progress:a,currentStage:u,cacheStats:d,error:h.error,data:h.data}},xe=t=>t==null?\"\":`\"${String(t).replace(/\"/g,'\"\"')}\"`,Wb=t=>{var r,n,s,i,a;if(t.email)return t.email;const e=(n=(r=t.enrichment_data)==null?void 0:r.emails)==null?void 0:n.find(l=>l.verified);return(e==null?void 0:e.email)||((a=(i=(s=t.enrichment_data)==null?void 0:s.emails)==null?void 0:i[0])==null?void 0:a.email)||\"\"},Vb=t=>{var s,i;const e=t.owner_data||{};if(e&&Object.keys(e).length>0)return e;const r=(i=(s=t.enrichment_data)==null?void 0:s.emails)==null?void 0:i.find(a=>{var l;return(l=a.type)==null?void 0:l.toLowerCase().includes(\"owner\")});return r?{name:[r.firstName,r.lastName].filter(Boolean).join(\" \"),email:r.email,phone:r.phone,confidence_score:r.confidence}:{}},Zu=(t,e={})=>{if(!t.length){console.warn(\"No leads provided for export.\");return}const r=[\"Business Name\",\"Address\",\"Phone\",\"Website\",\"Email\",\"Confidence Score\",\"Validation Status\",\"Cost to Acquire\",\"Data Sources\",\"Enrichment Tier\",\"Vault Secured\",\"Hunter Verified\",\"NeverBounce Verified\",\"License Verified\",\"Owner Name\",\"Owner Email\",\"Owner Phone\",\"Owner Confidence Score\"],n=t.map(u=>{var h,f,y,x;const c=((h=u.enrichment_data)==null?void 0:h.dataSources)||u.data_sources||[],d=Vb(u);return[xe(u.business_name),xe(u.address||\"\"),xe(u.phone||\"\"),xe(u.website||\"\"),xe(Wb(u)),xe(u.confidence_score??\"\"),xe(u.validation_status||\"\"),xe((u.cost_to_acquire??0).toFixed(3)),xe(c.join(\"; \")),xe(u.enrichment_tier||\"\"),xe(u.vault_secured?\"Yes\":\"No\"),xe((f=u.enrichment_data)!=null&&f.hunterVerified?\"Yes\":\"No\"),xe((y=u.enrichment_data)!=null&&y.neverBounceVerified?\"Yes\":\"No\"),xe((x=u.enrichment_data)!=null&&x.licenseVerified?\"Yes\":\"No\"),xe(d.name||\"\"),xe(d.email||\"\"),xe(d.phone||\"\"),xe(d.confidence_score??\"\")].join(\",\")}),s=[r.join(\",\"),...n].join(`\n`),i=new Blob([s],{type:\"text/csv;charset=utf-8;\"}),a=document.createElement(\"a\"),l=URL.createObjectURL(i);a.href=l,a.download=e.fileName||`campaign-leads-${new Date().toISOString().split(\"T\")[0]}.csv`,a.style.display=\"none\",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)},Gd=\"Home & Property Services\",qb={lat:40.7128,lng:-74.006,address:\"New York, NY\"},Kb=10,Gb=[{id:1,title:\"Targeting\",description:\"Audience & geography\"},{id:2,title:\"Campaign setup\",description:\"Tier & quantity\"},{id:3,title:\"Results\",description:\"Leads & export\"}],Qb=t=>t>=90?\"border border-emerald-200 bg-emerald-50 text-emerald-700 dark:border-emerald-400 dark:bg-transparent dark:text-emerald-300\":t>=80?\"border border-sky-200 bg-sky-50 text-sky-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\":t>=70?\"border border-amber-200 bg-amber-50 text-amber-700 dark:border-amber-400 dark:bg-transparent dark:text-amber-300\":\"border border-rose-200 bg-rose-50 text-rose-700 dark:border-rose-400 dark:bg-transparent dark:text-rose-300\",Jb=t=>{switch(t){case\"validated\":return\"border border-emerald-200 bg-emerald-50 text-emerald-700 dark:border-emerald-400 dark:bg-transparent dark:text-emerald-300\";case\"validating\":return\"border border-sky-200 bg-sky-50 text-sky-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\";case\"pending\":return\"border border-amber-200 bg-amber-50 text-amber-700 dark:border-amber-400 dark:bg-transparent dark:text-amber-300\";case\"failed\":return\"border border-rose-200 bg-rose-50 text-rose-700 dark:border-rose-400 dark:bg-transparent dark:text-rose-300\";default:return\"border border-gray-200 bg-gray-50 text-gray-700 dark:border-slate-500 dark:bg-transparent dark:text-slate-300\"}},Qd=()=>{const t=sn(),{user:e,loading:r}=Pr(),n=$=>{console.log(\"ðŸš€ Job created, navigating to progress page:\",$),t(`/campaign/${$.campaignId}/progress?jobId=${$.jobId}`)},{startDiscovery:s,isDiscovering:i,progress:a,currentStage:l,cacheStats:u,error:c}=x0(n),d=vs[Gd]||[],[h,f]=k.useState([Gd]),[y,x]=k.useState(d.length>0?[d[0]]:[]),[w,v]=k.useState(\"\"),[m,p]=k.useState(qb),[g,b]=k.useState(Kb),[S,j]=k.useState(!1),[N,P]=k.useState(3),[D,T]=k.useState(\"BASE\"),[z,G]=k.useState(1),ue=Yu[D],Ce=N*ue.price,Ee=(N-1)/9*100,{leads:M,currentCampaign:O}=ze(),C=k.useMemo(()=>O?M.filter($=>$.campaign_id===O.campaign_id):M,[M,O]),A=k.useMemo(()=>C.filter($=>$.confidence_score>=70).length,[C]),L=C.length>0;k.useEffect(()=>{L&&z===2&&!i&&G(3)},[L,z,i]);const W=()=>{C.length&&Zu(C,{fileName:`campaign-${(O==null?void 0:O.campaign_id)||Date.now()}-results.csv`})},J=()=>{O&&t(`/campaign?id=${O.campaign_id}`)},F=w.split(\",\").map($=>$.trim()).filter($=>$.length>0).join(\", \"),Z=y.join(\", \"),ee=Math.round(Math.PI*g*g),Pe=y.length>0&&m.address.trim().length>0,Tr=($,Rr)=>{p($),b(Rr)},wt=()=>{if(!Pe){alert(\"Please select at least one business type and provide a location.\");return}G(2)},di=()=>{G(1)},w0=()=>{if(!e){alert(\"Please sign in to run a discovery campaign.\");return}if(!Pe){G(1),alert(\"Please complete targeting details before running the campaign.\");return}const $={search_terms:`${Z}${F?` ${F}`:\"\"}`.trim(),location:m.address.trim(),business_type:Z,budget_limit:Ce,max_results:N,include_email_validation:D===\"PROFESSIONAL\"||D===\"ENTERPRISE\",include_website_validation:!0,min_confidence_score:70,chamber_verification:!0,trade_association:!0,professional_license:!0,keywords:F,search_radius:`${g} miles`,expand_geography:S,selectedTier:D};console.log(\"ðŸš€ Starting campaign:\",$),s($)},b0=y.length?(()=>{const $=y.slice(0,5).join(\", \"),Rr=y.length-5;return Rr>0?`${$} +${Rr} more`:$})():\"No business types selected\",k0=[{label:\"Business categories\",value:h.length>0?h.join(\", \"):\"No categories selected\"},{label:\"Business types\",value:b0},{label:\"Keywords\",value:F.length>0?F:\"None\"},{label:\"Location\",value:m.address},{label:\"Radius\",value:`${g} miles`},{label:\"Geography\",value:S?\"Auto-expand enabled\":\"Stay within radius\"},{label:\"Coverage\",value:`~${ee} square miles`}];return r?o.jsx(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-6 text-center shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:o.jsxs(\"div\",{className:\"flex items-center justify-center space-x-3 text-gray-600 dark:text-slate-300\",children:[o.jsx(\"div\",{className:\"h-6 w-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\"}),o.jsx(\"span\",{children:\"Loading your workspaceâ€¦\"})]})}):e?o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"div\",{className:\"border-b border-gray-200 px-6 py-4 dark:border-slate-700\",children:o.jsx(\"div\",{className:\"flex flex-wrap items-center gap-4\",children:Gb.map($=>{const Rr=z===$.id,ec=z>$.id,_0=$.id===1||$.id===2&&Pe||$.id===3,S0=$.id===2&&!Pe,tc=!_0||S0;return o.jsxs(\"button\",{type:\"button\",disabled:tc,onClick:()=>G($.id),className:`flex items-center gap-3 rounded-md border px-4 py-2 text-left transition-colors ${Rr?\"border-blue-600 bg-blue-50 text-blue-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\":ec?\"border-blue-200 bg-white text-blue-600 dark:border-slate-600 dark:bg-transparent dark:text-sky-300\":\"border-transparent bg-white text-gray-600 hover:border-blue-200 hover:text-blue-700 dark:border-transparent dark:bg-transparent dark:text-slate-300 dark:hover:border-sky-400\"} ${tc?\"cursor-not-allowed opacity-60\":\"\"}`,children:[o.jsx(\"span\",{className:`flex h-8 w-8 items-center justify-center rounded-full border-2 text-sm font-semibold ${Rr?\"border-blue-600 bg-blue-600 text-white dark:border-sky-400 dark:bg-sky-400 dark:text-slate-900\":ec?\"border-blue-300 bg-blue-100 text-blue-700 dark:border-sky-400 dark:bg-transparent dark:text-sky-300\":\"border-gray-300 bg-white text-gray-500 dark:border-slate-600 dark:bg-transparent dark:text-slate-400\"}`,\"aria-hidden\":\"true\",children:$.id}),o.jsxs(\"span\",{className:\"flex flex-col\",children:[o.jsx(\"span\",{className:\"text-sm font-semibold\",children:$.title}),o.jsx(\"span\",{className:\"text-xs text-gray-500 dark:text-slate-400\",children:$.description})]})]},$.id)})})}),o.jsxs(\"div\",{className:\"p-6 space-y-8\",children:[o.jsxs(\"section\",{className:`space-y-6 ${z===1?\"\":\"hidden\"}`,\"aria-hidden\":z!==1,children:[o.jsxs(\"header\",{children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 dark:text-gray-100\",children:\"Targeting & Geography\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300 mt-1\",children:\"Choose the businesses and regions you want ProspectPro to discover.\"})]}),o.jsx(Fb,{selectedCategories:h,selectedBusinessTypes:y,onCategoriesChange:f,onBusinessTypesChange:x}),o.jsxs(\"div\",{children:[o.jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\",children:\"Additional Keywords (Optional)\"}),o.jsx(\"input\",{type:\"text\",value:w,onChange:$=>v($.target.value),placeholder:\"e.g., luxury, organic, 24-hour (comma-separated)\",className:\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400\"}),o.jsx(\"p\",{className:\"text-xs text-gray-500 dark:text-gray-400 mt-1\",children:\"Add comma-separated keywords to refine your search.\"})]}),o.jsxs(\"div\",{className:\"space-y-4\",children:[o.jsx(Ub,{onLocationChange:Tr,initialLocation:m,initialRadius:g}),o.jsxs(\"div\",{className:\"flex items-center\",children:[o.jsx(\"input\",{type:\"checkbox\",id:\"expandGeography\",checked:S,onChange:$=>j($.target.checked),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700\"}),o.jsx(\"label\",{htmlFor:\"expandGeography\",className:\"ml-2 text-sm text-gray-700 dark:text-gray-300\",children:\"Expand geography automatically if initial results are limited\"})]})]}),o.jsx(\"div\",{className:\"flex justify-end\",children:o.jsx(\"button\",{type:\"button\",onClick:wt,className:\"px-5 py-2 rounded-md bg-blue-600 text-white font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\",disabled:!Pe,children:\"Continue to Campaign Setup\"})})]}),o.jsxs(\"section\",{className:`space-y-6 ${z===2?\"\":\"hidden\"}`,\"aria-hidden\":z!==2,children:[o.jsxs(\"header\",{className:\"flex items-center justify-between\",children:[o.jsxs(\"div\",{children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 dark:text-gray-100\",children:\"Campaign Setup\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300 mt-1\",children:\"Review your targeting, then select enrichment tier and lead quantity.\"})]}),o.jsx(\"button\",{type:\"button\",onClick:di,className:\"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-300\",children:\"â† Edit targeting\"})]}),o.jsxs(\"div\",{className:\"rounded-md border border-gray-200 bg-gray-50 p-4 dark:border-slate-700 dark:bg-slate-900/80\",children:[o.jsx(\"h3\",{className:\"mb-3 text-sm font-semibold text-gray-800 dark:text-slate-200\",children:\"Campaign summary\"}),o.jsx(\"dl\",{className:\"grid gap-3 sm:grid-cols-2\",children:k0.map($=>o.jsxs(\"div\",{className:\"flex flex-col\",children:[o.jsx(\"dt\",{className:\"text-xs uppercase tracking-wide text-gray-500 dark:text-slate-400\",children:$.label}),o.jsx(\"dd\",{className:\"text-sm text-gray-800 dark:text-slate-100\",children:$.value})]},$.label))})]}),o.jsx(Bb,{selectedTier:D,onTierChange:T,numberOfLeads:N}),o.jsxs(\"div\",{children:[o.jsx(\"label\",{className:\"mb-2 block text-sm font-medium text-gray-700 dark:text-slate-200\",children:\"Number of Leads\"}),o.jsxs(\"div\",{className:\"flex items-center gap-4\",children:[o.jsx(\"input\",{type:\"range\",min:\"1\",max:\"10\",value:N,onChange:$=>P(parseInt($.target.value,10)),className:\"h-2 flex-1 cursor-pointer appearance-none rounded-full bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500\",style:{background:`linear-gradient(90deg, #2563eb 0%, #2563eb ${Ee}%, #d1d5db ${Ee}%, #d1d5db 100%)`,accentColor:\"#2563eb\"}}),o.jsxs(\"div\",{className:\"min-w-fit rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-sm font-medium text-blue-700 dark:border-sky-400 dark:bg-slate-900 dark:text-sky-300\",children:[N,\" leads\"]})]})]}),o.jsx(\"div\",{className:\"rounded-lg border-2 border-yellow-400 bg-white p-4 shadow-sm dark:border-amber-400 dark:bg-slate-900\",children:o.jsxs(\"div\",{className:\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\",children:[o.jsxs(\"div\",{children:[o.jsx(\"p\",{className:\"text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-slate-300\",children:\"Estimated cost\"}),o.jsx(\"div\",{className:\"mt-1 flex items-baseline gap-x-3\",children:o.jsxs(\"span\",{className:\"text-3xl font-bold text-blue-700 dark:text-sky-300\",children:[\"$\",Ce.toFixed(2)]})})]}),o.jsxs(\"div\",{className:\"flex w-full flex-col items-start gap-2 sm:w-auto sm:items-end\",children:[o.jsxs(\"span\",{className:\"text-sm text-gray-600 dark:text-slate-400\",children:[N,\" leads Ã— $\",ue.price.toFixed(2)]}),o.jsxs(\"div\",{className:\"flex flex-wrap items-center gap-2\",children:[o.jsx(\"span\",{className:\"rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-xs font-medium text-blue-700 dark:border-sky-400 dark:bg-slate-900 dark:text-sky-300\",children:ue.name}),o.jsx(\"button\",{type:\"button\",onClick:w0,disabled:i,className:\"inline-flex items-center justify-center rounded-md bg-blue-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60 dark:bg-sky-500 dark:hover:bg-sky-600\",children:i?o.jsxs(o.Fragment,{children:[o.jsxs(\"svg\",{className:\"-ml-1 mr-2 h-4 w-4 animate-spin text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[o.jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),o.jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Runningâ€¦\"]}):\"Run Campaign\"})]})]})]})}),o.jsx(Xu,{isDiscovering:i,progress:a,currentStage:l,cacheStats:u})]}),o.jsxs(\"section\",{className:`space-y-6 ${z===3?\"\":\"hidden\"}`,\"aria-hidden\":z!==3,children:[o.jsxs(\"header\",{className:\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\",children:[o.jsxs(\"div\",{children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 dark:text-gray-100\",children:\"Campaign Results\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300 mt-1\",children:L?`${C.length} leads captured â€¢ ${A} qualified`:i?\"We're still enriching this campaign. Hang tight while ProspectPro verifies contacts.\":\"Results will appear here once a campaign finishes. You can keep working in the meantime.\"})]}),o.jsxs(\"div\",{className:\"flex flex-wrap gap-3\",children:[O&&o.jsx(\"button\",{type:\"button\",onClick:J,className:\"inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-slate-600 dark:bg-transparent dark:text-slate-200 dark:hover:border-sky-400\",children:\"View full campaign\"}),L&&o.jsx(\"button\",{type:\"button\",onClick:W,className:\"inline-flex items-center gap-2 rounded-md border border-emerald-400 px-4 py-2 text-sm font-semibold text-emerald-700 transition-colors hover:bg-emerald-50 dark:border-emerald-400 dark:text-emerald-300 dark:hover:bg-transparent\",children:\"ðŸ“Š Export CSV\"})]})]}),O&&o.jsx(\"div\",{className:\"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-slate-700 dark:bg-slate-900/70\",children:o.jsxs(\"div\",{className:\"flex flex-wrap items-start justify-between gap-4\",children:[o.jsxs(\"div\",{children:[o.jsx(\"div\",{className:\"text-xs uppercase tracking-wide text-gray-500 dark:text-slate-400\",children:\"Campaign ID\"}),o.jsx(\"div\",{className:\"text-sm font-semibold text-gray-900 dark:text-slate-100\",children:O.campaign_id}),o.jsxs(\"div\",{className:\"mt-2 text-xs text-gray-500 dark:text-slate-400\",children:[\"Status â€¢ \",O.status]})]}),o.jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 sm:grid-cols-4\",children:[o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-gray-900 dark:text-slate-100\",children:O.leads_found??C.length}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-slate-400\",children:\"Total Leads\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-blue-600 dark:text-sky-300\",children:O.leads_qualified??A}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-slate-400\",children:\"Qualified\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-green-600 dark:text-emerald-300\",children:O.leads_validated??0}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-slate-400\",children:\"Validated\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-purple-600 dark:text-violet-300\",children:O.tier_used||D}),o.jsx(\"div\",{className:\"text-xs text-gray-600 dark:text-slate-400\",children:\"Tier\"})]})]})]})}),o.jsx(\"div\",{className:\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden shadow-sm\",children:L?o.jsx(\"div\",{className:\"overflow-x-auto\",children:o.jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\",children:[o.jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-900/40\",children:o.jsxs(\"tr\",{children:[o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\",children:\"Business\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\",children:\"Contact\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\",children:\"Confidence\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\",children:\"Enrichment\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\",children:\"Status\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-600 dark:text-gray-300\",children:\"Cost\"})]})}),o.jsx(\"tbody\",{className:\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\",children:C.map($=>o.jsxs(\"tr\",{className:\"hover:bg-gray-50 dark:hover:bg-gray-900/30\",children:[o.jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:[o.jsx(\"div\",{className:\"text-sm font-semibold text-gray-900 dark:text-gray-100\",children:$.business_name}),o.jsx(\"div\",{className:\"mt-1 text-xs text-gray-500 dark:text-gray-400\",children:$.address})]}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{className:\"text-sm text-gray-900 dark:text-gray-100 space-y-1\",children:[$.phone&&o.jsxs(\"div\",{children:[\"ðŸ“ž \",$.phone]}),$.website&&o.jsxs(\"div\",{children:[\"ðŸŒ\",\" \",o.jsx(\"a\",{href:$.website,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-blue-600 dark:text-blue-400 hover:underline\",children:$.website.replace(/^https?:\\/\\//,\"\")})]}),$.email&&o.jsxs(\"div\",{children:[\"ðŸ“§ \",$.email]})]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"span\",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Qb($.confidence_score)}`,children:[$.confidence_score,\"%\"]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{className:\"flex flex-col space-y-1\",children:[o.jsx(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300\",children:$.enrichment_tier||ue.name}),$.vault_secured&&o.jsx(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300\",children:\"ðŸ” Vault Secured\"})]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsx(\"span\",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Jb($.validation_status)}`,children:$.validation_status||\"pending\"})}),o.jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200\",children:[\"$\",$.cost_to_acquire.toFixed(2)]})]},$.id))})]})}):o.jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-16 text-center\",children:[o.jsx(\"span\",{className:\"text-4xl mb-2\",children:\"ðŸ”\"}),o.jsx(\"h3\",{className:\"text-base font-semibold text-gray-900 dark:text-gray-100\",children:i?\"ProspectPro is working on your campaign\":\"No leads yet\"}),o.jsx(\"p\",{className:\"mt-2 max-w-md text-sm text-gray-600 dark:text-gray-300\",children:i?\"Please keep this tab open. We'll move results here automatically once enrichment finishes.\":\"Launch or complete a campaign to populate results with verified leads.\"})]})})]}),c&&o.jsx(\"div\",{className:\"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md\",children:o.jsxs(\"div\",{className:\"flex\",children:[o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsx(\"svg\",{className:\"h-5 w-5 text-red-400 dark:text-red-500\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\",clipRule:\"evenodd\"})})}),o.jsxs(\"div\",{className:\"ml-3\",children:[o.jsx(\"h3\",{className:\"text-sm font-medium text-red-800 dark:text-red-200\",children:\"Discovery Failed\"}),o.jsx(\"div\",{className:\"mt-2 text-sm text-red-700 dark:text-red-300\",children:o.jsx(\"p\",{children:c instanceof Error?c.message:String(c)})})]})]})})]})]}):o.jsxs(\"div\",{className:\"rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm dark:border-slate-700 dark:bg-slate-900\",children:[o.jsx(\"h1\",{className:\"text-2xl font-semibold text-gray-900 dark:text-gray-100\",children:\"Sign in required\"}),o.jsx(\"p\",{className:\"mt-3 text-sm text-gray-600 dark:text-gray-300\",children:\"Create an account or sign in to launch new campaigns and access verified leads.\"})]})},Yb=()=>{const{user:t}=Pr(),[e,r]=k.useState(0),[n,s]=k.useState(\"\"),[i,a]=k.useState(0),[l,u]=k.useState(0),c=Fp({mutationFn:async f=>{var y,x,w,v,m,p;r(10),s(`Enriching ${f.businessName}...`);try{if(console.log(\"ðŸ”„ Starting enrichment for:\",f.businessName),!await c0()||!(t!=null&&t.id))throw new Error(\"Please sign in to run lead enrichment.\");const b={tier:f.tier??\"professional\",maxCostPerBusiness:f.maxCostPerBusiness??.5,currency:\"USD\"},{data:S,error:j}=await fe.functions.invoke(\"enrichment-orchestrator\",{body:{businessName:f.businessName,domain:(y=f.domain)==null?void 0:y.replace(/^https?:\\/\\//,\"\").replace(/\\/$/,\"\"),address:f.address,phone:f.phone,website:f.website,industry:f.industry,state:f.state,includeBusinessLicense:f.includeBusinessLicense??!0,discoverEmails:f.discoverEmails??!0,verifyEmails:f.verifyEmails??!0,includeCompanyEnrichment:f.includeCompanyEnrichment??!1,includePersonEnrichment:f.includePersonEnrichment??!1,apolloEnrichment:f.apolloEnrichment??!1,maxCostPerBusiness:f.maxCostPerBusiness??.5,minConfidenceScore:f.minConfidenceScore??50,tier:f.tier??\"professional\",sessionUserId:t.id,userId:t.id,billingContext:b}});if(j)throw console.error(\"âŒ Enrichment error:\",j),new Error(`Enrichment failed: ${j.message}`);if(!S||!S.success)throw new Error(((v=(w=(x=S==null?void 0:S.processingMetadata)==null?void 0:x.errors)==null?void 0:w[0])==null?void 0:v.error)||\"Enrichment service returned no data\");return console.log(\"âœ… Enrichment complete:\",S),r(100),s(`Found ${((p=(m=S.enrichedData)==null?void 0:m.emails)==null?void 0:p.length)||0} emails`),S}catch(g){throw console.error(\"âŒ Enrichment error:\",g),s(\"Enrichment failed\"),g}},onSuccess:f=>{a(y=>y+1),u(y=>y+f.totalCost)}}),d=async(f,y)=>{var v;const x=[],w=[];r(0),a(0),u(0);for(let m=0;m<f.length;m++){const p=f[m];s(`Enriching ${m+1}/${f.length}: ${p.businessName}...`),r(Math.round(m/f.length*100));try{const g=await c.mutateAsync({businessName:p.businessName,website:p.website,domain:(v=p.website)==null?void 0:v.replace(/^https?:\\/\\//,\"\").replace(/\\/$/,\"\"),address:p.address,phone:p.phone,...y});x.push(g)}catch(g){console.error(`âŒ Failed to enrich ${p.businessName}:`,g),w.push({businessName:p.businessName,error:g instanceof Error?g.message:\"Unknown error\"})}}return r(100),s(`Enriched ${x.length}/${f.length} leads`),{results:x,errors:w}},h=()=>{r(0),s(\"\"),a(0),u(0)};return{enrichLead:c.mutate,enrichLeadAsync:c.mutateAsync,enrichMultipleLeads:d,isEnriching:c.isPending,progress:e,currentStage:n,enrichedCount:i,totalCost:l,error:c.error,data:c.data,reset:h}},Xb=({campaignId:t,onComplete:e})=>{const{leads:r,updateLead:n}=ze(),{enrichMultipleLeads:s,isEnriching:i,progress:a,currentStage:l,enrichedCount:u,totalCost:c,reset:d}=Yb(),[h,f]=k.useState(!1),x=r.filter(v=>v.campaign_id===t).filter(v=>{var m;return!((m=v.enrichment_data)!=null&&m.hunterVerified)}),w=async()=>{if(x.length===0){alert(\"All leads are already enriched!\");return}f(!0),d();try{const{results:v,errors:m}=await s(x.map(p=>({businessName:p.business_name,website:p.website,address:p.address,phone:p.phone})),{includeBusinessLicense:!0,discoverEmails:!0,verifyEmails:!0,maxCostPerBusiness:.5});v.forEach((p,g)=>{var S,j,N,P,D,T,z,G,ue,Ce,Ee;const b=x[g];b&&n(b.id,{email:((N=(j=(S=p.enrichedData)==null?void 0:S.emails)==null?void 0:j[0])==null?void 0:N.email)||b.email,enrichment_data:{...b.enrichment_data||{},emails:((P=p.enrichedData)==null?void 0:P.emails)||[],businessLicense:(D=p.enrichedData)==null?void 0:D.businessLicense,hunterVerified:(((z=(T=p.enrichedData)==null?void 0:T.emails)==null?void 0:z.length)||0)>0,neverBounceVerified:(ue=(G=p.enrichedData)==null?void 0:G.emails)==null?void 0:ue.some(M=>M.verified),licenseVerified:((Ee=(Ce=p.enrichedData)==null?void 0:Ce.businessLicense)==null?void 0:Ee.isValid)||!1,processingMetadata:{...p.processingMetadata,totalCost:p.totalCost,enrichmentCostBreakdown:p.costBreakdown}}})}),setTimeout(()=>{alert(`Enrichment Complete!\n\nâœ… Enriched: ${v.length} leads\nâŒ Failed: ${m.length} leads\nðŸ’° Total Cost: $${c.toFixed(3)}\nðŸ“§ Emails Found: ${v.reduce((p,g)=>{var b,S;return p+(((S=(b=g.enrichedData)==null?void 0:b.emails)==null?void 0:S.length)||0)},0)}`),f(!1),e==null||e()},1e3)}catch(v){console.error(\"Enrichment error:\",v),alert(`Enrichment failed: ${v instanceof Error?v.message:\"Unknown error\"}`),f(!1)}};return x.length===0?o.jsx(\"button\",{disabled:!0,className:\"px-4 py-2 bg-gray-300 text-gray-600 rounded-lg cursor-not-allowed\",children:\"âœ… All Leads Enriched\"}):o.jsxs(\"div\",{className:\"space-y-3\",children:[o.jsx(\"button\",{onClick:w,disabled:i,className:`px-6 py-3 rounded-lg font-semibold transition-all ${i?\"bg-blue-400 cursor-wait\":\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\"} text-white shadow-md`,children:i?o.jsxs(\"span\",{className:\"flex items-center gap-2\",children:[o.jsxs(\"svg\",{className:\"animate-spin h-5 w-5\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[o.jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),o.jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Enriching...\"]}):`ðŸš€ Enrich ${x.length} Leads`}),h&&o.jsx(\"div\",{className:\"bg-white border border-blue-200 rounded-lg p-4 shadow-sm\",children:o.jsxs(\"div\",{className:\"space-y-2\",children:[o.jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3 overflow-hidden\",children:o.jsx(\"div\",{className:\"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-300\",style:{width:`${a}%`}})}),o.jsxs(\"div\",{className:\"flex justify-between items-center text-sm\",children:[o.jsx(\"span\",{className:\"text-gray-700 font-medium\",children:l}),o.jsxs(\"span\",{className:\"text-gray-600\",children:[a,\"%\"]})]}),o.jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 pt-2 border-t border-gray-200\",children:[o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:u}),o.jsx(\"div\",{className:\"text-xs text-gray-600\",children:\"Enriched\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsxs(\"div\",{className:\"text-2xl font-bold text-green-600\",children:[\"$\",c.toFixed(3)]}),o.jsx(\"div\",{className:\"text-xs text-gray-600\",children:\"Total Cost\"})]})]})]})}),o.jsxs(\"div\",{className:\"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-lg p-3\",children:[o.jsx(\"div\",{className:\"font-semibold mb-1\",children:\"âœ¨ Progressive Enrichment\"}),o.jsxs(\"ul\",{className:\"space-y-1 text-xs\",children:[o.jsxs(\"li\",{children:[\"ðŸ“§ \",o.jsx(\"strong\",{children:\"Email Discovery\"}),\" (Hunter.io) - $0.034/lead\"]}),o.jsxs(\"li\",{children:[\"âœ… \",o.jsx(\"strong\",{children:\"Email Verification\"}),\" (NeverBounce) - $0.008/lead\"]}),o.jsxs(\"li\",{children:[\"ðŸ“œ \",o.jsx(\"strong\",{children:\"License Validation\"}),\" - $0.03/lead\"]}),o.jsxs(\"li\",{className:\"pt-1 border-t border-blue-200 font-semibold\",children:[\"ðŸ’° Estimated: $\",(x.length*.072).toFixed(2),\" total\"]})]})]})]})},Zb=()=>{const t=sn(),[e]=Hu(),r=e.get(\"id\"),{currentCampaign:n,campaigns:s,leads:i,setCurrentCampaign:a}=ze(),{isDiscovering:l,progress:u,currentStage:c,cacheStats:d,error:h}=x0(),[f,y]=k.useState(!1),x=n?i.filter(v=>v.campaign_id===n.campaign_id):[];k.useEffect(()=>{if(!n&&r){const v=s.find(m=>m.campaign_id===r);v&&a(v)}},[r,s,n,a]),k.useEffect(()=>{x.length>0&&y(!0)},[x.length]);const w=()=>{x.length&&Zu(x,{fileName:`campaign-${(n==null?void 0:n.campaign_id)||Date.now()}-results.csv`})};return o.jsxs(\"div\",{className:\"space-y-6\",children:[o.jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:o.jsxs(\"div\",{className:\"flex items-center justify-between\",children:[o.jsxs(\"div\",{children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Campaign Progress\"}),o.jsx(\"p\",{className:\"text-gray-600 mt-1\",children:n?`Campaign ${n.campaign_id}`:\"Running campaign...\"})]}),o.jsxs(\"div\",{className:\"flex space-x-3\",children:[o.jsx(\"button\",{onClick:()=>t(\"/discovery\"),className:\"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200\",children:\"Back to Discovery\"}),f&&o.jsx(\"button\",{onClick:w,className:\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\",children:\"Export CSV\"})]})]})}),l&&o.jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:o.jsx(Xu,{isDiscovering:l,progress:u,currentStage:c,cacheStats:d})}),n&&o.jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Campaign Summary\"}),o.jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[o.jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg\",children:[o.jsx(\"div\",{className:\"text-sm text-blue-600 font-medium\",children:\"Status\"}),o.jsx(\"div\",{className:\"text-lg font-bold text-blue-900 capitalize\",children:n.status})]}),o.jsxs(\"div\",{className:\"bg-green-50 p-4 rounded-lg\",children:[o.jsx(\"div\",{className:\"text-sm text-green-600 font-medium\",children:\"Leads Found\"}),o.jsx(\"div\",{className:\"text-lg font-bold text-green-900\",children:n.leads_found||0})]}),o.jsxs(\"div\",{className:\"bg-yellow-50 p-4 rounded-lg\",children:[o.jsx(\"div\",{className:\"text-sm text-yellow-600 font-medium\",children:\"Qualified\"}),o.jsx(\"div\",{className:\"text-lg font-bold text-yellow-900\",children:n.leads_qualified||0})]}),o.jsxs(\"div\",{className:\"bg-purple-50 p-4 rounded-lg\",children:[o.jsx(\"div\",{className:\"text-sm text-purple-600 font-medium\",children:\"Total Cost\"}),o.jsxs(\"div\",{className:\"text-lg font-bold text-purple-900\",children:[\"$\",(n.total_cost||0).toFixed(2)]})]})]})]}),n&&f&&x.length>0&&o.jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Progressive Enrichment\"}),o.jsxs(\"div\",{className:\"flex items-start justify-between gap-6\",children:[o.jsxs(\"div\",{className:\"flex-1\",children:[o.jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Enrich your leads with verified emails, business license validation, and more. Only pay for successful enrichments.\"}),o.jsxs(\"div\",{className:\"grid grid-cols-3 gap-3 text-sm\",children:[o.jsxs(\"div\",{className:\"bg-blue-50 p-3 rounded\",children:[o.jsx(\"div\",{className:\"font-semibold text-blue-900\",children:x.filter(v=>{var m,p;return(p=(m=v.enrichment_data)==null?void 0:m.emails)==null?void 0:p.length}).length}),o.jsx(\"div\",{className:\"text-blue-600 text-xs\",children:\"With Emails\"})]}),o.jsxs(\"div\",{className:\"bg-green-50 p-3 rounded\",children:[o.jsx(\"div\",{className:\"font-semibold text-green-900\",children:x.filter(v=>{var m;return(m=v.enrichment_data)==null?void 0:m.neverBounceVerified}).length}),o.jsx(\"div\",{className:\"text-green-600 text-xs\",children:\"Email Verified\"})]}),o.jsxs(\"div\",{className:\"bg-purple-50 p-3 rounded\",children:[o.jsx(\"div\",{className:\"font-semibold text-purple-900\",children:x.filter(v=>{var m;return(m=v.enrichment_data)==null?void 0:m.licenseVerified}).length}),o.jsx(\"div\",{className:\"text-purple-600 text-xs\",children:\"License Verified\"})]})]})]}),o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsx(Xb,{campaignId:n.campaign_id,onComplete:()=>{console.log(\"Enrichment completed for campaign:\",n.campaign_id)}})})]})]}),f&&x.length>0&&o.jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm overflow-hidden\",children:[o.jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:o.jsxs(\"div\",{className:\"flex items-center justify-between\",children:[o.jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"Campaign Results\"}),o.jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[x.length,\" leads found\"]})]})}),o.jsx(\"div\",{className:\"overflow-x-auto\",children:o.jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[o.jsx(\"thead\",{className:\"bg-gray-50\",children:o.jsxs(\"tr\",{children:[o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Business\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Contact Info\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Score\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Cost\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"})]})}),o.jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:x.map(v=>o.jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{children:[o.jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:v.business_name}),o.jsx(\"div\",{className:\"text-sm text-gray-500 truncate max-w-xs\",children:v.address})]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{className:\"space-y-1\",children:[v.phone&&o.jsx(\"div\",{className:\"text-sm text-gray-900\",children:v.phone}),v.email&&o.jsx(\"div\",{className:\"text-sm text-blue-600\",children:v.email}),v.website&&o.jsx(\"div\",{className:\"text-sm text-gray-500 truncate max-w-xs\",children:o.jsx(\"a\",{href:v.website,target:\"_blank\",rel:\"noopener noreferrer\",className:\"hover:text-blue-600\",children:v.website})})]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{className:\"flex items-center\",children:[o.jsxs(\"div\",{className:\"text-sm font-medium text-gray-900\",children:[v.confidence_score,\"%\"]}),o.jsx(\"div\",{className:\"ml-2 w-16 bg-gray-200 rounded-full h-2\",children:o.jsx(\"div\",{className:`h-2 rounded-full ${v.confidence_score>=80?\"bg-green-500\":v.confidence_score>=60?\"bg-yellow-500\":\"bg-red-500\"}`,style:{width:`${v.confidence_score}%`}})})]})}),o.jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",(v.cost_to_acquire||0).toFixed(2)]}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsx(\"span\",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${v.validation_status===\"validated\"?\"bg-green-100 text-green-800\":v.validation_status===\"pending\"?\"bg-yellow-100 text-yellow-800\":\"bg-red-100 text-red-800\"}`,children:v.validation_status||\"unknown\"})})]},v.id))})]})})]}),h&&o.jsx(\"div\",{className:\"bg-red-50 border border-red-200 rounded-md p-4\",children:o.jsxs(\"div\",{className:\"flex\",children:[o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsx(\"svg\",{className:\"h-5 w-5 text-red-400\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:o.jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\",clipRule:\"evenodd\"})})}),o.jsxs(\"div\",{className:\"ml-3\",children:[o.jsx(\"h3\",{className:\"text-sm font-medium text-red-800\",children:\"Campaign Failed\"}),o.jsx(\"div\",{className:\"mt-2 text-sm text-red-700\",children:o.jsx(\"p\",{children:h instanceof Error?h.message:String(h)})})]})]})}),f&&x.length===0&&o.jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-12 text-center\",children:[o.jsx(\"svg\",{className:\"mx-auto h-12 w-12 text-gray-400\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:o.jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),o.jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-900\",children:\"No results found\"}),o.jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:\"Try adjusting your search criteria or location.\"}),o.jsx(\"div\",{className:\"mt-6\",children:o.jsx(\"button\",{onClick:()=>t(\"/discovery\"),className:\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\",children:\"Start New Campaign\"})})]})]})},ek={pending:\"pending\",processing:\"processing\",completed:\"completed\",failed:\"failed\"};function tk(t){return t?ek[t]??\"processing\":\"processing\"}function rk(t){const[e,r]=k.useState(null),[n,s]=k.useState(!0),i=k.useRef(null),a=k.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]),l=k.useCallback(d=>{if(!d)return;const h={jobId:d.id,status:tk(d.status),progress:d.progress??0,currentStage:d.current_stage??\"processing\",metrics:d.metrics??void 0,error:d.error??void 0,completedAt:d.completed_at??void 0};r(h),(h.status===\"completed\"||h.status===\"failed\")&&a()},[a]),u=k.useCallback(async()=>{if(!t)return null;const{data:d,error:h}=await fe.from(\"discovery_jobs\").select(\"*\").eq(\"id\",t).single();return h?(console.error(\"Error fetching job status:\",h),null):(l(d),d)},[t,l]),c=k.useCallback(()=>{i.current!==null||!t||(i.current=window.setInterval(()=>{u()},4e3))},[u,t]);return k.useEffect(()=>{if(!t){s(!1),a(),r(null);return}let d=!0;(async()=>{const y=await u();d&&(s(!1),y&&y.status!==\"completed\"&&y.status!==\"failed\"&&c())})();const f=fe.channel(`discovery_jobs:${t}`).on(\"postgres_changes\",{event:\"UPDATE\",schema:\"public\",table:\"discovery_jobs\",filter:`id=eq.${t}`},y=>{console.log(\"Real-time update:\",y.new),l(y.new)}).subscribe(y=>{(y===\"TIMED_OUT\"||y===\"CHANNEL_ERROR\"||y===\"CLOSED\")&&(console.warn(\"Realtime subscription failed. Falling back to polling.\",{status:y,jobId:t}),c())});return()=>{d=!1,fe.removeChannel(f),a()}},[u,t,c,a,l]),{progress:e,isLoading:n}}const nk=t=>{switch(t){case\"running\":case\"completed\":case\"failed\":case\"cancelled\":return t;default:return\"completed\"}},sk=t=>{switch(t){case\"pending\":case\"validating\":case\"validated\":case\"failed\":return t;default:return\"validated\"}},ik=t=>{var s;if(!t)return[\"google_places\"];const e=Array.isArray((s=t==null?void 0:t.processingMetadata)==null?void 0:s.servicesUsed)?t.processingMetadata.servicesUsed:[],r=Array.isArray(t==null?void 0:t.verificationSources)?t.verificationSources:[],n=[...e,...r].filter(Boolean);return n.length>0?n:[\"google_places\"]},Ii=(t,e=0)=>{const r=Number(t);return Number.isFinite(r)?r:e},ak=(t,e=[],r={})=>{if(!t)throw new Error(\"Campaign record is required\");const n=r.metrics??{},s=e.map(c=>{var y,x;const d=c.enrichment_data??void 0,h=c.validation_cost??((y=d==null?void 0:d.processingMetadata)==null?void 0:y.totalCost)??0,f=((x=d==null?void 0:d.processingMetadata)==null?void 0:x.enrichmentTier)??(d==null?void 0:d.enrichmentTier);return{id:String(c.id),campaign_id:c.campaign_id??t.id,business_name:c.business_name??\"Unknown Business\",address:c.address??\"\",phone:c.phone??\"\",website:c.website??\"\",email:c.email??\"\",confidence_score:Ii(c.confidence_score,0),validation_status:sk((d==null?void 0:d.validationStatus)??c.validation_status),created_at:c.created_at??new Date().toISOString(),cost_to_acquire:Ii(h,0),data_sources:ik(d),enrichment_tier:f??(n==null?void 0:n.tier)??(n==null?void 0:n.tier_name)??void 0,vault_secured:!0,enrichment_data:d}}),i=s.filter(c=>c.confidence_score>=70).length,a=s.filter(c=>c.validation_status===\"validated\").length,l=t.results_count??s.length??0;return{campaignResult:{campaign_id:t.id,business_type:t.business_type??void 0,location:t.location??void 0,status:nk(t.status),progress:100,total_cost:Ii(t.total_cost??(n==null?void 0:n.total_cost)??0,0),leads_found:Ii(l,s.length),leads_qualified:i,leads_validated:a,created_at:t.created_at??new Date().toISOString(),completed_at:t.updated_at??void 0,tier_used:(n==null?void 0:n.tier)??(n==null?void 0:n.tier_name)??void 0,vault_secured:!0,cache_performance:void 0},leads:s}},ok=()=>{const{campaignId:t}=Pv(),[e]=Hu(),r=sn(),n=e.get(\"jobId\"),{progress:s}=rk(n||\"\"),i=ze(O=>O.campaigns),a=ze(O=>O.addCampaign),l=ze(O=>O.updateCampaign),u=ze(O=>O.setCurrentCampaign),c=ze(O=>O.clearLeads),d=ze(O=>O.addLeads),h=ze(O=>O.setLoading),f=ze(O=>O.setError),{user:y,loading:x}=Pr(),w=(y==null?void 0:y.id)??null,[v,m]=k.useState(!1),[p,g]=k.useState(null),b=k.useRef(!1),S=k.useRef(!0);k.useEffect(()=>()=>{S.current=!1},[]);const j=(s==null?void 0:s.progress)||0,N=(s==null?void 0:s.status)||\"pending\",P=(s==null?void 0:s.currentStage)||\"Initializing...\",D=s==null?void 0:s.metrics,T=N===\"completed\",z=s==null?void 0:s.error,G=v?\"Preparing final results...\":P,ue=v?Math.min(100,Math.max(j,96)):j,Ce=!T||v,Ee=k.useCallback(async()=>{if(!t)return;if(!w){g(\"Sign in again to view campaign results.\");return}b.current=!0,m(!0),g(null),h(!0);const O=C=>new Promise(A=>{setTimeout(A,C)});try{let A=null,L=[];for(let F=0;F<5;F+=1){const Z=fe.from(\"campaigns\").select(\"id,business_type,location,status,total_cost,results_count,created_at,updated_at\").eq(\"id\",t).eq(\"user_id\",w),{data:ee,error:Pe}=await Z.maybeSingle();if(Pe)throw Pe;const Tr=fe.from(\"leads\").select(\"id,campaign_id,business_name,address,phone,website,email,confidence_score,validation_cost,enrichment_data,created_at\").eq(\"campaign_id\",t).eq(\"user_id\",w).order(\"confidence_score\",{ascending:!1}),{data:wt,error:di}=await Tr;if(di)throw di;if(A=ee,L=wt??[],A&&(L.length>0||F===4))break;await O(2e3)}if(!A)throw new Error(\"Campaign record not available yet. Please try again in a moment.\");const{campaignResult:W,leads:J}=ak(A,L,{metrics:D??null});i.some(F=>F.campaign_id===W.campaign_id)?l(W.campaign_id,W):a(W),c(),d(J),u(W),S.current&&(g(null),r(\"/results\",{replace:!0,state:{campaignId:t}}))}catch(C){console.error(\"âš ï¸ Unable to load campaign results\",C);const A=C instanceof Error?C.message:\"Unable to load campaign results. Please try again.\";S.current&&g(A),f(A),b.current=!1}finally{S.current&&(m(!1),h(!1))}},[a,d,w,t,i,c,D,r,u,f,h,l]);k.useEffect(()=>{!T||!t||!n||w&&(b.current||Ee())},[w,t,Ee,T,n]);const M=()=>{if(t){if(!w){g(\"Sign in again to re-establish your session.\");return}Ee()}};return x?o.jsx(\"div\",{className:\"container mx-auto px-4 py-12\",children:o.jsx(\"div\",{className:\"flex items-center justify-center\",children:o.jsxs(\"div\",{className:\"flex items-center space-x-3 text-gray-600\",children:[o.jsx(\"div\",{className:\"h-6 w-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\"}),o.jsx(\"span\",{children:\"Loading campaign...\"})]})})}):w?!n||!t?o.jsx(\"div\",{className:\"container mx-auto px-4 py-8\",children:o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-red-600 mb-4\",children:\"Invalid Campaign\"}),o.jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Missing job or campaign information.\"}),o.jsx(\"button\",{onClick:()=>r(\"/\"),className:\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\",children:\"Return Home\"})]})}):z?o.jsx(\"div\",{className:\"container mx-auto px-4 py-8\",children:o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-red-600 mb-4\",children:\"Processing Error\"}),o.jsx(\"p\",{className:\"text-gray-600 mb-4\",children:z}),o.jsx(\"button\",{onClick:()=>r(\"/\"),className:\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\",children:\"Start New Campaign\"})]})}):o.jsxs(\"div\",{className:\"container mx-auto px-4 py-8 max-w-4xl\",children:[o.jsxs(\"div\",{className:\"text-center mb-8\",children:[o.jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-2\",children:\"Campaign Discovery in Progress\"}),o.jsxs(\"p\",{className:\"text-gray-600\",children:[\"Campaign ID: \",o.jsx(\"span\",{className:\"font-mono text-sm\",children:t})]}),o.jsxs(\"p\",{className:\"text-gray-600\",children:[\"Job ID: \",o.jsx(\"span\",{className:\"font-mono text-sm\",children:n})]})]}),v&&!p&&o.jsx(\"div\",{className:\"mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4 text-sm text-blue-700\",children:\"Finalizing campaign results and syncing verified leads to your vault...\"}),p&&o.jsxs(\"div\",{className:\"mb-6 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-700\",children:[o.jsx(\"div\",{className:\"font-semibold\",children:\"Unable to load campaign results\"}),o.jsx(\"p\",{className:\"mt-1\",children:p}),o.jsx(\"button\",{onClick:M,className:\"mt-3 inline-flex items-center rounded border border-red-300 bg-white px-3 py-1.5 text-xs font-medium text-red-700 shadow-sm transition hover:bg-red-100\",children:\"Retry syncing results\"})]}),o.jsx(Xu,{isDiscovering:Ce,progress:ue,currentStage:G,cacheStats:null}),D&&o.jsxs(\"div\",{className:\"mt-6 bg-white border border-gray-200 rounded-lg p-6\",children:[o.jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"ðŸ“Š Live Discovery Metrics\"}),o.jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:D.total_found||0}),o.jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Total Found\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:D.qualified_leads||0}),o.jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Qualified\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-purple-600\",children:D.avg_confidence?`${D.avg_confidence}%`:\"0%\"}),o.jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Avg Confidence\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsxs(\"div\",{className:\"text-2xl font-bold text-orange-600\",children:[\"$\",(D.total_cost||0).toFixed(2)]}),o.jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Total Cost\"})]})]})]}),o.jsxs(\"div\",{className:\"mt-6 bg-gray-50 border border-gray-200 rounded-lg p-4\",children:[o.jsx(\"h4\",{className:\"font-semibold text-gray-900 mb-2\",children:\"Status Updates\"}),o.jsxs(\"div\",{className:\"space-y-2\",children:[o.jsxs(\"div\",{className:\"flex items-center text-sm\",children:[o.jsx(\"div\",{className:\"w-2 h-2 bg-green-400 rounded-full mr-2\"}),o.jsxs(\"span\",{className:\"text-gray-600\",children:[\"Campaign started at \",new Date().toLocaleTimeString()]})]}),o.jsxs(\"div\",{className:\"flex items-center text-sm\",children:[o.jsx(\"div\",{className:\"w-2 h-2 bg-blue-400 rounded-full mr-2 animate-pulse\"}),o.jsx(\"span\",{className:\"text-gray-900 font-medium\",children:G})]}),v&&o.jsxs(\"div\",{className:\"flex items-center text-sm\",children:[o.jsx(\"div\",{className:\"w-2 h-2 bg-purple-400 rounded-full mr-2 animate-pulse\"}),o.jsx(\"span\",{className:\"text-purple-600 font-medium\",children:\"Finalizing leads and preparing results...\"})]}),N===\"completed\"&&o.jsxs(\"div\",{className:\"flex items-center text-sm\",children:[o.jsx(\"div\",{className:\"w-2 h-2 bg-green-400 rounded-full mr-2\"}),o.jsx(\"span\",{className:\"text-green-600 font-medium\",children:\"âœ… Discovery completed! Redirecting to results...\"})]}),p&&o.jsxs(\"div\",{className:\"flex items-center text-sm\",children:[o.jsx(\"div\",{className:\"w-2 h-2 bg-red-400 rounded-full mr-2\"}),o.jsx(\"span\",{className:\"text-red-600 font-medium\",children:p})]})]})]}),o.jsxs(\"div\",{className:\"mt-8 text-center space-x-4\",children:[o.jsx(\"button\",{onClick:()=>r(\"/\"),className:\"px-4 py-2 text-gray-600 bg-gray-100 rounded hover:bg-gray-200\",children:\"Start New Campaign\"}),!Ce&&o.jsx(\"button\",{onClick:()=>r(\"/results\",{state:{campaignId:t}}),className:\"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\",children:\"View Complete Results\"})]})]}):o.jsx(\"div\",{className:\"container mx-auto px-4 py-12\",children:o.jsxs(\"div\",{className:\"max-w-xl mx-auto rounded-lg border border-gray-200 bg-white p-8 text-center shadow-sm dark:border-gray-700 dark:bg-gray-800\",children:[o.jsx(\"h1\",{className:\"text-2xl font-semibold text-gray-900 dark:text-gray-100\",children:\"Sign in required\"}),o.jsx(\"p\",{className:\"mt-3 text-sm text-gray-600 dark:text-gray-300\",children:\"Please sign in to review campaign progress and download results.\"})]})})},lk=()=>{const{user:t,loading:e}=Pr(),{campaigns:r,leads:n}=ze(),s=sn(),[i,a]=k.useState([]),[l,u]=k.useState(!0),[c,d]=k.useState(null);k.useEffect(()=>{(async()=>{if(!e){if(!(t!=null&&t.id)){a([]),u(!1),d(null);return}try{u(!0),console.log(\"ðŸ“Š Fetching campaigns for user:\",t.id);const m=fe.from(\"campaigns\").select(\"*\").eq(\"user_id\",t.id),{data:p,error:g}=await m.order(\"created_at\",{ascending:!1});if(g){console.error(\"âŒ Error fetching campaigns:\",g),d(g.message);return}console.log(\"âœ… Campaigns loaded:\",(p==null?void 0:p.length)||0),a(p||[])}catch(m){console.error(\"âŒ Unexpected error:\",m),d(m instanceof Error?m.message:\"Failed to load campaigns\")}finally{u(!1)}}})()},[e,t==null?void 0:t.id]);const h=i.reduce((v,m)=>v+(m.total_cost||0),0),f=i.reduce((v,m)=>v+(m.results_count||0),0),y=n.filter(v=>v.confidence_score>=80).length,x=[{name:\"Total Campaigns\",value:i.length||r.length,icon:\"ðŸš€\"},{name:\"Total Leads\",value:f||n.length,icon:\"ðŸ‘¥\"},{name:\"Qualified Leads\",value:y,icon:\"âœ…\"},{name:\"Total Cost\",value:`$${h.toFixed(2)}`,icon:\"ðŸ’°\"}],w=i.length>0?i.slice(0,5):r.slice(0,5);return l||e?o.jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"}),o.jsx(\"p\",{className:\"mt-4 text-gray-600 dark:text-gray-400\",children:\"Loading campaigns...\"})]})}):t?c?o.jsx(\"div\",{className:\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\",children:o.jsxs(\"div\",{className:\"flex\",children:[o.jsx(\"div\",{className:\"text-red-500 dark:text-red-400 text-xl mr-3\",children:\"âš ï¸\"}),o.jsxs(\"div\",{children:[o.jsx(\"h3\",{className:\"text-sm font-medium text-red-800 dark:text-red-200\",children:\"Error loading campaigns\"}),o.jsx(\"p\",{className:\"text-sm text-red-700 dark:text-red-300 mt-1\",children:c})]})]})}):o.jsxs(\"div\",{className:\"space-y-6\",children:[o.jsxs(\"div\",{children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 dark:text-gray-100\",children:\"Dashboard\"}),o.jsx(\"p\",{className:\"mt-1 text-sm text-gray-500 dark:text-gray-400\",children:\"Overview of your lead generation campaigns and results\"})]}),o.jsx(\"div\",{className:\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4\",children:x.map(v=>o.jsx(\"div\",{className:\"bg-white dark:bg-gray-700 overflow-hidden shadow rounded-lg border border-gray-200 dark:border-gray-600\",children:o.jsx(\"div\",{className:\"p-5\",children:o.jsxs(\"div\",{className:\"flex items-center\",children:[o.jsx(\"div\",{className:\"flex-shrink-0\",children:o.jsx(\"span\",{className:\"text-2xl\",children:v.icon})}),o.jsx(\"div\",{className:\"ml-5 w-0 flex-1\",children:o.jsxs(\"dl\",{children:[o.jsx(\"dt\",{className:\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\",children:v.name}),o.jsx(\"dd\",{className:\"text-lg font-medium text-gray-900 dark:text-gray-100\",children:v.value})]})})]})})},v.name))}),o.jsx(\"div\",{className:\"bg-white dark:bg-gray-700 shadow rounded-lg border border-gray-200 dark:border-gray-600\",children:o.jsxs(\"div\",{className:\"px-4 py-5 sm:p-6\",children:[o.jsx(\"h3\",{className:\"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100 mb-4\",children:\"Recent Campaigns\"}),w.length===0?o.jsxs(\"div\",{className:\"text-center py-8\",children:[o.jsx(\"span\",{className:\"text-4xl\",children:\"ðŸ”\"}),o.jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100\",children:\"No campaigns yet\"}),o.jsx(\"p\",{className:\"mt-1 text-sm text-gray-500 dark:text-gray-400\",children:\"Get started by creating your first lead discovery campaign.\"}),o.jsx(\"div\",{className:\"mt-6\",children:o.jsx(\"a\",{href:\"/discovery\",className:\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors\",children:\"Start Discovery\"})})]}):o.jsx(\"div\",{className:\"space-y-3\",children:w.map(v=>{const m=v.id||v.campaign_id||\"\",p=v.results_count||v.leads_found||0,g=v.leads_qualified||0;return o.jsxs(\"div\",{className:\"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer transition-colors\",onClick:()=>s(`/campaign?id=${m}`),children:[o.jsxs(\"div\",{className:\"flex-1\",children:[o.jsxs(\"div\",{className:\"flex items-center\",children:[o.jsx(\"span\",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status===\"completed\"?\"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200\":v.status===\"running\"?\"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200\":v.status===\"failed\"?\"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200\":\"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200\"}`,children:v.status}),o.jsxs(\"span\",{className:\"ml-3 text-sm font-weight-medium text-gray-900 dark:text-gray-100\",children:[v.business_type,\" in \",v.location]})]}),o.jsxs(\"div\",{className:\"mt-1 text-sm text-gray-500 dark:text-gray-400\",children:[p,\" results â€¢ \",g,\" qualified â€¢ $\",v.total_cost.toFixed(2),\" cost\"]})]}),o.jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[o.jsx(\"div\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:new Date(v.created_at).toLocaleDateString()}),o.jsx(\"button\",{onClick:b=>{b.stopPropagation(),s(`/campaign?id=${m}`)},className:\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm font-medium transition-colors\",children:\"View Details â†’\"})]})]},m)})})]})})]}):o.jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-8 text-center\",children:[o.jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2\",children:\"Sign in to view your campaigns\"}),o.jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300\",children:\"Create an account or sign in to access saved campaigns and lead history.\"})]})},uk=()=>{const{leads:t,currentCampaign:e}=ze(),r=i=>{if(t.length)if(i===\"csv\")Zu(t,{fileName:`prospects-vault-secured-${new Date().toISOString().split(\"T\")[0]}.csv`});else{const a=new Blob([JSON.stringify(t,null,2)],{type:\"application/json\"}),l=URL.createObjectURL(a),u=document.createElement(\"a\");u.href=l,u.download=`prospects-vault-secured-${new Date().toISOString().split(\"T\")[0]}.json`,u.click(),URL.revokeObjectURL(l)}},n=i=>i>=90?\"bg-green-100 text-green-800\":i>=80?\"bg-blue-100 text-blue-800\":i>=70?\"bg-yellow-100 text-yellow-800\":\"bg-red-100 text-red-800\",s=i=>{switch(i){case\"validated\":return\"bg-green-100 text-green-800\";case\"validating\":return\"bg-blue-100 text-blue-800\";case\"pending\":return\"bg-yellow-100 text-yellow-800\";case\"failed\":return\"bg-red-100 text-red-800\";default:return\"bg-gray-100 text-gray-800\"}};return o.jsxs(\"div\",{className:\"space-y-6\",children:[o.jsxs(\"div\",{className:\"flex justify-between items-center\",children:[o.jsxs(\"div\",{children:[o.jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Results\"}),o.jsxs(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:[t.length,\" leads found â€¢\",\" \",t.filter(i=>i.confidence_score>=70).length,\" qualified\"]})]}),t.length>0&&o.jsxs(\"div\",{className:\"flex space-x-3\",children:[o.jsx(\"button\",{onClick:()=>r(\"csv\"),className:\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",children:\"ðŸ“Š Export CSV\"}),o.jsx(\"button\",{onClick:()=>r(\"json\"),className:\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",children:\"ðŸ“„ Export JSON\"})]})]}),e&&o.jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[o.jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[o.jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"Progressive Enrichment Results\"}),e.vault_secured&&o.jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:\"ðŸ” Vault Secured\"})]}),o.jsxs(\"div\",{className:\"grid grid-cols-1 gap-4 sm:grid-cols-5\",children:[o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-gray-900\",children:e.leads_found}),o.jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Total Found\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:e.leads_qualified}),o.jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Qualified\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:e.leads_validated}),o.jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Validated\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsx(\"div\",{className:\"text-2xl font-bold text-purple-600\",children:e.tier_used||\"Professional\"}),o.jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Tier Used\"})]}),o.jsxs(\"div\",{className:\"text-center\",children:[o.jsxs(\"div\",{className:\"text-2xl font-bold text-gray-900\",children:[\"$\",e.total_cost.toFixed(2)]}),o.jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Total Cost\"})]})]}),e.cache_performance&&o.jsxs(\"div\",{className:\"mt-6 pt-6 border-t border-gray-200\",children:[o.jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-3\",children:\"ðŸš€ 90-Day Intelligent Cache Performance\"}),o.jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[o.jsxs(\"div\",{className:\"bg-green-50 p-3 rounded-lg text-center\",children:[o.jsxs(\"div\",{className:\"text-lg font-bold text-green-600\",children:[e.cache_performance.cache_hit_ratio.toFixed(1),\"%\"]}),o.jsx(\"div\",{className:\"text-xs text-gray-600\",children:\"Cache Hit Ratio\"})]}),o.jsxs(\"div\",{className:\"bg-blue-50 p-3 rounded-lg text-center\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-blue-600\",children:e.cache_performance.cache_hits}),o.jsx(\"div\",{className:\"text-xs text-gray-600\",children:\"Cache Hits\"})]}),o.jsxs(\"div\",{className:\"bg-yellow-50 p-3 rounded-lg text-center\",children:[o.jsx(\"div\",{className:\"text-lg font-bold text-yellow-600\",children:e.cache_performance.cache_misses}),o.jsx(\"div\",{className:\"text-xs text-gray-600\",children:\"Cache Misses\"})]}),o.jsxs(\"div\",{className:\"bg-green-50 p-3 rounded-lg text-center\",children:[o.jsxs(\"div\",{className:\"text-lg font-bold text-green-600\",children:[\"$\",e.cache_performance.cost_savings.toFixed(2)]}),o.jsx(\"div\",{className:\"text-xs text-gray-600\",children:\"Cost Savings\"})]})]})]})]}),o.jsx(\"div\",{className:\"bg-white shadow rounded-lg overflow-hidden\",children:t.length===0?o.jsxs(\"div\",{className:\"text-center py-12\",children:[o.jsx(\"span\",{className:\"text-4xl\",children:\"ðŸ”\"}),o.jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-900\",children:\"No results yet\"}),o.jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:\"Start a discovery campaign to find business leads.\"})]}):o.jsx(\"div\",{className:\"overflow-x-auto\",children:o.jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[o.jsx(\"thead\",{className:\"bg-gray-50\",children:o.jsxs(\"tr\",{children:[o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Business\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Contact\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Confidence\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Enrichment\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"}),o.jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Cost\"})]})}),o.jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:t.map(i=>o.jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsx(\"div\",{className:\"flex items-center\",children:o.jsxs(\"div\",{children:[o.jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:i.business_name}),o.jsx(\"div\",{className:\"text-sm text-gray-500\",children:i.address})]})})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{className:\"text-sm text-gray-900\",children:[i.phone&&o.jsxs(\"div\",{children:[\"ðŸ“ž \",i.phone]}),i.website&&o.jsxs(\"div\",{children:[\"ðŸŒ\",\" \",o.jsx(\"a\",{href:i.website,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-blue-600 hover:underline\",children:i.website.replace(/^https?:\\/\\//,\"\")})]}),i.email&&o.jsxs(\"div\",{children:[\"ðŸ“§ \",i.email]})]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"span\",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n(i.confidence_score)}`,children:[i.confidence_score,\"%\"]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsxs(\"div\",{className:\"flex flex-col space-y-1\",children:[o.jsx(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800\",children:i.enrichment_tier||\"Professional\"}),i.vault_secured&&o.jsx(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800\",children:\"ðŸ” Vault Secured\"})]})}),o.jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:o.jsx(\"span\",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s(i.validation_status)}`,children:i.validation_status})}),o.jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:[\"$\",i.cost_to_acquire.toFixed(3)]})]},i.id))})]})})})]})};function ck(){return o.jsx(Yw,{children:o.jsx(eb,{children:o.jsxs(Vv,{children:[o.jsx(kt,{path:\"/\",element:o.jsx(Qd,{})}),o.jsx(kt,{path:\"/dashboard\",element:o.jsx(lk,{})}),o.jsx(kt,{path:\"/discovery\",element:o.jsx(Qd,{})}),o.jsx(kt,{path:\"/campaign\",element:o.jsx(Zb,{})}),o.jsx(kt,{path:\"/campaign/:campaignId/progress\",element:o.jsx(ok,{})}),o.jsx(kt,{path:\"/results\",element:o.jsx(uk,{})}),o.jsx(kt,{path:\"/account\",element:o.jsx(Ib,{})}),o.jsx(kt,{path:\"/admin\",element:o.jsx($b,{})}),o.jsx(kt,{path:\"/auth/callback\",element:o.jsx(Db,{})})]})})})}const dk=new Ty({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});Ro.createRoot(document.getElementById(\"root\")).render(o.jsx(Jl.StrictMode,{children:o.jsx(Oy,{client:dk,children:o.jsx(Zv,{children:o.jsx(ck,{})})})}));\n//# sourceMappingURL=index-ClZNJYQq.js.map\n"}}},
{"type":"measure","name":"lsp.did_open","count":77,"duration":365.972},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":32,"duration":0.341},
{"type":"mark","name":"lsp.did_close","count":8,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/dist/index.html"}}},
{"type":"measure","name":"lsp.did_close","count":8,"duration":0.04},
{"type":"mark","name":"lsp.did_close","count":9,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/CAMPAIGN_HISTORY_LINKING_COMPLETE.md"}}},
{"type":"measure","name":"lsp.did_close","count":9,"duration":0.034},
{"type":"mark","name":"lsp.did_close","count":10,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":10,"duration":1.249},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":33,"duration":0.299},
{"type":"mark","name":"lsp.did_close","count":11,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Results.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":11,"duration":1.326},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":34,"duration":0.532},
{"type":"mark","name":"lsp.did_open","count":78,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/App.tsx","languageId":"typescriptreact","version":1,"text":"import { Route, Routes } from \"react-router-dom\";\nimport { Layout } from \"./components/Layout\";\nimport { AuthProvider } from \"./contexts/AuthContext\";\nimport { AccountPage } from \"./pages/AccountPage\";\nimport { AdminPanel } from \"./pages/AdminPanel\";\nimport { AuthCallback } from \"./pages/AuthCallback\";\nimport { BusinessDiscovery } from \"./pages/BusinessDiscovery\";\nimport { Campaign } from \"./pages/Campaign\";\nimport { CampaignProgress } from \"./pages/CampaignProgress\";\nimport { Dashboard } from \"./pages/Dashboard\";\nimport { Results } from \"./pages/Results\";\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <Layout>\n        <Routes>\n          <Route path=\"/\" element={<BusinessDiscovery />} />\n          <Route path=\"/dashboard\" element={<Dashboard />} />\n          <Route path=\"/discovery\" element={<BusinessDiscovery />} />\n          <Route path=\"/campaign\" element={<Campaign />} />\n          <Route\n            path=\"/campaign/:campaignId/progress\"\n            element={<CampaignProgress />}\n          />\n          <Route path=\"/results\" element={<Results />} />\n          <Route path=\"/account\" element={<AccountPage />} />\n          <Route path=\"/admin\" element={<AdminPanel />} />\n          <Route path=\"/auth/callback\" element={<AuthCallback />} />\n        </Routes>\n      </Layout>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n"}}},
{"type":"measure","name":"lsp.did_open","count":78,"duration":2.71},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":35,"duration":0.338},
{"type":"mark","name":"lsp.did_close","count":12,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"}}},
{"type":"measure","name":"lsp.did_close","count":12,"duration":1.061},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":36,"duration":0.296},
{"type":"mark","name":"lsp.did_close","count":13,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/components/AuthComponent.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":13,"duration":1.267},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":37,"duration":0.338},
{"type":"mark","name":"lsp.did_close","count":14,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/dist/assets/index-ClZNJYQq.js"}}},
{"type":"measure","name":"lsp.did_close","count":14,"duration":8.858},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":38,"duration":0.21},
{"type":"mark","name":"lsp.did_open","count":79,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","languageId":"typescript","version":1,"text":"import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport type { BusinessLead, CampaignResult, CampaignStore } from \"../types\";\n\ninterface CampaignActions {\n  addCampaign: (campaign: CampaignResult) => void;\n  updateCampaign: (\n    campaignId: string,\n    updates: Partial<CampaignResult>\n  ) => void;\n  setCurrentCampaign: (campaign: CampaignResult | null) => void;\n  addLeads: (leads: BusinessLead[]) => void;\n  updateLead: (leadId: string, updates: Partial<BusinessLead>) => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  clearLeads: () => void;\n  reset: () => void;\n}\n\nconst initialState: CampaignStore = {\n  campaigns: [],\n  currentCampaign: null,\n  leads: [],\n  isLoading: false,\n  error: null,\n};\n\nexport const useCampaignStore = create<CampaignStore & CampaignActions>()(\n  persist(\n    (set) => ({\n      ...initialState,\n\n      addCampaign: (campaign) =>\n        set((state) => ({\n          campaigns: [campaign, ...state.campaigns],\n        })),\n\n      updateCampaign: (campaignId, updates) =>\n        set((state) => ({\n          campaigns: state.campaigns.map((c) =>\n            c.campaign_id === campaignId ? { ...c, ...updates } : c\n          ),\n          currentCampaign:\n            state.currentCampaign?.campaign_id === campaignId\n              ? { ...state.currentCampaign, ...updates }\n              : state.currentCampaign,\n        })),\n\n      setCurrentCampaign: (campaign) => set({ currentCampaign: campaign }),\n\n      addLeads: (leads) =>\n        set((state) => ({\n          leads: [...state.leads, ...leads],\n        })),\n\n      updateLead: (leadId, updates) =>\n        set((state) => ({\n          leads: state.leads.map((l) =>\n            l.id === leadId ? { ...l, ...updates } : l\n          ),\n        })),\n\n      setLoading: (loading) => set({ isLoading: loading }),\n\n      setError: (error) => set({ error }),\n\n      clearLeads: () => set({ leads: [] }),\n\n      reset: () => set(initialState),\n    }),\n    {\n      name: \"campaign-store\",\n      partialize: (state) => ({\n        campaigns: state.campaigns,\n        leads: state.leads,\n      }),\n    }\n  )\n);\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":39,"duration":0.289},
{"type":"measure","name":"lsp.did_open","count":79,"duration":5.737},
{"type":"mark","name":"lsp.did_close","count":15,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/App.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":15,"duration":1.053},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":40,"duration":0.275},
{"type":"mark","name":"lsp.did_open","count":80,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/types/index.ts","languageId":"typescript","version":1,"text":"// Business Discovery Types\nexport interface BusinessLead {\n  id: string;\n  campaign_id?: string;\n  business_name: string;\n  address?: string;\n  phone?: string;\n  website?: string;\n  email?: string;\n  industry?: string;\n  confidence_score: number;\n  validation_status: \"pending\" | \"validating\" | \"validated\" | \"failed\";\n  created_at: string;\n  cost_to_acquire: number;\n  data_sources: string[];\n  // Progressive enrichment fields\n  enrichment_tier?: string;\n  vault_secured?: boolean;\n  enrichment_data?: {\n    emails?: Array<{\n      email: string;\n      confidence: number;\n      verified: boolean;\n      type?: string;\n      firstName?: string;\n      lastName?: string;\n      position?: string;\n    }>;\n    businessLicense?: {\n      isValid: boolean;\n      licenseNumber?: string;\n      status?: string;\n      expirationDate?: string;\n      professionalType?: string;\n      source: string;\n    };\n    companyInfo?: {\n      name?: string;\n      industry?: string;\n      size?: string;\n      founded?: number;\n      revenue?: string;\n      website?: string;\n      description?: string;\n      source: string;\n    };\n    hunterVerified?: boolean;\n    neverBounceVerified?: boolean;\n    licenseVerified?: boolean;\n    processingMetadata?: {\n      servicesUsed?: string[];\n      servicesSkipped?: string[];\n      totalCost?: number;\n      validationCost?: number;\n      enrichmentCost?: number;\n      enrichmentTier?: string;\n      enrichmentCostBreakdown?: {\n        businessLicenseCost: number;\n        companyEnrichmentCost: number;\n        hunterCost: number;\n        neverBounceCost: number;\n        personEnrichmentCost: number;\n        apolloCost: number;\n        complianceCost: number;\n      };\n    };\n    dataSources?: string[];\n  };\n}\n\nexport interface CampaignConfig {\n  search_terms: string;\n  location: string;\n  business_type?: string;\n  budget_limit: number;\n  max_results: number;\n  include_email_validation: boolean;\n  include_website_validation: boolean;\n  min_confidence_score: number;\n  chamber_verification?: boolean;\n  trade_association?: boolean;\n  professional_license?: boolean;\n  keywords?: string;\n  search_radius?: string;\n  expand_geography?: boolean;\n}\n\nexport interface ValidationResult {\n  field: string;\n  is_valid: boolean;\n  confidence: number;\n  source: string;\n  details?: string;\n}\n\nexport interface CampaignResult {\n  campaign_id: string;\n  business_type?: string;\n  location?: string;\n  status: \"running\" | \"completed\" | \"failed\" | \"cancelled\";\n  progress: number;\n  total_cost: number;\n  leads_found: number;\n  leads_qualified: number;\n  leads_validated: number;\n  created_at: string;\n  completed_at?: string;\n  error_message?: string;\n  // Progressive enrichment fields\n  tier_used?: string;\n  vault_secured?: boolean;\n  cache_performance?: {\n    cache_hits: number;\n    cache_misses: number;\n    cache_hit_ratio: number;\n    cost_savings: number;\n  };\n}\n\n// Census Intelligence Types\nexport interface CensusIntelligence {\n  business_density: {\n    total_establishments: number;\n    density_score: number;\n    confidence_multiplier: number;\n  };\n  geographic_optimization: {\n    optimal_radius: number;\n    expected_results: number;\n    api_efficiency_score: number;\n  };\n  market_insights: {\n    market_density: \"High\" | \"Medium\" | \"Low\";\n    competition_level: \"High\" | \"Medium\" | \"Low\";\n    search_optimization: string;\n  };\n}\n\n// API Response Types\nexport interface EdgeFunctionResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  cost?: number;\n  processing_time?: number;\n}\n\nexport interface BusinessDiscoveryResponse {\n  businesses: BusinessLead[];\n  total_cost: number;\n  processing_time: string;\n  campaign_id: string;\n  qualified_count: number;\n  total_found: number;\n  census_intelligence?: CensusIntelligence;\n  // Background job fields\n  job_id?: string; // For tracking background processing\n  status?: string; // Job status (pending, processing, completed, failed)\n  estimated_time?: number; // Estimated completion time in seconds\n  realtime_channel?: string; // Channel for real-time updates\n  // Progressive enrichment fields (vault-secured)\n  tier_used?: string;\n  cache_performance?: {\n    cache_hits: number;\n    cache_misses: number;\n    cache_hit_ratio: number;\n    cost_savings: number;\n  };\n  vault_status?: string;\n  stage_progress?: number;\n  current_stage?: string;\n}\n\n// Store Types\nexport interface CampaignStore {\n  campaigns: CampaignResult[];\n  currentCampaign: CampaignResult | null;\n  leads: BusinessLead[];\n  isLoading: boolean;\n  error: string | null;\n}\n\nexport interface UIStore {\n  sidebarOpen: boolean;\n  theme: \"light\" | \"dark\";\n  notifications: Notification[];\n}\n\nexport interface Notification {\n  id: string;\n  type: \"success\" | \"error\" | \"warning\" | \"info\";\n  title: string;\n  message: string;\n  timestamp: number;\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":80,"duration":18.744},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":41,"duration":1.966},
{"type":"mark","name":"lsp.did_open","count":81,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Results.tsx","languageId":"typescriptreact","version":1,"text":"import React from \"react\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nexport const Results: React.FC = () => {\n  const { leads, currentCampaign } = useCampaignStore();\n\n  const handleExport = (format: \"csv\" | \"json\") => {\n    if (!leads.length) {\n      return;\n    }\n\n    if (format === \"csv\") {\n      exportLeadsToCsv(leads, {\n        fileName: `prospects-vault-secured-${\n          new Date().toISOString().split(\"T\")[0]\n        }.csv`,\n      });\n    } else {\n      const blob = new Blob([JSON.stringify(leads, null, 2)], {\n        type: \"application/json\",\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `prospects-vault-secured-${\n        new Date().toISOString().split(\"T\")[0]\n      }.json`;\n      a.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const getConfidenceColor = (score: number) => {\n    if (score >= 90) return \"bg-green-100 text-green-800\";\n    if (score >= 80) return \"bg-blue-100 text-blue-800\";\n    if (score >= 70) return \"bg-yellow-100 text-yellow-800\";\n    return \"bg-red-100 text-red-800\";\n  };\n\n  const getValidationStatusColor = (status: string) => {\n    switch (status) {\n      case \"validated\":\n        return \"bg-green-100 text-green-800\";\n      case \"validating\":\n        return \"bg-blue-100 text-blue-800\";\n      case \"pending\":\n        return \"bg-yellow-100 text-yellow-800\";\n      case \"failed\":\n        return \"bg-red-100 text-red-800\";\n      default:\n        return \"bg-gray-100 text-gray-800\";\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Results</h1>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            {leads.length} leads found â€¢{\" \"}\n            {leads.filter((l) => l.confidence_score >= 70).length} qualified\n          </p>\n        </div>\n\n        {leads.length > 0 && (\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => handleExport(\"csv\")}\n              className=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              ðŸ“Š Export CSV\n            </button>\n            <button\n              onClick={() => handleExport(\"json\")}\n              className=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              ðŸ“„ Export JSON\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Campaign Summary */}\n      {currentCampaign && (\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              Progressive Enrichment Results\n            </h3>\n            {currentCampaign.vault_secured && (\n              <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                ðŸ” Vault Secured\n              </span>\n            )}\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-5\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900\">\n                {currentCampaign.leads_found}\n              </div>\n              <div className=\"text-sm text-gray-500\">Total Found</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {currentCampaign.leads_qualified}\n              </div>\n              <div className=\"text-sm text-gray-500\">Qualified</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {currentCampaign.leads_validated}\n              </div>\n              <div className=\"text-sm text-gray-500\">Validated</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {currentCampaign.tier_used || \"Professional\"}\n              </div>\n              <div className=\"text-sm text-gray-500\">Tier Used</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900\">\n                ${currentCampaign.total_cost.toFixed(2)}\n              </div>\n              <div className=\"text-sm text-gray-500\">Total Cost</div>\n            </div>\n          </div>\n\n          {/* Cache Performance Display */}\n          {currentCampaign.cache_performance && (\n            <div className=\"mt-6 pt-6 border-t border-gray-200\">\n              <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n                ðŸš€ 90-Day Intelligent Cache Performance\n              </h4>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-green-600\">\n                    {currentCampaign.cache_performance.cache_hit_ratio.toFixed(\n                      1\n                    )}\n                    %\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Hit Ratio</div>\n                </div>\n                <div className=\"bg-blue-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-blue-600\">\n                    {currentCampaign.cache_performance.cache_hits}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Hits</div>\n                </div>\n                <div className=\"bg-yellow-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-yellow-600\">\n                    {currentCampaign.cache_performance.cache_misses}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Misses</div>\n                </div>\n                <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-green-600\">\n                    ${currentCampaign.cache_performance.cost_savings.toFixed(2)}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cost Savings</div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Results Table */}\n      <div className=\"bg-white shadow rounded-lg overflow-hidden\">\n        {leads.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <span className=\"text-4xl\">ðŸ”</span>\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n              No results yet\n            </h3>\n            <p className=\"mt-1 text-sm text-gray-500\">\n              Start a discovery campaign to find business leads.\n            </p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Business\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Contact\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Confidence\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Enrichment\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cost\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {leads.map((lead) => (\n                  <tr key={lead.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div>\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {lead.business_name}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">\n                            {lead.address}\n                          </div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"text-sm text-gray-900\">\n                        {lead.phone && <div>ðŸ“ž {lead.phone}</div>}\n                        {lead.website && (\n                          <div>\n                            ðŸŒ{\" \"}\n                            <a\n                              href={lead.website}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"text-blue-600 hover:underline\"\n                            >\n                              {lead.website.replace(/^https?:\\/\\//, \"\")}\n                            </a>\n                          </div>\n                        )}\n                        {lead.email && <div>ðŸ“§ {lead.email}</div>}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getConfidenceColor(\n                          lead.confidence_score\n                        )}`}\n                      >\n                        {lead.confidence_score}%\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex flex-col space-y-1\">\n                        <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800\">\n                          {lead.enrichment_tier || \"Professional\"}\n                        </span>\n                        {lead.vault_secured && (\n                          <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800\">\n                            ðŸ” Vault Secured\n                          </span>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getValidationStatusColor(\n                          lead.validation_status\n                        )}`}\n                      >\n                        {lead.validation_status}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${lead.cost_to_acquire.toFixed(3)}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":81,"duration":2.672},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":42,"duration":0.307},
{"type":"mark","name":"lsp.did_close","count":16,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"}}},
{"type":"measure","name":"lsp.did_close","count":16,"duration":1.374},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":43,"duration":0.321},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":6,"duration":0.023},
{"type":"mark","name":"lsp.did_change_batched","count":4,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":4,"duration":2.856},
{"type":"mark","name":"lsp.testing_update"},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":7,"duration":0.01},
{"type":"measure","name":"lsp.testing_update","count":44,"duration":0.318},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":6,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",45]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":3,"duration":0.855},
{"type":"mark","name":"tsc.op.op_resolve","count":234,"args":{"base":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":234,"duration":0.088},
{"type":"mark","name":"tsc.op.op_resolve","count":235,"args":{"base":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":235,"duration":0.059},
{"type":"mark","name":"tsc.op.op_resolve","count":236,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":236,"duration":0.112},
{"type":"mark","name":"tsc.op.op_load","count":297,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":297,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":237,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../stores/campaignStore"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":237,"duration":0.117},
{"type":"mark","name":"tsc.op.op_resolve","count":238,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":238,"duration":3.24},
{"type":"mark","name":"tsc.op.op_resolve","count":239,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":239,"duration":0.111},
{"type":"mark","name":"tsc.op.op_resolve","count":240,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":240,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":241,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":241,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":242,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":242,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":243,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":243,"duration":0.189},
{"type":"mark","name":"tsc.op.op_resolve","count":244,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":244,"duration":0.119},
{"type":"mark","name":"tsc.op.op_resolve","count":245,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":245,"duration":0.068},
{"type":"mark","name":"tsc.op.op_load","count":298,"args":"file:///workspaces/ProspectPro/src/pages/Results.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":298,"duration":0.046},
{"type":"mark","name":"tsc.op.op_resolve","count":246,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Results.tsx","specifiers":[[false,"react"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":246,"duration":0.063},
{"type":"mark","name":"tsc.op.op_load","count":299,"args":"file:///workspaces/ProspectPro/src/types/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":299,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":247,"args":{"base":"file:///workspaces/ProspectPro/src/vite-env.d.ts","specifiers":[[false,"vite/client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":247,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":248,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":248,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":249,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":249,"duration":0.071},
{"type":"mark","name":"tsc.op.op_resolve","count":250,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":250,"duration":0.045},
{"type":"mark","name":"tsc.op.op_resolve","count":251,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":251,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":252,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":252,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":253,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":253,"duration":0.06},
{"type":"mark","name":"tsc.op.op_resolve","count":254,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":254,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":255,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":255,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":256,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":256,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":257,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":257,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":258,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":258,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":259,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":259,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":260,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":260,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":261,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":261,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":262,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":262,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":263,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":263,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":264,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":264,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":265,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":265,"duration":0.043},
{"type":"mark","name":"tsc.op.op_resolve","count":266,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":266,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":267,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":267,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":268,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":268,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":269,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":269,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":270,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":270,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":271,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":271,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":272,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":272,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":273,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":273,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":274,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":274,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":275,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":275,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":276,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":276,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":277,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":277,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":278,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":278,"duration":0.046},
{"type":"mark","name":"tsc.op.op_resolve","count":279,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":279,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":280,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":280,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":281,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":281,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":282,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":282,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":283,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":283,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":284,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":284,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":285,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":285,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":286,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":286,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":287,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":287,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":288,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":288,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":289,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":289,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":290,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":290,"duration":0.06},
{"type":"mark","name":"tsc.op.op_resolve","count":291,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":291,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":292,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":292,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":293,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":293,"duration":0.088},
{"type":"mark","name":"tsc.op.op_resolve","count":294,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":294,"duration":0.056},
{"type":"mark","name":"tsc.op.op_resolve","count":295,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":295,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":296,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":296,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":297,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":297,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":298,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":298,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":299,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":299,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":300,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":300,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":301,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":301,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":302,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":302,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":303,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":303,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":304,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":304,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":305,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":305,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":306,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":306,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":307,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":307,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":308,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":308,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":309,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":309,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":310,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":310,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":311,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":311,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":312,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":312,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":313,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":313,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":314,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":314,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":315,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":315,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":316,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":316,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":317,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":317,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":318,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":318,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":319,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":319,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":320,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":320,"duration":0.04},
{"type":"mark","name":"tsc.op.op_resolve","count":321,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":321,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":322,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":322,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":323,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":323,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":324,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":324,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":325,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":325,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":326,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":326,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":327,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":327,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":328,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":328,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":329,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":329,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":330,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":330,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":331,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":331,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":332,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":332,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":333,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":333,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":334,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":334,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":335,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":335,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":336,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":336,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":337,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":337,"duration":0.047},
{"type":"mark","name":"tsc.op.op_resolve","count":338,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":338,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":339,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":339,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":340,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":340,"duration":0.061},
{"type":"mark","name":"tsc.op.op_resolve","count":341,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":341,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":342,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":342,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":343,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":343,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":344,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":344,"duration":0.048},
{"type":"mark","name":"tsc.op.op_resolve","count":345,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":345,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":346,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":346,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":347,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":347,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":348,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":348,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":349,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":349,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":350,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":350,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":351,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":351,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":352,"args":{"base":"file:///workspaces/ProspectPro/vite.config.ts","specifiers":[[false,"@vitejs/plugin-react"],[false,"path"],[false,"vite"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":352,"duration":0.018},
{"type":"mark","name":"tsc.op.op_release","count":1,"args":"file:///workspaces/ProspectPro/.devcontainer/devcontainer.json"},
{"type":"measure","name":"tsc.op.op_release","count":1,"duration":0.198},
{"type":"mark","name":"tsc.op.op_release","count":2,"args":"file:///workspaces/ProspectPro/archive/deployment-logs/package.json"},
{"type":"measure","name":"tsc.op.op_release","count":2,"duration":0.101},
{"type":"mark","name":"tsc.op.op_release","count":3,"args":"file:///workspaces/ProspectPro/mcp-servers/package.json"},
{"type":"measure","name":"tsc.op.op_release","count":3,"duration":0.074},
{"type":"mark","name":"tsc.op.op_release","count":4,"args":"file:///workspaces/ProspectPro/package.json"},
{"type":"measure","name":"tsc.op.op_release","count":4,"duration":0.102},
{"type":"mark","name":"tsc.op.op_release","count":5,"args":"file:///c:/Users/Alext/AppData/Roaming/Code/User/settings.json"},
{"type":"measure","name":"tsc.op.op_release","count":5,"duration":0.034},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":6,"duration":679.775},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":6,"duration":681.815},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":4,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":4,"duration":0.27},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":4,"duration":1.654},
{"type":"measure","name":"lsp.diagnostic","count":8,"duration":686.571},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":9,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":3,"duration":0.022},
{"type":"mark","name":"lsp.did_close","count":17,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/types/index.ts"}}},
{"type":"measure","name":"lsp.did_close","count":17,"duration":1.068},
{"type":"mark","name":"lsp.did_close","count":18,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Results.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":18,"duration":1.349},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":45,"duration":0.264},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":46,"duration":0.245},
{"type":"mark","name":"lsp.did_open","count":82,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts","languageId":"typescript","version":1,"text":"import type { BusinessLead, CampaignResult } from \"../types\";\n\nconst normalizeCampaignStatus = (\n  value: string | null | undefined\n): CampaignResult[\"status\"] => {\n  switch (value) {\n    case \"running\":\n    case \"completed\":\n    case \"failed\":\n    case \"cancelled\":\n      return value;\n    default:\n      return \"completed\";\n  }\n};\n\nconst normalizeValidationStatus = (\n  value: string | null | undefined\n): BusinessLead[\"validation_status\"] => {\n  switch (value) {\n    case \"pending\":\n    case \"validating\":\n    case \"validated\":\n    case \"failed\":\n      return value;\n    default:\n      return \"validated\";\n  }\n};\n\nconst deriveDataSources = (enrichmentData: any): string[] => {\n  if (!enrichmentData) {\n    return [\"google_places\"];\n  }\n\n  const fromServices = Array.isArray(\n    enrichmentData?.processingMetadata?.servicesUsed\n  )\n    ? enrichmentData.processingMetadata.servicesUsed\n    : [];\n\n  const fromSources = Array.isArray(enrichmentData?.verificationSources)\n    ? enrichmentData.verificationSources\n    : [];\n\n  const dataSources = [...fromServices, ...fromSources].filter(Boolean);\n  return dataSources.length > 0 ? dataSources : [\"google_places\"];\n};\n\nconst coerceNumber = (value: unknown, fallback = 0): number => {\n  const parsed = Number(value);\n  return Number.isFinite(parsed) ? parsed : fallback;\n};\n\ninterface TransformOptions {\n  metrics?: Record<string, any> | null;\n}\n\nexport interface CampaignTransformResult {\n  campaignResult: CampaignResult;\n  leads: BusinessLead[];\n}\n\nexport const transformCampaignData = (\n  campaignRecord: any,\n  leadsRecords: any[] = [],\n  options: TransformOptions = {}\n): CampaignTransformResult => {\n  if (!campaignRecord) {\n    throw new Error(\"Campaign record is required\");\n  }\n\n  const metricsAny = options.metrics ?? {};\n\n  const mappedLeads: BusinessLead[] = leadsRecords.map((lead) => {\n    const enrichmentData = lead.enrichment_data ?? undefined;\n    const rawCost =\n      lead.validation_cost ??\n      enrichmentData?.processingMetadata?.totalCost ??\n      0;\n\n    const tierFromData =\n      enrichmentData?.processingMetadata?.enrichmentTier ??\n      enrichmentData?.enrichmentTier;\n\n    return {\n      id: String(lead.id),\n      campaign_id: lead.campaign_id ?? campaignRecord.id,\n      business_name: lead.business_name ?? \"Unknown Business\",\n      address: lead.address ?? \"\",\n      phone: lead.phone ?? \"\",\n      website: lead.website ?? \"\",\n      email: lead.email ?? \"\",\n      confidence_score: coerceNumber(lead.confidence_score, 0),\n      validation_status: normalizeValidationStatus(\n        enrichmentData?.validationStatus ?? lead.validation_status\n      ),\n      created_at: lead.created_at ?? new Date().toISOString(),\n      cost_to_acquire: coerceNumber(rawCost, 0),\n      data_sources: deriveDataSources(enrichmentData),\n      enrichment_tier:\n        tierFromData ??\n        (metricsAny?.tier as string | undefined) ??\n        (metricsAny?.tier_name as string | undefined) ??\n        undefined,\n      vault_secured: true,\n      enrichment_data: enrichmentData,\n    };\n  });\n\n  const leadsQualified = mappedLeads.filter(\n    (lead) => lead.confidence_score >= 70\n  ).length;\n  const leadsValidated = mappedLeads.filter(\n    (lead) => lead.validation_status === \"validated\"\n  ).length;\n\n  const totalFoundRaw = campaignRecord.results_count ?? mappedLeads.length ?? 0;\n\n  const campaignResult: CampaignResult = {\n    campaign_id: campaignRecord.id,\n    business_type: campaignRecord.business_type ?? undefined,\n    location: campaignRecord.location ?? undefined,\n    status: normalizeCampaignStatus(campaignRecord.status),\n    progress: 100,\n    total_cost: coerceNumber(\n      campaignRecord.total_cost ?? metricsAny?.total_cost ?? 0,\n      0\n    ),\n    leads_found: coerceNumber(totalFoundRaw, mappedLeads.length),\n    leads_qualified: leadsQualified,\n    leads_validated: leadsValidated,\n    created_at: campaignRecord.created_at ?? new Date().toISOString(),\n    completed_at: campaignRecord.updated_at ?? undefined,\n    tier_used:\n      (metricsAny?.tier as string | undefined) ??\n      (metricsAny?.tier_name as string | undefined) ??\n      undefined,\n    vault_secured: true,\n    cache_performance: undefined,\n  };\n\n  return {\n    campaignResult,\n    leads: mappedLeads,\n  };\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":82,"duration":4.805},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":47,"duration":0.298},
{"type":"mark","name":"lsp.did_change_batched","count":5,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":5,"duration":3.571},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":10,"duration":0.012},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":48,"duration":0.298},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":7,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",49]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":4,"duration":2.489},
{"type":"mark","name":"tsc.op.op_resolve","count":353,"args":{"base":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":353,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":354,"args":{"base":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":354,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":355,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":355,"duration":0.102},
{"type":"mark","name":"tsc.op.op_load","count":300,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":300,"duration":0.317},
{"type":"mark","name":"tsc.op.op_resolve","count":356,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../stores/campaignStore"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":356,"duration":0.094},
{"type":"mark","name":"tsc.op.op_resolve","count":357,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":357,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":358,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":358,"duration":0.107},
{"type":"mark","name":"tsc.op.op_resolve","count":359,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":359,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":360,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":360,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":361,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":361,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":362,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":362,"duration":0.199},
{"type":"mark","name":"tsc.op.op_resolve","count":363,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":363,"duration":0.117},
{"type":"mark","name":"tsc.op.op_resolve","count":364,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":364,"duration":0.066},
{"type":"mark","name":"tsc.op.op_load","count":301,"args":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts"},
{"type":"measure","name":"tsc.op.op_load","count":301,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":365,"args":{"base":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts","specifiers":[[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":365,"duration":0.056},
{"type":"mark","name":"tsc.op.op_resolve","count":366,"args":{"base":"file:///workspaces/ProspectPro/src/vite-env.d.ts","specifiers":[[false,"vite/client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":366,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":367,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":367,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":368,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":368,"duration":0.065},
{"type":"mark","name":"tsc.op.op_resolve","count":369,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":369,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":370,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":370,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":371,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":371,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":372,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":372,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":373,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":373,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":374,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":374,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":375,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":375,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":376,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":376,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":377,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":377,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":378,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":378,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":379,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":379,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":380,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":380,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":381,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":381,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":382,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":382,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":383,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":383,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":384,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":384,"duration":0.04},
{"type":"mark","name":"tsc.op.op_resolve","count":385,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":385,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":386,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":386,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":387,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":387,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":388,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":388,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":389,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":389,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":390,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":390,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":391,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":391,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":392,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":392,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":393,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":393,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":394,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":394,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":395,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":395,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":396,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":396,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":397,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":397,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":398,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":398,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":399,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":399,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":400,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":400,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":401,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":401,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":402,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":402,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":403,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":403,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":404,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":404,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":405,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":405,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":406,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":406,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":407,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":407,"duration":0.057},
{"type":"mark","name":"tsc.op.op_resolve","count":408,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":408,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":409,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":409,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":410,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":410,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":411,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":411,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":412,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":412,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":413,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":413,"duration":0.057},
{"type":"mark","name":"tsc.op.op_resolve","count":414,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":414,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":415,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":415,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":416,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":416,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":417,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":417,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":418,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":418,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":419,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":419,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":420,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":420,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":421,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":421,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":422,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":422,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":423,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":423,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":424,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":424,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":425,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":425,"duration":3.304},
{"type":"mark","name":"tsc.op.op_resolve","count":426,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":426,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":427,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":427,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":428,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":428,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":429,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":429,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":430,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":430,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":431,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":431,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":432,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":432,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":433,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":433,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":434,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":434,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":435,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":435,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":436,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":436,"duration":0.048},
{"type":"mark","name":"tsc.op.op_resolve","count":437,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":437,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":438,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":438,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":439,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":439,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":440,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":440,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":441,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":441,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":442,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":442,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":443,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":443,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":444,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":444,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":445,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":445,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":446,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":446,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":447,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":447,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":448,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":448,"duration":0.053},
{"type":"mark","name":"tsc.op.op_resolve","count":449,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":449,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":450,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":450,"duration":0.047},
{"type":"mark","name":"tsc.op.op_resolve","count":451,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":451,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":452,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":452,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":453,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":453,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":454,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":454,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":455,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":455,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":456,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":456,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":457,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":457,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":458,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":458,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":459,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":459,"duration":0.043},
{"type":"mark","name":"tsc.op.op_resolve","count":460,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":460,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":461,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":461,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":462,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":462,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":463,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":463,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":464,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":464,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":465,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":465,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":466,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":466,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":467,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":467,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":468,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":468,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":469,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":469,"duration":0.047},
{"type":"mark","name":"tsc.op.op_resolve","count":470,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":470,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":471,"args":{"base":"file:///workspaces/ProspectPro/vite.config.ts","specifiers":[[false,"@vitejs/plugin-react"],[false,"path"],[false,"vite"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":471,"duration":0.015},
{"type":"mark","name":"tsc.op.op_release","count":6,"args":"file:///workspaces/ProspectPro/src/pages/Results.tsx"},
{"type":"measure","name":"tsc.op.op_release","count":6,"duration":1.525},
{"type":"mark","name":"tsc.op.op_release","count":7,"args":"file:///workspaces/ProspectPro/src/types/index.ts"},
{"type":"measure","name":"tsc.op.op_release","count":7,"duration":0.746},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":7,"duration":548.148},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":7,"duration":553.229},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":5,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":5,"duration":75.147},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":5,"duration":75.257},
{"type":"measure","name":"lsp.diagnostic","count":11,"duration":629.481},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":12,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":4,"duration":0.023},
{"type":"mark","name":"lsp.did_close","count":19,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts"}}},
{"type":"measure","name":"lsp.did_close","count":19,"duration":1.319},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":49,"duration":0.272},
{"type":"mark","name":"lsp.did_change_batched","count":6,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":50,"duration":0.282},
{"type":"measure","name":"lsp.did_change_batched","count":6,"duration":7.811},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":13,"duration":0.012},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":8,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",51]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":5,"duration":0.778},
{"type":"mark","name":"tsc.op.op_resolve","count":472,"args":{"base":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":472,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":473,"args":{"base":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":473,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":474,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":474,"duration":0.089},
{"type":"mark","name":"tsc.op.op_load","count":302,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":302,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":475,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../stores/campaignStore"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":475,"duration":0.086},
{"type":"mark","name":"tsc.op.op_resolve","count":476,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":476,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":477,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":477,"duration":0.095},
{"type":"mark","name":"tsc.op.op_resolve","count":478,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":478,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":479,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":479,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":480,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":480,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":481,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":481,"duration":0.16},
{"type":"mark","name":"tsc.op.op_resolve","count":482,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":482,"duration":0.116},
{"type":"mark","name":"tsc.op.op_resolve","count":483,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":483,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":484,"args":{"base":"file:///workspaces/ProspectPro/src/vite-env.d.ts","specifiers":[[false,"vite/client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":484,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":485,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":485,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":486,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":486,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":487,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":487,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":488,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":488,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":489,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":489,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":490,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":490,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":491,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":491,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":492,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":492,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":493,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":493,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":494,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":494,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":495,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":495,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":496,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":496,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":497,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":497,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":498,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":498,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":499,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":499,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":500,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":500,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":501,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":501,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":502,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":502,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":503,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":503,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":504,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":504,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":505,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":505,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":506,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":506,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":507,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":507,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":508,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":508,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":509,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":509,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":510,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":510,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":511,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":511,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":512,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":512,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":513,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":513,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":514,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":514,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":515,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":515,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":516,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":516,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":517,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":517,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":518,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":518,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":519,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":519,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":520,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":520,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":521,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":521,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":522,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":522,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":523,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":523,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":524,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":524,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":525,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":525,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":526,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":526,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":527,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":527,"duration":0.057},
{"type":"mark","name":"tsc.op.op_resolve","count":528,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":528,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":529,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":529,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":530,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":530,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":531,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":531,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":532,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":532,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":533,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":533,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":534,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":534,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":535,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":535,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":536,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":536,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":537,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":537,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":538,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":538,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":539,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":539,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":540,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":540,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":541,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":541,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":542,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":542,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":543,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":543,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":544,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":544,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":545,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":545,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":546,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":546,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":547,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":547,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":548,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":548,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":549,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":549,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":550,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":550,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":551,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":551,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":552,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":552,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":553,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":553,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":554,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":554,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":555,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":555,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":556,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":556,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":557,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":557,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":558,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":558,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":559,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":559,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":560,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":560,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":561,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":561,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":562,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":562,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":563,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":563,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":564,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":564,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":565,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":565,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":566,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":566,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":567,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":567,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":568,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":568,"duration":0.044},
{"type":"mark","name":"tsc.op.op_resolve","count":569,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":569,"duration":0.01},
{"type":"mark","name":"tsc.op.op_resolve","count":570,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":570,"duration":0.01},
{"type":"mark","name":"tsc.op.op_resolve","count":571,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":571,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":572,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":572,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":573,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":573,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":574,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":574,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":575,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":575,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":576,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":576,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":577,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":577,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":578,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":578,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":579,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":579,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":580,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":580,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":581,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":581,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":582,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":582,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":583,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":583,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":584,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":584,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":585,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":585,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":586,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":586,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":587,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":587,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":588,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":588,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":589,"args":{"base":"file:///workspaces/ProspectPro/vite.config.ts","specifiers":[[false,"@vitejs/plugin-react"],[false,"path"],[false,"vite"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":589,"duration":0.012},
{"type":"mark","name":"tsc.op.op_release","count":8,"args":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts"},
{"type":"measure","name":"tsc.op.op_release","count":8,"duration":0.84},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":8,"duration":181.923},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":8,"duration":182.1},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":6,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":6,"duration":0.177},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":6,"duration":0.304},
{"type":"measure","name":"lsp.diagnostic","count":14,"duration":182.649},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":15,"duration":0.002},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":5,"duration":0.022},
{"type":"mark","name":"lsp.did_change_batched","count":7,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":7,"duration":2.286},
{"type":"mark","name":"lsp.testing_update"},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":16,"duration":0.011},
{"type":"measure","name":"lsp.testing_update","count":51,"duration":0.273},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":6,"duration":0.022},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":9,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",52]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":2,"duration":0.034},
{"type":"mark","name":"tsc.op.op_load","count":303,"args":"file:///workspaces/ProspectPro/src/components/Layout.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":303,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":590,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../stores/campaignStore"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":590,"duration":0.106},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":9,"duration":875.884},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":9,"duration":880.087},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":7,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":7,"duration":138.033},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":7,"duration":140.497},
{"type":"measure","name":"lsp.diagnostic","count":17,"duration":1021.054},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":18,"duration":0.001},
{"type":"mark","name":"lsp.did_open","count":83,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":83,"duration":0.053},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":19,"duration":0.025},
{"type":"mark","name":"lsp.did_change_batched","count":8,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":52,"duration":0.296},
{"type":"measure","name":"lsp.did_change_batched","count":8,"duration":5.991},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":20,"duration":0.011},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":10,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",53]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":3,"duration":0.02},
{"type":"mark","name":"tsc.op.op_load","count":304,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":304,"duration":0.081},
{"type":"mark","name":"tsc.op.op_resolve","count":591,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":591,"duration":0.21},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":10,"duration":483.991},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":10,"duration":485.181},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":8,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":8,"duration":162.153},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":8,"duration":162.261},
{"type":"measure","name":"lsp.diagnostic","count":21,"duration":648.222},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":22,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":23,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":7,"duration":0.023},
{"type":"mark","name":"lsp.did_close","count":20,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json"}}},
{"type":"measure","name":"lsp.did_close","count":20,"duration":0.032},
{"type":"mark","name":"lsp.did_change_batched","count":9,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":53,"duration":0.268},
{"type":"measure","name":"lsp.did_change_batched","count":9,"duration":7.389},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":24,"duration":0.009},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":11,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",54]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":4,"duration":0.019},
{"type":"mark","name":"tsc.op.op_load","count":305,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":305,"duration":0.081},
{"type":"mark","name":"tsc.op.op_resolve","count":592,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":592,"duration":0.201},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":11,"duration":352.805},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":11,"duration":354.425},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":9,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":9,"duration":0.158},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":9,"duration":0.221},
{"type":"measure","name":"lsp.diagnostic","count":25,"duration":355.508},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":26,"duration":0.023},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":27,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":8,"duration":0.023},
{"type":"mark","name":"lsp.did_change_batched","count":10,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":10,"duration":6.935},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":28,"duration":0.012},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":54,"duration":0.317},
{"type":"mark","name":"lsp.did_change_batched","count":11,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":11,"duration":13.723},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":29,"duration":0.012},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":55,"duration":0.287},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":12,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",56]}},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":9,"duration":0.023},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":5,"duration":0.034},
{"type":"mark","name":"tsc.op.op_load","count":306,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":306,"duration":0.089},
{"type":"mark","name":"tsc.op.op_resolve","count":593,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":593,"duration":0.223},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":12,"duration":819.611},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":12,"duration":820.464},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":10,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":10,"duration":0.171},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":10,"duration":0.23},
{"type":"measure","name":"lsp.diagnostic","count":30,"duration":820.981},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":31,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":32,"duration":0.002},
{"type":"mark","name":"lsp.did_open","count":84,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":84,"duration":0.05},
{"type":"mark","name":"lsp.did_change_batched","count":12,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":56,"duration":0.284},
{"type":"measure","name":"lsp.did_change_batched","count":12,"duration":6.759},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":33,"duration":0.009},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":13,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",57]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":6,"duration":0.035},
{"type":"mark","name":"tsc.op.op_load","count":307,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":307,"duration":0.081},
{"type":"mark","name":"tsc.op.op_resolve","count":594,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":594,"duration":0.206},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":13,"duration":446.415},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":13,"duration":450.949},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":11,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":11,"duration":248.234},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":11,"duration":253.949},
{"type":"measure","name":"lsp.diagnostic","count":34,"duration":707.007},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":35,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":36,"duration":0.002},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":10,"duration":0.023},
{"type":"mark","name":"lsp.did_close","count":21,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json"}}},
{"type":"measure","name":"lsp.did_close","count":21,"duration":0.032},
{"type":"mark","name":"lsp.goto_definition","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts"},"position":{"line":84,"character":6}}},
{"type":"mark","name":"lsp.did_change_batched","count":13,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":13,"duration":5.47},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":37,"duration":0.011},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":57,"duration":0.297},
{"type":"mark","name":"lsp.did_change_batched","count":14,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":14,"duration":13.688},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":38,"duration":0.01},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":58,"duration":0.274},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":14,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",59]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":7,"duration":0.021},
{"type":"mark","name":"tsc.op.op_load","count":308,"args":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":308,"duration":0.079},
{"type":"mark","name":"tsc.op.op_resolve","count":595,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":595,"duration":0.2},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":11,"duration":0.022},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":14,"duration":610.537},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":14,"duration":616.532},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":12,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":12,"duration":0.186},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":12,"duration":2.534},
{"type":"measure","name":"lsp.diagnostic","count":39,"duration":619.371},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":40,"duration":0.022},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":41,"duration":0.001},
{"type":"mark","name":"lsp.did_open","count":85,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":85,"duration":0.045},
{"type":"mark","name":"lsp.document_symbol","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts"}}},
{"type":"mark","name":"lsp.did_open","count":86,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","languageId":"typescript","version":1,"text":"import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport type { BusinessLead, CampaignResult, CampaignStore } from \"../types\";\n\ninterface CampaignActions {\n  addCampaign: (campaign: CampaignResult) => void;\n  updateCampaign: (\n    campaignId: string,\n    updates: Partial<CampaignResult>\n  ) => void;\n  setCurrentCampaign: (campaign: CampaignResult | null) => void;\n  addLeads: (leads: BusinessLead[]) => void;\n  updateLead: (leadId: string, updates: Partial<BusinessLead>) => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  clearLeads: () => void;\n  reset: () => void;\n}\n\nconst initialState: CampaignStore = {\n  campaigns: [],\n  currentCampaign: null,\n  leads: [],\n  isLoading: false,\n  error: null,\n};\n\nexport const useCampaignStore = create<CampaignStore & CampaignActions>()(\n  persist(\n    (set) => ({\n      ...initialState,\n\n      addCampaign: (campaign) =>\n        set((state) => ({\n          campaigns: [campaign, ...state.campaigns],\n        })),\n\n      updateCampaign: (campaignId, updates) =>\n        set((state) => ({\n          campaigns: state.campaigns.map((c) =>\n            c.campaign_id === campaignId ? { ...c, ...updates } : c\n          ),\n          currentCampaign:\n            state.currentCampaign?.campaign_id === campaignId\n              ? { ...state.currentCampaign, ...updates }\n              : state.currentCampaign,\n        })),\n\n      setCurrentCampaign: (campaign) => set({ currentCampaign: campaign }),\n\n      addLeads: (leads) =>\n        set((state) => ({\n          leads: [...state.leads, ...leads],\n        })),\n\n      updateLead: (leadId, updates) =>\n        set((state) => ({\n          leads: state.leads.map((l) =>\n            l.id === leadId ? { ...l, ...updates } : l\n          ),\n        })),\n\n      setLoading: (loading) => set({ isLoading: loading }),\n\n      setError: (error) => set({ error }),\n\n      clearLeads: () => set({ leads: [] }),\n\n      reset: () => set(initialState),\n    }),\n    {\n      name: \"campaign-store\",\n      partialize: (state) => ({\n        campaigns: state.campaigns,\n        leads: state.leads,\n      }),\n    }\n  )\n);\n"}}},
{"type":"measure","name":"lsp.did_open","count":86,"duration":4.735},
{"type":"mark","name":"lsp.document_symbol","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":59,"duration":0.296},
{"type":"mark","name":"lsp.did_open","count":87,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx","languageId":"typescriptreact","version":1,"text":"import React, { useEffect, useState } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { EnrichmentButton } from \"../components/EnrichmentButton\";\nimport { ProgressDisplay } from \"../components/ProgressDisplay\";\nimport { useBusinessDiscovery } from \"../hooks/useBusinessDiscovery\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport type { BusinessLead } from \"../types\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nexport const Campaign: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const campaignId = searchParams.get(\"id\");\n  const { currentCampaign, campaigns, leads, setCurrentCampaign } =\n    useCampaignStore();\n  const { isDiscovering, progress, currentStage, cacheStats, error } =\n    useBusinessDiscovery();\n  const [showResults, setShowResults] = useState(false);\n\n  // Filter leads for current campaign\n  const campaignLeads = currentCampaign\n    ? leads.filter((lead) => lead.campaign_id === currentCampaign.campaign_id)\n    : [];\n\n  useEffect(() => {\n    if (!currentCampaign && campaignId) {\n      const matchedCampaign = campaigns.find(\n        (campaign) => campaign.campaign_id === campaignId\n      );\n      if (matchedCampaign) {\n        setCurrentCampaign(matchedCampaign);\n      }\n    }\n  }, [campaignId, campaigns, currentCampaign, setCurrentCampaign]);\n\n  useEffect(() => {\n    if (campaignLeads.length > 0) {\n      setShowResults(true);\n    }\n  }, [campaignLeads.length]);\n\n  const exportToCsv = () => {\n    if (!campaignLeads.length) return;\n\n    exportLeadsToCsv(campaignLeads, {\n      fileName: `campaign-${\n        currentCampaign?.campaign_id || Date.now()\n      }-results.csv`,\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Campaign Header */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">\n              Campaign Progress\n            </h1>\n            <p className=\"text-gray-600 mt-1\">\n              {currentCampaign\n                ? `Campaign ${currentCampaign.campaign_id}`\n                : \"Running campaign...\"}\n            </p>\n          </div>\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => navigate(\"/discovery\")}\n              className=\"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200\"\n            >\n              Back to Discovery\n            </button>\n            {showResults && (\n              <button\n                onClick={exportToCsv}\n                className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\"\n              >\n                Export CSV\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Progress Display */}\n      {isDiscovering && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <ProgressDisplay\n            isDiscovering={isDiscovering}\n            progress={progress}\n            currentStage={currentStage}\n            cacheStats={cacheStats}\n          />\n        </div>\n      )}\n\n      {/* Campaign Summary */}\n      {currentCampaign && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Campaign Summary\n          </h2>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-blue-600 font-medium\">Status</div>\n              <div className=\"text-lg font-bold text-blue-900 capitalize\">\n                {currentCampaign.status}\n              </div>\n            </div>\n            <div className=\"bg-green-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-green-600 font-medium\">\n                Leads Found\n              </div>\n              <div className=\"text-lg font-bold text-green-900\">\n                {currentCampaign.leads_found || 0}\n              </div>\n            </div>\n            <div className=\"bg-yellow-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-yellow-600 font-medium\">\n                Qualified\n              </div>\n              <div className=\"text-lg font-bold text-yellow-900\">\n                {currentCampaign.leads_qualified || 0}\n              </div>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-purple-600 font-medium\">\n                Total Cost\n              </div>\n              <div className=\"text-lg font-bold text-purple-900\">\n                ${(currentCampaign.total_cost || 0).toFixed(2)}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Enrichment Section */}\n      {currentCampaign && showResults && campaignLeads.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Progressive Enrichment\n          </h2>\n          <div className=\"flex items-start justify-between gap-6\">\n            <div className=\"flex-1\">\n              <p className=\"text-gray-600 mb-4\">\n                Enrich your leads with verified emails, business license\n                validation, and more. Only pay for successful enrichments.\n              </p>\n              <div className=\"grid grid-cols-3 gap-3 text-sm\">\n                <div className=\"bg-blue-50 p-3 rounded\">\n                  <div className=\"font-semibold text-blue-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.emails?.length\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-blue-600 text-xs\">With Emails</div>\n                </div>\n                <div className=\"bg-green-50 p-3 rounded\">\n                  <div className=\"font-semibold text-green-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.neverBounceVerified\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-green-600 text-xs\">Email Verified</div>\n                </div>\n                <div className=\"bg-purple-50 p-3 rounded\">\n                  <div className=\"font-semibold text-purple-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.licenseVerified\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-purple-600 text-xs\">\n                    License Verified\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"flex-shrink-0\">\n              <EnrichmentButton\n                campaignId={currentCampaign.campaign_id}\n                onComplete={() => {\n                  // Optionally refresh data or show success message\n                  console.log(\n                    \"Enrichment completed for campaign:\",\n                    currentCampaign.campaign_id\n                  );\n                }}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Results Table */}\n      {showResults && campaignLeads.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm overflow-hidden\">\n          <div className=\"px-6 py-4 border-b border-gray-200\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">\n                Campaign Results\n              </h2>\n              <div className=\"text-sm text-gray-500\">\n                {campaignLeads.length} leads found\n              </div>\n            </div>\n          </div>\n\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Business\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Contact Info\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Score\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cost\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {campaignLeads.map((lead: BusinessLead) => (\n                  <tr key={lead.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div>\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {lead.business_name}\n                        </div>\n                        <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                          {lead.address}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"space-y-1\">\n                        {lead.phone && (\n                          <div className=\"text-sm text-gray-900\">\n                            {lead.phone}\n                          </div>\n                        )}\n                        {lead.email && (\n                          <div className=\"text-sm text-blue-600\">\n                            {lead.email}\n                          </div>\n                        )}\n                        {lead.website && (\n                          <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                            <a\n                              href={lead.website}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"hover:text-blue-600\"\n                            >\n                              {lead.website}\n                            </a>\n                          </div>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {lead.confidence_score}%\n                        </div>\n                        <div\n                          className={`ml-2 w-16 bg-gray-200 rounded-full h-2`}\n                        >\n                          <div\n                            className={`h-2 rounded-full ${\n                              lead.confidence_score >= 80\n                                ? \"bg-green-500\"\n                                : lead.confidence_score >= 60\n                                ? \"bg-yellow-500\"\n                                : \"bg-red-500\"\n                            }`}\n                            style={{ width: `${lead.confidence_score}%` }}\n                          ></div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${(lead.cost_to_acquire || 0).toFixed(2)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                          lead.validation_status === \"validated\"\n                            ? \"bg-green-100 text-green-800\"\n                            : lead.validation_status === \"pending\"\n                            ? \"bg-yellow-100 text-yellow-800\"\n                            : \"bg-red-100 text-red-800\"\n                        }`}\n                      >\n                        {lead.validation_status || \"unknown\"}\n                      </span>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg\n                className=\"h-5 w-5 text-red-400\"\n                viewBox=\"0 0 20 20\"\n                fill=\"currentColor\"\n              >\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">\n                Campaign Failed\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700\">\n                <p>{error instanceof Error ? error.message : String(error)}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* No Results State */}\n      {showResults && campaignLeads.length === 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-12 text-center\">\n          <svg\n            className=\"mx-auto h-12 w-12 text-gray-400\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n            />\n          </svg>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n            No results found\n          </h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Try adjusting your search criteria or location.\n          </p>\n          <div className=\"mt-6\">\n            <button\n              onClick={() => navigate(\"/discovery\")}\n              className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\n            >\n              Start New Campaign\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":60,"duration":0.332},
{"type":"measure","name":"lsp.did_open","count":87,"duration":13.472},
{"type":"mark","name":"lsp.goto_definition","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"},"position":{"line":21,"character":34}}},
{"type":"mark","name":"lsp.goto_definition","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"},"position":{"line":26,"character":30}}},
{"type":"mark","name":"lsp.did_close","count":22,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json"}}},
{"type":"measure","name":"lsp.did_close","count":22,"duration":0.031},
{"type":"mark","name":"lsp.did_open","count":88,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":88,"duration":0.043},
{"type":"mark","name":"lsp.did_close","count":23,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":61,"duration":0.336},
{"type":"measure","name":"lsp.did_close","count":23,"duration":1.902},
{"type":"mark","name":"lsp.did_close","count":24,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":24,"duration":1.291},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":62,"duration":0.32},
{"type":"mark","name":"lsp.did_close","count":25,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json"}}},
{"type":"measure","name":"lsp.did_close","count":25,"duration":0.035},
{"type":"mark","name":"lsp.did_open","count":89,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","languageId":"typescript","version":1,"text":"import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport type { BusinessLead, CampaignResult, CampaignStore } from \"../types\";\n\ninterface CampaignActions {\n  addCampaign: (campaign: CampaignResult) => void;\n  updateCampaign: (\n    campaignId: string,\n    updates: Partial<CampaignResult>\n  ) => void;\n  setCurrentCampaign: (campaign: CampaignResult | null) => void;\n  addLeads: (leads: BusinessLead[]) => void;\n  updateLead: (leadId: string, updates: Partial<BusinessLead>) => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  clearLeads: () => void;\n  reset: () => void;\n}\n\nconst initialState: CampaignStore = {\n  campaigns: [],\n  currentCampaign: null,\n  leads: [],\n  isLoading: false,\n  error: null,\n};\n\nexport const useCampaignStore = create<CampaignStore & CampaignActions>()(\n  persist(\n    (set) => ({\n      ...initialState,\n\n      addCampaign: (campaign) =>\n        set((state) => ({\n          campaigns: [campaign, ...state.campaigns],\n        })),\n\n      updateCampaign: (campaignId, updates) =>\n        set((state) => ({\n          campaigns: state.campaigns.map((c) =>\n            c.campaign_id === campaignId ? { ...c, ...updates } : c\n          ),\n          currentCampaign:\n            state.currentCampaign?.campaign_id === campaignId\n              ? { ...state.currentCampaign, ...updates }\n              : state.currentCampaign,\n        })),\n\n      setCurrentCampaign: (campaign) => set({ currentCampaign: campaign }),\n\n      addLeads: (leads) =>\n        set((state) => ({\n          leads: [...state.leads, ...leads],\n        })),\n\n      updateLead: (leadId, updates) =>\n        set((state) => ({\n          leads: state.leads.map((l) =>\n            l.id === leadId ? { ...l, ...updates } : l\n          ),\n        })),\n\n      setLoading: (loading) => set({ isLoading: loading }),\n\n      setError: (error) => set({ error }),\n\n      clearLeads: () => set({ leads: [] }),\n\n      reset: () => set(initialState),\n    }),\n    {\n      name: \"campaign-store\",\n      partialize: (state) => ({\n        campaigns: state.campaigns,\n        leads: state.leads,\n      }),\n    }\n  )\n);\n"}}},
{"type":"measure","name":"lsp.did_open","count":89,"duration":2.997},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":63,"duration":0.504},
{"type":"mark","name":"lsp.did_open","count":90,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts","languageId":"typescript","version":1,"text":"import type { BusinessLead, CampaignResult } from \"../types\";\n\nconst normalizeCampaignStatus = (\n  value: string | null | undefined\n): CampaignResult[\"status\"] => {\n  switch (value) {\n    case \"running\":\n    case \"completed\":\n    case \"failed\":\n    case \"cancelled\":\n      return value;\n    default:\n      return \"completed\";\n  }\n};\n\nconst normalizeValidationStatus = (\n  value: string | null | undefined\n): BusinessLead[\"validation_status\"] => {\n  switch (value) {\n    case \"pending\":\n    case \"validating\":\n    case \"validated\":\n    case \"failed\":\n      return value;\n    default:\n      return \"validated\";\n  }\n};\n\nconst deriveDataSources = (enrichmentData: any): string[] => {\n  if (!enrichmentData) {\n    return [\"google_places\"];\n  }\n\n  const fromServices = Array.isArray(\n    enrichmentData?.processingMetadata?.servicesUsed\n  )\n    ? enrichmentData.processingMetadata.servicesUsed\n    : [];\n\n  const fromSources = Array.isArray(enrichmentData?.verificationSources)\n    ? enrichmentData.verificationSources\n    : [];\n\n  const dataSources = [...fromServices, ...fromSources].filter(Boolean);\n  return dataSources.length > 0 ? dataSources : [\"google_places\"];\n};\n\nconst coerceNumber = (value: unknown, fallback = 0): number => {\n  const parsed = Number(value);\n  return Number.isFinite(parsed) ? parsed : fallback;\n};\n\ninterface TransformOptions {\n  metrics?: Record<string, any> | null;\n}\n\nexport interface CampaignTransformResult {\n  campaignResult: CampaignResult;\n  leads: BusinessLead[];\n}\n\nexport const transformCampaignData = (\n  campaignRecord: any,\n  leadsRecords: any[] = [],\n  options: TransformOptions = {}\n): CampaignTransformResult => {\n  if (!campaignRecord) {\n    throw new Error(\"Campaign record is required\");\n  }\n\n  const metricsAny = options.metrics ?? {};\n\n  const mappedLeads: BusinessLead[] = leadsRecords.map((lead) => {\n    const enrichmentData = lead.enrichment_data ?? undefined;\n    const rawCost =\n      lead.validation_cost ??\n      enrichmentData?.processingMetadata?.totalCost ??\n      0;\n\n    const tierFromData =\n      enrichmentData?.processingMetadata?.enrichmentTier ??\n      enrichmentData?.enrichmentTier;\n\n    return {\n      id: String(lead.id),\n      campaign_id: lead.campaign_id ?? campaignRecord.id,\n      business_name: lead.business_name ?? \"Unknown Business\",\n      address: lead.address ?? \"\",\n      phone: lead.phone ?? \"\",\n      website: lead.website ?? \"\",\n      email: lead.email ?? \"\",\n      confidence_score: coerceNumber(lead.confidence_score, 0),\n      validation_status: normalizeValidationStatus(\n        enrichmentData?.validationStatus ?? lead.validation_status\n      ),\n      created_at: lead.created_at ?? new Date().toISOString(),\n      cost_to_acquire: coerceNumber(rawCost, 0),\n      data_sources: deriveDataSources(enrichmentData),\n      enrichment_tier:\n        tierFromData ??\n        (metricsAny?.tier as string | undefined) ??\n        (metricsAny?.tier_name as string | undefined) ??\n        undefined,\n      vault_secured: true,\n      enrichment_data: enrichmentData,\n    };\n  });\n\n  const leadsQualified = mappedLeads.filter(\n    (lead) => lead.confidence_score >= 70\n  ).length;\n  const leadsValidated = mappedLeads.filter(\n    (lead) => lead.validation_status === \"validated\"\n  ).length;\n\n  const totalFoundRaw = campaignRecord.results_count ?? mappedLeads.length ?? 0;\n\n  const campaignResult: CampaignResult = {\n    campaign_id: campaignRecord.id,\n    business_type: campaignRecord.business_type ?? undefined,\n    location: campaignRecord.location ?? undefined,\n    status: normalizeCampaignStatus(campaignRecord.status),\n    progress: 100,\n    total_cost: coerceNumber(\n      campaignRecord.total_cost ?? metricsAny?.total_cost ?? 0,\n      0\n    ),\n    leads_found: coerceNumber(totalFoundRaw, mappedLeads.length),\n    leads_qualified: leadsQualified,\n    leads_validated: leadsValidated,\n    created_at: campaignRecord.created_at ?? new Date().toISOString(),\n    completed_at: campaignRecord.updated_at ?? undefined,\n    tier_used:\n      (metricsAny?.tier as string | undefined) ??\n      (metricsAny?.tier_name as string | undefined) ??\n      undefined,\n    vault_secured: true,\n    cache_performance: undefined,\n  };\n\n  return {\n    campaignResult,\n    leads: mappedLeads,\n  };\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":90,"duration":3.777},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":64,"duration":0.301},
{"type":"mark","name":"lsp.did_open","count":91,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx","languageId":"typescriptreact","version":1,"text":"import React, { useEffect, useState } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { EnrichmentButton } from \"../components/EnrichmentButton\";\nimport { ProgressDisplay } from \"../components/ProgressDisplay\";\nimport { useBusinessDiscovery } from \"../hooks/useBusinessDiscovery\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport type { BusinessLead } from \"../types\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nexport const Campaign: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const campaignId = searchParams.get(\"id\");\n  const { currentCampaign, campaigns, leads, setCurrentCampaign } =\n    useCampaignStore();\n  const { isDiscovering, progress, currentStage, cacheStats, error } =\n    useBusinessDiscovery();\n  const [showResults, setShowResults] = useState(false);\n\n  // Filter leads for current campaign\n  const campaignLeads = currentCampaign\n    ? leads.filter((lead) => lead.campaign_id === currentCampaign.campaign_id)\n    : [];\n\n  useEffect(() => {\n    if (!currentCampaign && campaignId) {\n      const matchedCampaign = campaigns.find(\n        (campaign) => campaign.campaign_id === campaignId\n      );\n      if (matchedCampaign) {\n        setCurrentCampaign(matchedCampaign);\n      }\n    }\n  }, [campaignId, campaigns, currentCampaign, setCurrentCampaign]);\n\n  useEffect(() => {\n    if (campaignLeads.length > 0) {\n      setShowResults(true);\n    }\n  }, [campaignLeads.length]);\n\n  const exportToCsv = () => {\n    if (!campaignLeads.length) return;\n\n    exportLeadsToCsv(campaignLeads, {\n      fileName: `campaign-${\n        currentCampaign?.campaign_id || Date.now()\n      }-results.csv`,\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Campaign Header */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">\n              Campaign Progress\n            </h1>\n            <p className=\"text-gray-600 mt-1\">\n              {currentCampaign\n                ? `Campaign ${currentCampaign.campaign_id}`\n                : \"Running campaign...\"}\n            </p>\n          </div>\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => navigate(\"/discovery\")}\n              className=\"px-4 py-2 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200\"\n            >\n              Back to Discovery\n            </button>\n            {showResults && (\n              <button\n                onClick={exportToCsv}\n                className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700\"\n              >\n                Export CSV\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Progress Display */}\n      {isDiscovering && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <ProgressDisplay\n            isDiscovering={isDiscovering}\n            progress={progress}\n            currentStage={currentStage}\n            cacheStats={cacheStats}\n          />\n        </div>\n      )}\n\n      {/* Campaign Summary */}\n      {currentCampaign && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Campaign Summary\n          </h2>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-blue-600 font-medium\">Status</div>\n              <div className=\"text-lg font-bold text-blue-900 capitalize\">\n                {currentCampaign.status}\n              </div>\n            </div>\n            <div className=\"bg-green-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-green-600 font-medium\">\n                Leads Found\n              </div>\n              <div className=\"text-lg font-bold text-green-900\">\n                {currentCampaign.leads_found || 0}\n              </div>\n            </div>\n            <div className=\"bg-yellow-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-yellow-600 font-medium\">\n                Qualified\n              </div>\n              <div className=\"text-lg font-bold text-yellow-900\">\n                {currentCampaign.leads_qualified || 0}\n              </div>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-lg\">\n              <div className=\"text-sm text-purple-600 font-medium\">\n                Total Cost\n              </div>\n              <div className=\"text-lg font-bold text-purple-900\">\n                ${(currentCampaign.total_cost || 0).toFixed(2)}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Enrichment Section */}\n      {currentCampaign && showResults && campaignLeads.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Progressive Enrichment\n          </h2>\n          <div className=\"flex items-start justify-between gap-6\">\n            <div className=\"flex-1\">\n              <p className=\"text-gray-600 mb-4\">\n                Enrich your leads with verified emails, business license\n                validation, and more. Only pay for successful enrichments.\n              </p>\n              <div className=\"grid grid-cols-3 gap-3 text-sm\">\n                <div className=\"bg-blue-50 p-3 rounded\">\n                  <div className=\"font-semibold text-blue-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.emails?.length\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-blue-600 text-xs\">With Emails</div>\n                </div>\n                <div className=\"bg-green-50 p-3 rounded\">\n                  <div className=\"font-semibold text-green-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.neverBounceVerified\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-green-600 text-xs\">Email Verified</div>\n                </div>\n                <div className=\"bg-purple-50 p-3 rounded\">\n                  <div className=\"font-semibold text-purple-900\">\n                    {\n                      campaignLeads.filter(\n                        (l) => l.enrichment_data?.licenseVerified\n                      ).length\n                    }\n                  </div>\n                  <div className=\"text-purple-600 text-xs\">\n                    License Verified\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"flex-shrink-0\">\n              <EnrichmentButton\n                campaignId={currentCampaign.campaign_id}\n                onComplete={() => {\n                  // Optionally refresh data or show success message\n                  console.log(\n                    \"Enrichment completed for campaign:\",\n                    currentCampaign.campaign_id\n                  );\n                }}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Results Table */}\n      {showResults && campaignLeads.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm overflow-hidden\">\n          <div className=\"px-6 py-4 border-b border-gray-200\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">\n                Campaign Results\n              </h2>\n              <div className=\"text-sm text-gray-500\">\n                {campaignLeads.length} leads found\n              </div>\n            </div>\n          </div>\n\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Business\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Contact Info\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Score\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cost\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {campaignLeads.map((lead: BusinessLead) => (\n                  <tr key={lead.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div>\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {lead.business_name}\n                        </div>\n                        <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                          {lead.address}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"space-y-1\">\n                        {lead.phone && (\n                          <div className=\"text-sm text-gray-900\">\n                            {lead.phone}\n                          </div>\n                        )}\n                        {lead.email && (\n                          <div className=\"text-sm text-blue-600\">\n                            {lead.email}\n                          </div>\n                        )}\n                        {lead.website && (\n                          <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                            <a\n                              href={lead.website}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"hover:text-blue-600\"\n                            >\n                              {lead.website}\n                            </a>\n                          </div>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {lead.confidence_score}%\n                        </div>\n                        <div\n                          className={`ml-2 w-16 bg-gray-200 rounded-full h-2`}\n                        >\n                          <div\n                            className={`h-2 rounded-full ${\n                              lead.confidence_score >= 80\n                                ? \"bg-green-500\"\n                                : lead.confidence_score >= 60\n                                ? \"bg-yellow-500\"\n                                : \"bg-red-500\"\n                            }`}\n                            style={{ width: `${lead.confidence_score}%` }}\n                          ></div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${(lead.cost_to_acquire || 0).toFixed(2)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                          lead.validation_status === \"validated\"\n                            ? \"bg-green-100 text-green-800\"\n                            : lead.validation_status === \"pending\"\n                            ? \"bg-yellow-100 text-yellow-800\"\n                            : \"bg-red-100 text-red-800\"\n                        }`}\n                      >\n                        {lead.validation_status || \"unknown\"}\n                      </span>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg\n                className=\"h-5 w-5 text-red-400\"\n                viewBox=\"0 0 20 20\"\n                fill=\"currentColor\"\n              >\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">\n                Campaign Failed\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700\">\n                <p>{error instanceof Error ? error.message : String(error)}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* No Results State */}\n      {showResults && campaignLeads.length === 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-12 text-center\">\n          <svg\n            className=\"mx-auto h-12 w-12 text-gray-400\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n            />\n          </svg>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n            No results found\n          </h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Try adjusting your search criteria or location.\n          </p>\n          <div className=\"mt-6\">\n            <button\n              onClick={() => navigate(\"/discovery\")}\n              className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\n            >\n              Start New Campaign\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"}}},
{"type":"measure","name":"lsp.did_open","count":91,"duration":5.054},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":65,"duration":0.309},
{"type":"mark","name":"lsp.did_open","count":92,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Results.tsx","languageId":"typescriptreact","version":1,"text":"import React from \"react\";\nimport { useCampaignStore } from \"../stores/campaignStore\";\nimport { exportLeadsToCsv } from \"../utils/exportLeadsToCsv\";\n\nexport const Results: React.FC = () => {\n  const { leads, currentCampaign } = useCampaignStore();\n\n  const handleExport = (format: \"csv\" | \"json\") => {\n    if (!leads.length) {\n      return;\n    }\n\n    if (format === \"csv\") {\n      exportLeadsToCsv(leads, {\n        fileName: `prospects-vault-secured-${\n          new Date().toISOString().split(\"T\")[0]\n        }.csv`,\n      });\n    } else {\n      const blob = new Blob([JSON.stringify(leads, null, 2)], {\n        type: \"application/json\",\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `prospects-vault-secured-${\n        new Date().toISOString().split(\"T\")[0]\n      }.json`;\n      a.click();\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  const getConfidenceColor = (score: number) => {\n    if (score >= 90) return \"bg-green-100 text-green-800\";\n    if (score >= 80) return \"bg-blue-100 text-blue-800\";\n    if (score >= 70) return \"bg-yellow-100 text-yellow-800\";\n    return \"bg-red-100 text-red-800\";\n  };\n\n  const getValidationStatusColor = (status: string) => {\n    switch (status) {\n      case \"validated\":\n        return \"bg-green-100 text-green-800\";\n      case \"validating\":\n        return \"bg-blue-100 text-blue-800\";\n      case \"pending\":\n        return \"bg-yellow-100 text-yellow-800\";\n      case \"failed\":\n        return \"bg-red-100 text-red-800\";\n      default:\n        return \"bg-gray-100 text-gray-800\";\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Results</h1>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            {leads.length} leads found â€¢{\" \"}\n            {leads.filter((l) => l.confidence_score >= 70).length} qualified\n          </p>\n        </div>\n\n        {leads.length > 0 && (\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => handleExport(\"csv\")}\n              className=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              ðŸ“Š Export CSV\n            </button>\n            <button\n              onClick={() => handleExport(\"json\")}\n              className=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              ðŸ“„ Export JSON\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Campaign Summary */}\n      {currentCampaign && (\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              Progressive Enrichment Results\n            </h3>\n            {currentCampaign.vault_secured && (\n              <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                ðŸ” Vault Secured\n              </span>\n            )}\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-5\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900\">\n                {currentCampaign.leads_found}\n              </div>\n              <div className=\"text-sm text-gray-500\">Total Found</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {currentCampaign.leads_qualified}\n              </div>\n              <div className=\"text-sm text-gray-500\">Qualified</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {currentCampaign.leads_validated}\n              </div>\n              <div className=\"text-sm text-gray-500\">Validated</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {currentCampaign.tier_used || \"Professional\"}\n              </div>\n              <div className=\"text-sm text-gray-500\">Tier Used</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900\">\n                ${currentCampaign.total_cost.toFixed(2)}\n              </div>\n              <div className=\"text-sm text-gray-500\">Total Cost</div>\n            </div>\n          </div>\n\n          {/* Cache Performance Display */}\n          {currentCampaign.cache_performance && (\n            <div className=\"mt-6 pt-6 border-t border-gray-200\">\n              <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n                ðŸš€ 90-Day Intelligent Cache Performance\n              </h4>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-green-600\">\n                    {currentCampaign.cache_performance.cache_hit_ratio.toFixed(\n                      1\n                    )}\n                    %\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Hit Ratio</div>\n                </div>\n                <div className=\"bg-blue-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-blue-600\">\n                    {currentCampaign.cache_performance.cache_hits}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Hits</div>\n                </div>\n                <div className=\"bg-yellow-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-yellow-600\">\n                    {currentCampaign.cache_performance.cache_misses}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cache Misses</div>\n                </div>\n                <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                  <div className=\"text-lg font-bold text-green-600\">\n                    ${currentCampaign.cache_performance.cost_savings.toFixed(2)}\n                  </div>\n                  <div className=\"text-xs text-gray-600\">Cost Savings</div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Results Table */}\n      <div className=\"bg-white shadow rounded-lg overflow-hidden\">\n        {leads.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <span className=\"text-4xl\">ðŸ”</span>\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n              No results yet\n            </h3>\n            <p className=\"mt-1 text-sm text-gray-500\">\n              Start a discovery campaign to find business leads.\n            </p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Business\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Contact\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Confidence\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Enrichment\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cost\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {leads.map((lead) => (\n                  <tr key={lead.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div>\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {lead.business_name}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">\n                            {lead.address}\n                          </div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"text-sm text-gray-900\">\n                        {lead.phone && <div>ðŸ“ž {lead.phone}</div>}\n                        {lead.website && (\n                          <div>\n                            ðŸŒ{\" \"}\n                            <a\n                              href={lead.website}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"text-blue-600 hover:underline\"\n                            >\n                              {lead.website.replace(/^https?:\\/\\//, \"\")}\n                            </a>\n                          </div>\n                        )}\n                        {lead.email && <div>ðŸ“§ {lead.email}</div>}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getConfidenceColor(\n                          lead.confidence_score\n                        )}`}\n                      >\n                        {lead.confidence_score}%\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex flex-col space-y-1\">\n                        <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800\">\n                          {lead.enrichment_tier || \"Professional\"}\n                        </span>\n                        {lead.vault_secured && (\n                          <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800\">\n                            ðŸ” Vault Secured\n                          </span>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getValidationStatusColor(\n                          lead.validation_status\n                        )}`}\n                      >\n                        {lead.validation_status}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${lead.cost_to_acquire.toFixed(3)}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.did_open","count":92,"duration":3.321},
{"type":"measure","name":"lsp.testing_update","count":66,"duration":0.425},
{"type":"mark","name":"lsp.did_close","count":26,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"}}},
{"type":"measure","name":"lsp.did_close","count":26,"duration":1.385},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":67,"duration":0.321},
{"type":"mark","name":"lsp.did_open","count":93,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","languageId":"typescript","version":1,"text":"import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport type { BusinessLead, CampaignResult, CampaignStore } from \"../types\";\n\ninterface CampaignActions {\n  addCampaign: (campaign: CampaignResult) => void;\n  updateCampaign: (\n    campaignId: string,\n    updates: Partial<CampaignResult>\n  ) => void;\n  setCurrentCampaign: (campaign: CampaignResult | null) => void;\n  addLeads: (leads: BusinessLead[]) => void;\n  updateLead: (leadId: string, updates: Partial<BusinessLead>) => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  clearLeads: () => void;\n  reset: () => void;\n}\n\nconst initialState: CampaignStore = {\n  campaigns: [],\n  currentCampaign: null,\n  leads: [],\n  isLoading: false,\n  error: null,\n};\n\nexport const useCampaignStore = create<CampaignStore & CampaignActions>()(\n  persist(\n    (set) => ({\n      ...initialState,\n\n      addCampaign: (campaign) =>\n        set((state) => ({\n          campaigns: [campaign, ...state.campaigns],\n        })),\n\n      updateCampaign: (campaignId, updates) =>\n        set((state) => ({\n          campaigns: state.campaigns.map((c) =>\n            c.campaign_id === campaignId ? { ...c, ...updates } : c\n          ),\n          currentCampaign:\n            state.currentCampaign?.campaign_id === campaignId\n              ? { ...state.currentCampaign, ...updates }\n              : state.currentCampaign,\n        })),\n\n      setCurrentCampaign: (campaign) => set({ currentCampaign: campaign }),\n\n      addLeads: (leads) =>\n        set((state) => ({\n          leads: [...state.leads, ...leads],\n        })),\n\n      updateLead: (leadId, updates) =>\n        set((state) => ({\n          leads: state.leads.map((l) =>\n            l.id === leadId ? { ...l, ...updates } : l\n          ),\n        })),\n\n      setLoading: (loading) => set({ isLoading: loading }),\n\n      setError: (error) => set({ error }),\n\n      clearLeads: () => set({ leads: [] }),\n\n      reset: () => set(initialState),\n    }),\n    {\n      name: \"campaign-store\",\n      partialize: (state) => ({\n        campaigns: state.campaigns,\n        leads: state.leads,\n      }),\n    }\n  )\n);\n"}}},
{"type":"measure","name":"lsp.did_open","count":93,"duration":1.527},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":68,"duration":0.533},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":42,"duration":0.022},
{"type":"mark","name":"lsp.did_change_batched","count":15,"args":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"},
{"type":"measure","name":"lsp.did_change_batched","count":15,"duration":2.444},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":43,"duration":0.028},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":69,"duration":0.34},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":15,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",70]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":6,"duration":0.877},
{"type":"mark","name":"tsc.op.op_resolve","count":596,"args":{"base":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":596,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":597,"args":{"base":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":597,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":598,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":598,"duration":0.126},
{"type":"mark","name":"tsc.op.op_resolve","count":599,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../stores/campaignStore"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":599,"duration":0.08},
{"type":"mark","name":"tsc.op.op_resolve","count":600,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":600,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":601,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":601,"duration":0.097},
{"type":"mark","name":"tsc.op.op_resolve","count":602,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":602,"duration":0.053},
{"type":"mark","name":"tsc.op.op_resolve","count":603,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":603,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":604,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":604,"duration":0.046},
{"type":"mark","name":"tsc.op.op_resolve","count":605,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":605,"duration":2.215},
{"type":"mark","name":"tsc.op.op_load","count":309,"args":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":309,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":606,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/EnrichmentButton"],[false,"../components/ProgressDisplay"],[false,"../hooks/useBusinessDiscovery"],[false,"../stores/campaignStore"],[false,"../types"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":606,"duration":0.14},
{"type":"mark","name":"tsc.op.op_resolve","count":607,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":607,"duration":0.102},
{"type":"mark","name":"tsc.op.op_resolve","count":608,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":608,"duration":0.86},
{"type":"mark","name":"tsc.op.op_load","count":310,"args":"file:///workspaces/ProspectPro/src/pages/Results.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":310,"duration":0.292},
{"type":"mark","name":"tsc.op.op_resolve","count":609,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Results.tsx","specifiers":[[false,"react"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":609,"duration":0.058},
{"type":"mark","name":"tsc.op.op_load","count":311,"args":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"},
{"type":"measure","name":"tsc.op.op_load","count":311,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":610,"args":{"base":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","specifiers":[[false,"zustand"],[false,"zustand/middleware"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":610,"duration":0.056},
{"type":"mark","name":"tsc.op.op_load","count":312,"args":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts"},
{"type":"measure","name":"tsc.op.op_load","count":312,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":611,"args":{"base":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts","specifiers":[[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":611,"duration":0.056},
{"type":"mark","name":"tsc.op.op_resolve","count":612,"args":{"base":"file:///workspaces/ProspectPro/src/vite-env.d.ts","specifiers":[[false,"vite/client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":612,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":613,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":613,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":614,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":614,"duration":0.062},
{"type":"mark","name":"tsc.op.op_resolve","count":615,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":615,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":616,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":616,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":617,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":617,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":618,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":618,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":619,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":619,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":620,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":620,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":621,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":621,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":622,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":622,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":623,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":623,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":624,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":624,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":625,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":625,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":626,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":626,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":627,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":627,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":628,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":628,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":629,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":629,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":630,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":630,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":631,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":631,"duration":0.039},
{"type":"mark","name":"tsc.op.op_resolve","count":632,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":632,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":633,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":633,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":634,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":634,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":635,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":635,"duration":0.045},
{"type":"mark","name":"tsc.op.op_resolve","count":636,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":636,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":637,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":637,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":638,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":638,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":639,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":639,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":640,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":640,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":641,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":641,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":642,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":642,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":643,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":643,"duration":0.045},
{"type":"mark","name":"tsc.op.op_resolve","count":644,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":644,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":645,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":645,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":646,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":646,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":647,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":647,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":648,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":648,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":649,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":649,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":650,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":650,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":651,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":651,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":652,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":652,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":653,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":653,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":654,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":654,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":655,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":655,"duration":0.183},
{"type":"mark","name":"tsc.op.op_resolve","count":656,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":656,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":657,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":657,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":658,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":658,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":659,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":659,"duration":0.059},
{"type":"mark","name":"tsc.op.op_resolve","count":660,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":660,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":661,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":661,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":662,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":662,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":663,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":663,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":664,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":664,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":665,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":665,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":666,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":666,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":667,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":667,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":668,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":668,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":669,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":669,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":670,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":670,"duration":0.631},
{"type":"mark","name":"tsc.op.op_resolve","count":671,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":671,"duration":0.401},
{"type":"mark","name":"tsc.op.op_resolve","count":672,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":672,"duration":1.229},
{"type":"mark","name":"tsc.op.op_resolve","count":673,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":673,"duration":0.26},
{"type":"mark","name":"tsc.op.op_resolve","count":674,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":674,"duration":0.293},
{"type":"mark","name":"tsc.op.op_resolve","count":675,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":675,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":676,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":676,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":677,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":677,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":678,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":678,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":679,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":679,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":680,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":680,"duration":0.142},
{"type":"mark","name":"tsc.op.op_resolve","count":681,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":681,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":682,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":682,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":683,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":683,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":684,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":684,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":685,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":685,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":686,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":686,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":687,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":687,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":688,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":688,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":689,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":689,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":690,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":690,"duration":2.491},
{"type":"mark","name":"tsc.op.op_resolve","count":691,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":691,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":692,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":692,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":693,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":693,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":694,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":694,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":695,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":695,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":696,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":696,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":697,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":697,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":698,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":698,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":699,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":699,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":700,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":700,"duration":0.038},
{"type":"mark","name":"tsc.op.op_resolve","count":701,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":701,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":702,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":702,"duration":0.04},
{"type":"mark","name":"tsc.op.op_resolve","count":703,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":703,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":704,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":704,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":705,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":705,"duration":4.097},
{"type":"mark","name":"tsc.op.op_resolve","count":706,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":706,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":707,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":707,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":708,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":708,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":709,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":709,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":710,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":710,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":711,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":711,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":712,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":712,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":713,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":713,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":714,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":714,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":715,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":715,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":716,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":716,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":717,"args":{"base":"file:///workspaces/ProspectPro/vite.config.ts","specifiers":[[false,"@vitejs/plugin-react"],[false,"path"],[false,"vite"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":717,"duration":0.01},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":15,"duration":386.275},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":15,"duration":386.435},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":13,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":13,"duration":121.86},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":13,"duration":124.386},
{"type":"measure","name":"lsp.diagnostic","count":44,"duration":513.496},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":45,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":46,"duration":0.02},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":47,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":12,"duration":0.02},
{"type":"mark","name":"lsp.did_close","count":27,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts"}}},
{"type":"measure","name":"lsp.did_close","count":27,"duration":2.444},
{"type":"mark","name":"lsp.did_close","count":28,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"}}},
{"type":"measure","name":"lsp.did_close","count":28,"duration":0.827},
{"type":"mark","name":"lsp.did_close","count":29,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/Results.tsx"}}},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":70,"duration":0.276},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":71,"duration":0.259},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":72,"duration":0.262},
{"type":"measure","name":"lsp.did_close","count":29,"duration":2.667},
{"type":"mark","name":"lsp.did_change_batched","count":16,"args":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":16,"duration":3.272},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":73,"duration":0.277},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":48,"duration":0.013},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":13,"duration":0.021},
{"type":"mark","name":"lsp.did_change_batched","count":17,"args":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":74,"duration":0.304},
{"type":"measure","name":"lsp.did_change_batched","count":17,"duration":2.247},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":49,"duration":0.009},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":16,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",75]}},
{"type":"mark","name":"tsc.op.op_script_names"},
{"type":"measure","name":"tsc.op.op_script_names","count":7,"duration":0.753},
{"type":"mark","name":"tsc.op.op_resolve","count":718,"args":{"base":"file:///workspaces/ProspectPro/DEPLOYMENT_CHECKLIST.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":718,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":719,"args":{"base":"file:///workspaces/ProspectPro/QUICKSTART_BACKGROUND_TASKS.md","specifiers":[[false,"../hooks/useJobProgress"],[false,"react-router-dom"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":719,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":720,"args":{"base":"file:///workspaces/ProspectPro/mcp-servers/production-server.js","specifiers":[[true,"@modelcontextprotocol/sdk/server/index.js"],[true,"@modelcontextprotocol/sdk/server/stdio.js"],[true,"@modelcontextprotocol/sdk/types.js"],[true,"@supabase/supabase-js"],[true,"https"],[true,"child_process"],[true,"fs"],[true,"path"],[true,"../modules/api-clients/google-places-client"],[true,"../modules/api-clients/foursquare-places-client"],[true,"../modules/api-clients/hunter-io-client"],[true,"../modules/api-clients/neverbounce-client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":720,"duration":0.1},
{"type":"mark","name":"tsc.op.op_resolve","count":721,"args":{"base":"file:///workspaces/ProspectPro/src/components/Layout.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../stores/campaignStore"],[false,"./AuthComponent"],[false,"./ThemeToggle"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":721,"duration":1.538},
{"type":"mark","name":"tsc.op.op_resolve","count":722,"args":{"base":"file:///workspaces/ProspectPro/src/contexts/AuthContext.tsx","specifiers":[[false,"@supabase/supabase-js"],[false,"react"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":722,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":723,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useBusinessDiscovery.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":723,"duration":0.093},
{"type":"mark","name":"tsc.op.op_resolve","count":724,"args":{"base":"file:///workspaces/ProspectPro/src/hooks/useLeadEnrichment.ts","specifiers":[[false,"@tanstack/react-query"],[false,"react"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":724,"duration":0.043},
{"type":"mark","name":"tsc.op.op_resolve","count":725,"args":{"base":"file:///workspaces/ProspectPro/src/lib/supabase.ts","specifiers":[[false,"@supabase/supabase-js"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":725,"duration":0.01},
{"type":"mark","name":"tsc.op.op_resolve","count":726,"args":{"base":"file:///workspaces/ProspectPro/src/pages/AccountPage.tsx","specifiers":[[false,"react"],[false,"../components/ApiUsageTable"],[false,"../contexts/AuthContext"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":726,"duration":0.043},
{"type":"mark","name":"tsc.op.op_resolve","count":727,"args":{"base":"file:///workspaces/ProspectPro/src/pages/BusinessDiscovery.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/GeographicSelector"],[false,"../components/MultiSelectBusinessTypes"],[false,"../components/ProgressDisplay"],[false,"../components/TierSelector"],[false,"../constants/businessTaxonomy"],[false,"../contexts/AuthContext"],[false,"../hooks/useBusinessDiscovery"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/exportLeadsToCsv"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":727,"duration":0.157},
{"type":"mark","name":"tsc.op.op_load","count":313,"args":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":313,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":728,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":728,"duration":0.115},
{"type":"mark","name":"tsc.op.op_resolve","count":729,"args":{"base":"file:///workspaces/ProspectPro/src/pages/Dashboard.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../contexts/AuthContext"],[false,"../lib/supabase"],[false,"../stores/campaignStore"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":729,"duration":0.059},
{"type":"mark","name":"tsc.op.op_load","count":314,"args":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"},
{"type":"measure","name":"tsc.op.op_load","count":314,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":730,"args":{"base":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","specifiers":[[false,"zustand"],[false,"zustand/middleware"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":730,"duration":0.058},
{"type":"mark","name":"tsc.op.op_resolve","count":731,"args":{"base":"file:///workspaces/ProspectPro/src/vite-env.d.ts","specifiers":[[false,"vite/client"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":731,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":732,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/api-usage.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":732,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":733,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":733,"duration":0.056},
{"type":"mark","name":"tsc.op.op_resolve","count":734,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":734,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":735,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":735,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":736,"args":{"base":"https://esm.sh/@supabase/functions-js@2.5.0/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":736,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":737,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":737,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":738,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":738,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":739,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":739,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":740,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./select-query-parser/utils.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":740,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":741,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":741,"duration":0.025},
{"type":"mark","name":"tsc.op.op_resolve","count":742,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./select-query-parser/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":742,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":743,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"],[false,"./select-query-parser/types.d.ts"],[false,"./select-query-parser/utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":743,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":744,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":744,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":745,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":745,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":746,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":746,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":747,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":747,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":748,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./lib/websocket-factory.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":748,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":749,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeClient.d.ts","specifiers":[[false,"./lib/websocket-factory.d.ts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":749,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":750,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":750,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":751,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":751,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":752,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":752,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":753,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":753,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":754,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":754,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":755,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"./BlobDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":755,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":756,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":756,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":757,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":757,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":758,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/BlobDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"],[false,"./StreamDownloadBuilder.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":758,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":759,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StreamDownloadBuilder.d.ts","specifiers":[[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":759,"duration":0.015},
{"type":"mark","name":"tsc.op.op_resolve","count":760,"args":{"base":"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"],[false,"../StorageClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":760,"duration":0.026},
{"type":"mark","name":"tsc.op.op_resolve","count":761,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":761,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":762,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":762,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":763,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":763,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":764,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":764,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":765,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/types.d.ts","specifiers":[[false,"./web3/ethereum.d.ts"],[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./web3/solana.d.ts"],[false,"./web3/ethereum.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":765,"duration":0.029},
{"type":"mark","name":"tsc.op.op_resolve","count":766,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":766,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":767,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":767,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":768,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":768,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":769,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":769,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":770,"args":{"base":"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":770,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":771,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.58.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/auth-js@2.72.0/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.15.5/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.21.4/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.12.2/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":771,"duration":0.027},
{"type":"mark","name":"tsc.op.op_resolve","count":772,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth-simplified.ts","specifiers":[[false,"./edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":772,"duration":0.031},
{"type":"mark","name":"tsc.op.op_resolve","count":773,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/edge-auth.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":773,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":774,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":774,"duration":0.051},
{"type":"mark","name":"tsc.op.op_resolve","count":775,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":775,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":776,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts","specifiers":[[false,"./FunctionsClient.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":776,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":777,"args":{"base":"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/FunctionsClient.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":777,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":778,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts","specifiers":[[false,"./PostgrestClient.d.ts"],[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./PostgrestTransformBuilder.d.ts"],[false,"./PostgrestBuilder.d.ts"],[false,"./PostgrestError.d.ts"],[false,"./types.d.ts"],[false,"./select-query-parser/result.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":778,"duration":0.056},
{"type":"mark","name":"tsc.op.op_resolve","count":779,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestClient.d.ts","specifiers":[[false,"./PostgrestQueryBuilder.d.ts"],[false,"./PostgrestFilterBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":779,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":780,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestQueryBuilder.d.ts","specifiers":[[false,"./PostgrestFilterBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":780,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":781,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestFilterBuilder.d.ts","specifiers":[[false,"./PostgrestTransformBuilder.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":781,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":782,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestTransformBuilder.d.ts","specifiers":[[false,"./PostgrestBuilder.d.ts"],[false,"./select-query-parser/result.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":782,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":783,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/PostgrestBuilder.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":783,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":784,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/types.d.ts","specifiers":[[false,"./PostgrestError.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":784,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":785,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/result.d.ts","specifiers":[[false,"../types.d.ts"],[false,"./types.d.ts"],[false,"./parser.d.ts"],[false,"./types.d.ts"],[false,"./utils.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":785,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":786,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/types.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":786,"duration":2.714},
{"type":"mark","name":"tsc.op.op_resolve","count":787,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/parser.d.ts","specifiers":[[false,"../types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":787,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":788,"args":{"base":"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/select-query-parser/utils.d.ts","specifiers":[[false,"./parser.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":788,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":789,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts","specifiers":[[false,"./RealtimeClient.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":789,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":790,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeClient.d.ts","specifiers":[[false,"https://esm.sh/@types/ws@8.5.13/index.d.mts"],[false,"./lib/constants.d.ts"],[false,"./lib/serializer.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimeChannel.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":790,"duration":0.035},
{"type":"mark","name":"tsc.op.op_resolve","count":791,"args":{"base":"https://esm.sh/@types/ws@8.5.13/index.d.mts","specifiers":[[false,"./index.d.mts"],[true,"./index.d.mts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":791,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":792,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimeChannel.d.ts","specifiers":[[false,"./lib/constants.d.ts"],[false,"./lib/push.d.ts"],[false,"./RealtimeClient.d.ts"],[false,"./lib/timer.d.ts"],[false,"./RealtimePresence.d.ts"],[false,"./RealtimePresence.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":792,"duration":0.036},
{"type":"mark","name":"tsc.op.op_resolve","count":793,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/lib/push.d.ts","specifiers":[[false,"../RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":793,"duration":0.016},
{"type":"mark","name":"tsc.op.op_resolve","count":794,"args":{"base":"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/RealtimePresence.d.ts","specifiers":[[false,"https://esm.sh/@types/phoenix@1.6.6/index.d.ts"],[false,"./RealtimeChannel.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":794,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":795,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts","specifiers":[[false,"./StorageClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":795,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":796,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/StorageClient.d.ts","specifiers":[[false,"./packages/StorageFileApi.d.ts"],[false,"./packages/StorageBucketApi.d.ts"],[false,"./lib/fetch.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":796,"duration":0.023},
{"type":"mark","name":"tsc.op.op_resolve","count":797,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageFileApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":797,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":798,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":798,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":799,"args":{"base":"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/packages/StorageBucketApi.d.ts","specifiers":[[false,"../lib/errors.d.ts"],[false,"../lib/fetch.d.ts"],[false,"../lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":799,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":800,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":800,"duration":0.018},
{"type":"mark","name":"tsc.op.op_resolve","count":801,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./GoTrueClient.d.ts"],[false,"./AuthAdminApi.d.ts"],[false,"./AuthClient.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/locks.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":801,"duration":0.041},
{"type":"mark","name":"tsc.op.op_resolve","count":802,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueAdminApi.d.ts","specifiers":[[false,"./lib/fetch.d.ts"],[false,"./lib/types.d.ts"],[false,"./lib/errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":802,"duration":0.02},
{"type":"mark","name":"tsc.op.op_resolve","count":803,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/fetch.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":803,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":804,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/types.d.ts","specifiers":[[false,"./errors.d.ts"],[false,"./fetch.d.ts"],[false,"./internal-types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":804,"duration":0.336},
{"type":"mark","name":"tsc.op.op_resolve","count":805,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/errors.d.ts","specifiers":[[false,"./types.d.ts"],[false,"./error-codes.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":805,"duration":0.019},
{"type":"mark","name":"tsc.op.op_resolve","count":806,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/internal-types.d.ts","specifiers":[[false,"./errors.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":806,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":807,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/GoTrueClient.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"],[false,"./lib/errors.d.ts"],[false,"./lib/fetch.d.ts"],[false,"./lib/helpers.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":807,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":808,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/lib/helpers.d.ts","specifiers":[[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":808,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":809,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthAdminApi.d.ts","specifiers":[[false,"./GoTrueAdminApi.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":809,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":810,"args":{"base":"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/AuthClient.d.ts","specifiers":[[false,"./GoTrueClient.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":810,"duration":0.013},
{"type":"mark","name":"tsc.op.op_resolve","count":811,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.0/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":811,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":812,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/_shared/vault-client.ts","specifiers":[[false,"https://esm.sh/@supabase/supabase-js@2.38.0"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":812,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":813,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":813,"duration":0.047},
{"type":"mark","name":"tsc.op.op_resolve","count":814,"args":{"base":"https://deno.land/std@0.168.0/http/server.ts","specifiers":[[false,"../async/mod.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":814,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":815,"args":{"base":"https://deno.land/std@0.168.0/async/mod.ts","specifiers":[[false,"./abortable.ts"],[false,"./deadline.ts"],[false,"./debounce.ts"],[false,"./deferred.ts"],[false,"./delay.ts"],[false,"./mux_async_iterator.ts"],[false,"./pool.ts"],[false,"./tee.ts"],[false,"./retry.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":815,"duration":0.045},
{"type":"mark","name":"tsc.op.op_resolve","count":816,"args":{"base":"https://deno.land/std@0.168.0/async/abortable.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":816,"duration":0.011},
{"type":"mark","name":"tsc.op.op_resolve","count":817,"args":{"base":"https://deno.land/std@0.168.0/async/deadline.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":817,"duration":0.01},
{"type":"mark","name":"tsc.op.op_resolve","count":818,"args":{"base":"https://deno.land/std@0.168.0/async/mux_async_iterator.ts","specifiers":[[false,"./deferred.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":818,"duration":0.012},
{"type":"mark","name":"tsc.op.op_resolve","count":819,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-optimized/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":819,"duration":0.037},
{"type":"mark","name":"tsc.op.op_resolve","count":820,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":820,"duration":0.062},
{"type":"mark","name":"tsc.op.op_resolve","count":821,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export-user-aware/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":821,"duration":0.042},
{"type":"mark","name":"tsc.op.op_resolve","count":822,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/campaign-export/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":822,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":823,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-business-license/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":823,"duration":0.028},
{"type":"mark","name":"tsc.op.op_resolve","count":824,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/index.d.ts","specifiers":[[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"./SupabaseClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":824,"duration":0.049},
{"type":"mark","name":"tsc.op.op_resolve","count":825,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/SupabaseClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/functions-js@2.4.4/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/postgrest-js@1.17.11/dist/cjs/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/storage-js@2.7.1/dist/module/index.d.ts"],[false,"./lib/SupabaseAuthClient.d.ts"],[false,"./lib/types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":825,"duration":0.034},
{"type":"mark","name":"tsc.op.op_resolve","count":826,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/SupabaseAuthClient.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"./types.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":826,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":827,"args":{"base":"https://esm.sh/@supabase/supabase-js@2.38.4/dist/module/lib/types.d.ts","specifiers":[[false,"https://esm.sh/@supabase/gotrue-js@2.67.3/dist/module/index.d.ts"],[false,"https://esm.sh/@supabase/realtime-js@2.11.3/dist/module/index.d.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":827,"duration":0.017},
{"type":"mark","name":"tsc.op.op_resolve","count":828,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-hunter/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":828,"duration":0.055},
{"type":"mark","name":"tsc.op.op_resolve","count":829,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-neverbounce/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/vault-client.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":829,"duration":0.03},
{"type":"mark","name":"tsc.op.op_resolve","count":830,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-orchestrator/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/api-usage.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":830,"duration":0.024},
{"type":"mark","name":"tsc.op.op_resolve","count":831,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/enrichment-pdl/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.4"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":831,"duration":0.021},
{"type":"mark","name":"tsc.op.op_resolve","count":832,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-business-discovery/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":832,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":833,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-google-places/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":833,"duration":0.014},
{"type":"mark","name":"tsc.op.op_resolve","count":834,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-new-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2.38.0"],[false,"../_shared/edge-auth.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":834,"duration":0.032},
{"type":"mark","name":"tsc.op.op_resolve","count":835,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/test-official-auth/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":835,"duration":0.022},
{"type":"mark","name":"tsc.op.op_resolve","count":836,"args":{"base":"file:///workspaces/ProspectPro/vite.config.ts","specifiers":[[false,"@vitejs/plugin-react"],[false,"path"],[false,"vite"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":836,"duration":0.01},
{"type":"mark","name":"tsc.op.op_release","count":9,"args":"file:///workspaces/ProspectPro/src/pages/Campaign.tsx"},
{"type":"measure","name":"tsc.op.op_release","count":9,"duration":3.643},
{"type":"mark","name":"tsc.op.op_release","count":10,"args":"file:///workspaces/ProspectPro/src/pages/Results.tsx"},
{"type":"measure","name":"tsc.op.op_release","count":10,"duration":1.305},
{"type":"mark","name":"tsc.op.op_release","count":11,"args":"file:///workspaces/ProspectPro/src/utils/campaignTransforms.ts"},
{"type":"measure","name":"tsc.op.op_release","count":11,"duration":0.739},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":16,"duration":400.516},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":16,"duration":401.62},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":14,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":14,"duration":0.128},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":14,"duration":0.172},
{"type":"measure","name":"lsp.diagnostic","count":50,"duration":406.855},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":51,"duration":0.019},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":52,"duration":0.017},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":14,"duration":0.042},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":53,"duration":0.001},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":54,"duration":0.022},
{"type":"mark","name":"lsp.goto_definition","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},"position":{"line":19,"character":8}}},
{"type":"mark","name":"lsp.goto_definition","count":5,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},"position":{"line":20,"character":8}}},
{"type":"mark","name":"lsp.goto_definition","count":6,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},"position":{"line":24,"character":8}}},
{"type":"mark","name":"lsp.did_change_batched","count":18,"args":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":18,"duration":7.302},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":55,"duration":0.011},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":75,"duration":0.312},
{"type":"mark","name":"lsp.did_change_batched","count":19,"args":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},
{"type":"measure","name":"lsp.did_change_batched","count":19,"duration":11.596},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":56,"duration":0.012},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":76,"duration":0.359},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":17,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",77]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":8,"duration":0.034},
{"type":"mark","name":"tsc.op.op_load","count":315,"args":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx"},
{"type":"measure","name":"tsc.op.op_load","count":315,"duration":0.052},
{"type":"mark","name":"tsc.op.op_resolve","count":837,"args":{"base":"file:///workspaces/ProspectPro/src/pages/CampaignProgress.tsx","specifiers":[[false,"react"],[false,"react-router-dom"],[false,"../components/ProgressDisplay"],[false,"../contexts/AuthContext"],[false,"../hooks/useJobProgress"],[false,"../lib/supabase"],[false,"../stores/campaignStore"],[false,"../utils/campaignTransforms"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":837,"duration":0.131},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":17,"duration":527.353},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":17,"duration":533.465},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":15,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":15,"duration":107.429},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":15,"duration":108.603},
{"type":"measure","name":"lsp.diagnostic","count":57,"duration":644.589},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":58,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":59,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":60,"duration":0.021},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":61,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":15,"duration":0.021},
{"type":"mark","name":"lsp.did_change_batched","count":20,"args":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"},
{"type":"measure","name":"lsp.did_change_batched","count":20,"duration":4.161},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":62,"duration":0.011},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":77,"duration":0.29},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":18,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",78]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":9,"duration":0.02},
{"type":"mark","name":"tsc.op.op_load","count":316,"args":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts"},
{"type":"measure","name":"tsc.op.op_load","count":316,"duration":0.033},
{"type":"mark","name":"tsc.op.op_resolve","count":838,"args":{"base":"file:///workspaces/ProspectPro/src/stores/campaignStore.ts","specifiers":[[false,"zustand"],[false,"zustand/middleware"],[false,"../types"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":838,"duration":0.068},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":18,"duration":472.591},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":18,"duration":472.76},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":16,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":16,"duration":10.982},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":16,"duration":14.096},
{"type":"measure","name":"lsp.diagnostic","count":63,"duration":488.869},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":16,"duration":0.02},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":64,"duration":0.023},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":65,"duration":0.02},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":66,"duration":0.001},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":67,"duration":0.019},
{"type":"mark","name":"lsp.did_open","count":94,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":94,"duration":0.049},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":68,"duration":0.045},
{"type":"mark","name":"lsp.code_action","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":0,"character":0},"end":{"line":0,"character":0}},"context":{"diagnostics":[],"triggerKind":2}}},
{"type":"mark","name":"tsc.request.$getSupportedCodeFixes"},
{"type":"mark","name":"lsp.document_symbol","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":1,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"mark","name":"tsc.request.getNavigationTree"},
{"type":"mark","name":"tsc.host.$getSupportedCodeFixes","count":1,"args":"GetSupportedCodeFixes"},
{"type":"measure","name":"tsc.host.$getSupportedCodeFixes","count":1,"duration":311.642},
Unable to send result to client.
{"type":"mark","name":"tsc.host.getNavigationTree","count":1,"args":{"GetNavigationTree":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"mark","name":"lsp.did_change_batched","count":21,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"lsp.did_change_batched","count":21,"duration":38.339},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"lsp.semantic_tokens_range","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1161,"character":0},"end":{"line":1275,"character":71}}}},
{"type":"mark","name":"tsc.request.getEncodedSemanticClassifications"},
{"type":"mark","name":"lsp.folding_range","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getOutliningSpans"},
{"type":"mark","name":"lsp.document_symbol","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":2,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"mark","name":"tsc.request.getNavigationTree"},
{"type":"mark","name":"lsp.semantic_tokens_full","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getEncodedSemanticClassifications"},
{"type":"mark","name":"lsp.document_symbol","count":5,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":3,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"mark","name":"lsp.code_action","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":0,"character":0},"end":{"line":0,"character":0}},"context":{"diagnostics":[],"triggerKind":2}}},
{"type":"mark","name":"tsc.request.$getSupportedCodeFixes"},
{"type":"measure","name":"lsp.testing_update","count":78,"duration":0.758},
{"type":"mark","name":"lsp.inlay_hint","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1131,"character":0},"end":{"line":1305,"character":12}}}},
{"type":"measure","name":"tsc.host.getNavigationTree","count":1,"duration":447.825},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":19,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",79]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":10,"duration":0.029},
{"type":"mark","name":"tsc.op.op_load","count":317,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":317,"duration":0.124},
{"type":"mark","name":"tsc.op.op_resolve","count":839,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":839,"duration":0.085},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":19,"duration":516.335},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":19,"duration":737.14},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.getEncodedSemanticClassifications","count":1,"args":{"GetEncodedSemanticClassifications":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"start":31150,"length":3103},"2020"]}},
{"type":"measure","name":"tsc.host.getEncodedSemanticClassifications","count":1,"duration":23.061},
{"type":"measure","name":"tsc.request.getEncodedSemanticClassifications","count":1,"duration":760.223},
{"type":"measure","name":"lsp.semantic_tokens_range","count":1,"duration":760.365},
{"type":"mark","name":"tsc.host.getOutliningSpans","count":1,"args":{"GetOutliningSpans":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"measure","name":"tsc.host.getOutliningSpans","count":1,"duration":112.855},
{"type":"mark","name":"tsc.host.getNavigationTree","count":2,"args":{"GetNavigationTree":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"measure","name":"tsc.request.getOutliningSpans","count":1,"duration":874.316},
{"type":"measure","name":"lsp.folding_range","count":1,"duration":874.557},
{"type":"measure","name":"tsc.host.getNavigationTree","count":2,"duration":35.766},
{"type":"measure","name":"tsc.request.getNavigationTree","count":2,"duration":910.26},
{"type":"measure","name":"lsp.get_navigation_tree","count":2,"duration":910.302},
{"type":"mark","name":"tsc.host.getEncodedSemanticClassifications","count":2,"args":{"GetEncodedSemanticClassifications":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"start":0,"length":51253},"2020"]}},
{"type":"measure","name":"lsp.document_symbol","count":4,"duration":916.187},
{"type":"measure","name":"lsp.get_navigation_tree","count":3,"duration":924.031},
{"type":"measure","name":"lsp.document_symbol","count":5,"duration":924.738},
{"type":"measure","name":"tsc.host.getEncodedSemanticClassifications","count":2,"duration":211.745},
{"type":"mark","name":"tsc.host.$getSupportedCodeFixes","count":2,"args":"GetSupportedCodeFixes"},
{"type":"measure","name":"tsc.host.$getSupportedCodeFixes","count":2,"duration":0.064},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":17,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":17,"duration":0.137},
{"type":"measure","name":"tsc.request.getEncodedSemanticClassifications","count":2,"duration":1123.643},
{"type":"measure","name":"lsp.semantic_tokens_full","count":1,"duration":1124.02},
{"type":"measure","name":"tsc.request.$getSupportedCodeFixes","count":2,"duration":1124.237},
{"type":"mark","name":"tsc.request.getApplicableRefactors"},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":17,"duration":387.706},
{"type":"measure","name":"lsp.diagnostic","count":69,"duration":1133.139},
{"type":"mark","name":"tsc.host.getApplicableRefactors","count":1,"args":{"GetApplicableRefactors":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"pos":0,"end":0},{"quotePreference":"auto","includeCompletionsForModuleExports":false,"includeCompletionsForImportStatements":true,"includeCompletionsWithSnippetText":true,"includeAutomaticOptionalChainCompletions":true,"includeCompletionsWithInsertText":true,"includeCompletionsWithClassMemberSnippets":true,"includeCompletionsWithObjectLiteralMethodSnippets":true,"useLabelDetailsInCompletionEntries":true,"allowIncompleteCompletions":true,"importModuleSpecifierPreference":"shortest","importModuleSpecifierEnding":"index","allowTextChangesInNewFiles":true,"providePrefixAndSuffixTextForRename":true,"provideRefactorNotApplicableReason":true,"jsxAttributeCompletionStyle":"auto","includeInlayParameterNameHints":"none","includeInlayParameterNameHintsWhenArgumentMatchesName":false,"includeInlayFunctionParameterTypeHints":false,"includeInlayVariableTypeHints":false,"includeInlayVariableTypeHintsWhenTypeMatchesName":false,"includeInlayPropertyDeclarationTypeHints":false,"includeInlayFunctionLikeReturnTypeHints":false,"includeInlayEnumMemberValueHints":false,"autoImportFileExcludePatterns":[],"interactiveInlayHints":true,"preferTypeOnlyAutoImports":false},"implicit",""]}},
{"type":"measure","name":"tsc.host.getApplicableRefactors","count":1,"duration":74.464},
{"type":"measure","name":"tsc.request.getApplicableRefactors","count":1,"duration":76.751},
{"type":"measure","name":"lsp.code_action","count":2,"duration":1201.285},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":17,"duration":0.058},
{"type":"mark","name":"lsp.code_lens","count":1,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":4,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":4,"duration":0.0},
{"type":"measure","name":"lsp.code_lens","count":1,"duration":1.185},
{"type":"mark","name":"lsp.inlay_hint","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":5}}}},
{"type":"mark","name":"lsp.semantic_tokens_range","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1653,"character":0},"end":{"line":1765,"character":25}}}},
{"type":"measure","name":"lsp.semantic_tokens_range","count":2,"duration":0.039},
{"type":"mark","name":"lsp.did_close","count":30,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json"}}},
{"type":"measure","name":"lsp.did_close","count":30,"duration":0.03},
{"type":"mark","name":"lsp.code_action","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":0,"character":0},"end":{"line":0,"character":0}},"context":{"diagnostics":[],"triggerKind":2}}},
{"type":"mark","name":"tsc.request.getApplicableRefactors"},
{"type":"mark","name":"tsc.host.getApplicableRefactors","count":2,"args":{"GetApplicableRefactors":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"pos":0,"end":0},{"quotePreference":"auto","includeCompletionsForModuleExports":false,"includeCompletionsForImportStatements":true,"includeCompletionsWithSnippetText":true,"includeAutomaticOptionalChainCompletions":true,"includeCompletionsWithInsertText":true,"includeCompletionsWithClassMemberSnippets":true,"includeCompletionsWithObjectLiteralMethodSnippets":true,"useLabelDetailsInCompletionEntries":true,"allowIncompleteCompletions":true,"importModuleSpecifierPreference":"shortest","importModuleSpecifierEnding":"index","allowTextChangesInNewFiles":true,"providePrefixAndSuffixTextForRename":true,"provideRefactorNotApplicableReason":true,"jsxAttributeCompletionStyle":"auto","includeInlayParameterNameHints":"none","includeInlayParameterNameHintsWhenArgumentMatchesName":false,"includeInlayFunctionParameterTypeHints":false,"includeInlayVariableTypeHints":false,"includeInlayVariableTypeHintsWhenTypeMatchesName":false,"includeInlayPropertyDeclarationTypeHints":false,"includeInlayFunctionLikeReturnTypeHints":false,"includeInlayEnumMemberValueHints":false,"autoImportFileExcludePatterns":[],"interactiveInlayHints":true,"preferTypeOnlyAutoImports":false},"implicit",""]}},
{"type":"measure","name":"tsc.host.getApplicableRefactors","count":2,"duration":3.015},
{"type":"measure","name":"tsc.request.getApplicableRefactors","count":2,"duration":3.218},
{"type":"measure","name":"lsp.code_action","count":3,"duration":3.47},
{"type":"mark","name":"lsp.inlay_hint","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":5}}}},
{"type":"mark","name":"lsp.inlay_hint","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":5}}}},
{"type":"mark","name":"lsp.did_change_batched","count":22,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":79,"duration":0.724},
{"type":"measure","name":"lsp.did_change_batched","count":22,"duration":14.394},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":20,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",80]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":11,"duration":0.019},
{"type":"mark","name":"tsc.op.op_load","count":318,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":318,"duration":0.068},
{"type":"mark","name":"tsc.op.op_resolve","count":840,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":840,"duration":0.071},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":20,"duration":466.608},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":20,"duration":466.752},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":18,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":18,"duration":0.14},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":18,"duration":0.219},
{"type":"measure","name":"lsp.diagnostic","count":70,"duration":469.385},
{"type":"mark","name":"lsp.inlay_hint","count":5,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":34}}}},
{"type":"mark","name":"lsp.inlay_hint","count":6,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":34}}}},
{"type":"mark","name":"lsp.document_symbol","count":6,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":5,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"mark","name":"tsc.request.getNavigationTree"},
{"type":"mark","name":"lsp.semantic_tokens_full","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getEncodedSemanticClassifications"},
{"type":"mark","name":"tsc.host.getNavigationTree","count":3,"args":{"GetNavigationTree":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"measure","name":"tsc.host.getNavigationTree","count":3,"duration":49.461},
{"type":"measure","name":"tsc.request.getNavigationTree","count":3,"duration":56.279},
{"type":"measure","name":"lsp.get_navigation_tree","count":5,"duration":56.369},
{"type":"measure","name":"lsp.document_symbol","count":6,"duration":57.075},
{"type":"mark","name":"tsc.host.getEncodedSemanticClassifications","count":3,"args":{"GetEncodedSemanticClassifications":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"start":0,"length":51324},"2020"]}},
{"type":"measure","name":"tsc.host.getEncodedSemanticClassifications","count":3,"duration":108.385},
{"type":"measure","name":"tsc.request.getEncodedSemanticClassifications","count":3,"duration":160.521},
{"type":"measure","name":"lsp.semantic_tokens_full","count":2,"duration":160.842},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":18,"duration":0.055},
{"type":"mark","name":"lsp.code_action","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":0,"character":0},"end":{"line":0,"character":0}},"context":{"diagnostics":[],"triggerKind":2}}},
{"type":"mark","name":"tsc.request.getApplicableRefactors"},
{"type":"mark","name":"lsp.document_symbol","count":7,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":6,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":6,"duration":0.0},
{"type":"measure","name":"lsp.document_symbol","count":7,"duration":0.618},
{"type":"mark","name":"tsc.host.getApplicableRefactors","count":3,"args":{"GetApplicableRefactors":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"pos":0,"end":0},{"quotePreference":"auto","includeCompletionsForModuleExports":false,"includeCompletionsForImportStatements":true,"includeCompletionsWithSnippetText":true,"includeAutomaticOptionalChainCompletions":true,"includeCompletionsWithInsertText":true,"includeCompletionsWithClassMemberSnippets":true,"includeCompletionsWithObjectLiteralMethodSnippets":true,"useLabelDetailsInCompletionEntries":true,"allowIncompleteCompletions":true,"importModuleSpecifierPreference":"shortest","importModuleSpecifierEnding":"index","allowTextChangesInNewFiles":true,"providePrefixAndSuffixTextForRename":true,"provideRefactorNotApplicableReason":true,"jsxAttributeCompletionStyle":"auto","includeInlayParameterNameHints":"none","includeInlayParameterNameHintsWhenArgumentMatchesName":false,"includeInlayFunctionParameterTypeHints":false,"includeInlayVariableTypeHints":false,"includeInlayVariableTypeHintsWhenTypeMatchesName":false,"includeInlayPropertyDeclarationTypeHints":false,"includeInlayFunctionLikeReturnTypeHints":false,"includeInlayEnumMemberValueHints":false,"autoImportFileExcludePatterns":[],"interactiveInlayHints":true,"preferTypeOnlyAutoImports":false},"implicit",""]}},
{"type":"measure","name":"tsc.host.getApplicableRefactors","count":3,"duration":0.76},
{"type":"measure","name":"tsc.request.getApplicableRefactors","count":3,"duration":8.858},
{"type":"measure","name":"lsp.code_action","count":4,"duration":9.102},
{"type":"mark","name":"lsp.folding_range","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getOutliningSpans"},
{"type":"mark","name":"lsp.code_lens","count":2,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":7,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":7,"duration":0.0},
{"type":"measure","name":"lsp.code_lens","count":2,"duration":0.353},
{"type":"mark","name":"tsc.host.getOutliningSpans","count":2,"args":{"GetOutliningSpans":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"measure","name":"tsc.host.getOutliningSpans","count":2,"duration":58.231},
{"type":"measure","name":"tsc.request.getOutliningSpans","count":2,"duration":60.514},
{"type":"measure","name":"lsp.folding_range","count":2,"duration":60.751},
{"type":"mark","name":"lsp.inlay_hint","count":7,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":34}}}},
{"type":"mark","name":"lsp.inlay_hint","count":8,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":34}}}},
{"type":"mark","name":"lsp.inlay_hint","count":9,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":34}}}},
{"type":"mark","name":"lsp.inlay_hint","count":10,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":34}}}},
{"type":"mark","name":"lsp.did_change_batched","count":23,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":80,"duration":0.304},
{"type":"measure","name":"lsp.did_change_batched","count":23,"duration":12.576},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":21,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",81]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":12,"duration":0.036},
{"type":"mark","name":"tsc.op.op_load","count":319,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":319,"duration":0.075},
{"type":"mark","name":"tsc.op.op_resolve","count":841,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":841,"duration":0.075},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":21,"duration":664.412},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":21,"duration":666.838},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":19,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":19,"duration":0.201},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":19,"duration":5.24},
{"type":"measure","name":"lsp.diagnostic","count":71,"duration":672.323},
{"type":"mark","name":"lsp.inlay_hint","count":11,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":19}}}},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":19,"duration":0.058},
{"type":"mark","name":"lsp.document_symbol","count":8,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":8,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"mark","name":"tsc.request.getNavigationTree"},
{"type":"mark","name":"lsp.semantic_tokens_full","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.host.getNavigationTree","count":4,"args":{"GetNavigationTree":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"mark","name":"tsc.request.getEncodedSemanticClassifications"},
{"type":"mark","name":"lsp.inlay_hint","count":12,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":19}}}},
{"type":"measure","name":"tsc.host.getNavigationTree","count":4,"duration":48.157},
{"type":"measure","name":"tsc.request.getNavigationTree","count":4,"duration":49.92},
{"type":"measure","name":"lsp.get_navigation_tree","count":8,"duration":50.021},
{"type":"mark","name":"tsc.host.getEncodedSemanticClassifications","count":4,"args":{"GetEncodedSemanticClassifications":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"start":0,"length":51579},"2020"]}},
{"type":"measure","name":"lsp.document_symbol","count":8,"duration":52.842},
{"type":"measure","name":"tsc.host.getEncodedSemanticClassifications","count":4,"duration":129.94},
{"type":"measure","name":"tsc.request.getEncodedSemanticClassifications","count":4,"duration":181.676},
{"type":"measure","name":"lsp.semantic_tokens_full","count":3,"duration":182.086},
{"type":"mark","name":"lsp.code_action","count":5,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":0,"character":0},"end":{"line":0,"character":0}},"context":{"diagnostics":[],"triggerKind":2}}},
{"type":"mark","name":"tsc.request.getApplicableRefactors"},
{"type":"mark","name":"tsc.host.getApplicableRefactors","count":4,"args":{"GetApplicableRefactors":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"pos":0,"end":0},{"quotePreference":"auto","includeCompletionsForModuleExports":false,"includeCompletionsForImportStatements":true,"includeCompletionsWithSnippetText":true,"includeAutomaticOptionalChainCompletions":true,"includeCompletionsWithInsertText":true,"includeCompletionsWithClassMemberSnippets":true,"includeCompletionsWithObjectLiteralMethodSnippets":true,"useLabelDetailsInCompletionEntries":true,"allowIncompleteCompletions":true,"importModuleSpecifierPreference":"shortest","importModuleSpecifierEnding":"index","allowTextChangesInNewFiles":true,"providePrefixAndSuffixTextForRename":true,"provideRefactorNotApplicableReason":true,"jsxAttributeCompletionStyle":"auto","includeInlayParameterNameHints":"none","includeInlayParameterNameHintsWhenArgumentMatchesName":false,"includeInlayFunctionParameterTypeHints":false,"includeInlayVariableTypeHints":false,"includeInlayVariableTypeHintsWhenTypeMatchesName":false,"includeInlayPropertyDeclarationTypeHints":false,"includeInlayFunctionLikeReturnTypeHints":false,"includeInlayEnumMemberValueHints":false,"autoImportFileExcludePatterns":[],"interactiveInlayHints":true,"preferTypeOnlyAutoImports":false},"implicit",""]}},
{"type":"measure","name":"tsc.host.getApplicableRefactors","count":4,"duration":5.429},
{"type":"measure","name":"tsc.request.getApplicableRefactors","count":4,"duration":5.598},
{"type":"measure","name":"lsp.code_action","count":5,"duration":5.855},
{"type":"mark","name":"lsp.inlay_hint","count":13,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":19}}}},
{"type":"mark","name":"lsp.inlay_hint","count":14,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1795,"character":19}}}},
{"type":"mark","name":"lsp.document_symbol","count":9,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":9,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":9,"duration":0.0},
{"type":"measure","name":"lsp.document_symbol","count":9,"duration":0.764},
{"type":"mark","name":"lsp.inlay_hint","count":15,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":0}}}},
{"type":"mark","name":"lsp.code_lens","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":10,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":10,"duration":0.0},
{"type":"measure","name":"lsp.code_lens","count":3,"duration":0.425},
{"type":"mark","name":"lsp.folding_range","count":3,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getOutliningSpans"},
{"type":"mark","name":"tsc.host.getOutliningSpans","count":3,"args":{"GetOutliningSpans":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"measure","name":"tsc.host.getOutliningSpans","count":3,"duration":43.247},
{"type":"measure","name":"tsc.request.getOutliningSpans","count":3,"duration":46.139},
{"type":"measure","name":"lsp.folding_range","count":3,"duration":46.372},
{"type":"mark","name":"lsp.inlay_hint","count":16,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":0}}}},
{"type":"mark","name":"lsp.did_change_batched","count":24,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"lsp.did_change_batched","count":24,"duration":25.112},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"mark","name":"tsc.request.$getDiagnostics"},
{"type":"mark","name":"tsc.host.$getDiagnostics","count":22,"args":{"GetDiagnostics":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",82]}},
{"type":"mark","name":"tsc.op.op_script_version"},
{"type":"measure","name":"tsc.op.op_script_version","count":13,"duration":0.021},
{"type":"mark","name":"lsp.testing_update"},
{"type":"measure","name":"lsp.testing_update","count":81,"duration":0.303},
{"type":"mark","name":"tsc.op.op_load","count":320,"args":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},
{"type":"measure","name":"tsc.op.op_load","count":320,"duration":0.072},
{"type":"mark","name":"tsc.op.op_resolve","count":842,"args":{"base":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts","specifiers":[[false,"https://deno.land/std@0.168.0/http/server.ts"],[false,"https://esm.sh/@supabase/supabase-js@2"],[false,"../_shared/api-usage.ts"],[false,"../_shared/edge-auth.ts"]]}},
{"type":"measure","name":"tsc.op.op_resolve","count":842,"duration":0.078},
{"type":"measure","name":"tsc.host.$getDiagnostics","count":22,"duration":336.191},
{"type":"measure","name":"tsc.request.$getDiagnostics","count":22,"duration":336.383},
{"type":"mark","name":"tsc.request.$getAmbientModules"},
{"type":"mark","name":"tsc.host.$getAmbientModules","count":20,"args":"GetAmbientModules"},
{"type":"measure","name":"tsc.host.$getAmbientModules","count":20,"duration":0.175},
{"type":"measure","name":"tsc.request.$getAmbientModules","count":20,"duration":1.659},
{"type":"measure","name":"lsp.diagnostic","count":72,"duration":342.61},
{"type":"mark","name":"lsp.inlay_hint","count":17,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":20,"duration":0.058},
{"type":"mark","name":"lsp.document_symbol","count":10,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":11,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"mark","name":"tsc.request.getNavigationTree"},
{"type":"mark","name":"lsp.code_action","count":6,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":0,"character":0},"end":{"line":0,"character":0}},"context":{"diagnostics":[],"triggerKind":2}}},
{"type":"mark","name":"tsc.host.getNavigationTree","count":5,"args":{"GetNavigationTree":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"mark","name":"tsc.request.getApplicableRefactors"},
{"type":"mark","name":"lsp.semantic_tokens_full","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getEncodedSemanticClassifications"},
{"type":"mark","name":"lsp.inlay_hint","count":18,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"measure","name":"tsc.host.getNavigationTree","count":5,"duration":64.127},
{"type":"measure","name":"tsc.request.getNavigationTree","count":5,"duration":65.489},
{"type":"measure","name":"lsp.get_navigation_tree","count":11,"duration":65.996},
{"type":"measure","name":"lsp.document_symbol","count":10,"duration":66.731},
{"type":"mark","name":"tsc.host.getApplicableRefactors","count":5,"args":{"GetApplicableRefactors":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"pos":0,"end":0},{"quotePreference":"auto","includeCompletionsForModuleExports":false,"includeCompletionsForImportStatements":true,"includeCompletionsWithSnippetText":true,"includeAutomaticOptionalChainCompletions":true,"includeCompletionsWithInsertText":true,"includeCompletionsWithClassMemberSnippets":true,"includeCompletionsWithObjectLiteralMethodSnippets":true,"useLabelDetailsInCompletionEntries":true,"allowIncompleteCompletions":true,"importModuleSpecifierPreference":"shortest","importModuleSpecifierEnding":"index","allowTextChangesInNewFiles":true,"providePrefixAndSuffixTextForRename":true,"provideRefactorNotApplicableReason":true,"jsxAttributeCompletionStyle":"auto","includeInlayParameterNameHints":"none","includeInlayParameterNameHintsWhenArgumentMatchesName":false,"includeInlayFunctionParameterTypeHints":false,"includeInlayVariableTypeHints":false,"includeInlayVariableTypeHintsWhenTypeMatchesName":false,"includeInlayPropertyDeclarationTypeHints":false,"includeInlayFunctionLikeReturnTypeHints":false,"includeInlayEnumMemberValueHints":false,"autoImportFileExcludePatterns":[],"interactiveInlayHints":true,"preferTypeOnlyAutoImports":false},"implicit",""]}},
{"type":"measure","name":"tsc.host.getApplicableRefactors","count":5,"duration":0.561},
{"type":"mark","name":"tsc.host.getEncodedSemanticClassifications","count":5,"args":{"GetEncodedSemanticClassifications":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",{"start":0,"length":51694},"2020"]}},
{"type":"measure","name":"tsc.request.getApplicableRefactors","count":5,"duration":76.431},
{"type":"measure","name":"lsp.code_action","count":6,"duration":76.66},
{"type":"measure","name":"tsc.host.getEncodedSemanticClassifications","count":5,"duration":126.235},
{"type":"measure","name":"tsc.request.getEncodedSemanticClassifications","count":5,"duration":193.505},
{"type":"measure","name":"lsp.semantic_tokens_full","count":4,"duration":193.901},
{"type":"mark","name":"lsp.inlay_hint","count":19,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.inlay_hint","count":20,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.document_symbol","count":11,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":12,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":12,"duration":0.0},
{"type":"measure","name":"lsp.document_symbol","count":11,"duration":0.733},
{"type":"mark","name":"lsp.code_lens","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"lsp.get_navigation_tree","count":13,"args":{"specifier":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}},
{"type":"measure","name":"lsp.get_navigation_tree","count":13,"duration":0.001},
{"type":"measure","name":"lsp.code_lens","count":4,"duration":0.437},
{"type":"mark","name":"lsp.folding_range","count":4,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"}}},
{"type":"mark","name":"tsc.request.getOutliningSpans"},
{"type":"mark","name":"tsc.host.getOutliningSpans","count":4,"args":{"GetOutliningSpans":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"]}},
{"type":"measure","name":"tsc.host.getOutliningSpans","count":4,"duration":19.223},
{"type":"measure","name":"tsc.request.getOutliningSpans","count":4,"duration":20.331},
{"type":"measure","name":"lsp.folding_range","count":4,"duration":20.552},
{"type":"mark","name":"lsp.inlay_hint","count":21,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.did_change_batched","count":25,"args":"file:///workspaces/ProspectPro/database/auth-and-payments-schema.sql"},
{"type":"measure","name":"lsp.did_change_batched","count":25,"duration":0.695},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":73,"duration":0.016},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":21,"duration":0.021},
{"type":"mark","name":"lsp.inlay_hint","count":22,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":74,"duration":0.023},
{"type":"mark","name":"lsp.did_change_batched","count":26,"args":"file:///workspaces/ProspectPro/database/security-fixes-consolidated.sql"},
{"type":"measure","name":"lsp.did_change_batched","count":26,"duration":1.084},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":75,"duration":0.0},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":76,"duration":0.001},
{"type":"mark","name":"lsp.diagnostic"},
{"type":"measure","name":"lsp.diagnostic","count":77,"duration":0.001},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":22,"duration":0.023},
{"type":"mark","name":"lsp.inlay_hint","count":23,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.goto_definition","count":7,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"position":{"line":595,"character":13}}},
{"type":"mark","name":"tsc.request.getDefinitionAndBoundSpan"},
{"type":"mark","name":"tsc.host.getDefinitionAndBoundSpan","count":1,"args":{"GetDefinitionAndBoundSpan":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",14979]}},
{"type":"measure","name":"tsc.host.getDefinitionAndBoundSpan","count":1,"duration":114.115},
{"type":"measure","name":"tsc.request.getDefinitionAndBoundSpan","count":1,"duration":114.308},
{"type":"measure","name":"lsp.goto_definition","count":7,"duration":114.5},
{"type":"mark","name":"lsp.inlay_hint","count":24,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":23,"duration":0.064},
{"type":"mark","name":"lsp.inlay_hint","count":25,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"range":{"start":{"line":1623,"character":0},"end":{"line":1799,"character":19}}}},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":24,"duration":0.022},
{"type":"mark","name":"lsp.did_save"},
{"type":"measure","name":"lsp.did_save","count":25,"duration":0.022},
{"type":"mark","name":"lsp.did_open","count":95,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/tsconfig.json","languageId":"jsonc","version":1,"text":"{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n\n    /* Bundler mode */\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n\n    /* Linting */\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n\n    /* Path mapping */\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n"}}},
{"type":"measure","name":"lsp.did_open","count":95,"duration":0.047},
{"type":"mark","name":"lsp.goto_definition","count":8,"args":{"textDocument":{"uri":"file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts"},"position":{"line":595,"character":13}}},
{"type":"mark","name":"tsc.request.getDefinitionAndBoundSpan"},
{"type":"mark","name":"tsc.host.getDefinitionAndBoundSpan","count":2,"args":{"GetDefinitionAndBoundSpan":["file:///workspaces/ProspectPro/supabase/functions/business-discovery-background/index.ts",14979]}},
{"type":"measure","name":"tsc.host.getDefinitionAndBoundSpan","count":2,"duration":0.477},
{"type":"measure","name":"tsc.request.getDefinitionAndBoundSpan","count":2,"duration":0.63},
{"type":"measure","name":"lsp.goto_definition","count":8,"duration":0.792},
