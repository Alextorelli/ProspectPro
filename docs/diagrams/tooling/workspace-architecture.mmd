%% Workspace Architecture (Merged)
%% accTitle: Workspace Architecture
%% accDescr: AI agent entry through context hub, MCP fleet, repo automation, and feedback loops with directional annotations
%% Palette: app #2563eb, dev-tools #f97316, docs #16a34a, config #64748b, reports #facc15
flowchart TD
  subgraph AGENTS["Agent Entry"]
    A1["Developer Prompt / AI Agent"]
    style AGENTS fill:#f97316
  end
  subgraph CONTEXT["Context Hub üîÅ"]
    C1["Context Store"]
    C2["Knowledge Index (Docs + Code)"]
    style CONTEXT fill:#64748b
  end
  subgraph MCP["MCP Fleet"]
    M1["Production MCP"]
    M2["Development MCP"]
    M3["Troubleshooting MCP"]
    style MCP fill:#2563eb
  end
  subgraph REPO["Repo Automation"]
    R1["CI/CD Pipeline"]
    R2["Supabase Edge Functions"]
    style REPO fill:#16a34a
  end
  subgraph FEEDBACK["Feedback Loops"]
    F1["Thunder Tasks"]
    F2["Supabase Logs"]
    F3["Docs Update"]
    style FEEDBACK fill:#facc15
  end
  A1 --> C1
  C1 -->|"context hydrate"| C2
  C2 -->|"lookup"| M1
  C2 -->|"lookup"| M2
  C2 -->|"lookup"| M3
  M1 -->|"deploy"| R1
  M2 -->|"execute"| R2
  R1 -->|"metrics"| F1
  R2 -->|"logs"| F2
  F1 -->|"update"| C1
  F2 -->|"telemetry"| C1
  F3 -->|"regenerate"| C2
  F1 -.->|"feedback"| AGENTS
  F2 -.->|"feedback"| AGENTS
  classDef app fill:#2563eb;
  classDef devtools fill:#f97316;
  classDef docs fill:#16a34a;
  classDef config fill:#64748b;
  classDef reports fill:#facc15;
  %% Legend
  subgraph LEGEND["Legend"]
    direction LR
    L1["App"]
    L2["Dev-Tools"]
    L3["Docs"]
    L4["Config"]
    L5["Reports"]
    style LEGEND fill:#fff,stroke:#888,stroke-width:1px
    style L1 fill:#2563eb,color:#fff
    style L2 fill:#f97316,color:#fff
    style L3 fill:#16a34a,color:#fff
    style L4 fill:#64748b,color:#fff
    style L5 fill:#facc15,color:#222
  end
  %% Callout
  CALLOUT["‚ÑπÔ∏è MCP servers align with agent modes in MCP_MODE_TOOL_MATRIX.md"]
  style CALLOUT fill:#ffffcc,color:#333,stroke:#f97316,stroke-width:2px
