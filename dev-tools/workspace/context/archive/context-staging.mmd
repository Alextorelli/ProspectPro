%%{init: { "theme": "dark", "fontFamily": "Inter", "flowchart": { "htmlLabels": false, "curve": "monotoneX" } }}%%
flowchart LR
    subgraph OBS_FLOW["ğŸ“ˆ Observability Agent"]
        direction TB
        OBS_START["ğŸš€ Start"]
        OBS_ORCH["ğŸ§  Orchestrator<br/>Monitor Stack"]
        OBS_MEM["ï¿½ï¿½ Load Context<br/>60 entries"]
        OBS_MCP["ï¿½ï¿½ MCP Mesh<br/>Query Metrics Â· Logs"]
        OBS_SIG["ğŸ“Š Metrics<br/>ğŸ“œ Logs Â· ğŸš¨ Alerts"]
        OBS_SAVE["ğŸ’¾ Checkpoint<br/>Hourly"]
        OBS_END["âœ… Complete"]
        
        OBS_START --> OBS_ORCH
        OBS_ORCH --> OBS_MEM
        OBS_MEM --> OBS_MCP
        OBS_MCP --> OBS_SIG
        OBS_SIG --> OBS_SAVE
        OBS_SAVE --> OBS_END
        OBS_END -.-> OBS_START
    end

    subgraph SHARED["ğŸ”„ Shared Infrastructure"]
        ENV["ğŸ“Š Staging/Observability<br/>Read-Mostly"]
        CM["ğŸ—‚ï¸ Context Manager"]
        MEMORY["ğŸ§  Memory Store<br/>Metrics Â· Baselines Â· Checkpoints"]
        MCP["ğŸŒ Read-Focus MCP<br/>Supabase (RO) Â· Utility"]
    end

    subgraph DEV_FLOW["ğŸ’» Dev Workflow Agent (Support)"]
        direction TB
        DEV_START["ğŸš€ Start"]
        DEV_ORCH["ğŸ§  Orchestrator<br/>Support Diagnostics"]
        DEV_MEM["ğŸ§  Load Context<br/>Limited Write"]
        DEV_MCP["ğŸŒ MCP Mesh<br/>Diagnostics"]
        DEV_SIG["ğŸ” Diagnostic Results"]
        DEV_SAVE["ğŸ’¾ Checkpoint<br/>Selective"]
        DEV_END["âœ… Complete"]
        
        DEV_START --> DEV_ORCH
        DEV_ORCH --> DEV_MEM
        DEV_MEM --> DEV_MCP
        DEV_MCP --> DEV_SIG
        DEV_SIG --> DEV_SAVE
        DEV_SAVE --> DEV_END
        DEV_END -.-> DEV_START
    end

    OBS_FLOW -.-> SHARED
    DEV_FLOW -.-> SHARED
    SHARED -.-> OBS_FLOW
    SHARED -.-> DEV_FLOW

    style OBS_FLOW fill:#2a1a4a,stroke:#a78bfa,stroke-width:2px
    style DEV_FLOW fill:#1a2a3a,stroke:#60a5fa,stroke-width:2px,stroke-dasharray: 5 5
    style SHARED fill:#1a1a2a,stroke:#818cf8,stroke-width:2px
    style OBS_START fill:#4c1d95,stroke:#a78bfa,stroke-width:3px
    style DEV_START fill:#1e3a5f,stroke:#60a5fa,stroke-width:2px,stroke-dasharray: 5 5
    style OBS_END fill:#4c1d95,stroke:#a78bfa,stroke-width:3px
    style DEV_END fill:#1e3a5f,stroke:#60a5fa,stroke-width:2px,stroke-dasharray: 5 5
